!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).G6ExtensionVue={})}(this,(function(t){"use strict";var e="undefined"!=typeof document?document.currentScript:null,n="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}function o(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}function v(t,e){if(e&&("object"==r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function m(t,e,n){return e=p(e),v(t,g()?Reflect.construct(e,n||[],p(t).constructor):e.apply(t,n))}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function w(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}var k,M={exports:{}};var N=(k||(k=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||t,a),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,o,a){var s=n?n+t:t;if(!this._events[s])return!1;var l,c,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,i),!0;case 5:return u.fn.call(u.context,e,r,i,o),!0;case 6:return u.fn.call(u.context,e,r,i,o,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,r);break;case 4:u[c].fn.call(u[c].context,e,r,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==e||i&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s}(M)),M.exports),O=E(N),S=1e-6,T="undefined"!=typeof Float32Array?Float32Array:Array;function _(){var t=new T(9);return T!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function A(){var t=new T(16);return T!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function C(t){var e=new T(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function P(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function D(t,e,n,r,i,o,a,s,l,c,u,h,d,f,p,g){var v=new T(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=l,v[9]=c,v[10]=u,v[11]=h,v[12]=d,v[13]=f,v[14]=p,v[15]=g,v}function R(t,e,n,r,i,o,a,s,l,c,u,h,d,f,p,g,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=g,t[15]=v,t}function L(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function j(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=n*s-r*a,b=n*l-i*a,x=n*c-o*a,E=r*l-i*s,w=r*c-o*s,k=i*c-o*l,M=u*g-h*p,N=u*v-d*p,O=u*m-f*p,S=h*v-d*g,T=h*m-f*g,_=d*m-f*v,A=y*_-b*T+x*S+E*O-w*N+k*M;return A?(A=1/A,t[0]=(s*_-l*T+c*S)*A,t[1]=(i*T-r*_-o*S)*A,t[2]=(g*k-v*w+m*E)*A,t[3]=(d*w-h*k-f*E)*A,t[4]=(l*O-a*_-c*N)*A,t[5]=(n*_-i*O+o*N)*A,t[6]=(v*x-p*k-m*b)*A,t[7]=(u*k-d*x+f*b)*A,t[8]=(a*T-s*O+c*M)*A,t[9]=(r*O-n*T-o*M)*A,t[10]=(p*w-g*x+m*y)*A,t[11]=(h*x-u*w-f*y)*A,t[12]=(s*N-a*S-l*M)*A,t[13]=(n*S-r*N+i*M)*A,t[14]=(g*b-p*E-v*y)*A,t[15]=(u*E-h*b+d*y)*A,t):null}function F(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return(e*a-n*o)*(h*v-d*g)-(e*s-r*o)*(u*v-d*p)+(e*l-i*o)*(u*g-h*p)+(n*s-r*a)*(c*v-d*f)-(n*l-i*a)*(c*g-h*f)+(r*l-i*s)*(c*p-u*f)}function B(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],v=e[13],m=e[14],y=e[15],b=n[0],x=n[1],E=n[2],w=n[3];return t[0]=b*r+x*s+E*h+w*g,t[1]=b*i+x*l+E*d+w*v,t[2]=b*o+x*c+E*f+w*m,t[3]=b*a+x*u+E*p+w*y,b=n[4],x=n[5],E=n[6],w=n[7],t[4]=b*r+x*s+E*h+w*g,t[5]=b*i+x*l+E*d+w*v,t[6]=b*o+x*c+E*f+w*m,t[7]=b*a+x*u+E*p+w*y,b=n[8],x=n[9],E=n[10],w=n[11],t[8]=b*r+x*s+E*h+w*g,t[9]=b*i+x*l+E*d+w*v,t[10]=b*o+x*c+E*f+w*m,t[11]=b*a+x*u+E*p+w*y,b=n[12],x=n[13],E=n[14],w=n[15],t[12]=b*r+x*s+E*h+w*g,t[13]=b*i+x*l+E*d+w*v,t[14]=b*o+x*c+E*f+w*m,t[15]=b*a+x*u+E*p+w*y,t}function z(t,e,n){var r,i,o,a,s,l,c,u,h,d,f,p,g=n[0],v=n[1],m=n[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*m+e[12],t[13]=e[1]*g+e[5]*v+e[9]*m+e[13],t[14]=e[2]*g+e[6]*v+e[10]*m+e[14],t[15]=e[3]*g+e[7]*v+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=r*g+s*v+h*m+e[12],t[13]=i*g+l*v+d*m+e[13],t[14]=o*g+c*v+f*m+e[14],t[15]=a*g+u*v+p*m+e[15]),t}function V(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function G(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+u*r,t[6]=s*i+h*r,t[7]=l*i+d*r,t[8]=c*i-o*r,t[9]=u*i-a*r,t[10]=h*i-s*r,t[11]=d*i-l*r,t}function W(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-u*r,t[2]=s*i-h*r,t[3]=l*i-d*r,t[8]=o*r+c*i,t[9]=a*r+u*i,t[10]=s*r+h*i,t[11]=l*r+d*i,t}function $(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function H(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,e,n){var r,i,o,a=n[0],s=n[1],l=n[2],c=Math.hypot(a,s,l);return c<S?null:(a*=c=1/c,s*=c,l*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+l*r,t[2]=l*a*o-s*r,t[3]=0,t[4]=a*s*o-l*r,t[5]=s*s*o+i,t[6]=l*s*o+a*r,t[7]=0,t[8]=a*l*o+s*r,t[9]=s*l*o-a*r,t[10]=l*l*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Y(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function q(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function X(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function K(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,l=i+i,c=o+o,u=r*s,h=r*l,d=r*c,f=i*l,p=i*c,g=o*c,v=a*s,m=a*l,y=a*c;return t[0]=1-(f+g),t[1]=h+y,t[2]=d-m,t[3]=0,t[4]=h-y,t[5]=1-(u+g),t[6]=p+v,t[7]=0,t[8]=d+m,t[9]=p-v,t[10]=1-(u+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Z(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function J(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(l,c,u),t}function Q(t,e){var n=new T(3);J(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,l=e[2]*o,c=e[4]*r,u=e[5]*i,h=e[6]*o,d=e[8]*r,f=e[9]*i,p=e[10]*o,g=a+u+p,v=0;return g>0?(v=2*Math.sqrt(g+1),t[3]=.25*v,t[0]=(h-f)/v,t[1]=(d-l)/v,t[2]=(s-c)/v):a>u&&a>p?(v=2*Math.sqrt(1+a-u-p),t[3]=(h-f)/v,t[0]=.25*v,t[1]=(s+c)/v,t[2]=(d+l)/v):u>p?(v=2*Math.sqrt(1+u-a-p),t[3]=(d-l)/v,t[0]=(s+c)/v,t[1]=.25*v,t[2]=(h+f)/v):(v=2*Math.sqrt(1+p-a-u),t[3]=(s-c)/v,t[0]=(d+l)/v,t[1]=(h+f)/v,t[2]=.25*v),t}function tt(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],l=e[3],c=o+o,u=a+a,h=s+s,d=o*c,f=o*u,p=o*h,g=a*u,v=a*h,m=s*h,y=l*c,b=l*u,x=l*h,E=r[0],w=r[1],k=r[2],M=i[0],N=i[1],O=i[2],S=(1-(g+m))*E,T=(f+x)*E,_=(p-b)*E,A=(f-x)*w,C=(1-(d+m))*w,P=(v+y)*w,D=(p+b)*k,R=(v-y)*k,L=(1-(d+g))*k;return t[0]=S,t[1]=T,t[2]=_,t[3]=0,t[4]=A,t[5]=C,t[6]=P,t[7]=0,t[8]=D,t[9]=R,t[10]=L,t[11]=0,t[12]=n[0]+M-(S*M+A*N+D*O),t[13]=n[1]+N-(T*M+C*N+R*O),t[14]=n[2]+O-(_*M+P*N+L*O),t[15]=1,t}function et(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,l=i+i,c=n*a,u=r*a,h=r*s,d=i*a,f=i*s,p=i*l,g=o*a,v=o*s,m=o*l;return t[0]=1-h-p,t[1]=u+m,t[2]=d-v,t[3]=0,t[4]=u-m,t[5]=1-c-p,t[6]=f+g,t[7]=0,t[8]=d+v,t[9]=f-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nt(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var rt=nt;function it(t,e,n,r,i,o,a){var s=1/(e-n),l=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=(a+o)*c,t[15]=1,t}var ot=it;function at(t,e,n,r,i,o,a){var s=1/(e-n),l=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*l,t[14]=o*c,t[15]=1,t}function st(t,e,n,r){var i,o,a,s,l,c,u,h,d,f,p=e[0],g=e[1],v=e[2],m=r[0],y=r[1],b=r[2],x=n[0],E=n[1],w=n[2];return Math.abs(p-x)<S&&Math.abs(g-E)<S&&Math.abs(v-w)<S?L(t):(u=p-x,h=g-E,d=v-w,i=y*(d*=f=1/Math.hypot(u,h,d))-b*(h*=f),o=b*(u*=f)-m*d,a=m*h-y*u,(f=Math.hypot(i,o,a))?(i*=f=1/f,o*=f,a*=f):(i=0,o=0,a=0),s=h*a-d*o,l=d*i-u*a,c=u*o-h*i,(f=Math.hypot(s,l,c))?(s*=f=1/f,l*=f,c*=f):(s=0,l=0,c=0),t[0]=i,t[1]=s,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*p+o*g+a*v),t[13]=-(s*p+l*g+c*v),t[14]=-(u*p+h*g+d*v),t[15]=1,t)}function lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ct(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}var ut=B,ht=lt,dt=Object.freeze({__proto__:null,add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},adjoint:function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15];return t[0]=s*(d*m-f*v)-h*(l*m-c*v)+g*(l*f-c*d),t[1]=-(r*(d*m-f*v)-h*(i*m-o*v)+g*(i*f-o*d)),t[2]=r*(l*m-c*v)-s*(i*m-o*v)+g*(i*c-o*l),t[3]=-(r*(l*f-c*d)-s*(i*f-o*d)+h*(i*c-o*l)),t[4]=-(a*(d*m-f*v)-u*(l*m-c*v)+p*(l*f-c*d)),t[5]=n*(d*m-f*v)-u*(i*m-o*v)+p*(i*f-o*d),t[6]=-(n*(l*m-c*v)-a*(i*m-o*v)+p*(i*c-o*l)),t[7]=n*(l*f-c*d)-a*(i*f-o*d)+u*(i*c-o*l),t[8]=a*(h*m-f*g)-u*(s*m-c*g)+p*(s*f-c*h),t[9]=-(n*(h*m-f*g)-u*(r*m-o*g)+p*(r*f-o*h)),t[10]=n*(s*m-c*g)-a*(r*m-o*g)+p*(r*c-o*s),t[11]=-(n*(s*f-c*h)-a*(r*f-o*h)+u*(r*c-o*s)),t[12]=-(a*(h*v-d*g)-u*(s*v-l*g)+p*(s*d-l*h)),t[13]=n*(h*v-d*g)-u*(r*v-i*g)+p*(r*d-i*h),t[14]=-(n*(s*v-l*g)-a*(r*v-i*g)+p*(r*l-i*s)),t[15]=n*(s*d-l*h)-a*(r*d-i*h)+u*(r*l-i*s),t},clone:C,copy:P,create:A,determinant:F,equals:function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],v=t[14],m=t[15],y=e[0],b=e[1],x=e[2],E=e[3],w=e[4],k=e[5],M=e[6],N=e[7],O=e[8],T=e[9],_=e[10],A=e[11],C=e[12],P=e[13],D=e[14],R=e[15];return Math.abs(n-y)<=S*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=S*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=S*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-E)<=S*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(a-w)<=S*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-k)<=S*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-M)<=S*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-N)<=S*Math.max(1,Math.abs(c),Math.abs(N))&&Math.abs(u-O)<=S*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(h-T)<=S*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-_)<=S*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(f-A)<=S*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(p-C)<=S*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-P)<=S*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(v-D)<=S*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(m-R)<=S*Math.max(1,Math.abs(m),Math.abs(R))},exactEquals:ct,frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},fromQuat:et,fromQuat2:function(t,e){var n=new T(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+o*o+a*a;return h>0?(n[0]=2*(s*a+u*r+l*o-c*i)/h,n[1]=2*(l*a+u*i+c*r-s*o)/h,n[2]=2*(c*a+u*o+s*i-l*r)/h):(n[0]=2*(s*a+u*r+l*o-c*i),n[1]=2*(l*a+u*i+c*r-s*o),n[2]=2*(c*a+u*o+s*i-l*r)),K(t,e,n),t},fromRotation:U,fromRotationTranslation:K,fromRotationTranslationScale:function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],l=i+i,c=o+o,u=a+a,h=i*l,d=i*c,f=i*u,p=o*c,g=o*u,v=a*u,m=s*l,y=s*c,b=s*u,x=r[0],E=r[1],w=r[2];return t[0]=(1-(p+v))*x,t[1]=(d+b)*x,t[2]=(f-y)*x,t[3]=0,t[4]=(d-b)*E,t[5]=(1-(h+v))*E,t[6]=(g+m)*E,t[7]=0,t[8]=(f+y)*w,t[9]=(g-m)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:tt,fromScaling:H,fromTranslation:$,fromValues:D,fromXRotation:Y,fromYRotation:q,fromZRotation:X,frustum:function(t,e,n,r,i,o,a){var s=1/(n-e),l=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*l,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},getRotation:Q,getScaling:J,getTranslation:Z,identity:L,invert:j,lookAt:st,mul:ut,multiply:B,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},multiplyScalarAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},ortho:ot,orthoNO:it,orthoZO:at,perspective:rt,perspectiveFromFieldOfView:function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+s),c=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*l*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},perspectiveNO:nt,perspectiveZO:function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t},rotate:function(t,e,n,r){var i,o,a,s,l,c,u,h,d,f,p,g,v,m,y,b,x,E,w,k,M,N,O,T,_=r[0],A=r[1],C=r[2],P=Math.hypot(_,A,C);return P<S?null:(_*=P=1/P,A*=P,C*=P,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],l=e[1],c=e[2],u=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],v=e[9],m=e[10],y=e[11],b=_*_*a+o,x=A*_*a+C*i,E=C*_*a-A*i,w=_*A*a-C*i,k=A*A*a+o,M=C*A*a+_*i,N=_*C*a+A*i,O=A*C*a-_*i,T=C*C*a+o,t[0]=s*b+h*x+g*E,t[1]=l*b+d*x+v*E,t[2]=c*b+f*x+m*E,t[3]=u*b+p*x+y*E,t[4]=s*w+h*k+g*M,t[5]=l*w+d*k+v*M,t[6]=c*w+f*k+m*M,t[7]=u*w+p*k+y*M,t[8]=s*N+h*O+g*T,t[9]=l*N+d*O+v*T,t[10]=c*N+f*O+m*T,t[11]=u*N+p*O+y*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},rotateX:G,rotateY:W,rotateZ:function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+u*r,t[2]=s*i+h*r,t[3]=l*i+d*r,t[4]=c*i-o*r,t[5]=u*i-a*r,t[6]=h*i-s*r,t[7]=d*i-l*r,t},scale:V,set:R,str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},sub:ht,subtract:lt,targetTo:function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],l=r[1],c=r[2],u=i-n[0],h=o-n[1],d=a-n[2],f=u*u+h*h+d*d;f>0&&(u*=f=1/Math.sqrt(f),h*=f,d*=f);var p=l*d-c*h,g=c*u-s*d,v=s*h-l*u;return(f=p*p+g*g+v*v)>0&&(p*=f=1/Math.sqrt(f),g*=f,v*=f),t[0]=p,t[1]=g,t[2]=v,t[3]=0,t[4]=h*v-d*g,t[5]=d*p-u*v,t[6]=u*g-h*p,t[7]=0,t[8]=u,t[9]=h,t[10]=d,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t},translate:z,transpose:I});function ft(){var t=new T(3);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pt(t){var e=new T(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function gt(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function vt(t,e,n){var r=new T(3);return r[0]=t,r[1]=e,r[2]=n,r}function mt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function yt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function bt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function xt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Et(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function wt(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function kt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Mt(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=i*l-o*s,t[1]=o*a-r*l,t[2]=r*s-i*a,t}function Nt(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function Ot(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function St(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=S*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=S*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=S*Math.max(1,Math.abs(i),Math.abs(s))}var Tt=xt,_t=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)},At=gt;function Ct(){var t=new T(4);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Pt(t,e,n,r){var i=new T(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Dt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function Rt(){var t=new T(4);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Lt(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function It(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return t[0]=r*u+a*s+i*c-o*l,t[1]=i*u+a*l+o*s-r*c,t[2]=o*u+a*c+r*l-i*s,t[3]=a*u-r*s-i*l-o*c,t}function jt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function Ft(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r);return t[0]=o*l*u-a*s*c,t[1]=a*s*u+o*l*c,t[2]=a*l*c-o*s*u,t[3]=a*l*u+o*s*c,t}ft(),function(){var t=Ct()}();var Bt=Pt,zt=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Vt=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},Gt=It,Wt=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t};function $t(){var t=new T(2);return T!=Float32Array&&(t[0]=0,t[1]=0),t}ft(),vt(1,0,0),vt(0,1,0),Rt(),Rt(),_(),function(){var t=$t()}();var Ht=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},Ut=function(t,e){return void 0===e&&(e=[]),function(t,e){if(!Ht(t))return t;for(var n=[],r=0;r<t.length;r++){var i=t[r];e(i,r)&&n.push(i)}return n}(t,(function(t){return!function(t,e){return!!Ht(t)&&t.indexOf(e)>-1}(e,t)}))};function Yt(t){return"function"==typeof t}function qt(t){return null==t}function Xt(t){return Array.isArray(t)}var Kt=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function Zt(t,e){if(t)if(Xt(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(Kt(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}var Jt=function(t){return"object"==typeof t&&null!==t},Qt={}.toString,te=function(t,e){return Qt.call(t)==="[object "+e+"]"},ee=function(t){if(!Jt(t)||!te(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function ne(t){if(!Array.isArray(t))return-1/0;var e=t.length;if(!e)return-1/0;for(var n=t[0],r=1;r<e;r++)n=Math.max(n,t[r]);return n}var re=function(t){if(Xt(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])};function ie(t){return"string"==typeof t}var oe=Object.prototype.hasOwnProperty;function ae(t,e){if(!e||!Xt(t))return{};for(var n,r={},i=Yt(e)?e:function(t){return t[e]},o=0;o<t.length;o++){var a=t[o];n=i(a),oe.call(r,n)?r[n].push(a):r[n]=[a]}return r}var se=function(t,e,n){return t<e?e:t>n?n:t};function le(t){return"number"==typeof t}function ce(t,e,n){return void 0===n&&(n=1e-5),t===e||Math.abs(t-e)<n}var ue=function(t,e){if(Xt(t)){for(var n,r=-1/0,i=0;i<t.length;i++){var o=t[i],a=Yt(e)?e(o):o[e];a>r&&(n=o,r=a)}return n}},he=function(t,e){if(Xt(t)){for(var n,r=1/0,i=0;i<t.length;i++){var o=t[i],a=Yt(e)?e(o):o[e];a<r&&(n=o,r=a)}return n}},de=function(t,e){return(t%e+e)%e},fe=function(t){return qt(t)?"":t.toString()};var pe=function(t){var e=fe(t);return e.charAt(0).toUpperCase()+e.substring(1)},ge={}.toString,ve=function(t){return te(t,"Boolean")};var me=Object.prototype,ye=function(t){return void 0===t},be=function(t){if("object"!=typeof t||null===t)return t;var e;if(Xt(t)){e=[];for(var n=0,r=t.length;n<r;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=be(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=be(t[i]):e[i]=t[i];return e};function xe(t,e,n){var r;return function(){var i=this,o=arguments,a=n&&!r;clearTimeout(r),r=setTimeout((function(){r=null,n||t.apply(i,o)}),e),a&&t.apply(i,o)}}var Ee=new Map;function we(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function ke(t,e,n,r){for(var i in n=n||0,r=r||5,e)if(we(e,i)){var o=e[i];null!==o&&ee(o)?(ee(t[i])||(t[i]={}),n<r?ke(t[i],o,n+1,r):t[i]=e[i]):Xt(o)?(t[i]=[],t[i]=t[i].concat(o)):void 0!==o&&(t[i]=o)}}var Me=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)ke(t,e[r]);return t},Ne=Object.prototype.hasOwnProperty;function Oe(t){if(qt(t))return!0;if(Ht(t))return!t.length;var e=function(t){return ge.call(t).replace(/^\[object /,"").replace(/]$/,"")}(t);if("Map"===e||"Set"===e)return!t.size;if(function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||me)}(t))return!Object.keys(t).length;for(var n in t)if(Ne.call(t,n))return!1;return!0}var Se=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(ie(t)||ie(e))return!1;if(Ht(t)||Ht(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=Se(t[r],e[r]));r++);return n}if(Jt(t)||Jt(e)){var i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(n=!0,r=0;r<i.length&&(n=Se(t[i[r]],e[i[r]]));r++);return n}return!1},Te=function(t,e,n){for(var r=0,i=ie(e)?e.split("."):e;t&&r<i.length;)t=t[i[r++]];return void 0===t||r<i.length?n:t},_e=function(t,e,n){var r=t,i=ie(e)?e.split("."):e;return i.forEach((function(t,e){e<i.length-1?(Kt(r[t])||(r[t]=le(i[e+1])?[]:{}),r=r[t]):r[t]=n})),t},Ae=Object.prototype.hasOwnProperty,Ce=function(t,e){if(null===t||!ee(t))return{};var n={};return Zt(e,(function(e){Ae.call(t,e)&&(n[e]=t[e])})),n},Pe=function(t,e){return function(t,e,n){if(!Xt(t)&&!ee(t))return t;var r=n;return Zt(t,(function(t,n){r=e(r,t,n)})),r}(t,(function(t,n,r){return e.includes(r)||(t[r]=n),t}),{})},De=function(t,e,n){var r,i,o,a,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=Date.now();s||!1!==n.leading||(s=c);var u=e-(c-s);return i=this,o=arguments,u<=0||u>e?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(l,u)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},Re={},Le=function(){},Ie=function(t){return t},je=function(t,e){return je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},je(t,e)};function Fe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}je(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Be=function(){return Be=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Be.apply(this,arguments)};function ze(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function Ve(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function Ge(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function We(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function $e(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function He(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}"function"==typeof SuppressedError&&SuppressedError;var Ue={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Ye(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}var qe={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Xe(t){return Array.isArray(t)&&t.every((function(t){var e=t[0].toLowerCase();return qe[e]===t.length-1&&"achlmqstvz".includes(e)}))}function Ke(t){return Xe(t)&&t.every((function(t){var e=t[0];return e===e.toUpperCase()}))}function Ze(t){return Ke(t)&&t.every((function(t){var e=t[0];return"ACLMQZ".includes(e)}))}function Je(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=qe[n]&&("m"===n&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,qe[n]))),qe[n]););}function Qe(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'.concat(n[e],'", expecting 0 or 1 at index ').concat(e))}function tn(t){return t>=48&&t<=57||43===t||45===t||46===t}function en(t){return t>=48&&t<=57}function nn(t){var e,n=t.max,r=t.pathValue,i=t.index,o=i,a=!1,s=!1,l=!1,c=!1;if(o>=n)t.err="[path-util]: Invalid path value at index ".concat(o,', "pathValue" is missing param');else if(43!==(e=r.charCodeAt(o))&&45!==e||(o+=1,e=r.charCodeAt(o)),en(e)||46===e){if(46!==e){if(a=48===e,o+=1,e=r.charCodeAt(o),a&&o<n&&e&&en(e))return void(t.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(r[i],'" illegal number'));for(;o<n&&en(r.charCodeAt(o));)o+=1,s=!0;e=r.charCodeAt(o)}if(46===e){for(c=!0,o+=1;en(r.charCodeAt(o));)o+=1,l=!0;e=r.charCodeAt(o)}if(101===e||69===e){if(c&&!s&&!l)return void(t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" invalid float exponent'));if(o+=1,43!==(e=r.charCodeAt(o))&&45!==e||(o+=1),!(o<n&&en(r.charCodeAt(o))))return void(t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" invalid integer exponent'));for(;o<n&&en(r.charCodeAt(o));)o+=1}t.index=o,t.param=+t.pathValue.slice(i,o)}else t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" is not a number')}function rn(t){for(var e,n=t.pathValue,r=t.max;t.index<r&&(10===(e=n.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e));)t.index+=1}function on(t){var e=t.max,n=t.pathValue,r=t.index,i=n.charCodeAt(r),o=qe[n[r].toLowerCase()];if(t.segmentStart=r,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(i))if(t.index+=1,rn(t),t.data=[],o){for(;;){for(var a=o;a>0;a-=1){if(97!=(32|i)||3!==a&&4!==a?nn(t):Qe(t),t.err.length)return;t.data.push(t.param),rn(t),t.index<e&&44===n.charCodeAt(t.index)&&(t.index+=1,rn(t))}if(t.index>=t.max)break;if(!tn(n.charCodeAt(t.index)))break}Je(t)}else Je(t);else t.err='[path-util]: Invalid path value "'.concat(n[r],'" is not a path command')}var an=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function sn(t){if(Ke(t))return[].concat(t);var e=function(t){if(Xe(t))return[].concat(t);var e=new an(t);for(rn(e);e.index<e.max&&!e.err.length;)on(e);return e.err?e.err:e.segments}(t),n=0,r=0,i=0,o=0;return e.map((function(t){var e,a=t.slice(1).map(Number),s=t[0],l=s.toUpperCase();if("M"===s)return n=a[0],r=a[1],i=n,o=r,["M",n,r];if(s!==l)switch(l){case"A":e=[l,a[0],a[1],a[2],a[3],a[4],a[5]+n,a[6]+r];break;case"V":e=[l,a[0]+r];break;case"H":e=[l,a[0]+n];break;default:var c=a.map((function(t,e){return t+(e%2?r:n)}));e=[l].concat(c)}else e=[l].concat(a);var u=e.length;switch(l){case"Z":n=i,r=o;break;case"H":n=e[1];break;case"V":r=e[1];break;default:n=e[u-2],r=e[u-1],"M"===l&&(i=n,o=r)}return e}))}function ln(t,e){var n=t[0],r=e.x1,i=e.y1,o=e.x2,a=e.y2,s=t.slice(1).map(Number),l=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)l=["L",t[1],i];else if("V"===n)l=["L",r,t[1]];else if("S"===n){var c=2*r-o,u=2*i-a;e.x1=c,e.y1=u,l=["C",c,u].concat(s)}else if("T"===n){var h=2*r-e.qx,d=2*i-e.qy;e.qx=h,e.qy=d,l=["Q",h,d].concat(s)}else if("Q"===n){var f=s[0],p=s[1];e.qx=f,e.qy=p}return l}function cn(t){if(Ze(t))return[].concat(t);for(var e=sn(t),n=Be({},Ue),r=0;r<e.length;r+=1){e[r]=ln(e[r],n);var i=e[r],o=i.length;n.x1=+i[o-2],n.y1=+i[o-1],n.x2=+i[o-4]||n.x1,n.y2=+i[o-3]||n.y1}return e}function un(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function hn(t,e,n,r,i,o,a,s,l,c){var u,h,d,f,p,g=t,v=e,m=n,y=r,b=s,x=l,E=120*Math.PI/180,w=Math.PI/180*(+i||0),k=[];if(c)h=c[0],d=c[1],f=c[2],p=c[3];else{g=(u=un(g,v,-w)).x,v=u.y;var M=(g-(b=(u=un(b,x,-w)).x))/2,N=(v-(x=u.y))/2,O=M*M/(m*m)+N*N/(y*y);O>1&&(m*=O=Math.sqrt(O),y*=O);var S=m*m,T=y*y,_=(o===a?-1:1)*Math.sqrt(Math.abs((S*T-S*N*N-T*M*M)/(S*N*N+T*M*M)));f=_*m*N/y+(g+b)/2,p=_*-y*M/m+(v+x)/2,h=Math.asin(((v-p)/y*Math.pow(10,9)|0)/Math.pow(10,9)),d=Math.asin(((x-p)/y*Math.pow(10,9)|0)/Math.pow(10,9)),h=g<f?Math.PI-h:h,d=b<f?Math.PI-d:d,h<0&&(h=2*Math.PI+h),d<0&&(d=2*Math.PI+d),a&&h>d&&(h-=2*Math.PI),!a&&d>h&&(d-=2*Math.PI)}var A=d-h;if(Math.abs(A)>E){var C=d,P=b,D=x;d=h+E*(a&&d>h?1:-1),k=hn(b=f+m*Math.cos(d),x=p+y*Math.sin(d),m,y,i,0,a,P,D,[d,C,f,p])}A=d-h;var R=Math.cos(h),L=Math.sin(h),I=Math.cos(d),j=Math.sin(d),F=Math.tan(A/4),B=4/3*m*F,z=4/3*y*F,V=[g,v],G=[g+B*L,v-z*R],W=[b+B*j,x-z*I],$=[b,x];if(G[0]=2*V[0]-G[0],G[1]=2*V[1]-G[1],c)return G.concat(W,$,k);for(var H=[],U=0,Y=(k=G.concat(W,$,k)).length;U<Y;U+=1)H[U]=U%2?un(k[U-1],k[U],w).y:un(k[U],k[U+1],w).x;return H}function dn(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}var fn=function(t,e,n,r){return $e($e([],dn([t,e],[n,r],.5),!0),[n,r,n,r],!1)};function pn(t,e){var n,r,i,o,a,s,l,c,u,h=t[0],d=t.slice(1).map(Number),f=d[0],p=d[1],g=e.x1,v=e.y1,m=e.x,y=e.y;switch("TQ".includes(h)||(e.qx=null,e.qy=null),h){case"M":return e.x=f,e.y=p,t;case"A":return n=[g,v].concat(d),["C"].concat(hn(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=f,e.qy=p,n=[g,v].concat(d),["C"].concat((r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],[(c=1/3)*r+(u=2/3)*o,c*i+u*a,c*s+u*o,c*l+u*a,s,l]));case"L":return["C"].concat(fn(g,v,f,p));case"Z":return g===m&&v===y?["C",g,v,m,y,m,y]:["C"].concat(fn(g,v,m,y))}return t}function gn(t,e){if(void 0===e&&(e=!1),function(t){return Ze(t)&&t.every((function(t){var e=t[0];return"MC".includes(e)}))}(t)){var n=[].concat(t);return e?[n,[]]:n}for(var r,i,o=cn(t),a=Be({},Ue),s=[],l="",c=o.length,u=[],h=0;h<c;h+=1){o[h]&&(l=o[h][0]),s[h]=l;var d=pn(o[h],a);o[h]=d,Ye(o,s,h),c=o.length,"Z"===l&&u.push(h),i=(r=o[h]).length,a.x1=+r[i-2],a.y1=+r[i-1],a.x2=+r[i-4]||a.x1,a.y2=+r[i-3]||a.y1}return e?[o,u]:o}function vn(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function mn(t,e,n,r,i){var o=vn([t,e],[n,r]),a={x:0,y:0};if("number"==typeof i)if(i<=0)a={x:t,y:e};else if(i>=o)a={x:n,y:r};else{var s=dn([t,e],[n,r],i/o);a={x:s[0],y:s[1]}}return{length:o,point:a,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function yn(t,e){var n=t.x,r=t.y,i=e.x,o=e.y,a=n*i+r*o,s=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(o,2)));return(n*o-r*i<0?-1:1)*Math.acos(a/s)}function bn(t,e,n,r,i,o,a,s,l,c){var u=Math.abs,h=Math.sin,d=Math.cos,f=Math.sqrt,p=Math.PI,g=u(n),v=u(r),m=(i%360+360)%360*(p/180);if(t===s&&e===l)return{x:t,y:e};if(0===g||0===v)return mn(t,e,s,l,c).point;var y=(t-s)/2,b=(e-l)/2,x={x:d(m)*y+h(m)*b,y:-h(m)*y+d(m)*b},E=Math.pow(x.x,2)/Math.pow(g,2)+Math.pow(x.y,2)/Math.pow(v,2);E>1&&(g*=f(E),v*=f(E));var w=(Math.pow(g,2)*Math.pow(v,2)-Math.pow(g,2)*Math.pow(x.y,2)-Math.pow(v,2)*Math.pow(x.x,2))/(Math.pow(g,2)*Math.pow(x.y,2)+Math.pow(v,2)*Math.pow(x.x,2)),k=(o!==a?1:-1)*f(w=w<0?0:w),M=k*(g*x.y/v),N=k*(-v*x.x/g),O=d(m)*M-h(m)*N+(t+s)/2,S=h(m)*M+d(m)*N+(e+l)/2,T={x:(x.x-M)/g,y:(x.y-N)/v},_=yn({x:1,y:0},T),A=yn(T,{x:(-x.x-M)/g,y:(-x.y-N)/v});!a&&A>0?A-=2*p:a&&A<0&&(A+=2*p);var C=_+(A%=2*p)*c,P=g*d(C),D=v*h(C);return{x:d(m)*P-h(m)*D+O,y:h(m)*P+d(m)*D+S}}function xn(t,e,n,r,i,o,a,s,l,c,u){var h,d=u.bbox,f=void 0===d||d,p=u.length,g=void 0===p||p,v=u.sampleSize,m=void 0===v?30:v,y="number"==typeof c,b=t,x=e,E=0,w=[b,x,E],k=[b,x],M={x:0,y:0},N=[{x:b,y:x}];y&&c<=0&&(M={x:b,y:x});for(var O=0;O<=m;O+=1){if(b=(h=bn(t,e,n,r,i,o,a,s,l,O/m)).x,x=h.y,f&&N.push({x:b,y:x}),g&&(E+=vn(k,[b,x])),k=[b,x],y&&E>=c&&c>w[2]){var S=(E-c)/(E-w[2]);M={x:k[0]*(1-S)+w[0]*S,y:k[1]*(1-S)+w[1]*S}}w=[b,x,E]}return y&&c>=E&&(M={x:s,y:l}),{length:E,point:M,min:{x:Math.min.apply(null,N.map((function(t){return t.x}))),y:Math.min.apply(null,N.map((function(t){return t.y})))},max:{x:Math.max.apply(null,N.map((function(t){return t.x}))),y:Math.max.apply(null,N.map((function(t){return t.y})))}}}function En(t,e,n,r,i,o,a,s,l){var c=1-l;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*l*n+3*c*Math.pow(l,2)*i+Math.pow(l,3)*a,y:Math.pow(c,3)*e+3*Math.pow(c,2)*l*r+3*c*Math.pow(l,2)*o+Math.pow(l,3)*s}}function wn(t,e,n,r,i,o,a,s,l,c){var u,h=c.bbox,d=void 0===h||h,f=c.length,p=void 0===f||f,g=c.sampleSize,v=void 0===g?10:g,m="number"==typeof l,y=t,b=e,x=0,E=[y,b,x],w=[y,b],k={x:0,y:0},M=[{x:y,y:b}];m&&l<=0&&(k={x:y,y:b});for(var N=0;N<=v;N+=1){if(y=(u=En(t,e,n,r,i,o,a,s,N/v)).x,b=u.y,d&&M.push({x:y,y:b}),p&&(x+=vn(w,[y,b])),w=[y,b],m&&x>=l&&l>E[2]){var O=(x-l)/(x-E[2]);k={x:w[0]*(1-O)+E[0]*O,y:w[1]*(1-O)+E[1]*O}}E=[y,b,x]}return m&&l>=x&&(k={x:a,y:s}),{length:x,point:k,min:{x:Math.min.apply(null,M.map((function(t){return t.x}))),y:Math.min.apply(null,M.map((function(t){return t.y})))},max:{x:Math.max.apply(null,M.map((function(t){return t.x}))),y:Math.max.apply(null,M.map((function(t){return t.y})))}}}function kn(t,e,n,r,i,o,a){var s=1-a;return{x:Math.pow(s,2)*t+2*s*a*n+Math.pow(a,2)*i,y:Math.pow(s,2)*e+2*s*a*r+Math.pow(a,2)*o}}function Mn(t,e,n,r,i,o,a,s){var l,c=s.bbox,u=void 0===c||c,h=s.length,d=void 0===h||h,f=s.sampleSize,p=void 0===f?10:f,g="number"==typeof a,v=t,m=e,y=0,b=[v,m,y],x=[v,m],E={x:0,y:0},w=[{x:v,y:m}];g&&a<=0&&(E={x:v,y:m});for(var k=0;k<=p;k+=1){if(v=(l=kn(t,e,n,r,i,o,k/p)).x,m=l.y,u&&w.push({x:v,y:m}),d&&(y+=vn(x,[v,m])),x=[v,m],g&&y>=a&&a>b[2]){var M=(y-a)/(y-b[2]);E={x:x[0]*(1-M)+b[0]*M,y:x[1]*(1-M)+b[1]*M}}b=[v,m,y]}return g&&a>=y&&(E={x:i,y:o}),{length:y,point:E,min:{x:Math.min.apply(null,w.map((function(t){return t.x}))),y:Math.min.apply(null,w.map((function(t){return t.y})))},max:{x:Math.max.apply(null,w.map((function(t){return t.x}))),y:Math.max.apply(null,w.map((function(t){return t.y})))}}}function Nn(t,e,n){for(var r,i,o,a,s,l,c,u,h,d=cn(t),f="number"==typeof e,p=[],g=0,v=0,m=0,y=0,b=[],x=[],E=0,w={x:0,y:0},k=w,M=w,N=w,O=0,S=0,T=d.length;S<T;S+=1)p=(c="M"===(u=(h=d[S])[0]))?p:[g,v].concat(h.slice(1)),c?(k=w={x:m=h[1],y:y=h[2]},E=0,f&&e<.001&&(N=w)):"L"===u?(E=(r=mn(p[0],p[1],p[2],p[3],(e||0)-O)).length,w=r.min,k=r.max,M=r.point):"A"===u?(E=(i=xn(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],(e||0)-O,n||{})).length,w=i.min,k=i.max,M=i.point):"C"===u?(E=(o=wn(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],(e||0)-O,n||{})).length,w=o.min,k=o.max,M=o.point):"Q"===u?(E=(a=Mn(p[0],p[1],p[2],p[3],p[4],p[5],(e||0)-O,n||{})).length,w=a.min,k=a.max,M=a.point):"Z"===u&&(E=(s=mn((p=[g,v,m,y])[0],p[1],p[2],p[3],(e||0)-O)).length,w=s.min,k=s.max,M=s.point),f&&O<e&&O+E>=e&&(N=M),x.push(k),b.push(w),O+=E,g=(l="Z"!==u?h.slice(-2):[m,y])[0],v=l[1];return f&&e>=O&&(N={x:g,y:v}),{length:O,point:N,min:{x:Math.min.apply(null,b.map((function(t){return t.x}))),y:Math.min.apply(null,b.map((function(t){return t.y})))},max:{x:Math.max.apply(null,x.map((function(t){return t.x}))),y:Math.max.apply(null,x.map((function(t){return t.y})))}}}function On(t,e){var n=t.length-1,r=[],i=0,o=function(t){var e=t.length,n=e-1;return t.map((function(r,i){return t.map((function(r,o){var a,s=i+o;return 0===o||t[s]&&"M"===t[s][0]?(a=t[s],["M"].concat(a.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(t);return o.forEach((function(o,a){t.slice(1).forEach((function(r,o){i+=vn(t[(a+o)%n].slice(-2),e[o%n].slice(-2))})),r[a]=i,i=0})),o[r.indexOf(Math.min.apply(null,r))]}function Sn(t){return function(t){var e=0,n=0,r=0;return gn(t).map((function(t){var i;if("M"===t[0])return e=t[1],n=t[2],0;var o=t.slice(1),a=o[0],s=o[1],l=o[2],c=o[3],u=o[4],h=o[5];return r=function(t,e,n,r,i,o,a,s){return 3*((s-e)*(n+i)-(a-t)*(r+o)+r*(t-i)-n*(e-o)+s*(i+t/3)-a*(o+e/3))/20}(e,n,a,s,l,c,u,h),i=t.slice(-2),e=i[0],n=i[1],r})).reduce((function(t,e){return t+e}),0)}(t)>=0}function Tn(t){return t.map((function(t,e,n){var r=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?wn(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],{bbox:!1}).length:0;return{s:t,ss:e?i?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),o=t.slice(6,8),a=dn(n,r,e),s=dn(r,i,e),l=dn(i,o,e),c=dn(a,s,e),u=dn(s,l,e),h=dn(c,u,e);return[["C"].concat(a,c,h),["C"].concat(u,l,o)]}(r):[t,t]:[t],l:i}}))}function _n(t,e,n){var r=Tn(t),i=Tn(e),o=r.length,a=i.length,s=r.filter((function(t){return t.l})).length,l=i.filter((function(t){return t.l})).length,c=r.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/s||0,u=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/l||0,h=n||Math.max(o,a),d=[c,u],f=[h-o,h-a],p=0,g=[r,i].map((function(t,e){return t.l===h?t.map((function(t){return t.s})):t.map((function(t,n){return p=n&&f[e]&&t.l>=d[e],f[e]-=p?1:0,p?t.ss:[t.s]})).flat()}));return g[0].length===g[1].length?g:_n(g[0],g[1],h)}function An(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}function Cn(){return Cn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cn.apply(null,arguments)}function Pn(t,e,n,r){var i=Cn(p(t.prototype),e,n);return"function"==typeof i?function(t){return i.apply(n,t)}:i}function Dn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Rn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ln(){}var In=.7,jn=1/In,Fn="\\s*([+-]?\\d+)\\s*",Bn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vn=/^#([0-9a-f]{3,8})$/,Gn=new RegExp(`^rgb\\(${Fn},${Fn},${Fn}\\)$`),Wn=new RegExp(`^rgb\\(${zn},${zn},${zn}\\)$`),$n=new RegExp(`^rgba\\(${Fn},${Fn},${Fn},${Bn}\\)$`),Hn=new RegExp(`^rgba\\(${zn},${zn},${zn},${Bn}\\)$`),Un=new RegExp(`^hsl\\(${Bn},${zn},${zn}\\)$`),Yn=new RegExp(`^hsla\\(${Bn},${zn},${zn},${Bn}\\)$`),qn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xn(){return this.rgb().formatHex()}function Kn(){return this.rgb().formatRgb()}function Zn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Vn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Jn(e):3===n?new tr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Qn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Qn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Gn.exec(t))?new tr(e[1],e[2],e[3],1):(e=Wn.exec(t))?new tr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=$n.exec(t))?Qn(e[1],e[2],e[3],e[4]):(e=Hn.exec(t))?Qn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Un.exec(t))?ar(e[1],e[2]/100,e[3]/100,1):(e=Yn.exec(t))?ar(e[1],e[2]/100,e[3]/100,e[4]):qn.hasOwnProperty(t)?Jn(qn[t]):"transparent"===t?new tr(NaN,NaN,NaN,0):null}function Jn(t){return new tr(t>>16&255,t>>8&255,255&t,1)}function Qn(t,e,n,r){return r<=0&&(t=e=n=NaN),new tr(t,e,n,r)}function tr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function er(){return`#${or(this.r)}${or(this.g)}${or(this.b)}`}function nr(){const t=rr(this.opacity);return`${1===t?"rgb(":"rgba("}${ir(this.r)}, ${ir(this.g)}, ${ir(this.b)}${1===t?")":`, ${t})`}`}function rr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ir(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function or(t){return((t=ir(t))<16?"0":"")+t.toString(16)}function ar(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new lr(t,e,n,r)}function sr(t){if(t instanceof lr)return new lr(t.h,t.s,t.l,t.opacity);if(t instanceof Ln||(t=Zn(t)),!t)return new lr;if(t instanceof lr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new lr(a,s,l,t.opacity)}function lr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function cr(t){return(t=(t||0)%360)<0?t+360:t}function ur(t){return Math.max(0,Math.min(1,t||0))}function hr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function dr(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function fr(t,e){var n=Math.min.apply(Math,$e([],We(t),!1)),r=Math.min.apply(Math,$e([],We(e),!1));return{x:n,y:r,width:Math.max.apply(Math,$e([],We(t),!1))-n,height:Math.max.apply(Math,$e([],We(e),!1))-r}}function pr(t,e,n,r,i,o){return n*Math.cos(i)*Math.cos(o)-r*Math.sin(i)*Math.sin(o)+t}function gr(t,e,n,r,i,o){return n*Math.sin(i)*Math.cos(o)+r*Math.cos(i)*Math.sin(o)+e}function vr(t,e,n,r,i,o,a){for(var s=function(t,e,n){return Math.atan(-e/t*Math.tan(n))}(n,r,i),l=1/0,c=-1/0,u=[o,a],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var d=s+h;o<a?o<d&&d<a&&u.push(d):a<d&&d<o&&u.push(d)}for(h=0;h<u.length;h++){var f=pr(t,0,n,r,i,u[h]);f<l&&(l=f),f>c&&(c=f)}var p=function(t,e,n){return Math.atan(e/(t*Math.tan(n)))}(n,r,i),g=1/0,v=-1/0,m=[o,a];for(h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var y=p+h;o<a?o<y&&y<a&&m.push(y):a<y&&y<o&&m.push(y)}for(h=0;h<m.length;h++){var b=gr(0,e,n,r,i,m[h]);b<g&&(g=b),b>v&&(v=b)}return{x:l,y:g,width:c-l,height:v-g}}Dn(Ln,Zn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Xn,formatHex:Xn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return sr(this).formatHsl()},formatRgb:Kn,toString:Kn}),Dn(tr,(function(t,e,n,r){return 1===arguments.length?((i=t)instanceof Ln||(i=Zn(i)),i?new tr((i=i.rgb()).r,i.g,i.b,i.opacity):new tr):new tr(t,e,n,null==r?1:r);var i}),Rn(Ln,{brighter(t){return t=null==t?jn:Math.pow(jn,t),new tr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?In:Math.pow(In,t),new tr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tr(ir(this.r),ir(this.g),ir(this.b),rr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:er,formatHex:er,formatHex8:function(){return`#${or(this.r)}${or(this.g)}${or(this.b)}${or(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:nr,toString:nr})),Dn(lr,(function(t,e,n,r){return 1===arguments.length?sr(t):new lr(t,e,n,null==r?1:r)}),Rn(Ln,{brighter(t){return t=null==t?jn:Math.pow(jn,t),new lr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?In:Math.pow(In,t),new lr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new tr(hr(t>=240?t-240:t+120,i,r),hr(t,i,r),hr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new lr(cr(this.h),ur(this.s),ur(this.l),rr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=rr(this.opacity);return`${1===t?"hsl(":"hsla("}${cr(this.h)}, ${100*ur(this.s)}%, ${100*ur(this.l)}%${1===t?")":`, ${t})`}`}}));function mr(t,e,n,r,i,o){var a=-1,s=1/0,l=[n,r],c=20;o&&o>200&&(c=o/10);for(var u=1/c,h=u/10,d=0;d<=c;d++){var f=d*u,p=[i.apply(void 0,$e([],We(t.concat([f])),!1)),i.apply(void 0,$e([],We(e.concat([f])),!1))];(y=dr(l[0],l[1],p[0],p[1]))<s&&(a=f,s=y)}if(0===a)return{x:t[0],y:e[0]};if(1===a){var g=t.length;return{x:t[g-1],y:e[g-1]}}s=1/0;for(d=0;d<32&&!(h<1e-4);d++){var v=a-h,m=a+h,y=(p=[i.apply(void 0,$e([],We(t.concat([v])),!1)),i.apply(void 0,$e([],We(e.concat([v])),!1))],dr(l[0],l[1],p[0],p[1]));if(v>=0&&y<s)a=v,s=y;else{var b=[i.apply(void 0,$e([],We(t.concat([m])),!1)),i.apply(void 0,$e([],We(e.concat([m])),!1))],x=dr(l[0],l[1],b[0],b[1]);m<=1&&x<s?(a=m,s=x):h*=.5}}return{x:i.apply(void 0,$e([],We(t.concat([a])),!1)),y:i.apply(void 0,$e([],We(e.concat([a])),!1))}}function yr(t,e,n,r){return dr(t,e,n,r)}function br(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}}function xr(t,e,n,r,i,o){var a=[n-t,r-e];if(function(t,e){return t[0]===e[0]&&t[1]===e[1]}(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var s=[-a[1],a[0]];!function(t,e){var n=e[0],r=e[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i}(s,s);var l=[i-t,o-e];return Math.abs(function(t,e){return t[0]*e[0]+t[1]*e[1]}(l,s))}function Er(t,e,n,r,i){var o=1-i;return o*o*o*t+3*e*i*o*o+3*n*i*i*o+r*i*i*i}function wr(t,e,n,r){var i,o,a,s=-3*t+9*e-9*n+3*r,l=6*t-12*e+6*n,c=3*e-3*t,u=[];if(ce(s,0))ce(l,0)||(i=-c/l)>=0&&i<=1&&u.push(i);else{var h=l*l-4*s*c;ce(h,0)?u.push(-l/(2*s)):h>0&&(o=(-l-(a=Math.sqrt(h)))/(2*s),(i=(-l+a)/(2*s))>=0&&i<=1&&u.push(i),o>=0&&o<=1&&u.push(o))}return u}function kr(t,e,n,r,i,o,a,s){for(var l=[t,a],c=[e,s],u=wr(t,n,i,a),h=wr(e,r,o,s),d=0;d<u.length;d++)l.push(Er(t,n,i,a,u[d]));for(d=0;d<h.length;d++)c.push(Er(e,r,o,s,h[d]));return fr(l,c)}function Mr(t,e,n,r,i,o,a,s,l,c,u){var h=function(t,e,n,r,i,o,a,s,l,c,u){return mr([t,n,i,a],[e,r,o,s],l,c,Er,u)}(t,e,n,r,i,o,a,s,l,c,u);return dr(h.x,h.y,l,c)}function Nr(t){return function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=dr(r[0],r[1],i[0],i[1])}return e}(t)}function Or(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function Sr(t,e,n){var r=t+n-2*e;if(ce(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function Tr(t,e,n,r,i,o){var a=Sr(t,n,i)[0],s=Sr(e,r,o)[0],l=[t,i],c=[e,o];return void 0!==a&&l.push(Or(t,n,i,a)),void 0!==s&&c.push(Or(e,r,o,s)),fr(l,c)}function _r(t,e,n,r,i,o,a,s){var l=function(t,e,n,r,i,o,a,s){return mr([t,n,i],[e,r,o],a,s,Or)}(t,e,n,r,i,o,a,s);return dr(l.x,l.y,a,s)}function Ar(){Ar=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),s=new C(r||[]);return o(a,"_invoke",{value:S(t,n,s)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",g="executing",v="completed",m={};function y(){}function b(){}function x(){}var E={};u(E,s,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(P([])));k&&k!==n&&i.call(k,s)&&(E=k);var M=x.prototype=y.prototype=Object.create(E);function N(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,a,s,l){var c=d(t[o],t,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==r(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=f;return function(o,a){if(i===g)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var c=d(e,n,r);if("normal"===c.type){if(i=r.done?v:p,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=d(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(i.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return b.prototype=x,o(M,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:b,configurable:!0}),b.displayName=u(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,c,"GeneratorFunction")),t.prototype=Object.create(M),t},e.awrap=function(t){return{__await:t}},N(O.prototype),u(O.prototype,l,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(h(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},N(M),u(M,c,"Generator"),u(M,s,(function(){return this})),u(M,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=P,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Cr(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function Pr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Cr(o,r,i,a,s,"next",t)}function s(t){Cr(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Dr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=d(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Rr(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n||"undefined"!=typeof self&&self;var Lr={exports:{}};!function(t){t.exports=function(){function t(t,n,i,o,a){e(t,n,i||0,o||t.length-1,a||r)}function e(t,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,l=r-i+1,c=Math.log(s),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-l*u/s+h)),Math.min(o,Math.floor(r+(s-l)*u/s+h)),a)}var d=t[r],f=i,p=o;for(n(t,i,r),a(t[o],d)>0&&n(t,i,o);f<p;){for(n(t,f,p),f++,p--;a(t[f],d)<0;)f++;for(;a(t[p],d)>0;)p--}0===a(t[i],d)?n(t,i,p):n(t,++p,o),p<=r&&(i=p+1),r<=p&&(o=p-1)}}function n(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function r(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];l(i,t.leaf?r(a):a)}return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function p(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function v(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!v(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;v(t,s)&&(e.leaf?n.push(a):g(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!v(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(v(t,o)){if(e.leaf||g(t,o))return!0;n.push(i)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=m([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,r,i,a=this.data,s=this.toBBox(t),l=[],c=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=c.pop(),i=!0),a.leaf){var u=o(t,a.children,e);if(-1!==u)return a.children.splice(u,1),l.push(a),this._condense(l),this}i||a.leaf||!g(a,s)?r?(n++,a=r.children[n],i=!1):a=null:(l.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)return a(i=m(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=m([])).leaf=!1,i.height=r;var l=Math.ceil(o/s),c=l*Math.ceil(Math.sqrt(s));y(t,e,n,c,this.compareMinX);for(var u=e;u<=n;u+=c){var h=Math.min(u+c-1,n);y(t,u,h,l,this.compareMinY);for(var d=u;d<=h;d+=l){var f=Math.min(d+l-1,h);i.children.push(this._build(t,d,f,r-1))}}return a(i,this.toBBox),i},i.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var l=e.children[s],c=h(l),u=f(t,l)-c;u<o?(o=u,i=c<i?c:i,a=l):u===o&&c<i&&(i=c,a=l)}e=a||e.children[0]}return e},i.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),l(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},i.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=m(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},i.prototype._splitRoot=function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var r,i=1/0,o=1/0,a=e;a<=n-e;a++){var l=s(t,0,a,this.toBBox),c=s(t,a,n,this.toBBox),u=p(l,c),d=h(l)+h(c);u<i?(i=u,r=a,o=d<o?d:o):u===i&&d<o&&(o=d,r=a)}return r||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},i.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),a=s(t,n-e,n,i),c=d(o)+d(a),u=e;u<n-e;u++){var h=t.children[u];l(o,t.leaf?i(h):h),c+=d(o)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];l(a,t.leaf?i(p):p),c+=d(a)}return c},i.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():a(t[e],this.toBBox)},i}()}(Lr);var Ir=Lr.exports,jr=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),Fr=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),Br=function(){return u((function t(){l(this,t),this.plugins=[]}),[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))}}])}(),zr=function(){return u((function t(e){l(this,t),this.clipSpaceNearZ=Fr.NEGATIVE_ONE,this.plugins=[],this.config=s({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}),[{key:"registerPlugin",value:function(t){var e=this.plugins.findIndex((function(e){return e===t}));-1===e&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find((function(e){return e.name===t}))}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),Vr=bt,Gr=mt,Wr=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},$r=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},Hr=Et,Ur=Tt,Yr=function(){function t(){l(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return u(t,[{key:"update",value:function(t,e){Gr(this.center,t),Gr(this.halfExtents,e),Ur(this.min,this.center,this.halfExtents),Vr(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){Vr(this.center,e,t),Hr(this.center,this.center,.5),Ur(this.halfExtents,e,t),Hr(this.halfExtents,this.halfExtents,.5),Gr(this.min,t),Gr(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,r=n[0],i=n[1],o=n[2],a=this.halfExtents,s=a[0],l=a[1],c=a[2],u=r-s,h=r+s,d=i-l,f=i+l,p=o-c,g=o+c,v=e.center,m=v[0],y=v[1],b=v[2],x=e.halfExtents,E=x[0],w=x[1],k=x[2],M=m-E,N=m+E,O=y-w,S=y+w,T=b-k,_=b+k;M<u&&(u=M),N>h&&(h=N),O<d&&(d=O),S>f&&(f=S),T<p&&(p=T),_>g&&(g=_),n[0]=.5*(u+h),n[1]=.5*(d+f),n[2]=.5*(p+g),a[0]=.5*(h-u),a[1]=.5*(f-d),a[2]=.5*(g-p),this.min[0]=u,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,o=t.halfExtents,a=e[0],s=e[4],l=e[8],c=e[1],u=e[5],h=e[9],d=e[2],f=e[6],p=e[10],g=Math.abs(a),v=Math.abs(s),m=Math.abs(l),y=Math.abs(c),b=Math.abs(u),x=Math.abs(h),E=Math.abs(d),w=Math.abs(f),k=Math.abs(p);n[0]=e[12]+a*i[0]+s*i[1]+l*i[2],n[1]=e[13]+c*i[0]+u*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+p*i[2],r[0]=g*o[0]+v*o[1]+m*o[2],r[1]=y*o[0]+b*o[1]+x*o[2],r[2]=E*o[0]+w*o[1]+k*o[2],Ur(this.min,n,r),Vr(this.max,n,r)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=Wr([0,0,0],this.getMin(),e.getMin()),i=$r([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Gr([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Gr([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),qr=function(){return u((function t(e,n){l(this,t),this.distance=e||0,this.normal=n||vt(0,1,0),this.updatePNVertexFlag()}),[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return kt(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/At(this.normal);Et(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),o=i>=0&&i<=1;return o&&n&&Nt(n,t,e,i),o}}])}(),Xr=function(t){return t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE",t}({}),Kr=function(){return u((function t(e){if(l(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new qr)}),[{key:"extractFromVPMatrix",value:function(t){var e=x(t,16),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15];yt(this.planes[0].normal,o-n,c-a,f-u),this.planes[0].distance=m-p,yt(this.planes[1].normal,o+n,c+a,f+u),this.planes[1].distance=m+p,yt(this.planes[2].normal,o+r,c+s,f+h),this.planes[2].distance=m+g,yt(this.planes[3].normal,o-r,c-s,f-h),this.planes[3].distance=m-g,yt(this.planes[4].normal,o-i,c-l,f-d),this.planes[4].distance=m-v,yt(this.planes[5].normal,o+i,c+l,f+d),this.planes[5].distance=m+v,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}])}(),Zr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;l(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return u(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),Jr=function(){function t(e,n,r,i){l(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i}return u(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var r=Pt(e.x,e.y,0,1),i=Pt(e.x+e.width,e.y,0,1),o=Pt(e.x,e.y+e.height,0,1),a=Pt(e.x+e.width,e.y+e.height,0,1),s=Ct(),l=Ct(),c=Ct(),u=Ct();Dt(s,r,n),Dt(l,i,n),Dt(c,o,n),Dt(u,a,n);var h=Math.min(s[0],l[0],c[0],u[0]),d=Math.min(s[1],l[1],c[1],u[1]),f=Math.max(s[0],l[0],c[0],u[0]),p=Math.max(s[1],l[1],c[1],u[1]);return t.fromRect({x:h,y:d,width:f-h,height:p-d})}}])}(),Qr="Method not implemented.",ti="Use document.documentElement instead.";function ei(t){return void 0===t?0:t>360||t<-360?t%360:t}var ni=ft();function ri(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?r?pt(t):mt(ni,t):le(t)?r?vt(t,e,n):yt(ni,t,e,n):r?vt(t[0],t[1]||e,t[2]||n):yt(ni,t[0],t[1]||e,t[2]||n)}var ii=Math.PI/180;function oi(t){return t*ii}var ai=180/Math.PI;function si(t){return t*ai}var li=Math.PI/2;function ci(t,e){return 16===e.length?function(t,e){var n,r,i=x(J(ft(),e),3),o=i[0],a=i[1],s=i[2],l=Math.asin(-e[2]/o);return l<li?l>-li?(n=Math.atan2(e[6]/a,e[10]/s),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/a,e[5]/a)):(r=0,n=Math.atan2(e[4]/a,e[5]/a)),t[0]=n,t[1]=l,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=r*r,s=i*i,l=o*o,c=n*n+a+s+l,u=n*o-r*i;return u>.499995*c?(t[0]=li,t[1]=2*Math.atan2(r,n),t[2]=0):u<-.499995*c?(t[0]=-li,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-o*r)),t[1]=Math.atan2(2*(n*o+r*i),1-2*(s+l)),t[2]=Math.atan2(2*(n*r+i*o),1-2*(a+s))),t}(t,e)}function ui(t,e,n,r,i){var o,a,s,l,c,u,h,d,f,p,g=Math.cos(t),v=Math.sin(t);return o=r*g,a=i*v,s=0,l=-r*v,c=i*g,u=0,h=e,d=n,f=1,(p=new T(9))[0]=o,p[1]=a,p[2]=s,p[3]=l,p[4]=c,p[5]=u,p[6]=h,p[7]=d,p[8]=f,p}function hi(t){var e=t[0],n=t[1],r=t[3],i=t[4],o=Math.sqrt(e*e+n*n),a=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?o=-o:a=-a),o){var s=1/o;e*=s,n*=s}if(a){var l=1/a;r*=l,i*=l}var c=si(Math.atan2(n,e));return[t[6],t[7],o,a,c]}var di=A(),fi=A(),pi=Ct(),gi=[ft(),ft(),ft()],vi=ft();function mi(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}var yi=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),bi=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),xi=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),Ei="updated",wi=2e-4,ki=function(){return u((function t(){l(this,t),this.clipSpaceNearZ=Fr.NEGATIVE_ONE,this.eventEmitter=new O,this.matrix=A(),this.right=vt(1,0,0),this.up=vt(0,1,0),this.forward=vt(0,0,1),this.position=vt(0,0,1),this.focalPoint=vt(0,0,0),this.distanceVector=vt(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=A(),this.projectionMatrixInverse=A(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=yi.EXPLORING,this.trackingMode=bi.DEFAULT,this.projectionMode=xi.PERSPECTIVE,this.frustum=new Kr,this.orthoMatrix=A()}),[{key:"isOrtho",value:function(){return this.projectionMode===xi.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===yi.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===yi.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==yi.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return j(A(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=$(A(),[t,e,0]);this.jitteredProjectionMatrix=B(A(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===xi.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===xi.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,r,i,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===xi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===xi.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===xi.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===xi.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,o);var a=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=vt(a.x-r,a.y-i,0),l=kt(s,this.right)/gt(this.right),c=kt(s,this.up)/gt(this.up),u=x(this.getPosition(),2),h=u[0],d=u[1],f=x(this.getFocalPoint(),2),p=f[0],g=f[1];return this.setPosition(h-l,d-c),this.setFocalPoint(p-l,g-c),this}},{key:"setPerspective",value:function(t,e,n,r){var i;this.projectionMode=xi.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var o=this.near*Math.tan(oi(.5*this.fov))/this.zoom,a=2*o,s=this.aspect*a,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var c=this.view.fullWidth,u=this.view.fullHeight;l+=this.view.offsetX*s/c,o-=this.view.offsetY*a/u,s*=this.view.width/c,a*=this.view.height/u}return function(t,e,n,r,i,o,a){var s,l,c=2*o,u=n-e,h=r-i,d=c/u,f=c/h,p=(n+e)/u,g=(r+i)/h,v=a-o,m=a*o;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-a/v,l=-m/v):(s=-(a+o)/v,l=-2*m/v),t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=p,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,o-a,o,t,this.far,this.clipSpaceNearZ===Fr.ZERO),j(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,r,i,o){var a;this.projectionMode=xi.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=o;var s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),c=(this.rright+this.left)/2,u=(this.top+this.bottom)/2,h=c-s,d=c+s,f=u+l,p=u-l;if(null!==(a=this.view)&&void 0!==a&&a.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(h+=g*this.view.offsetX)+g*this.view.width,p=(f-=v*this.view.offsetY)-v*this.view.height}return this.clipSpaceNearZ===Fr.NEGATIVE_ONE?ot(this.projectionMatrix,h,d,f,p,i,o):at(this.projectionMatrix,h,d,f,p,i,o),j(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=ri(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=vt(0,1,0);if(this.focalPoint=ri(t,e,n),this.trackingMode===bi.CINEMATIC){var i=xt(ft(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var o=gt(i),a=si(Math.asin(e/o)),s=90+si(Math.atan2(n,t)),l=A();W(l,l,oi(s)),G(l,l,oi(a)),r=Ot(ft(),[0,1,0],l)}return j(this.matrix,st(A(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<wi&&(this.distance=wi),this.dollyingStep=this.distance/100;var e=ft();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=ei(t),this.computeMatrix(),this._getAxes(),this.type===yi.ORBITING||this.type===yi.EXPLORING?this._getPosition():this.type===yi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=ei(t),this.computeMatrix(),this._getAxes(),this.type===yi.ORBITING||this.type===yi.EXPLORING?this._getPosition():this.type===yi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=ei(t),this.computeMatrix(),this._getAxes(),this.type===yi.ORBITING||this.type===yi.EXPLORING?this._getPosition():this.type===yi.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Lt(Rt(),[0,0,1],oi(this.roll));L(this.matrix);var e=Lt(Rt(),[1,0,0],oi((this.rotateWorld&&this.type!==yi.TRACKING||this.type===yi.TRACKING?1:-1)*this.elevation)),n=Lt(Rt(),[0,1,0],oi((this.rotateWorld&&this.type!==yi.TRACKING||this.type===yi.TRACKING?1:-1)*this.azimuth)),r=It(Rt(),n,e);r=It(Rt(),r,t);var i=et(A(),r);this.type===yi.ORBITING||this.type===yi.EXPLORING?(z(this.matrix,this.matrix,this.focalPoint),B(this.matrix,this.matrix,i),z(this.matrix,this.matrix,[0,0,this.distance])):this.type===yi.TRACKING&&(z(this.matrix,this.matrix,this.position),B(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(t,e,n){this.position=ri(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){mt(this.right,ri(Dt(Ct(),[1,0,0,0],this.matrix))),mt(this.up,ri(Dt(Ct(),[0,1,0,0],this.matrix))),mt(this.forward,ri(Dt(Ct(),[0,0,1,0],this.matrix))),wt(this.right,this.right),wt(this.up,this.up),wt(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=gt(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===yi.TRACKING||this.rotateWorld?(this.elevation=si(Math.asin(e/r)),this.azimuth=si(Math.atan2(-t,-n))):(this.elevation=-si(Math.asin(e/r)),this.azimuth=-si(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){mt(this.position,ri(Dt(Ct(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){!function(t,e,n){var r=e[0],i=e[1],o=e[2];t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8]}(this.distanceVector,[0,0,-this.distance],function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}(_(),this.matrix)),bt(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=xt(ft(),this.focalPoint,this.position),this.distance=gt(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===xi.ORTHOGRAPHIC){var t=this.position,e=Lt(Rt(),[0,0,1],-this.roll*Math.PI/180);tt(this.orthoMatrix,e,vt((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),vt(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=B(A(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(Ei)}}},{key:"rotate",value:function(t,e,n){throw new Error(Qr)}},{key:"pan",value:function(t,e){throw new Error(Qr)}},{key:"dolly",value:function(t){throw new Error(Qr)}},{key:"createLandmark",value:function(t,e){throw new Error(Qr)}},{key:"gotoLandmark",value:function(t,e){throw new Error(Qr)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(Qr)}}])}(),Mi=function(t){return t[t.Standard=0]="Standard",t}({}),Ni=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),Oi={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Jr(0,0,0,0)},Si=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function Ti(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e?e.apply(this,i):i[0],s=n.cache;if(s.has(a))return s.get(a);var l=t.apply(this,i);return n.cache=s.set(a,l)||s,l};return n.cache=new(Ti.Cache||Map),n}Ti.Cache=Map;var _i=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),Ai=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),Ci=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),Pi=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),Di=[{name:"em",unit_type:_i.kEms},{name:"px",unit_type:_i.kPixels},{name:"deg",unit_type:_i.kDegrees},{name:"rad",unit_type:_i.kRadians},{name:"grad",unit_type:_i.kGradians},{name:"ms",unit_type:_i.kMilliseconds},{name:"s",unit_type:_i.kSeconds},{name:"rem",unit_type:_i.kRems},{name:"turn",unit_type:_i.kTurns}],Ri=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),Li=function(t){return t?"number"===t?_i.kNumber:"percent"===t||"%"===t?_i.kPercentage:function(t){return Di.find((function(e){return e.name===t})).unit_type}(t):_i.kUnknown},Ii=function(t){var e=1;switch(t){case _i.kPixels:case _i.kDegrees:case _i.kSeconds:break;case _i.kMilliseconds:e=.001;break;case _i.kRadians:e=180/Math.PI;break;case _i.kGradians:e=.9;break;case _i.kTurns:e=360}return e},ji=function(t){switch(t){case _i.kNumber:case _i.kInteger:return"";case _i.kPercentage:return"%";case _i.kEms:return"em";case _i.kRems:return"rem";case _i.kPixels:return"px";case _i.kDegrees:return"deg";case _i.kRadians:return"rad";case _i.kGradians:return"grad";case _i.kMilliseconds:return"ms";case _i.kSeconds:return"s";case _i.kTurns:return"turn"}return""},Fi=function(){return u((function t(){l(this,t)}),[{key:"toString",value:function(){return this.buildCSSText(Ci.kNo,Pi.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Ri.kUnitType&&this.getType()<=Ri.kClampType}}],[{key:"isAngle",value:function(t){return t===_i.kDegrees||t===_i.kRadians||t===_i.kGradians||t===_i.kTurns}},{key:"isLength",value:function(t){return t>=_i.kEms&&t<_i.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===_i.kPercentage||t===_i.kEms||t===_i.kRems}},{key:"isTime",value:function(t){return t===_i.kSeconds||t===_i.kMilliseconds}}])}(),Bi=function(t){function e(t){var n;return l(this,e),(n=m(this,e)).colorSpace=t,n}return b(e,t),u(e,[{key:"getType",value:function(){return Ri.kColorType}},{key:"to",value:function(t){return this}}])}(Fi),zi=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),Vi=function(t){function e(t,n){var r;return l(this,e),(r=m(this,e)).type=t,r.value=n,r}return b(e,t),u(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return Ri.kColorType}}])}(Fi),Gi=function(t){function e(t){var n;return l(this,e),(n=m(this,e)).value=t,n}return b(e,t),u(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return Ri.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(Fi),Wi=function(t){return function(t){switch(t){case Ai.kUNumber:return _i.kNumber;case Ai.kULength:return _i.kPixels;case Ai.kUPercent:return _i.kPercentage;case Ai.kUTime:return _i.kSeconds;case Ai.kUAngle:return _i.kDegrees;default:return _i.kUnknown}}(function(t){switch(t){case _i.kNumber:case _i.kInteger:return Ai.kUNumber;case _i.kPercentage:return Ai.kUPercent;case _i.kPixels:return Ai.kULength;case _i.kMilliseconds:case _i.kSeconds:return Ai.kUTime;case _i.kDegrees:case _i.kRadians:case _i.kGradians:case _i.kTurns:return Ai.kUAngle;default:return Ai.kUOther}}(t))},$i=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_i.kNumber;return l(this,e),n=m(this,e),r="string"==typeof i?Li(i):i,n.unit=r,n.value=t,n}return b(e,t),u(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return Ri.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=Wi(this.unit);if(n!==Wi(t)||n===_i.kUnknown)return null;var r=Ii(this.unit)/Ii(t);return new e(this.value*r,t)}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case _i.kUnknown:break;case _i.kInteger:r=Number(this.value).toFixed(0);break;case _i.kNumber:case _i.kPercentage:case _i.kEms:case _i.kRems:case _i.kPixels:case _i.kDegrees:case _i.kRadians:case _i.kGradians:case _i.kMilliseconds:case _i.kSeconds:case _i.kTurns:var i=this.value,o=ji(this.unit);if(i<-999999||i>999999){var a=ji(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(i,a):i+(a||"")}else r="".concat(i).concat(o)}return n+=r}}])}(Fi),Hi=new $i(0,"px");new $i(1,"px");var Ui=new $i(0,"deg"),Yi=function(t){function e(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return l(this,e),(i=m(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=o,i.isNone=a,i}return b(e,t),u(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(Bi),qi=new Gi("unset"),Xi={"":qi,unset:qi,initial:new Gi("initial"),inherit:new Gi("inherit")},Ki=new Yi(0,0,0,0,!0),Zi=new Yi(0,0,0,0),Ji=Ti((function(t,e,n,r){return new Yi(t,e,n,r)}),(function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")")})),Qi=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_i.kNumber;return new $i(t,e)};function to(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new $i(50,"%");var eo=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,i=/^(conic\-gradient)/i,o=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,a=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,p=/^,/,g=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,m=/^rgb/i,y=/^rgba/i,b=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function E(t){throw new Error("".concat(x,": ").concat(t))}function w(){var t=P(k);return x.length>0&&E("Invalid input not EOF"),t}function k(){return M("linear-gradient",t,O)||M("repeating-linear-gradient",e,O)||M("radial-gradient",n,S)||M("repeating-radial-gradient",r,S)||M("conic-gradient",i,S)}function M(t,e,n){return N(e,(function(e){var r=n();return r&&(F(p)||E("Missing comma before color stops")),{type:t,orientation:r,colorStops:P(D)}}))}function N(t,e){var n=F(t);if(n){F(d)||E("Missing (");var r=e(n);return F(f)||E("Missing )"),r}}function O(){return j("directional",o,1)||j("angular",h,1)}function S(){var t,e,n=T();return n&&((t=[]).push(n),e=x,F(p)&&((n=T())?t.push(n):x=e)),t}function T(){var t=function(){var t=j("shape",/^(circle)/i,0);t&&(t.style=I()||_());return t}()||function(){var t=j("shape",/^(ellipse)/i,0);t&&(t.style=L()||_());return t}();if(t)t.at=A();else{var e=_();if(e){t=e;var n=A();n&&(t.at=n)}else{var r=C();r&&(t={type:"default-radial",at:r})}}return t}function _(){return j("extent-keyword",a,1)}function A(){if(j("position",/^at/,0)){var t=C();return t||E("Missing positioning value"),t}}function C(){var t={x:L(),y:L()};if(t.x||t.y)return{type:"position",value:t}}function P(t){var e=t(),n=[];if(e)for(n.push(e);F(p);)(e=t())?n.push(e):E("One extra comma");return n}function D(){var t=j("hex",g,1)||N(y,(function(){return{type:"rgba",value:P(R)}}))||N(m,(function(){return{type:"rgb",value:P(R)}}))||j("literal",v,0);return t||E("Expected color definition"),t.length=L(),t}function R(){return F(b)[1]}function L(){return j("%",c,1)||j("position-keyword",s,1)||I()}function I(){return j("px",l,1)||j("em",u,1)}function j(t,e,n){var r=F(e);if(r)return{type:t,value:r[n]}}function F(t){var e=/^[\n\r\t\s]+/.exec(x);e&&B(e[0].length);var n=t.exec(x);return n&&B(n[0].length),n}function B(t){x=x.substring(t)}return function(t){return x=t,w()}}();var no=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,ro=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,io=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,oo=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;var ao={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},so=Ti((function(t){var e;return e="angular"===t.type?Number(t.value):ao[t.value]||0,Qi(e,"deg")})),lo=Ti((function(t){var e=50,n=50,r="%",i="%";if("position"===(null==t?void 0:t.type)){var o=t.value,a=o.x,s=o.y;"position-keyword"===(null==a?void 0:a.type)&&("left"===a.value?e=0:"center"===a.value?e=50:"right"===a.value?e=100:"top"===a.value?n=0:"bottom"===a.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==a?void 0:a.type)&&"%"!==(null==a?void 0:a.type)&&"em"!==(null==a?void 0:a.type)||(r=null==a?void 0:a.type,e=Number(a.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(i=null==s?void 0:s.type,n=Number(s.value))}return{cx:Qi(e,r),cy:Qi(n,i)}})),co=Ti((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eo(t).map((function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e,n,r=t.length;t[r-1].length=null!==(e=t[r-1].length)&&void 0!==e?e:{type:"%",value:"100"},r>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var i=0,o=Number(t[0].length.value),a=1;a<r;a++){var s,l=null===(s=t[a].length)||void 0===s?void 0:s.value;if(!qt(l)&&!qt(o)){for(var c=1;c<a-i;c++)t[i+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(a-i))};i=a,o=Number(l)}}}(r);var i,o=r.map((function(t){return{offset:Qi(Number(t.length.value),"%"),color:to(t)}}));if("linear-gradient"===e)return new Vi(zi.LinearGradient,{angle:n?so(n):Ui,steps:o});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,s=lo(n[0].at),l=s.cx,c=s.cy;if(n[0].style){var u=n[0].style,h=u.type,d=u.value;"extent-keyword"===h?(Xi[i=d]||(Xi[i]=new Gi(i)),a=Xi[i]):a=Qi(d,h)}return new Vi(zi.RadialGradient,{cx:l,cy:c,size:a,steps:o})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=no.exec(t);if(n){var r,i=(null===(r=n[2].match(oo))||void 0===r?void 0:r.map((function(t){return t.split(":")})))||[];return[new Vi(zi.LinearGradient,{angle:Qi(parseFloat(n[1]),"deg"),steps:i.map((function(t){var e=x(t,2),n=e[0],r=e[1];return{offset:Qi(100*Number(n),"%"),color:r}}))})]}}else if("r"===e){var o=function(t){var e=ro.exec(t);if(e){var n,r=(null===(n=e[4].match(oo))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:Qi(50,"%"),cy:Qi(50,"%"),steps:r.map((function(t){var e=x(t,2),n=e[0],r=e[1];return{offset:Qi(100*Number(n),"%"),color:r}}))}}return null}(t);if(o){if(!ie(o))return[new Vi(zi.RadialGradient,o)];t=o}}else if("p"===e)return function(t){var e=io.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}(t)}));function uo(t){return t&&!!t.image}function ho(t){return t&&!qt(t.r)&&!qt(t.g)&&!qt(t.b)}var fo=Ti((function(t){if(uo(t))return s({repetition:"repeat"},t);if(qt(t)&&(t=""),"transparent"===t)return Zi;if("currentColor"===t)t="black";else if("none"===t)return Ki;var e=co(t);if(e)return e;var n=Zn(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),Ji.apply(void 0,r)}));function po(t,e){if(ho(t)&&ho(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(se(e[n],0,255));return e[3]=se(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function go(t,e){if(qt(e))return Qi(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return Qi(Number(e),"px");if("deg".search(t)>=0)return Qi(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U".concat(t)}));var r="U(".concat(t.source,")");return n.map((function(t){return Qi(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(r,"g"),"*0")),t)}))[0]}var vo=function(t){return go(new RegExp("px","g"),t)},mo=Ti(vo);Ti((function(t){return go(new RegExp("%","g"),t)}));var yo=function(t){return le(t)||isFinite(Number(t))?Qi(Number(t)||0,"px"):go(new RegExp("px|%|em|rem","g"),t)},bo=Ti(yo),xo=function(t){return go(new RegExp("deg|rad|grad|turn","g"),t)},Eo=Ti(xo);function wo(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o="",a=t.value||0,s=e.value||0,l=Wi(t.unit),c=t.convertTo(l),u=e.convertTo(l);return c&&u?(a=c.value,s=u.value,o=ji(t.unit)):($i.isLength(t.unit)||$i.isLength(e.unit))&&(a=No(t,i,n),s=No(e,i,n),o="px"),[a,s,function(t){return t+o}]}function ko(t){var e=0;return t.unit===_i.kDegrees?e=t.value:t.unit===_i.kRadians?e=si(Number(t.value)):t.unit===_i.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function Mo(t,e){var n;return Array.isArray(t)?n=t.map((function(t){return Number(t)})):ie(t)?n=t.split(" ").map((function(t){return Number(t)})):le(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]}function No(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===_i.kPixels)return Number(t.value);if(t.unit===_i.kPercentage&&n){var i=n.nodeName===jr.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2}return 0}var Oo=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function So(t){return t.toString()}var To=function(t){return"number"==typeof t?Qi(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Qi(Number(t)):Qi(0)},_o=Ti(To);function Ao(t,e){return[t,e,So]}function Co(t,e){return function(n,r){return[n,r,function(n){return So(se(n,t,e))}]}}function Po(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function Do(t){var e;return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Nn(t.parsedStyle.d.absolutePath,void 0,Be(Be({},e),{bbox:!1,length:!0})).length),t.parsedStyle.d.totalLength}function Ro(t,e){return t[0]===e[0]&&t[1]===e[1]}function Lo(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,o=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),a=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),l=Math.acos((o+a-s)/(2*Math.sqrt(o)*Math.sqrt(a)));if(!l||0===Math.sin(l)||ce(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u,{xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0}}function Io(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}Ti((function(t){return ie(t)?t.split(" ").map(_o):t.map(_o)}));var jo=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r)},Fo=function(t,e,n,r,i,o,a,s){e=Math.abs(e),n=Math.abs(n);var l=oi(r=de(r,360));if(t.x===a.x&&t.y===a.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var c=(t.x-a.x)/2,u=(t.y-a.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));f=f<0?0:f;var p=(i!==o?1:-1)*Math.sqrt(f),g=p*(e*h.y/n),v=p*(-n*h.x/e),m={x:Math.cos(l)*g-Math.sin(l)*v+(t.x+a.x)/2,y:Math.sin(l)*g+Math.cos(l)*v+(t.y+a.y)/2},y={x:(h.x-g)/e,y:(h.y-v)/n},b=jo({x:1,y:0},y),x=jo(y,{x:(-h.x-g)/e,y:(-h.y-v)/n});!o&&x>0?x-=2*Math.PI:o&&x<0&&(x+=2*Math.PI);var E=b+(x%=2*Math.PI)*s,w=e*Math.cos(E),k=n*Math.sin(E);return{x:Math.cos(l)*w-Math.sin(l)*k+m.x,y:Math.sin(l)*w+Math.cos(l)*k+m.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+x,ellipticalArcAngle:E,ellipticalArcCenter:m,resultantRx:e,resultantRy:n}};function Bo(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.arcParams,i=r.rx,o=void 0===i?0:i,a=r.ry,s=void 0===a?0:a,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=Fo({x:t.prePoint[0],y:t.prePoint[1]},o,s,l,!!c,!!u,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=Fo({x:t.prePoint[0],y:t.prePoint[1]},o,s,l,!!c,!!u,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,p=d.y-h.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function zo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Vo(t,e){return zo(t)*zo(e)?(t[0]*e[0]+t[1]*e[1])/(zo(t)*zo(e)):1}function Go(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Vo(t,e))}function Wo(t,e){var n=e[1],r=e[2],i=de(oi(e[3]),2*Math.PI),o=e[4],a=e[5],s=t[0],l=t[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,d=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var p=n*n*(d*d)+r*r*(h*h),g=p?Math.sqrt((n*n*(r*r)-p)/p):1;o===a&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*n*d/r:0,m=n?g*-r*h/n:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*m,b=(l+u)/2+Math.sin(i)*v+Math.cos(i)*m,x=[(h-v)/n,(d-m)/r],E=[(-1*h-v)/n,(-1*d-m)/r],w=Go([1,0],x),k=Go(x,E);return Vo(x,E)<=-1&&(k=Math.PI),Vo(x,E)>=1&&(k=0),0===a&&k>0&&(k-=2*Math.PI),1===a&&k<0&&(k+=2*Math.PI),{cx:y,cy:b,rx:Ro(t,[c,u])?0:n,ry:Ro(t,[c,u])?0:r,startAngle:w,endAngle:w+k,xRotation:i,arcFlag:o,sweepFlag:a}}var $o=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=cn(t)}catch(n){e=cn(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],o=[r[1],r[2]],a=void 0;"L"===i||"M"===i?a=[n[1],n[2]]:"C"!==i&&"A"!==i&&"Q"!==i||(a=[n[n.length-2],n[n.length-1]]),a&&Ro(o,a)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var o=t[i],a=o[0];"M"===a?(r.length&&(n.push(r),r=[]),r.push([o[1],o[2]])):"Z"===a?r.length&&(e.push(r),r=[]):r.push([o[1],o[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}(e),i=r.polygons,o=r.polylines,a=function(t){for(var e=[],n=null,r=null,i=null,o=0,a=t.length,s=0;s<a;s++){var l=t[s];r=t[s+1];var c=l[0],u={command:c,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],o=s;break;case"A":var h=Wo(n,l);u.arcParams=h}if("Z"===c)n=i,r=t[o+1];else{var d=l.length;n=[l[d-2],l[d-1]]}r&&"Z"===r[0]&&(r=t[o],e[o]&&(e[o].prePoint=n)),u.currentPoint=n,e[o]&&Ro(n,e[o].currentPoint)&&(e[o].prePoint=u.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=f;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-n[0],p[1]-n[1]],u.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===c){var g=[l[1],l[2]];u.startTangent=[p[0]-g[0],p[1]-g[1]],u.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===c){var v=e[s-1],m=Io(v.currentPoint,p);"Q"===v.command?(u.command="Q",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[n[0]-m[0],n[1]-m[1]]):(u.command="TL",u.startTangent=[p[0]-n[0],p[1]-n[1]],u.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===c){var y=[l[1],l[2]],b=[l[3],l[4]];u.startTangent=[p[0]-y[0],p[1]-y[1]],u.endTangent=[n[0]-b[0],n[1]-b[1]],0===u.startTangent[0]&&0===u.startTangent[1]&&(u.startTangent=[y[0]-b[0],y[1]-b[1]]),0===u.endTangent[0]&&0===u.endTangent[1]&&(u.endTangent=[b[0]-y[0],b[1]-y[1]])}else if("S"===c){var x=e[s-1],E=Io(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(u.command="C",u.startTangent=[p[0]-E[0],p[1]-E[1]],u.endTangent=[n[0]-w[0],n[1]-w[1]]):(u.command="SQ",u.startTangent=[p[0]-w[0],p[1]-w[1]],u.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===c){var k=Bo(u,0),M=k.x,N=k.y,O=Bo(u,1,!1),S=O.x,T=O.y;u.startTangent=[M,N],u.endTangent=[S,T]}e.push(u)}return e}(e),s=function(t,e){for(var n=[],r=[],i=[],o=0;o<t.length;o++){var a=t[o],s=a.currentPoint,l=a.params,c=a.prePoint,u=void 0;switch(a.command){case"Q":u=Tr(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=kr(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=a.arcParams;u=vr(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1])}u&&(a.box=u,n.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height))}n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),r=r.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var d=re(n),f=re(r),p=ne(n),g=ne(r);if(0===i.length)return{x:d,y:f,width:p-d,height:g-f};for(var v=0;v<i.length;v++){var m=i[v],y=m.currentPoint;y[0]===d?d-=Lo(m,e).xExtra:y[0]===p&&(p+=Lo(m,e).xExtra),y[1]===f?f-=Lo(m,e).yExtra:y[1]===g&&(g+=Lo(m,e).yExtra)}return{x:d,y:f,width:p-d,height:g-f}}(a,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:a,polygons:i,polylines:o,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},Ho=Ti($o);function Uo(t){return ie(t)?Ho(t):$o(t)}function Yo(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=gn(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=gn(e.absolutePath,!1),e.curve=i);var o=[r,i];r.length!==i.length&&(o=_n(r,i));var a,s,l=Sn(o[0])!==Sn(o[1])?(a=o[0],s=a.slice(1).map((function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):a[0].slice(1).concat(t.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse(),[["M"].concat(s[0].slice(0,2))].concat(s.map((function(t){return["C"].concat(t.slice(2))})))):o[0].map((function(t){return Array.isArray(t)?[].concat(t):t}));return[l,On(o[1],l),function(t){return t}]}function qo(t,e){return[t.points,e.points,function(t){return t}]}var Xo=null,Ko=/\s*(\w+)\(([^)]*)\)/g;function Zo(t){return function(e){var n=0;return t.map((function(t){return t===Xo?e[n++]:t}))}}function Jo(t){return t}var Qo={matrix:["NNNNNN",[Xo,Xo,0,0,Xo,Xo,0,0,0,0,1,0,Xo,Xo,0,1],Jo],matrix3d:["NNNNNNNNNNNNNNNN",Jo],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Zo([Xo,Xo,new $i(1)]),Jo],scaleX:["N",Zo([Xo,new $i(1),new $i(1)]),Zo([Xo,new $i(1)])],scaleY:["N",Zo([new $i(1),Xo,new $i(1)]),Zo([new $i(1),Xo])],scaleZ:["N",Zo([new $i(1),new $i(1),Xo])],scale3d:["NNN",Jo],skew:["Aa",null,Jo],skewX:["A",null,Zo([Xo,Ui])],skewY:["A",null,Zo([Ui,Xo])],translate:["Tt",Zo([Xo,Xo,Hi]),Jo],translateX:["T",Zo([Xo,Hi,Hi]),Zo([Xo,Hi])],translateY:["T",Zo([Hi,Xo,Hi]),Zo([Hi,Xo])],translateZ:["L",Zo([Hi,Hi,Xo])],translate3d:["TTL",Jo]};function ta(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],o=i[0],a=i.slice(1);if("translate"===o||"skew"===o?1===a.length&&a.push(0):"scale"===o&&1===a.length&&a.push(a[0]),!Qo[o])return[];var s=a.map((function(t){return Qi(t)}));e.push({t:o,d:s})}return e}function ea(t){if(Array.isArray(t))return ta(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(Ko.lastIndex=0;e=Ko.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],o=Qo[i];if(!o)return[];var a=e[2].split(","),s=o[0];if(s.length<a.length)return[];for(var l=[],c=0;c<s.length;c++){var u=a[c],h=s[c],d=void 0;if(void 0===(d=u?{A:function(t){return"0"===t.trim()?Ui:Eo(t)},N:_o,T:bo,L:mo}[h.toUpperCase()](u):{a:Ui,n:l[0],t:Hi}[h]))return[];l.push(d)}if(n.push({t:i,d:l}),Ko.lastIndex===t.length)return n}return[]}function na(t){if(Array.isArray(t))return ta(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(Ko.lastIndex=0;e=Ko.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],o=Qo[i];if(!o)return[];var a=e[2].split(","),s=o[0];if(s.length<a.length)return[];for(var l=[],c=0;c<s.length;c++){var u=a[c],h=s[c],d=void 0;if(void 0===(d=u?{A:function(t){return"0"===t.trim()?Ui:xo(t)},N:To,T:yo,L:vo}[h.toUpperCase()](u):{a:Ui,n:l[0],t:Hi}[h]))return[];l.push(d)}if(n.push({t:i,d:l}),Ko.lastIndex===t.length)return n}return[]}function ra(t){var e,n,r,i;switch(t.t){case"rotateX":return i=oi(ko(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=oi(ko(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=oi(ko(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=oi(ko(t.d[3]));var o=e*e+n*n+r*r;if(0===o)e=1,n=0,r=0;else if(1!==o){var a=Math.sqrt(o);e/=a,n/=a,r/=a}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(n*n+r*r)*c,2*(e*n*c+r*l),2*(e*r*c-n*l),0,2*(e*n*c-r*l),1-2*(e*e+r*r)*c,2*(n*r*c+e*l),0,2*(e*r*c+n*l),2*(n*r*c-e*l),1-2*(e*e+n*n)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var u=oi(ko(t.d[0])),h=oi(ko(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=oi(ko(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=oi(ko(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=No(t.d[0],0,null)||0,n=No(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=No(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=No(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=No(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=No(t.d[0],0,null)||0,n=No(t.d[1],0,null)||0,r=No(t.d[2],0,null)||0,1];case"perspective":var d=No(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function ia(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function oa(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],o=[0,0,0,1];return function(t,e,n,r,i,o){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}(di,t))return!1;if(P(fi,di),fi[3]=0,fi[7]=0,fi[11]=0,fi[15]=1,Math.abs(F(fi))<1e-8)return!1;var a,s,l=di[3],c=di[7],u=di[11],h=di[12],d=di[13],f=di[14],p=di[15];if(0!==l||0!==c||0!==u){if(pi[0]=l,pi[1]=c,pi[2]=u,pi[3]=p,!j(fi,fi))return!1;I(fi,fi),Dt(i,pi,fi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=h,e[1]=d,e[2]=f,s=di,(a=gi)[0][0]=s[0],a[0][1]=s[1],a[0][2]=s[2],a[1][0]=s[4],a[1][1]=s[5],a[1][2]=s[6],a[2][0]=s[8],a[2][1]=s[9],a[2][2]=s[10],n[0]=gt(gi[0]),wt(gi[0],gi[0]),r[0]=kt(gi[0],gi[1]),mi(gi[1],gi[1],gi[0],1,-r[0]),n[1]=gt(gi[1]),wt(gi[1],gi[1]),r[0]/=n[1],r[1]=kt(gi[0],gi[2]),mi(gi[2],gi[2],gi[0],1,-r[1]),r[2]=kt(gi[1],gi[2]),mi(gi[2],gi[2],gi[1],1,-r[2]),n[2]=gt(gi[2]),wt(gi[2],gi[2]),r[1]/=n[2],r[2]/=n[2],Mt(vi,gi[1],gi[2]),kt(gi[0],vi)<0)for(var g=0;g<3;g++)n[g]*=-1,gi[g][0]*=-1,gi[g][1]*=-1,gi[g][2]*=-1;o[0]=.5*Math.sqrt(Math.max(1+gi[0][0]-gi[1][1]-gi[2][2],0)),o[1]=.5*Math.sqrt(Math.max(1-gi[0][0]+gi[1][1]-gi[2][2],0)),o[2]=.5*Math.sqrt(Math.max(1-gi[0][0]-gi[1][1]+gi[2][2],0)),o[3]=.5*Math.sqrt(Math.max(1+gi[0][0]+gi[1][1]+gi[2][2],0)),gi[2][1]>gi[1][2]&&(o[0]=-o[0]),gi[0][2]>gi[2][0]&&(o[1]=-o[1]),gi[1][0]>gi[0][1]&&(o[2]=-o[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(ra).reduce(ia)}(t),e,n,r,i,o),[[e,n,r,o,i]]}var aa=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var o=0;o<4;o++)n[r][i]+=e[r][o]*t[o][i];return n}return function(e,n,r,i,o){for(var a=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)a[s][3]=o[s];for(var l=0;l<3;l++)for(var c=0;c<3;c++)a[3][l]+=e[c]*a[c][l];var u=i[0],h=i[1],d=i[2],f=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(h*h+d*d),p[0][1]=2*(u*h-d*f),p[0][2]=2*(u*d+h*f),p[1][0]=2*(u*h+d*f),p[1][1]=1-2*(u*u+d*d),p[1][2]=2*(h*d-u*f),p[2][0]=2*(u*d-h*f),p[2][1]=2*(h*d+u*f),p[2][2]=1-2*(u*u+h*h),a=t(a,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],a=t(a,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],a=t(a,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],a=t(a,g));for(var v=0;v<3;v++)for(var m=0;m<3;m++)a[v][m]*=n[v];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(a)?[a[0][0],a[0][1],a[1][0],a[1][1],a[3][0],a[3][1]]:a[0].concat(a[1],a[2],a[3])}}();function sa(t){return t.toFixed(6).replace(".000000","")}function la(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=oa(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=oa(e)),null===n[0]||null===r[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}(t,e);r=se(r,-1,1);var i=[];if(1===r)i=t;else for(var o=Math.acos(r),a=1*Math.sin(n*o)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*o)-r*a)+e[s]*a);return i}(n[0][3],r[0][3],t[5]);return aa(t[0],t[1],t[2],e,t[4]).map(sa).join(",")}])}function ca(t){return t.replace(/[XY]/,"")}function ua(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function ha(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(){var n=t[o],r=n.t,i=n.d,a="scale"===r.substring(0,5)?1:0;e.push({t:r,d:i.map((function(t){return"number"==typeof t?Qi(a):Qi(a,t.unit)}))})},o=0;o<t.length;o++)i()}var a,s,l=[],c=[],u=[];if(t.length!==e.length){var h=la(t,e);l=[h[0]],c=[h[1]],u=[["matrix",[h[2]]]]}else for(var d=0;d<t.length;d++){var f=t[d].t,p=e[d].t,g=t[d].d,v=e[d].d,m=Qo[f],y=Qo[p],b=void 0;if(s=p,"perspective"===(a=f)&&"perspective"===s||!("matrix"!==a&&"matrix3d"!==a||"matrix"!==s&&"matrix3d"!==s)){var x=la([t[d]],[e[d]]);l.push(x[0]),c.push(x[1]),u.push(["matrix",[x[2]]])}else{if(f===p)b=f;else if(m[2]&&y[2]&&ca(f)===ca(p))b=ca(f),g=m[2](g),v=y[2](v);else{if(!m[1]||!y[1]||ua(f)!==ua(p)){var E=la(t,e);l=[E[0]],c=[E[1]],u=[["matrix",[E[2]]]];break}b=ua(f),g=m[1](g),v=y[1](v)}for(var w=[],k=[],M=[],N=0;N<g.length;N++){var O=wo(g[N],v[N],n,!1,N);w[N]=O[0],k[N]=O[1],M.push(O[2])}l.push(w),c.push(k),u.push([b,M])}}if(r){var S=l;l=c,c=S}return[l,c,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return u[e][1][n](t)})).join(",");return"matrix"===u[e][0]&&16===n.split(",").length&&(u[e][0]="matrix3d"),"matrix3d"===u[e][0]&&6===n.split(",").length&&(u[e][0]="matrix"),"".concat(u[e][0],"(").concat(n,")")})).join(" ")}]}var da=Ti((function(t){if(ie(t)){if("text-anchor"===t)return[Qi(0,"px"),Qi(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[bo(fa(e[0])),bo(fa(e[1]))]}return[Qi(t[0]||0,"px"),Qi(t[1]||0,"px")]}));function fa(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var pa=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Si.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Si.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Si.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Si.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Si.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Si.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Si.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Si.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Si.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Si.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Si.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Si.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:Si.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Si.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Si.FILTER},{n:"clipPath",syntax:Si.DEFINED_PATH},{n:"textPath",syntax:Si.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Si.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:Si.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:Si.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Si.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Si.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Si.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Si.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Si.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Si.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Si.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Si.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:Si.PATH,p:50},{n:"points",int:!0,l:!0,syntax:Si.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Si.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Si.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Si.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Si.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Si.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Si.NUMBER,d:function(t){return t===jr.PATH||t===jr.POLYGON||t===jr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:Si.MARKER},{n:"markerEnd",syntax:Si.MARKER},{n:"markerMid",syntax:Si.MARKER},{n:"markerStartOffset",syntax:Si.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Si.LENGTH,l:!0,int:!0,d:"0"}],ga=new Set(pa.filter((function(t){return!!t.l})).map((function(t){return t.n}))),va={},ma=function(){return u((function t(e){var n=this;l(this,t),this.runtime=e,pa.forEach((function(t){n.registerMetadata(t)}))}),[{key:"registerMetadata",value:function(t){[t.n].concat(f(t.a||[])).forEach((function(e){va[e]=t}))}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var r=t.parsedStyle.clipPath,i=t.parsedStyle.offsetPath;Object.assign(t.parsedStyle,e);var o,a,l=!!n.forceUpdateGeometry;if(!l)for(var c in e)if(ga.has(c)){l=!0;break}e.fill&&(t.parsedStyle.fill=fo(e.fill)),e.stroke&&(t.parsedStyle.stroke=fo(e.stroke)),e.shadowColor&&(t.parsedStyle.shadowColor=fo(e.shadowColor)),e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,Oo.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map((function(t){return go(/deg|rad|grad|turn|px|%/g,t)||fo(t)}))}),n.lastIndex===t.length)return r}return[]}(e.filter)),qt(e.radius)||(t.parsedStyle.radius=Mo(e.radius,4)),qt(e.lineDash)||(t.parsedStyle.lineDash=Mo(e.lineDash,2)),e.points&&(t.parsedStyle.points=(o=e.points,a=ie(o)?o.split(" ").map((function(t){var e=x(t.split(","),2),n=e[0],r=e[1];return[Number(n),Number(r)]})):o,{points:a,totalLength:0,segments:[]})),""===e.d&&(t.parsedStyle.d=s({},Oi)),e.d&&(t.parsedStyle.d=Uo(e.d)),e.textTransform&&this.runtime.CSSPropertySyntaxFactory[Si.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),ye(e.clipPath)||this.runtime.CSSPropertySyntaxFactory[Si.DEFINED_PATH].calculator("clipPath",r,e.clipPath,t,this.runtime),e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[Si.DEFINED_PATH].calculator("offsetPath",i,e.offsetPath,t,this.runtime),e.transform&&(t.parsedStyle.transform=ea(e.transform)),e.transformOrigin&&(t.parsedStyle.transformOrigin=da(e.transformOrigin)),e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[Si.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[Si.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[Si.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),qt(e.zIndex)||this.runtime.CSSPropertySyntaxFactory[Si.Z_INDEX].postProcessor(t),qt(e.offsetDistance)||this.runtime.CSSPropertySyntaxFactory[Si.OFFSET_DISTANCE].postProcessor(t),e.transform&&this.runtime.CSSPropertySyntaxFactory[Si.TRANSFORM].postProcessor(t),e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[Si.TRANSFORM_ORIGIN].postProcessor(t),l&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new Yr),r.renderBounds||(r.renderBounds=new Yr);var i=t.parsedStyle,o=n.update(i,t),a=o.cx,s=void 0===a?0:a,l=o.cy,c=void 0===l?0:l,u=o.cz,h=void 0===u?0:u,d=o.hwidth,f=void 0===d?0:d,p=o.hheight,g=void 0===p?0:p,v=o.hdepth,m=void 0===v?0:v,y=[Math.abs(f),Math.abs(g),m],b=i.stroke,x=i.lineWidth,E=void 0===x?1:x,w=i.increasedLineWidthForHitTesting,k=void 0===w?0:w,M=i.shadowType,N=void 0===M?"outer":M,O=i.shadowColor,S=i.filter,T=void 0===S?[]:S,_=i.transformOrigin,A=[s,c,h];r.contentBounds.update(A,y);var C=e===jr.POLYLINE||e===jr.POLYGON||e===jr.PATH?Math.SQRT2:.5;if(b&&!b.isNone){var P=((E||0)+(k||0))*C;y[0]+=P,y[1]+=P}if(r.renderBounds.update(A,y),O&&N&&"inner"!==N){var D=r.renderBounds,R=D.min,L=D.max,I=i.shadowBlur||0,j=i.shadowOffsetX||0,F=i.shadowOffsetY||0,B=R[0]-I+j,z=L[0]+I+j,V=R[1]-I+F,G=L[1]+I+F;R[0]=Math.min(R[0],B),L[0]=Math.max(L[0],z),R[1]=Math.min(R[1],V),L[1]=Math.max(L[1],G),r.renderBounds.setMinMax(R,L)}T.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,bt(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]))}else if("drop-shadow"===e){var o=n[0].value,a=n[1].value,s=n[2].value,l=r.renderBounds,c=l.min,u=l.max,h=c[0]-s+o,d=u[0]+s+o,f=c[1]-s+a,p=u[1]+s+a;c[0]=Math.min(c[0],h),u[0]=Math.max(u[0],d),c[1]=Math.min(c[1],f),u[1]=Math.max(u[1],p),r.renderBounds.setMinMax(c,u)}})),t.geometry.dirty=!1;var W=g<0,$=(f<0?-1:1)*(_?No(_[0],0,t,!0):0),H=(W?-1:1)*(_?No(_[1],1,t,!0):0);($||H)&&t.setOrigin($,H)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===jr.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===jr.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}(),ya=function(){return u((function t(){l(this,t),this.mixer=Ao}),[{key:"calculator",value:function(t,e,n,r){return ko(n)}}])}(),ba=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,r,i){return n instanceof Gi&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach((function(t){0===t.childNodes.length&&i.sceneGraphService.dirtifyToRoot(t)})),n}}])}(),xa=function(){return u((function t(){l(this,t),this.parser=fo,this.mixer=po}),[{key:"calculator",value:function(t,e,n,r){return n instanceof Gi?"none"===n.value?Ki:Zi:n}}])}(),Ea=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n){return n instanceof Gi?[]:n}}])}();function wa(t){var e=t.parsedStyle.fontSize;return qt(e)?null:e}var ka=function(){return u((function t(){l(this,t),this.mixer=Ao}),[{key:"calculator",value:function(t,e,n,r,i){if(le(n))return n;if(!$i.isRelativeUnit(n.unit))return n.value;if(n.unit===_i.kPercentage)return 0;if(n.unit===_i.kEms){if(r.parentNode){var o=wa(r.parentNode);if(o)return o*=n.value}return 0}if(n.unit===_i.kRems){var a;if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=wa(r.ownerDocument.documentElement);if(s)return s*=n.value}return 0}}}])}(),Ma=function(){return u((function t(){l(this,t),this.mixer=Po}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),Na=function(){return u((function t(){l(this,t),this.mixer=Po}),[{key:"calculator",value:function(t,e,n){return n.map((function(t){return t.value}))}}])}(),Oa=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,r){var i;n instanceof Gi&&(n=null);var o=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])}(),Sa=function(){return u((function t(){l(this,t),this.mixer=Ao}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),Ta=function(){return u((function t(){l(this,t),this.mixer=Co(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===jr.LINE||i===jr.PATH||i===jr.POLYLINE){var o=n.getPoint(r);o&&t.setLocalPosition(o.x,o.y)}}}}])}(),_a=function(){return u((function t(){l(this,t),this.mixer=Co(0,1)}),[{key:"calculator",value:function(t,e,n){return n.value}}])}(),Aa=function(){return u((function t(){l(this,t),this.parser=Uo,this.mixer=Yo}),[{key:"calculator",value:function(t,e,n){return n instanceof Gi&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Jr(0,0,0,0)}:n}}])}(),Ca=u((function t(){l(this,t),this.mixer=qo})),Pa=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).mixer=Co(0,1/0),t}return b(e,t),u(e)}(ka),Da=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,r){return n instanceof Gi?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),Ra=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var o=i;"capitalize"===n.value?o=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?o=i.toLowerCase():"uppercase"===n.value&&(o=i.toUpperCase()),r.parsedStyle.text=o}return n.value}}])}(),La=new WeakMap;function Ia(t,e,n){if(t){var r="string"==typeof t?document.getElementById(t):t;La.has(r)&&La.get(r).destroy(n),La.set(r,e)}}var ja="undefined"!=typeof window&&void 0!==window.document;function Fa(t){return!!t.getAttribute}function Ba(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var o=i.childNodes||[];return o.indexOf(t)-o.indexOf(e)}}return n-r}function za(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}function Va(t,e){if(ja)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var Ga={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Wa="object"==typeof performance&&performance.now?performance:Date;function $a(t){return t.nodeName===jr.FRAGMENT||t.getRootNode().nodeName===jr.FRAGMENT}function Ha(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,o=!!e&&!e.isNone,a=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(r=o,i=a):"visiblefill"===t||"fill"===t?r=!0:"visiblestroke"===t||"stroke"===t?i=!0:"visible"!==t&&"all"!==t||(r=!0,i=!0),[r,i]}var Ua=1,Ya="object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:{},qa=Date.now(),Xa={},Ka=Date.now(),Za=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-Ka,r=n>16?0:16-n,i=Ua++;return Xa[i]=t,Object.keys(Xa).length>1||setTimeout((function(){Ka=e;var t=Xa;Xa={},Object.keys(t).forEach((function(e){return t[e](Ya.performance&&"function"==typeof Ya.performance.now?Ya.performance.now():Date.now()-qa)}))}),r),i},Ja=function(t){delete Xa[t]},Qa=function(t){return"string"!=typeof t?Za:""===t?Ya.requestAnimationFrame:Ya["".concat(t,"RequestAnimationFrame")]},ts=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!Qa(t)})),es=Qa(ts),ns=function(t){return"string"!=typeof t?Ja:""===t?Ya.cancelAnimationFrame:Ya["".concat(t,"CancelAnimationFrame")]||Ya["".concat(t,"CancelRequestAnimationFrame")]}(ts);Ya.requestAnimationFrame=es,Ya.cancelAnimationFrame=ns;var rs=function(){return u((function t(){l(this,t),this.callbacks=[]}),[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map((function(t){return t.apply(void 0,e)})))}}])}(),is=function(){return u((function t(){l(this,t),this.callbacks=[]}),[{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:(t=Pr(Ar().mark((function t(){var e,n,r,i,o=arguments;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=14;break}return t.next=3,(e=this.callbacks)[0].apply(e,o);case 3:n=t.sent,r=0;case 5:if(!(r<this.callbacks.length-1)){t.next=13;break}return i=this.callbacks[r],t.next=9,i(n);case 9:n=t.sent;case 10:r++,t.next=5;break;case 13:return t.abrupt("return",n);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),os=function(){return u((function t(){l(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach((function(t){t.apply(void 0,r)}))}}])}(),as=function(){return u((function t(){l(this,t),this.callbacks=[]}),[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),o=0;o<this.callbacks.length-1;o++){i=(0,this.callbacks[o])(i)}return i}return null}}])}(),ss=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ls=/([\"\'])[^\'\"]+\1/;function cs(t,e,n){return L(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var us=A(),hs=A(),ds={scale:function(t){H(us,[t[0].value,t[1].value,1])},scaleX:function(t){H(us,[t[0].value,1,1])},scaleY:function(t){H(us,[1,t[0].value,1])},scaleZ:function(t){H(us,[1,1,t[0].value])},scale3d:function(t){H(us,[t[0].value,t[1].value,t[2].value])},translate:function(t){$(us,[t[0].value,t[1].value,0])},translateX:function(t){$(us,[t[0].value,0,0])},translateY:function(t){$(us,[0,t[0].value,0])},translateZ:function(t){$(us,[0,0,t[0].value])},translate3d:function(t){$(us,[t[0].value,t[1].value,t[2].value])},rotate:function(t){X(us,oi(ko(t[0])))},rotateX:function(t){Y(us,oi(ko(t[0])))},rotateY:function(t){q(us,oi(ko(t[0])))},rotateZ:function(t){X(us,oi(ko(t[0])))},rotate3d:function(t){U(us,oi(ko(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){cs(us,oi(t[0].value),oi(t[1].value))},skewX:function(t){cs(us,oi(t[0].value),0)},skewY:function(t){cs(us,0,oi(t[0].value))},matrix:function(t){R(us,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(t){R.apply(dt,[us].concat(f(t.map((function(t){return t.value})))))}},fs=vt(1,1,1),ps=ft(),gs={translate:function(t,e){xl.sceneGraphService.setLocalScale(t,fs,!1),xl.sceneGraphService.setLocalEulerAngles(t,ps,void 0,void 0,!1),xl.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),xl.sceneGraphService.dirtifyLocal(t,t.transformable)}};function vs(t,e){if(t.length){if(1===t.length&&gs[t[0].t])return void gs[t[0].t](e,t[0].d);for(var n=L(hs),r=0;r<t.length;r++){var i=t[r],o=i.t,a=i.d,s=ds[o];s&&(s(a),ut(n,n,us))}e.setLocalTransform(n)}else e.resetLocalTransform();return e.getLocalTransform()}var ms=function(){return u((function t(){l(this,t),this.parser=na,this.mixer=ha}),[{key:"calculator",value:function(t,e,n,r){return n instanceof Gi?[]:n}},{key:"postProcessor",value:function(t){vs(t.parsedStyle.transform,t)}}])}(),ys=function(){return u((function t(){l(this,t)}),[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===_i.kPixels&&e[1].unit===_i.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),bs=function(){return u((function t(){l(this,t)}),[{key:"calculator",value:function(t,e,n,r){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0,r.dirtyReason=Ni.Z_INDEX_CHANGED)}}}])}(),xs=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,o=void 0===i?0:i,a=t.r,s=void 0===a?0:a;return{cx:r,cy:o,hwidth:s,hheight:s}}}])}(),Es=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,o=void 0===i?0:i,a=t.rx,s=void 0===a?0:a,l=t.ry;return{cx:r,cy:o,hwidth:s,hheight:void 0===l?0:l}}}])}(),ws=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=Math.min(e,r),a=Math.max(e,r),s=Math.min(n,i),l=(a-o)/2,c=(Math.max(n,i)-s)/2;return{cx:o+l,cy:s+c,hwidth:l,hheight:c}}}])}(),ks=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width/2,o=e.height/2;return{cx:n+i,cy:r+o,hwidth:i,hheight:o}}}])}(),Ms=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t){if(t.points&&Xt(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,f(e.map((function(t){return t[0]})))),r=Math.max.apply(Math,f(e.map((function(t){return t[0]})))),i=Math.min.apply(Math,f(e.map((function(t){return t[1]})))),o=Math.max.apply(Math,f(e.map((function(t){return t[1]})))),a=(r-n)/2,s=(o-i)/2;return{cx:n+a,cy:i+s,hwidth:a,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Ns=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,a=t.src,s=t.width,l=void 0===s?0:s,c=t.height,u=l,h=void 0===c?0:c;return a&&!ie(a)&&(u||(u=a.width,t.width=u),h||(h=a.height,t.height=h)),{cx:r+u/2,cy:o+h/2,hwidth:u/2,hheight:h/2}}}])}(),Os=function(){return u((function t(e){l(this,t),this.globalRuntime=e}),[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,o=void 0===i?"start":i,a=t.lineWidth,s=void 0===a?1:a,l=t.textBaseline,c=void 0===l?"alphabetic":l,u=t.dx,h=void 0===u?0:u,d=t.dy,f=void 0===d?0:d,p=t.x,g=void 0===p?0:p,v=t.y,m=void 0===v?0:v;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var y=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(r,t,y);t.metrics=b;var x=b.width/2,E=b.height/2,w=g+x;"center"===o||"middle"===o?w+=s/2-x:"right"!==o&&"end"!==o||(w+=s-2*x);var k=m-E;return"middle"===c?k+=E:"top"===c||"hanging"===c?k+=2*E:"alphabetic"===c||"bottom"!==c&&"ideographic"!==c||(k+=0),h&&(w+=h),f&&(k+=f),{cx:w,cy:k,hwidth:x,hheight:E}}}])}(),Ss=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),Ts=function(){return u((function t(){l(this,t)}),[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,a=t.width,s=void 0===a?0:a,l=t.height,c=void 0===l?0:l;return{cx:r+s/2,cy:o+c/2,hwidth:s/2,hheight:c/2}}}])}(),_s=function(){return u((function t(e){l(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Zr,this.page=new Zr,this.canvas=new Zr,this.viewport=new Zr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(Qr)}}])}(),As=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).client=new Zr,t.movement=new Zr,t.offset=new Zr,t.global=new Zr,t.screen=new Zr,t}return b(e,t),u(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(Qr)}}])}(_s),Cs=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t}return b(e,t),u(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(As),Ps=function(t){function e(){return l(this,e),m(this,e,arguments)}return b(e,t),u(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(As),Ds=function(t){function e(t,n){var r;return l(this,e),(r=m(this,e,[null])).type=t,r.detail=n,Object.assign(r,n),r}return b(e,t),u(e)}(_s),Rs=new WeakMap,Ls=function(){return u((function t(){l(this,t),this.emitter=new O}),[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if(ve(n))r=n;else if(n){var o=n.capture;r=void 0!==o&&o;var a=n.once;i=void 0!==a&&a}r&&(t+="capture"),e=Yt(e)?e:e.handleEvent;var s=Yt(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var r;if(!this.emitter)return this;(ve(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=Yt(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var i=Yt(e)?void 0:e;return this.emitter.off(t,e,i),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new Ds(t,e))}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Rs.get(this);r||(r=this.document?this:this.defaultView?this.defaultView:null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView)&&Rs.set(this,r);if(r){if(t.manager=r.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),Is=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return b(e,t),u(e,[{key:"textContent",get:function(){var t="";this.nodeName===jr.TEXT&&(t+=this.style.text);var e,n=Dr(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===jr.TEXT?t+=r.nodeValue:t+=r.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===jr.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(Qr)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(Qr)}},{key:"lookupPrefix",value:function(t){throw new Error(Qr)}},{key:"normalize",value:function(){throw new Error(Qr)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,r=this,i=[n],o=[r];null!==(a=n.parentNode)&&void 0!==a?a:r.parentNode;){var a;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(o.push(r.parentNode),r.parentNode):r}if(n!==r)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=i.length>o.length?i:o,l=s===i?o:i;if(s[s.length-l.length]===l[0])return s===i?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-l.length,u=l.length-1;u>=0;u--){var h=l[u],d=s[c+u];if(d!==h){var f=h.parentNode.childNodes;return f.indexOf(h)<f.indexOf(d)?l===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(Ls);Is.DOCUMENT_POSITION_DISCONNECTED=1,Is.DOCUMENT_POSITION_PRECEDING=2,Is.DOCUMENT_POSITION_FOLLOWING=4,Is.DOCUMENT_POSITION_CONTAINS=8,Is.DOCUMENT_POSITION_CONTAINED_BY=16,Is.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var js=function(){return u((function t(e,n){var r=this;l(this,t),this.emitter=new O,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=A(),this.tmpVec3=ft(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown")}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e)},this.onPointerUp=function(t){var e=Wa.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup")}var o=r.trackingData(t.pointerId),a=r.findMountedTarget(o.pressTargetsByButton[t.button]),s=a;if(a&&!n.composedPath().includes(a)){for(var l=a;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var c=2===n.button;r.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}Is.isNode(l)&&(l=l.parentNode)}delete o.pressTargetsByButton[t.button],s=l}if(s){var u,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],o.clicksByButton[t.button]||(o.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=o.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(u=n.detail)&&void 0!==u&&u.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h)}r.freeEvent(n)},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),o=r.findMountedTarget(i.overTargets);if(i.overTargets&&o!==e.target){var a="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,a,o||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(o)){var l=r.createPointerEvent(t,"pointerleave",o||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),Is.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l)}r.freeEvent(s)}if(o!==e.target){var c="mousemove"===t.type?"mouseover":"pointerover",u=r.clonePointerEvent(e,c);r.dispatchEvent(u,"pointerover"),n&&r.dispatchEvent(u,"mouseover");for(var h=o&&Is.isNode(o)&&o.parentNode;h&&h!==(Is.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(Is.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==o&&d.target!==(Is.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),Is.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d)}r.freeEvent(u)}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e)},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),o=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(o),n&&r.dispatchEvent(o,"mouseout");var a=r.createPointerEvent(t,"pointerleave",i||void 0);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(Is.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),n&&r.notifyTarget(a,"mouseleave"),Is.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=null,r.freeEvent(o),r.freeEvent(a)}r.cursor=null},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var o=r.clonePointerEvent(n,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(Is.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),i&&r.notifyTarget(o,"mouseenter"),Is.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(o)},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var o=n;o;)i.currentTarget=o,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||"mouse"!==i.pointerType&&"pen"!==i.pointerType||r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),Is.isNode(o)&&(o=o.parentNode);delete e.pressTargetsByButton[t.button]}r.freeEvent(i)},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e)},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e)}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e)},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,o=r.offsetHeight;i&&o&&(e=t.width/i,n=t.height/o)}return{scaleX:e,scaleY:n,bbox:t}}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Zr((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r)}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Zr((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r)}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,o=i.width,a=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),c=B(this.tmpMatrix,l,s),u=yt(this.tmpVec3,e/o*2-1,2*(1-n/a)-1,0);return Ot(u,u,c),new Zr(u[0],u[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=B(this.tmpMatrix,n,r),o=yt(this.tmpVec3,t.x,t.y,0);Ot(this.tmpVec3,this.tmpVec3,i);var a=this.context.config,s=a.width,l=a.height;return new Zr((o[0]+1)/2*s,(1-(o[1]+1)/2)*l)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);this.emitter.emit(e||t.type,t)}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=i+1;o<n.length;o++)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)Is.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,o=r.height,a=r.disableHitTesting;return e<0||n<0||e>i||n>o?null:!a&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r)}return!(null==e||!e.composedPath)&&e.composedPath().indexOf(t)>-1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(Cs);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var o=this.getExistedHTML(i),a=this.context.contextService.getDomElement();return i.target=null!=n?n:o||this.isNativeEventFromCanvas(a,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(Ps);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(Ps);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(Cs);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=Wa.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){var n;e=null!==(n=e)&&void 0!==n?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||Is.isNode(r)&&r.parentNode===e))break;e=t[n]}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=Fa(e)&&e.getAttribute("cursor");if(n)return n;e=Is.isNode(e)&&e.parentNode}}}])}(),Fs=function(){return u((function t(){l(this,t)}),[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||xl.offscreenCanvas)this.canvas=t||xl.offscreenCanvas,this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",s({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),Bs=function(t){return t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE",t}({}),zs=function(){return u((function t(e,n){l(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new os,initAsync:new rs,dirtycheck:new as,cull:new as,beginFrame:new os,beforeRender:new os,render:new os,afterRender:new os,endFrame:new os,destroy:new os,pick:new is,pickSync:new as,pointerDown:new os,pointerUp:new os,pointerMove:new os,pointerOut:new os,pointerOver:new os,pointerWheel:new os,pointerCancel:new os,click:new os},this.globalRuntime=e,this.context=n}),[{key:"init",value:function(t){var e=this,n=s(s({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach((function(t){t.apply(n,e.globalRuntime)})),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then((function(){e.inited=!0,t()})).catch((function(t){}))}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(Bs.CAMERA_CHANGED)}},{key:"render",value:function(t,e,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===i.renderReasons.size&&i.renderReasons.has(Bs.CAMERA_CHANGED),a=!t.disableRenderHooks||!(t.disableRenderHooks&&o);a&&this.renderDisplayObject(i.root,t,i),this.hooks.beginFrame.call(e),a&&i.renderListCurrentFrame.forEach((function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t)})),this.hooks.endFrame.call(e),i.renderListCurrentFrame=[],i.renderReasons.clear(),n()}}},{key:"renderDisplayObject",value:function(t,e,n){var r=this,i=e.renderer.getConfig(),o=i.enableDirtyCheck,a=i.enableCulling;function s(t){var e=t.renderable,i=t.sortable,s=o?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t;if(s){var l=a?r.hooks.cull.call(s,r.context.camera):s;l&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l))}e.dirty=!1,i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0)}for(var l=[t];l.length>0;){var c=l.pop();s(c);for(var u=c.sortable.sorted||c.childNodes,h=u.length-1;h>=0;h--)l.push(u[h])}}},{key:"sort",value:function(t,e){e.sorted&&e.dirtyReason!==Ni.Z_INDEX_CHANGED?e.dirtyChildren.forEach((function(n){if(-1===t.childNodes.indexOf(n)){var r=e.sorted.indexOf(n);r>=0&&e.sorted.splice(r,1)}else if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;Ba(t[i],e)<0?n=i+1:r=i}return n}(e.sorted,n);e.sorted.splice(i,0,n)}})):e.sorted=t.childNodes.slice().sort(Ba)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(Bs.DISPLAY_OBJECT_CHANGED)}}])}(),Vs=/\[\s*(.*)=(.*)\s*\]/,Gs=function(){return u((function t(){l(this,t)}),[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.find((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(r){return e!==r&&r.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.findAll((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(Vs),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return qt(n)?"":n.toString?n.toString():""}}])}(),Ws=function(t){return t.REPARENT="reparent",t.DESTROY="destroy",t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.REMOVED="removed",t.MOUNTED="DOMNodeInsertedIntoDocument",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),$s=function(t){function e(t,n,r,i,o,a,s,c){var u;return l(this,e),(u=m(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=o,u.attrChange=a,u.prevParsedValue=s,u.newParsedValue=c,u.type=t,u}return b(e,t),u(e)}(_s);function Hs(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}$s.ADDITION=2,$s.MODIFICATION=1,$s.REMOVAL=3;var Us,Ys,qs,Xs=new $s(Ws.REPARENT,null,"","","",0,"",""),Ks=$t(),Zs=ft(),Js=vt(1,1,1),Qs=A(),tl=$t(),el=ft(),nl=A(),rl=Rt(),il=ft(),ol=Rt(),al=ft(),sl=ft(),ll=ft(),cl=A(),ul=Rt(),hl=Rt(),dl=Rt(),fl={affectChildren:!0},pl=function(){return u((function t(e){l(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new Ds(Ws.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}),[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var r,i=!1;t.parentNode&&(i=t.parentNode!==e,this.detach(t));var o=t.nodeName===jr.FRAGMENT,a=$a(e);t.parentNode=e;var s=o?t.childNodes:[t];le(n)?s.forEach((function(t){e.childNodes.splice(n,0,t),t.parentNode=e})):s.forEach((function(t){e.childNodes.push(t),t.parentNode=e}));var l=e.sortable;if((null!=l&&null!==(r=l.sorted)&&void 0!==r&&r.length||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=Ni.ADDED),!a){if(o)this.dirtifyFragment(t);else{var c=t.transformable;c&&this.dirtifyWorld(t,c)}i&&t.dispatchEvent(Xs)}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=Ni.REMOVED);var o=t.parentNode.childNodes.indexOf(t);o>-1&&t.parentNode.childNodes.splice(o,1),r&&this.dirtifyWorld(t,r),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var r=n.origin;r[0]=e[0],r[1]=e[1],r[2]=e[2]||0,this.dirtifyLocal(t,n)}}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=vt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var r=rl;Ft(r,e[0],e[1],e[2]);var i=this.getRotation(t),o=this.getRotation(t.parentNode);zt(dl,o),jt(dl,dl),It(r,dl,r),It(n.localRotation,r,i),Wt(n.localRotation,n.localRotation),this.dirtifyLocal(t,n)}else this.rotateLocal(t,e)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=vt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Ft(hl,e[0],e[1],e[2]),Gt(n.localRotation,n.localRotation,hl),this.dirtifyLocal(t,n)}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=vt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Ft(n.localRotation,e[0],e[1],e[2]);var r=this.getRotation(t.parentNode);zt(ul,jt(rl,r)),Gt(n.localRotation,n.localRotation,ul),this.dirtifyLocal(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=vt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var r=t.transformable;Ft(r.localRotation,e[0],e[1],e[2]),n&&this.dirtifyLocal(t,r)}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=vt(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;St(e,Zs)||(!function(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],l=e[1],c=e[2],u=i*c-o*l,h=o*s-r*c,d=r*l-i*s,f=i*d-o*h,p=o*u-r*d,g=r*h-i*u,v=2*a;u*=v,h*=v,d*=v,f*=2,p*=2,g*=2,t[0]=s+u+f,t[1]=l+h+p,t[2]=c+d+g}(e,e,n.localRotation),bt(n.localPosition,n.localPosition,e),this.dirtifyLocal(t,n))}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(ll[0]=e[0],ll[1]=e[1],ll[2]=null!==(n=e[2])&&void 0!==n?n:0,!St(this.getPosition(t),ll)){if(mt(r.position,ll),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;P(cl,i.worldTransform),j(cl,cl),Ot(r.localPosition,ll,cl)}else mt(r.localPosition,ll);this.dirtifyLocal(t,r)}}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;sl[0]=e[0],sl[1]=e[1],sl[2]=null!==(n=e[2])&&void 0!==n?n:0,St(i.localPosition,sl)||(mt(i.localPosition,sl),r&&this.dirtifyLocal(t,i))}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;!function(t,e,n){t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2]}(r.localScale,r.localScale,yt(el,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtifyLocal(t,r)}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;yt(el,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),St(el,i.localScale)||(mt(i.localScale,el),r&&this.dirtifyLocal(t,i))}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=yt(el,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),St(e,Zs)||(bt(el,this.getPosition(t),e),this.setPosition(t,el))}},{key:"setRotation",value:function(t,e,n,r,i){var o=t.transformable;if("number"==typeof e&&(e=Bt(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var a=this.getRotation(t.parentNode);zt(rl,a),jt(rl,rl),It(o.localRotation,rl,e),Wt(o.localRotation,o.localRotation),this.dirtifyLocal(t,o)}else this.setLocalRotation(t,e)}},{key:"setLocalRotation",value:function(t,e,n,r,i){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=Vt(rl,e,n,r,i));var a=t.transformable;zt(a.localRotation,e),o&&this.dirtifyLocal(t,a)}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=function(t,e,n){return t[0]=e,t[1]=n,t}(tl,e,n));var i=t.transformable;!function(t,e){t[0]=e[0],t[1]=e[1]}(i.localSkew,e),r&&this.dirtifyLocal(t,i)}},{key:"dirtifyLocal",value:function(t,e){$a(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))}},{key:"dirtifyWorld",value:function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var e=t.transformable;e&&(e.frozen=!1,e.dirtyFlag=!0,e.localDirtyFlag=!0);var n=t.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(t.childNodes[i]);t.nodeName===jr.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,e=new Set,n=function(n,r){n.isConnected&&!e.has(n)&&n.nodeName!==jr.FRAGMENT&&(t.boundsChangedEvent.detail=r,t.boundsChangedEvent.target=n,n.isMutationObserved?n.dispatchEvent(t.boundsChangedEvent):n.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),e.add(n))};this.pendingEvents.forEach((function(t,e){e.nodeName!==jr.FRAGMENT&&(fl.affectChildren=t,t?e.forEach((function(t){n(t,fl)})):n(e,fl))})),e.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;for(n.renderable&&(n.renderable.dirty=!0);n;)Hs(n),n=n.parentNode;e&&t.forEach((function(t){Hs(t)})),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,e)}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var o=i[t].indexOf(r);i[t].splice(o,1)}}if(n){var a=this.displayObjectDependencyMap.get(n);a||(this.displayObjectDependencyMap.set(n,{}),a=this.displayObjectDependencyMap.get(n)),a[t]||(a[t]=[]),a[t].push(r)}}},{key:"informDependentDisplayObjects",value:function(t){var e=this,n=this.displayObjectDependencyMap.get(t);n&&Object.keys(n).forEach((function(t){n[t].forEach((function(n){e.dirtifyToRoot(n,!0),n.dispatchEvent(new $s(Ws.ATTR_MODIFIED,n,e,e,t,$s.MODIFICATION,e,e)),n.isCustomElement&&n.isConnected&&n.attributeChangedCallback&&n.attributeChangedCallback(t,e,e)}))}))}},{key:"getPosition",value:function(t){var e=t.transformable;return Z(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return Q(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return J(e.scaling,this.getWorldTransform(t,e))}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){if(0!==t.localSkew[0]||0!==t.localSkew[1]){tt(t.localTransform,t.localRotation,t.localPosition,vt(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(L(nl),nl[4]=Math.tan(t.localSkew[0]),nl[1]=Math.tan(t.localSkew[1]),B(t.localTransform,t.localTransform,nl));var e=tt(nl,Vt(rl,0,0,0,1),yt(el,1,1,1),t.localScale,t.origin);B(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,o=t.localScale,a=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],c=1!==o[0]||1!==o[1]||1!==o[2],u=0!==a[0]||0!==a[1]||0!==a[2];l||c||u?tt(n,i,r,o,a):s?$(n,r):L(n)}}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform}},{key:"setLocalTransform",value:function(t,e){var n=Z(il,e),r=Q(ol,e),i=J(al,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,Js,!1),this.setLocalPosition(t,Zs,!1),this.setLocalEulerAngles(t,Zs,void 0,void 0,!1),this.setLocalSkew(t,Ks,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!Yr.isEmpty(r)){var i=n||new Yr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&xl.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new Yr}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,o=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach((function(t){var r=e.getBounds(t,n);r&&(o?o.add(r):(o=i||new Yr).update(r.center,r.halfExtents))})),o||(o=new Yr),n){var a=za(t);if(a){var s=a.parsedStyle.clipPath.getBounds(n);o?s&&(o=s.intersection(o)):o.update(s.center,s.halfExtents)}}return n?(r.renderBounds=o,r.renderBoundsDirty=!1):(r.bounds=o,r.boundsDirty=!1),o}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=Qs;t.parentNode.transformable&&(e=j(nl,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!Yr.isEmpty(n)){var r=new Yr;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);Yr.isEmpty(r)||(n=new Yr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var o=x(n.getMin(),2),a=o[0],s=o[1],l=x(n.getMax(),2),c=l[0],u=l[1];return new Jr(a+((null==i?void 0:i.left)||0),s+((null==i?void 0:i.top)||0),c-a,u-s)}return new Jr((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}}},{key:"sync",value:function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,r=n&&n.transformable;null!==n&&r?B(e.worldTransform,r.worldTransform,e.localTransform):P(e.worldTransform,e.localTransform),e.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}}}])}(),gl={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},vl=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ml=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),yl=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),bl=function(){return u((function t(e){var n=this;l(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!yl.exec(e)&&!ml.exec(t))},this.trimByKinsokuShorui=function(t){var e=f(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e},this.runtime=e}),[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var o=gl.MetricsString+gl.BaselineSymbol,a=Math.ceil(i.measureText(o).width),s=Math.ceil(i.measureText(gl.BaselineSymbol).width),l=gl.HeightMultiplier*s;s=s*gl.BaselineMultiplier|0,r.width=a,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,a,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var c=i.getImageData(0,0,a||1,l||1).data,u=c.length,h=4*a,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var g=0;g<h;g+=4)if(255!==c[f+g]){p=!0;break}if(p)break;f+=h}for(n.ascent=s-d,f=u-h,p=!1,d=l;d>s;--d){for(var v=0;v<h;v+=4)if(255!==c[f+v]){p=!0;break}if(p)break;f-=h}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,o=e.wordWrap,a=void 0!==o&&o,s=e.lineHeight,l=e.lineWidth,c=void 0===l?1:l,u=e.textBaseline,h=void 0===u?"alphabetic":u,d=e.textAlign,f=void 0===d?"start":d,p=e.letterSpacing,g=void 0===p?0:p,v=e.textPath;e.textPathSide,e.textPathStartOffset;var m=e.leading,y=void 0===m?0:m,b=function(t){for(var e=t.fontSize,n=void 0===e?16:e,r=t.fontFamily,i=void 0===r?"sans-serif":r,o=t.fontStyle,a=void 0===o?"normal":o,s=t.fontVariant,l=void 0===s?"normal":s,c=t.fontWeight,u=void 0===c?"normal":c,h=le(n)&&"".concat(n,"px")||"16px",d=i.split(","),f=d.length-1;f>=0;f--){var p=d[f].trim();!ls.test(p)&&ss.indexOf(p)<0&&(p='"'.concat(p,'"')),d[f]=p}return"".concat(a," ").concat(l," ").concat(u," ").concat(h," ").concat(d.join(","))}(e),x=this.measureFont(b,n);0===x.fontSize&&(x.fontSize=i,x.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=b,e.isOverflowing=!1;var w=(a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),k=new Array(w.length),M=0;if(!v){for(var N=0;N<w.length;N++){var O=E.measureText(w[N]).width+(w[N].length-1)*g;k[N]=O,M=Math.max(M,O)}var S=M+c,T=s||x.fontSize+c,_=Math.max(T,x.fontSize+c)+(w.length-1)*(T+y),A=0;return"middle"===h?A=-_/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?A=-_:"top"!==h&&"hanging"!==h||(A=0),{font:b,width:S,height:_,lines:w,lineWidths:k,lineHeight:T+=y,maxLineWidth:M,fontProperties:x,lineMetrics:k.map((function(t,e){var n=0;return"center"===f||"middle"===f?n-=t/2:"right"!==f&&"end"!==f||(n-=t),new Jr(n-c/2,A+e*T,t+c,T)}))}}v.getTotalLength();for(var C=0;C<w.length;C++)E.measureText(w[C]).width,w[C].length}},{key:"setGraphemeOnPath",value:function(){}},{key:"wordWrap",value:function(t,e,n){var r=this,i=e.wordWrapWidth,o=void 0===i?0:i,a=e.letterSpacing,s=void 0===a?0:a,l=e.maxLines,c=void 0===l?1/0:l,u=e.textOverflow,h=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),d=o+s,f="";"ellipsis"===u?f="...":u&&"clip"!==u&&(f=u);for(var p=[],g=0,v=0,m={},y=function(t){return r.getFromCache(t,s,m,h)},b=Array.from(f).reduce((function(t,e){return t+y(e)}),0),x=Array.from(t),E=0;E<x.length;E++){var w=x[E],k=t[E-1],M=t[E+1],N=y(w);if(this.isNewline(w)){if(++g>=c){e.isOverflowing=!0;break}v=0,p[g]=""}else{if(v>0&&v+N>d){if(g+1>=c){if(e.isOverflowing=!0,b>0&&b<=d){for(var O=p[g].length,S=0,T=O,_=0;_<O;_++){var A=y(p[g][_]);if(S+A+b>d){T=_;break}S+=A}p[g]=(p[g]||"").slice(0,T)+f}break}if(v=0,p[++g]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),v=this.sumTextWidthByCache(p[g]||"",m)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),v+=y(k||""))}v+=N,p[g]=(p[g]||"")+w}}return p.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&gl.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&gl.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=f(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),o=r+1,a=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(o,n.length),e[e.length-2]=n.slice(0,a),e}},{key:"canBreakInLastChar",value:function(t){return!t||!vl.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce((function(t,n){if(!e[n])throw Error("cannot count the word without cache");return t+e[n]}),0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!vl.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,r){var i=n[t];if("number"!=typeof i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i}}])}(),xl={},El=(Ys=new Ns,qs=new Ms,o(o(o(o(o(o(o(o(o(o(Us={},jr.CIRCLE,new xs),jr.ELLIPSE,new Es),jr.RECT,Ys),jr.IMAGE,Ys),jr.GROUP,new Ss),jr.LINE,new ws),jr.TEXT,new Os(xl)),jr.POLYLINE,qs),jr.POLYGON,qs),jr.PATH,new ks),o(o(Us,jr.HTML,new Ts),jr.MESH,null)),wl=function(t){var e=new xa,n=new ka;return o(o(o(o(o(o(o(o(o(o(t={},Si.PERCENTAGE,null),Si.NUMBER,new Sa),Si.ANGLE,new ya),Si.DEFINED_PATH,new ba),Si.PAINT,e),Si.COLOR,e),Si.FILTER,new Ea),Si.LENGTH,n),Si.LENGTH_PERCENTAGE,n),Si.LENGTH_PERCENTAGE_12,new Ma),o(o(o(o(o(o(o(o(o(o(t,Si.LENGTH_PERCENTAGE_14,new Na),Si.COORDINATE,new ka),Si.OFFSET_DISTANCE,new Ta),Si.OPACITY_VALUE,new _a),Si.PATH,new Aa),Si.LIST_OF_POINTS,new Ca),Si.SHADOW_BLUR,new Pa),Si.TEXT,new Da),Si.TEXT_TRANSFORM,new Ra),Si.TRANSFORM,new ms),o(o(o(t,Si.TRANSFORM_ORIGIN,new ys),Si.Z_INDEX,new bs),Si.MARKER,new Oa)}();xl.CameraContribution=ki,xl.AnimationTimeline=null,xl.EasingFunction=null,xl.offscreenCanvasCreator=new Fs,xl.sceneGraphSelector=new Gs,xl.sceneGraphService=new pl(xl),xl.textService=new bl(xl),xl.geometryUpdaterFactory=El,xl.CSSPropertySyntaxFactory=wl,xl.styleValueRegistry=new ma(xl),xl.layoutRegistry=null,xl.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},xl.enableStyleSyntax=!0,xl.enableSizeAttenuation=!1;var kl=0,Ml=new $s(Ws.INSERTED,null,"","","",0,"",""),Nl=new $s(Ws.REMOVED,null,"","","",0,"",""),Ol=new Ds(Ws.DESTROY),Sl=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).entity=kl++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:Mi.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return b(e,t),u(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(Qr)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return xl.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&($a(this)||t.nodeName!==jr.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(Ml.relatedNode=this,t.dispatchEvent(Ml)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e;return Nl.relatedNode=this,t.dispatchEvent(Nl),null!==(e=t.ownerDocument)&&void 0!==e&&e.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),xl.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return xl.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return xl.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return xl.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return xl.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return xl.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return xl.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return xl.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(xl.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach((function(r){return r===e||!t(r)||(n=r,!1)})),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach((function(r){r!==e&&t(r)&&n.push(r)})),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1)}))}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r[0],a=r.slice(1);this.parentNode.appendChild(o,e),(t=o).after.apply(t,f(a))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){return t.appendChild(e)}))}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e,n){return t.appendChild(e,n)}))}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(Ol),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return xl.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return xl.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return xl.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return xl.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return xl.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t){var e=this.attributes[t];return e}}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,n,r){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(Qr)}},{key:"getAttributeNode",value:function(t){throw new Error(Qr)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(Qr)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(Qr)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(Qr)}},{key:"removeAttributeNode",value:function(t){throw new Error(Qr)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(Qr)}},{key:"setAttributeNode",value:function(t){throw new Error(Qr)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(Qr)}},{key:"toggleAttribute",value:function(t,e){throw new Error(Qr)}}])}(Is);function Tl(t){return!(null==t||!t.nodeName)}var _l=xl.globalThis.Proxy?xl.globalThis.Proxy:function(){},Al=new $s(Ws.ATTR_MODIFIED,null,null,null,null,$s.MODIFICATION,null,null),Cl=ft(),Pl=Rt(),Dl=function(t){function e(t){var n;return l(this,e),(n=m(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||jr.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),xl.enableStyleSyntax&&(n.style=new _l({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,r){return n.setAttribute(e,r),!0}})),n}return b(e,t),u(e,[{key:"destroy",value:function(){Pn(e,"destroy",this)([]),this.getAnimations().forEach((function(t){t.cancel()}))}},{key:"cloneNode",value:function(t,e){var n=s({},this.attributes);for(var r in n){var i=n[r];Tl(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i))}var o=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:n});return o.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);o.appendChild(n)}})),o}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};xl.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.renderable.dirty=!0}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];ye(n)||(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),Pn(e,"setAttribute",this)([t,n]))}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.renderable,i=this.attributes[t],a=this.parsedStyle[t];xl.styleValueRegistry.processProperties(this,o({},t,e),n),r.dirty=!0;var s,l=this.parsedStyle[t];(this.isConnected&&(Al.relatedNode=this,Al.prevValue=i,Al.newValue=e,Al.attrName=t,Al.prevParsedValue=a,Al.newParsedValue=l,this.isMutationObserved?this.dispatchEvent(Al):(Al.target=this,this.ownerDocument.defaultView.dispatchEvent(Al,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(s=this.attributeChangedCallback)||void 0===s||s.call(this,t,i,e,a,l))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=x(t.getMin(),2),n=e[0],r=e[1],i=x(t.getMax(),2),o=i[0],a=i[1];return new Jr(n,r,o-n,a-r)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xl.sceneGraphService.setOrigin(this,ri(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return xl.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xl.sceneGraphService.setPosition(this,ri(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xl.sceneGraphService.setLocalPosition(this,ri(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xl.sceneGraphService.translate(this,ri(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xl.sceneGraphService.translateLocal(this,ri(t,e,n,!1)),this}},{key:"getPosition",value:function(){return xl.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return xl.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=ri(t,e=e||t,n=n||t,!1)),xl.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=ri(t,e=e||t,n=n||t,!1)),xl.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return xl.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return xl.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return si(x(ci(Cl,xl.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return si(x(ci(Cl,xl.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return xl.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return xl.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return qt(e)&&qt(n)?xl.sceneGraphService.rotateLocal(this,0,0,t):xl.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return qt(e)&&qt(n)?xl.sceneGraphService.rotate(this,0,0,t):xl.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,r){return xl.sceneGraphService.setRotation(this,t,e,n,r),this}},{key:"setLocalRotation",value:function(t,e,n,r){return xl.sceneGraphService.setLocalRotation(this,t,e,n,r),this}},{key:"setLocalSkew",value:function(t,e){return xl.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return xl.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return xl.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return xl.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return xl.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return xl.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return xl.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){xl.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,f(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],o=n[1];return i?Kt(i)?(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),this):2===n.length?(this.setAttribute(i,o),this):this.attributes[i]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=x(Z(Cl,e),2),r=n[0],i=n[1],o=x(J(Cl,e),2),a=o[0],s=o[1],l=Q(Pl,e),c=x(ci(Cl,l),3),u=c[0],h=c[2];return ui(u||h,r,i,a,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=x(hi(t),5),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setEulerAngles(a).setPosition(n,r).setLocalScale(i,o)}},{key:"setLocalMatrix",value:function(t){var e=x(hi(t),5),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setLocalEulerAngles(a).setLocalPosition(n,r).setLocalScale(i,o)}},{key:"show",value:function(){this.forEach((function(t){t.style.visibility="visible"}))}},{key:"hide",value:function(){this.forEach((function(t){t.style.visibility="hidden"}))}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(Sl),Rl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),m(this,e,[s({type:jr.CIRCLE},t)])}return b(e,t),u(e)}(Dl),Ll=["style"],Il=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Rr(n,Ll);return l(this,e),(t=m(this,e,[s({style:r},i)])).isCustomElement=!0,t}return b(e,t),u(e)}(Dl),jl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),m(this,e,[s({type:jr.ELLIPSE},t)])}return b(e,t),u(e)}(Dl),Fl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),m(this,e,[s({type:jr.GROUP},t)])}return b(e,t),u(e)}(Dl),Bl=["style"],zl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Rr(n,Bl);return l(this,e),(t=m(this,e,[s({type:jr.HTML,style:r},i)])).cullable.enable=!1,t}return b(e,t),u(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=j(A(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!Yr.isEmpty(e)){var n=new Yr;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(Dl),Vl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),m(this,e,[s({type:jr.IMAGE},t)])}return b(e,t),u(e)}(Dl),Gl=["style"],Wl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Rr(n,Gl);l(this,e),(t=m(this,e,[s({type:jr.LINE,style:s({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var o=t.parsedStyle,a=o.markerStart,c=o.markerEnd;return a&&Tl(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),c&&Tl(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return b(e,t),u(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Tl(r)&&(this.markerStartAngle=0,r.remove()),i&&Tl(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&Tl(r)&&(this.markerEndAngle=0,r.remove()),i&&Tl(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.x1,s=e.x2,l=e.y1,c=e.y2,u=t?n:r;if(u&&Tl(u)){var h,d,f,p,g,v,m;t?(p=a,g=l,d=s-a,f=c-l,v=i||0,m=this.markerStartAngle):(p=s,g=c,d=a-s,f=l-c,v=o||0,m=this.markerEndAngle),h=Math.atan2(f,d),u.setLocalEulerAngles(180*h/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*v,g+Math.sin(h)*v)}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=br(n.x1,n.y1,n.x2,n.y2,t),i=r.x,o=r.y,a=Ot(ft(),vt(i,o,0),e?this.getWorldTransform():this.getLocalTransform());return new Zr(a[0],a[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return yr(t.x1,t.y1,t.x2,t.y2)}}])}(Dl),$l=["style"],Hl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Rr(n,$l);l(this,e),(t=m(this,e,[s({type:jr.PATH,style:r,initialParsedStyle:{miterLimit:4,d:s({},Oi)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var o=t.parsedStyle,a=o.markerStart,c=o.markerEnd,u=o.markerMid;return a&&Tl(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),u&&Tl(u)&&t.placeMarkerMid(u),c&&Tl(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return b(e,t),u(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Tl(r)&&(this.markerStartAngle=0,r.remove()),i&&Tl(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&Tl(r)&&(this.markerEndAngle=0,r.remove()),i&&Tl(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=t?n:r;if(a&&Tl(a)){var s,l,c,u,h,d,f;if(t){var p=x(this.getStartTangent(),2),g=p[0],v=p[1];u=v[0],h=v[1],l=g[0]-v[0],c=g[1]-v[1],d=i||0,f=this.markerStartAngle}else{var m=x(this.getEndTangent(),2),y=m[0],b=m[1];u=b[0],h=b[1],l=y[0]-b[0],c=y[1]-b[1],d=o||0,f=this.markerEndAngle}s=Math.atan2(c,l),a.setLocalEulerAngles(180*s/Math.PI+f),a.setLocalPosition(u+Math.cos(s)*d,h+Math.sin(s)*d)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach((function(t){t.remove()})),t&&Tl(t))for(var n=1;n<e.length-1;n++){var r=x(e[n].currentPoint,2),i=r[0],o=r[1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(i,o)}}},{key:"getTotalLength",value:function(){return Do(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(t,e,n){return Nn(t,e,Be(Be({},n),{bbox:!1,length:!0})).point}(this.parsedStyle.d.absolutePath,t),r=n.x,i=n.y,o=Ot(ft(),vt(r,i,0),e?this.getWorldTransform():this.getLocalTransform());return new Zr(o[0],o[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*Do(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,o=t[e-1].endTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n}}])}(Dl),Ul=["style"],Yl=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=Rr(n,Ul);l(this,e),(t=m(this,e,[s({type:jr.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var o=t.parsedStyle,a=o.markerStart,c=o.markerEnd,u=o.markerMid;return a&&Tl(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),u&&Tl(u)&&t.placeMarkerMid(u),c&&Tl(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return b(e,t),u(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Tl(r)&&(this.markerStartAngle=0,r.remove()),i&&Tl(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&Tl(r)&&(this.markerEndAngle=0,r.remove()),i&&Tl(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=(e.points||{}).points,s=t?n:r;if(s&&Tl(s)&&a){var l,c,u,h,d,f,p;if(h=a[0][0],d=a[0][1],t)c=a[1][0]-a[0][0],u=a[1][1]-a[0][1],f=i||0,p=this.markerStartAngle;else{var g=a.length;this.parsedStyle.isClosed?(c=a[g-1][0]-a[0][0],u=a[g-1][1]-a[0][1]):(h=a[g-1][0],d=a[g-1][1],c=a[g-2][0]-a[g-1][0],u=a[g-2][1]-a[g-1][1]),f=o||0,p=this.markerEndAngle}l=Math.atan2(u,c),s.setLocalEulerAngles(180*l/Math.PI+p),s.setLocalPosition(h+Math.cos(l)*f,d+Math.sin(l)*f)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&Tl(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(r,i)}}}])}(Dl),ql=["style"],Xl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=Rr(t,ql);return l(this,e),m(this,e,[s({type:jr.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)])}return b(e,t),u(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Nr(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,o=[],a=0,s=this.getTotalLength();n.forEach((function(t,e){n[e+1]&&((r=[0,0])[0]=a/s,i=yr(t[0],t[1],n[e+1][0],n[e+1][1]),a+=i,r[1]=a/s,o.push(r))})),this.parsedStyle.points.segments=o}var l=0,c=0;this.parsedStyle.points.segments.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),c=n)}));var u=br(n[c][0],n[c][1],n[c+1][0],n[c+1][1],l),h=u.x,d=u.y,f=Ot(ft(),vt(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new Zr(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(Yl),Kl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),m(this,e,[s({type:jr.RECT},t)])}return b(e,t),u(e)}(Dl),Zl=["style"],Jl=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=Rr(t,Zl);return l(this,e),m(this,e,[s({type:jr.TEXT,style:s({fill:"black"},n)},r)])}return b(e,t),u(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Dl),Ql=function(){return u((function t(){l(this,t),this.registry={},this.define(jr.CIRCLE,Rl),this.define(jr.ELLIPSE,jl),this.define(jr.RECT,Kl),this.define(jr.IMAGE,Vl),this.define(jr.LINE,Wl),this.define(jr.GROUP,Fl),this.define(jr.PATH,Hl),this.define(jr.POLYGON,Yl),this.define(jr.POLYLINE,Xl),this.define(jr.TEXT,Jl),this.define(jr.HTML,zl)}),[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}])}(),tc=function(t){function e(){var t;l(this,e),(t=m(this,e)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new xl.AnimationTimeline(t)}catch(t){}var n={};return pa.forEach((function(t){var e=t.n,r=t.inh,i=t.d;r&&i&&(n[e]=Yt(i)?i(jr.GROUP):i)})),t.documentElement=new Fl({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return b(e,t),u(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?Jl:Fl);var r=new n(e);return r.ownerDocument=this,r}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n)}},{key:"cloneNode",value:function(t){throw new Error(Qr)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,r){var i=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:n,maxY:r}),o=[];return i.forEach((function(t){var e=t.displayObject,n=e.parsedStyle.pointerEvents,r=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===n?"auto":n);(!r||r&&e.isVisible())&&!e.isCulled()&&e.isInteractive()&&o.push(e)})),o.sort((function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder})),o}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height;if(r<0||i<0||r>a||i>s)return null;var l=this.defaultView.viewport2Client({x:r,y:i}),c=l.x,u=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:u},picked:[]}).picked;return h&&h[0]||this.documentElement}},{key:"elementFromPoint",value:(r=Pr(Ar().mark((function t(e,n){var r,i,o,a,s,l,c,u,h,d,f;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,l=a.height,!(i<0||o<0||i>s||o>l)){t.next=4;break}return t.abrupt("return",null);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),u=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:u,clientY:h},picked:[]});case 7:return d=t.sent,f=d.picked,t.abrupt("return",f&&f[0]||this.documentElement);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height;if(r<0||i<0||r>a||i>s)return[];var l=this.defaultView.viewport2Client({x:r,y:i}),c=l.x,u=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:u},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h}},{key:"elementsFromPoint",value:(n=Pr(Ar().mark((function t(e,n){var r,i,o,a,s,l,c,u,h,d,f;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,l=a.height,!(i<0||o<0||i>s||o>l)){t.next=4;break}return t.abrupt("return",[]);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),u=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:u,clientY:h},picked:[]});case 7:return d=t.sent,(f=d.picked)[f.length-1]!==this.documentElement&&f.push(this.documentElement),t.abrupt("return",f);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw new Error(ti)}},{key:"insertBefore",value:function(t,e){throw new Error(ti)}},{key:"removeChild",value:function(t,e){throw new Error(ti)}},{key:"replaceChild",value:function(t,e,n){throw new Error(ti)}},{key:"append",value:function(){throw new Error(ti)}},{key:"prepend",value:function(){throw new Error(ti)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}]);var n,r}(Is),ec=function(){function t(e){l(this,t),this.strategies=e}return u(t,[{key:"apply",value:function(e){var n=e.camera,r=e.renderingService,i=e.renderingContext,o=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e=t.cullable;return 0===o.length?e.visible=i.unculledEntities.indexOf(t.entity)>-1:e.visible=o.every((function(e){return e.isVisible(n,t)})),!t.isCulled()&&t.isVisible()?t:(t.dispatchEvent(new Ds(Ws.CULLED)),null)}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))}}])}();ec.tag="Culling";var nc=function(){function t(){var e=this;l(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new Cs(null),this.rootWheelEvent=new Ps(null),this.onPointerMove=function(t){var n,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!r.supportsTouchEvents||"touch"!==t.pointerType){var i,o=Dr(e.normalizeToPointerEvent(t,r));try{for(o.s();!(i=o.n()).done;){var a=i.value,s=e.bootstrapEvent(e.rootPointerEvent,a,r,t);e.context.eventService.mapEvent(s)}}catch(t){o.e(t)}finally{o.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,o=Dr(e.normalizeToPointerEvent(t,i));try{for(o.s();!(r=o.n()).done;){var a=r.value,s=e.bootstrapEvent(e.rootPointerEvent,a,i,t);e.context.eventService.mapEvent(s)}}catch(t){o.e(t)}finally{o.f()}e.setCursor(e.context.eventService.cursor)}}return u(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler((function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null})),r.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),r.hooks.pointerDown.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);if(n.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,o=Dr(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=n.bootstrapEvent(n.rootPointerEvent,a,i,t);n.context.eventService.mapEvent(s)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerUp.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),o=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",a=Dr(n.normalizeToPointerEvent(t,i));try{for(a.s();!(e=a.n()).done;){var s=e.value,l=n.bootstrapEvent(n.rootPointerEvent,s,i,t);l.type+=o,n.context.eventService.mapEvent(l)}}catch(t){a.e(t)}finally{a.f()}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,(function(t){var e,r=Dr(n.normalizeToPointerEvent(t,i));try{for(r.s();!(e=r.n()).done;){var o=e.value,a=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(a)}}catch(t){r.e(t)}finally{r.f()}n.setCursor(n.context.eventService.cursor)}))}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),o=i.x,a=i.y;t.viewport.x=o,t.viewport.y=a;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,c=s.y;return t.canvas.x=l,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Ga[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var o=this.context.eventService.viewport2Canvas(e.viewport),a=o.x,s=o.y;return e.canvas.x=a,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=Wa.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];ye(i.button)&&(i.button=0),ye(i.buttons)&&(i.buttons=1),ye(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),ye(i.width)&&(i.width=i.radiusX||1),ye(i.height)&&(i.height=i.radiusY||1),ye(i.tiltX)&&(i.tiltX=0),ye(i.tiltY)&&(i.tiltY=0),ye(i.pointerType)&&(i.pointerType="touch"),ye(i.pointerId)&&(i.pointerId=i.identifier||0),ye(i.pressure)&&(i.pressure=i.force||.5),ye(i.twist)&&(i.twist=0),ye(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var o=t;ye(o.isPrimary)&&(o.isPrimary=!0),ye(o.width)&&(o.width=1),ye(o.height)&&(o.height=1),ye(o.tiltX)&&(o.tiltX=0),ye(o.tiltY)&&(o.tiltY=0),ye(o.pointerType)&&(o.pointerType="mouse"),ye(o.pointerId)&&(o.pointerId=1),ye(o.pressure)&&(o.pressure=.5),ye(o.twist)&&(o.twist=0),ye(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,n.push(o)}else n.push(t);return n}}])}();nc.tag="Event";var rc=[jr.CIRCLE,jr.ELLIPSE,jr.IMAGE,jr.RECT,jr.LINE,jr.POLYLINE,jr.POLYGON,jr.TEXT,jr.PATH,jr.HTML],ic=function(){return u((function t(){l(this,t)}),[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(Yr.isEmpty(i))return!1;var o=t.getFrustum(),a=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,a||Xr.INDETERMINATE,o.planes),r.visible=r.visibilityPlaneMask!==Xr.OUTSIDE,r.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===Xr.OUTSIDE||n===Xr.INSIDE)return n;for(var i=Xr.INSIDE,o=rc.indexOf(t.nodeName)>-1,a=0,s=r.length;a<s;++a){var l=1<<a;if(n&l&&(!o||4!==a&&5!==a)){var c=r[a],u=c.normal,h=c.distance;if(kt(u,e.getPositiveFarPoint(r[a]))+h<0)return Xr.OUTSIDE;kt(u,e.getNegativeFarPoint(r[a]))+h<0&&(i|=l)}}return i}}])}(),oc=function(){function t(){l(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return u(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,o=e.renderingContext,a=e.rBushRoot,s=o.root.ownerDocument.defaultView;this.rBush=a;var l=function(t){t.target.renderable.dirty=!0,i.dirtify()},c=function(t){r.syncTasks.set(t.target,t.detail.affectChildren),i.dirtify()},u=function(t){var e=t.target;xl.enableSizeAttenuation&&xl.styleValueRegistry.updateSizeAttenuation(e,s.getCamera().getZoom())},h=function(t){var e=t.target,n=e.rBushNode;n.aabb&&r.rBush.remove(n.aabb),r.syncTasks.delete(e),xl.sceneGraphService.dirtifyToRoot(e),i.dirtify()};i.hooks.init.tap(t.tag,(function(){s.addEventListener(Ws.MOUNTED,u),s.addEventListener(Ws.UNMOUNTED,h),s.addEventListener(Ws.ATTR_MODIFIED,l),s.addEventListener(Ws.BOUNDS_CHANGED,c)})),i.hooks.destroy.tap(t.tag,(function(){s.removeEventListener(Ws.MOUNTED,u),s.removeEventListener(Ws.UNMOUNTED,h),s.removeEventListener(Ws.ATTR_MODIFIED,l),s.removeEventListener(Ws.BOUNDS_CHANGED,c),r.syncTasks.clear()}));var d=null!==(n=xl.globalThis.requestIdleCallback)&&void 0!==n?n:es.bind(xl.globalThis);i.hooks.endFrame.tap(t.tag,(function(){r.isFirstTimeRendering?(r.isFirstTimeRendering=!1,r.syncing=!0,d((function(){r.syncRTree(!0),r.isFirstTimeRenderingFinished=!0}))):r.syncRTree()}))}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=t.getRenderBounds();if(r){var i=t.renderable;e&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new Yr),i.dirtyRenderBounds.update(r.center,r.halfExtents));var o=x(r.getMin(),2),a=o[0],s=o[1],l=x(r.getMax(),2),c=l[0],u=l[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=a,n.aabb.minY=s,n.aabb.maxX=c,n.aabb.maxY=u}return n.aabb&&!(isNaN(n.aabb.maxX)||isNaN(n.aabb.maxX)||isNaN(n.aabb.minX)||isNaN(n.aabb.minY))?n.aabb:void 0}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var o=t.syncNode(i,e);o&&(n.push(o),r.add(i))}};this.syncTasks.forEach((function(t,e){t&&e.forEach(i);for(var n=e;n;)i(n),n=n.parentElement})),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();oc.tag="Prepare";var ac=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),sc=new Ds(Ws.MOUNTED),lc=new Ds(Ws.UNMOUNTED),cc=new Ds(ac.BEFORE_RENDER),uc=new Ds(ac.RERENDER),hc=new Ds(ac.AFTER_RENDER),dc=function(t){function e(t){var n;l(this,e),(n=m(this,e)).Element=Dl,n.inited=!1,n.context={},n.document=new tc,n.document.defaultView=n,n.customElements=new Ql;var r=t.container,i=t.canvas,o=t.offscreenCanvas,a=t.width,s=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,d=t.cursor,f=t.document,p=t.requestAnimationFrame,g=t.cancelAnimationFrame,v=t.createImage,y=t.enableLargeImageOptimization,b=t.supportsPointerEvents,x=t.supportsTouchEvents,E=t.supportsCSSTransform,w=t.cleanUpOnDestroy,k=void 0===w||w,M=t.supportsMutipleCanvasesInOneContainer,N=t.useNativeClickEvent,O=t.alwaysTriggerPointerEventOnCanvas,S=t.isTouchEvent,T=t.isMouseEvent,_=t.dblClickSpeed;M||Ia(r,n,k);var A=a,C=s,P=c;return i&&(P=(P=c||ja&&window.devicePixelRatio||1)>=1?Math.ceil(P):1,A=a||function(t){var e=Va(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(i)||i.width/P,C=s||function(t){var e=Va(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(i)||i.height/P),o&&(xl.offscreenCanvas=o),n.devicePixelRatio=P,n.requestAnimationFrame=null!=p?p:es.bind(xl.globalThis),n.cancelAnimationFrame=null!=g?g:ns.bind(xl.globalThis),n.supportsTouchEvents=null!=x?x:"ontouchstart"in xl.globalThis,n.supportsPointerEvents=null!=b?b:!!xl.globalThis.PointerEvent,n.isTouchEvent=null!=S?S:function(t){return n.supportsTouchEvents&&t instanceof xl.globalThis.TouchEvent},n.isMouseEvent=null!=T?T:function(t){return!xl.globalThis.MouseEvent||t instanceof xl.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof xl.globalThis.PointerEvent))},n.dblClickSpeed=null!=_?_:200,n.initRenderingContext({container:r,canvas:i,width:A,height:C,renderer:u,offscreenCanvas:o,devicePixelRatio:P,cursor:d||"default",background:h||"transparent",createImage:v,enableLargeImageOptimization:y,document:f,supportsCSSTransform:E,useNativeClickEvent:N,cleanUpOnDestroy:k,alwaysTriggerPointerEventOnCanvas:O}),n.initDefaultCamera(A,C,u.clipSpaceNearZ),n.initRenderer(u,!0),n}return b(e,t),u(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,e,n){var r=this,i=new xl.CameraContribution;i.clipSpaceNearZ=n,i.setType(yi.EXPLORING,bi.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),i.canvas=this,i.eventEmitter.on(Ei,(function(){r.context.renderingContext.renderReasons.add(Bs.CAMERA_CHANGED),xl.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation()})),this.context.camera=i}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach((function(e){xl.styleValueRegistry.updateSizeAttenuation(e,t)}))}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise((function(e){t.resolveReadyPromise=function(){e(t)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;void 0===e&&(e=this.getConfig().fastCleanExistingCanvas),e||this.dispatchEvent(new Ds(ac.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var n=this.getRoot();this.unmountChildren(n),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),e||this.dispatchEvent(new Ds(ac.AFTER_DESTROY));var r=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null};r(sc),r(lc),r(cc),r(uc),r(hc),r(Al),r(Ml),r(Nl),r(Ol)}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var n=this.context.config;n.width=t,n.height=e,this.getContextService().resize(t,e);var r=this.context.camera,i=r.getProjectionMode();r.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===xi.ORTHOGRAPHIC?r.setOrthographic(t/-2,t/2,e/2,e/-2,r.getNear(),r.getFar()):r.setAspect(t/e),this.dispatchEvent(new Ds(ac.RESIZE,{width:t,height:e}))}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var e=this;t&&(cc.detail=t,hc.detail=t),this.dispatchEvent(cc),this.getRenderingService().render(this.getConfig(),t,(function(){e.dispatchEvent(uc)})),this.dispatchEvent(hc)}},{key:"run",value:function(){var t=this,e=function(n,r){t.render(r),t.frameId=t.requestAnimationFrame(e)};e()}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new Ir,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new nc,new oc,new ec([new ic])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(s(s({},xl),this.context)),this.context.renderingService=new zs(xl,this.context),this.context.eventService=new js(xl,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then((function(){e.initRenderingService(t,n)}))}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init((function(){e.inited=!0,n?r?e.requestAnimationFrame((function(){e.dispatchEvent(new Ds(ac.READY))})):e.dispatchEvent(new Ds(ac.READY)):e.dispatchEvent(new Ds(ac.RENDERER_CHANGED)),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run()}))}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach((function(t){t.context=e.context,t.init(xl)}))}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),f((null==n?void 0:n.getPlugins())||[]).reverse().forEach((function(t){t.destroy(xl)})),this.initRenderer(t)}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this;t.childNodes.forEach((function(t){e.unmountChildren(t)})),this.inited&&(t.isMutationObserved?t.dispatchEvent(lc):(lc.target=t,this.dispatchEvent(lc,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$a(t);this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,n||(t.isMutationObserved?t.dispatchEvent(sc):(sc.target=t,this.dispatchEvent(sc,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach((function(t){e.mountChildren(t,n)})),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}])}(Ls),fc=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).landmarks=[],t}return b(e,t),u(e,[{key:"rotate",value:function(t,e,n){if(this.relElevation=ei(e),this.relAzimuth=ei(t),this.relRoll=ei(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===yi.EXPLORING){var r=Lt(Rt(),[1,0,0],oi((this.rotateWorld?1:-1)*this.relElevation)),i=Lt(Rt(),[0,1,0],oi((this.rotateWorld?1:-1)*this.relAzimuth)),o=Lt(Rt(),[0,0,1],oi(this.relRoll)),a=It(Rt(),i,r);a=It(Rt(),a,o);var s=et(A(),a);z(this.matrix,this.matrix,[0,0,-this.distance]),B(this.matrix,this.matrix,s),z(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===yi.ORBITING||this.type===yi.EXPLORING?this._getPosition():this.type===yi.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var n=ri(t,e,0),r=pt(this.position);return bt(r,r,Et(ft(),this.right,n[0])),bt(r,r,Et(ft(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,n=pt(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===yi.ORBITING||this.type===yi.EXPLORING?this._getDistance():this.type===yi.TRACKING&&bt(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(t){var e,n,r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.position,s=void 0===a?this.position:a,l=o.focalPoint,c=void 0===l?this.focalPoint:l,u=o.roll,h=o.zoom,d=new xl.CameraContribution;d.setType(this.type,void 0),d.setPosition(s[0],null!==(e=s[1])&&void 0!==e?e:this.position[1],null!==(n=s[2])&&void 0!==n?n:this.position[2]),d.setFocalPoint(c[0],null!==(r=c[1])&&void 0!==r?r:this.focalPoint[1],null!==(i=c[2])&&void 0!==i?i:this.focalPoint[2]),d.setRoll(null!=u?u:this.roll),d.setZoom(null!=h?h:this.zoom);var f={name:t,matrix:C(d.getWorldTransform()),right:pt(d.right),up:pt(d.up),forward:pt(d.forward),position:pt(d.getPosition()),focalPoint:pt(d.getFocalPoint()),distanceVector:pt(d.getDistanceVector()),distance:d.getDistance(),dollyingStep:d.getDollyingStep(),azimuth:d.getAzimuth(),elevation:d.getElevation(),roll:d.getRoll(),relAzimuth:d.relAzimuth,relElevation:d.relElevation,relRoll:d.relRoll,zoom:d.getZoom()};return this.landmarks.push(f),f}},{key:"gotoLandmark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ie(t)?this.landmarks.find((function(e){return e.name===t})):t;if(r){var i=le(n)?{duration:n}:n,o=i.easing,a=void 0===o?"linear":o,s=i.duration,l=void 0===s?100:s,c=i.easingFunction,u=void 0===c?void 0:c,h=i.onfinish,d=void 0===h?void 0:h,f=i.onframe,p=void 0===f?void 0:f;this.cancelLandmarkAnimation();var g,v=r.position,m=r.focalPoint,y=r.zoom,b=r.roll,x=u||xl.EasingFunction(a),E=function(){e.setFocalPoint(m),e.setPosition(v),e.setRoll(b),e.setZoom(y),e.computeMatrix(),e.triggerUpdate(),null==d||d()};if(0===l)return E();var w=function(t){void 0===g&&(g=t);var n=t-g;if(n>=l)E();else{var r,i,o=x(n/l),a=ft(),s=ft();if(Nt(a,e.focalPoint,m,o),Nt(s,e.position,v,o),i=e.roll*(1-o)+b*o,r=e.zoom*(1-o)+y*o,e.setFocalPoint(a),e.setPosition(s),e.setRoll(i),e.setZoom(r),_t(a,m)+_t(s,v)<=.01&&void 0===y&&void 0===b)return E();e.computeMatrix(),e.triggerUpdate(),n<l&&(null==p||p(o),e.landmarkAnimationID=e.canvas.requestAnimationFrame(w))}};this.canvas.requestAnimationFrame(w)}}}])}(ki);xl.CameraContribution=fc;
/*!
   * @antv/g-web-animations-api
   * @description A simple implementation of Web Animations API.
   * @version 2.1.6
   * @date 11/5/2024, 10:47:58 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */
var pc=function(t){function e(t,n,r,i){var o;return l(this,e),(o=m(this,e,[t])).currentTime=r,o.timelineTime=i,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=r,o.timelineTime=i,o}return b(e,t),u(e)}(_s),gc=0,vc=function(){return u((function t(e,n){var r;l(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(gc++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(r=this.effect)||void 0===r?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}),[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){var e;if(this.timeline.restart(),!this._paused&&null!==this._startTime)this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate;this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new pc(null,this,this.currentTime,null);setTimeout((function(){t.oncancel(e)}))}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this._totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this._totalDuration}}},{key:"persist",value:function(){throw new Error(Qr)}},{key:"addEventListener",value:function(t,e,n){throw new Error(Qr)}},{key:"removeEventListener",value:function(t,e,n){throw new Error(Qr)}},{key:"dispatchEvent",value:function(t){throw new Error(Qr)}},{key:"commitStyles",value:function(){throw new Error(Qr)}},{key:"ensureAlive",value:function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!(null===(t=this.effect)||void 0===t||!t.update(-1)):this._inEffect=!(null===(e=this.effect)||void 0===e||!e.update(this.currentTime));this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new pc(null,this,this.currentTime,t);setTimeout((function(){e.onfinish&&e.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new pc(null,this,this.currentTime,t);this.onframe(r)}this._finishedFlag=!1}}}])}(),mc=.1,yc="function"==typeof Float32Array,bc=function(t,e){return 1-3*e+3*t},xc=function(t,e){return 3*e-6*t},Ec=function(t){return 3*t},wc=function(t,e,n){return((bc(e,n)*t+xc(e,n))*t+Ec(e))*t},kc=function(t,e,n){return 3*bc(e,n)*t*t+2*xc(e,n)*t+Ec(e)},Mc=function(t,e,n,r){if(!(t>=0&&t<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(t){return t};for(var i=yc?new Float32Array(11):new Array(11),o=0;o<11;++o)i[o]=wc(o*mc,t,n);var a=function(e){for(var r=0,o=1;10!==o&&i[o]<=e;++o)r+=mc;--o;var a=r+(e-i[o])/(i[o+1]-i[o])*mc,s=kc(a,t,n);return s>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var o=kc(e,n,r);if(0===o)return e;e-=(wc(e,n,r)-t)/o}return e}(e,a,t,n):0===s?a:function(t,e,n,r,i){var o,a,s=0;do{(o=wc(a=e+(n-e)/2,r,i)-t)>0?n=a:e=a}while(Math.abs(o)>1e-7&&++s<10);return a}(e,r,r+mc,t,n)};return function(t){return 0===t||1===t?t:wc(a(t),e,r)}},Nc=function(t){return Math.pow(t,2)},Oc=function(t){return Math.pow(t,3)},Sc=function(t){return Math.pow(t,4)},Tc=function(t){return Math.pow(t,5)},_c=function(t){return Math.pow(t,6)},Ac=function(t){return 1-Math.cos(t*Math.PI/2)},Cc=function(t){return 1-Math.sqrt(1-t*t)},Pc=function(t){return t*t*(3*t-2)},Dc=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},Rc=function(t){var e=x(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?1:n,i=e[1],o=void 0===i?.5:i,a=se(Number(r),1,10),s=se(Number(o),.1,2);return 0===t||1===t?t:-a*Math.pow(2,10*(t-1))*Math.sin((t-1-s/(2*Math.PI)*Math.asin(1/a))*(2*Math.PI)/s)},Lc=function(t){var e=arguments.length>2?arguments[2]:void 0,n=x(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),r=n[0],i=void 0===r?1:r,o=n[1],a=void 0===o?100:o,s=n[2],l=void 0===s?10:s,c=n[3],u=void 0===c?0:c;i=se(i,.1,1e3),a=se(a,.1,1e3),l=se(l,.1,1e3),u=se(u,.1,1e3);var h=Math.sqrt(a/i),d=l/(2*Math.sqrt(a*i)),f=d<1?h*Math.sqrt(1-d*d):0,p=d<1?(d*h-u)/f:-u+h,g=e?e*t/1e3:t;return g=d<1?Math.exp(-g*d*h)*(1*Math.cos(f*g)+p*Math.sin(f*g)):(1+p*g)*Math.exp(-g*h),0===t||1===t?t:1-g},Ic=function(t){var e=x(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?10:n;return("start"===e[1]?Math.ceil:Math.floor)(se(t,0,1)*r)/r},jc=function(t){var e=x(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),n=e[0],r=e[1],i=e[2],o=e[3];return Mc(n,r,i,o)(t)},Fc=Mc(.42,0,1,1),Bc=function(t){return function(e){return 1-t(1-e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2?arguments[2]:void 0)}},zc=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?t(2*e,n,r)/2:1-t(-2*e+2,n,r)/2}},Vc=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-2*e,n,r))/2:(t(2*e-1,n,r)+1)/2}},Gc={steps:Ic,"step-start":function(t){return Ic(t,[1,"start"])},"step-end":function(t){return Ic(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":jc,ease:function(t){return jc(t,[.25,.1,.25,1])},in:Fc,out:Bc(Fc),"in-out":zc(Fc),"out-in":Vc(Fc),"in-quad":Nc,"out-quad":Bc(Nc),"in-out-quad":zc(Nc),"out-in-quad":Vc(Nc),"in-cubic":Oc,"out-cubic":Bc(Oc),"in-out-cubic":zc(Oc),"out-in-cubic":Vc(Oc),"in-quart":Sc,"out-quart":Bc(Sc),"in-out-quart":zc(Sc),"out-in-quart":Vc(Sc),"in-quint":Tc,"out-quint":Bc(Tc),"in-out-quint":zc(Tc),"out-in-quint":Vc(Tc),"in-expo":_c,"out-expo":Bc(_c),"in-out-expo":zc(_c),"out-in-expo":Vc(_c),"in-sine":Ac,"out-sine":Bc(Ac),"in-out-sine":zc(Ac),"out-in-sine":Vc(Ac),"in-circ":Cc,"out-circ":Bc(Cc),"in-out-circ":zc(Cc),"out-in-circ":Vc(Cc),"in-back":Pc,"out-back":Bc(Pc),"in-out-back":zc(Pc),"out-in-back":Vc(Pc),"in-bounce":Dc,"out-bounce":Bc(Dc),"in-out-bounce":zc(Dc),"out-in-bounce":Vc(Dc),"in-elastic":Rc,"out-elastic":Bc(Rc),"in-out-elastic":zc(Rc),"out-in-elastic":Vc(Rc),spring:Lc,"spring-in":Lc,"spring-out":Bc(Lc),"spring-in-out":zc(Lc),"spring-out-in":Vc(Lc)},Wc=function(t){return t};function $c(t,e){return function(n){if(n>=1)return 1;var r=1/t;return(n+=e*r)-n%r}}var Hc="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Uc=new RegExp("cubic-bezier\\(".concat(Hc,",").concat(Hc,",").concat(Hc,",").concat(Hc,"\\)")),Yc=/steps\(\s*(\d+)\s*\)/,qc=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Xc(t){var e=Uc.exec(t);if(e)return Mc.apply(void 0,f(e.slice(1).map(Number)));var n=Yc.exec(t);if(n)return $c(Number(n[1]),0);var r=qc.exec(t);return r?$c(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):Gc[function(t){return function(t){return"-"===(t=t.replace(/([A-Z])/g,(function(t){return"-".concat(t.toLowerCase())}))).charAt(0)?t.substring(1):t}(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()}(t)]||Gc.linear}function Kc(t){return Math.abs(function(t){var e;if(0===t.duration||0===t.iterations)return 0;return("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(t)/(t.playbackRate||1))}function Zc(t,e,n){var r=function(t,e,n){if(null===e)return 0;var r=n.endTime;return e<Math.min(n.delay,r)?1:e>=Math.min(n.delay+t+n.endDelay,r)?2:3}(t,e,n),i=function(t,e,n,r,i){switch(r){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-i;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,r,n.delay);if(null===i)return null;var o="auto"===n.duration?0:n.duration,a=function(t,e,n,r,i){var o=i;return 0===t?1!==e&&(o+=n):o+=r/t,o}(o,r,n.iterations,i,n.iterationStart),s=function(t,e,n,r,i,o){var a=t===1/0?e%1:t%1;return 0!==a||2!==n||0===r||0===i&&0!==o||(a=1),a}(a,n.iterationStart,r,n.iterations,i,o),l=function(t,e,n,r){return 2===t&&e===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,a),c=function(t,e,n){var r=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,l,s);return n.currentIteration=l,n.progress=c,n.easingFunction(c)}function Jc(t,e,n){var r=function(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(Qc(i)){var o={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:Xc(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(o)}return n}(t,e),i=function(t,e){var n=[];for(var r in t)for(var i=t[r],o=0;o<i.length-1;o++){var a=o,s=o+1,l=i[a].computedOffset,c=i[s].computedOffset,u=l,h=c;0===o&&(u=-1/0,0===c&&(s=a)),o===i.length-2&&(h=1/0,1===l&&(a=s)),n.push({applyFrom:u,applyTo:h,startOffset:i[a].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[a].easingFunction,property:r,interpolation:eu(r,i[a].value,i[s].value,e)})}return n.sort((function(t,e){return t.startOffset-e.startOffset})),n}(r,n);return function(t,e){if(null!==e)i.filter((function(t){return e>=t.applyFrom&&e<t.applyTo})).forEach((function(n){var r=e-n.startOffset,i=n.endOffset-n.startOffset,o=0===i?0:r/i;t.setAttribute(n.property,n.interpolation(o),!1,!1)}));else for(var n in r)Qc(n)&&t.setAttribute(n,null)}}function Qc(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var tu=function(t,e,n){return function(r){var i=nu(t,e,r);return le(i)?i:n(i)}};function eu(t,e,n,r){var i=va[t];if(i&&i.syntax&&i.int){var o=xl.styleValueRegistry.getPropertySyntax(i.syntax);if(o){var a=o.parser,s=a?a(e,r):e,l=a?a(n,r):n,c=o.mixer(s,l,r);if(c){var u=tu.apply(void 0,f(c));return function(t){return 0===t?e:1===t?n:u(t)}}}}return tu(!1,!0,(function(t){return t?n:e}))}function nu(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,i=e.length,o=Math.max(r,i),a=[],s=0;s<o;s++)a.push(nu(t[s<r?s:r-1],e[s<i?s:i-1],n));return a}throw new Error("Mismatched interpolation arguments ".concat(t,":").concat(e))}var ru=function(){return u((function t(){l(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=Wc,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}),[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=Xc(t),this._easing=t}}])}();function iu(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++){if(!e[o]){var a={};"offset"in t&&(a.offset=Number(t.offset)),"easing"in t&&(a.easing=t.easing),"composite"in t&&(a.composite=t.composite),e[o]=a}void 0!==r[o]&&null!==r[o]&&(e[o][n]=r[o])}}return e.sort((function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)})),e}(t));for(var n=t.map((function(t){var n={};for(var r in null!=e&&e.composite&&(n.composite="auto"),t){var i=t[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error("".concat(i," compositing is not supported"));n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),r=!0,i=-1/0,o=0;o<n.length;o++){var a=n[o].offset;if(qt(a))r=!1;else{if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}}return n=n.filter((function(t){return Number(t.offset)>=0&&Number(t.offset)<=1})),r||function(){var t,e,r=n.length;n[r-1].computedOffset=Number(null!==(t=n[r-1].offset)&&void 0!==t?t:1),r>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var i=0,o=Number(n[0].computedOffset),a=1;a<r;a++){var s=n[a].computedOffset;if(!qt(s)&&!qt(o)){for(var l=1;l<a-i;l++)n[i+l].computedOffset=o+(Number(s)-o)*l/(a-i);i=a,o=Number(s)}}}(),n}var ou="backwards|forwards|both|none".split("|"),au="reverse|alternate|alternate-reverse".split("|");function su(t,e){var n;return function(t){var e=new ru;return"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach((function(n){if(void 0!==t[n]&&null!==t[n]&&"auto"!==t[n]){if(("number"==typeof e[n]||"duration"===n)&&("number"!=typeof t[n]||isNaN(t[n])))return;if("fill"===n&&-1===ou.indexOf(t[n]))return;if("direction"===n&&-1===au.indexOf(t[n]))return;e[n]=t[n]}})):e.duration=t,e}(t=function(t){"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t});return t}(null!==(n=t)&&void 0!==n?n:{duration:"auto"}))}var lu=function(){return u((function t(e,n,r){var i=this;l(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=su(r),this.timing.effect=this,this.timing.activeDuration=Kc(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=iu(n,this.timing),this.interpolations=Jc(this.normalizedKeyframes,this.timing,this.target);var o=xl.globalThis.Proxy;this.computedTiming=o?new o(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?i.animation&&i.animation.currentTime||null:"currentIteration"===e?i.animation&&"running"===i.animation.playState?t.currentIteration||0:null:"progress"===e?i.animation&&"running"===i.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing}),[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=Zc(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=iu(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var e=this;Object.keys(t||{}).forEach((function(n){e.timing[n]=t[n]}))}}])}();function cu(t,e){return Number(t.id)-Number(e.id)}var uu=function(){return u((function t(e){var n=this;l(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){n.currentTime=t,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(t){var e=n.rafCallbacks;n.rafCallbacks=[],t<Number(n.currentTime)&&(t=Number(n.currentTime)),n.animations.sort(cu),n.animations=n.tick(t,!0,n.animations)[0],e.forEach((function(e){e[1](t)})),n.applyPendingEffects()},this.document=e}),[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,e,n){var r=new lu(t,e,n),i=new vc(r,this);return this.animations.push(i),this.restartWebAnimationsNextTick(),i.updatePromises(),i.play(),i.updatePromises(),i}},{key:"applyDirtiedAnimation",value:function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(cu),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)})),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach((function(t){null==t||t.applyInterpolations()})),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(t){return t.updatePromises()}))}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(t){return"finished"!==t.playState&&"idle"!==t.playState}))}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(t){var e=this;return this.rAF((function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()}))}},{key:"tick",value:function(t,e,n){var r,i,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var a=[],s=[],l=[],c=[];return n.forEach((function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(a.push(n.effect),n.unmarkTarget()),n._needsTick&&(o.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?l.push(n):c.push(n)})),(r=this.pendingEffects).push.apply(r,a),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[l,c]}}])}();xl.EasingFunction=Xc,xl.AnimationTimeline=uu;const hu={duration:500},du={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var fu,pu,gu,vu,mu,yu,bu,xu,Eu,wu;!function(t){t.NodeAdded="NodeAdded",t.NodeUpdated="NodeUpdated",t.NodeRemoved="NodeRemoved",t.EdgeAdded="EdgeAdded",t.EdgeUpdated="EdgeUpdated",t.EdgeRemoved="EdgeRemoved",t.ComboAdded="ComboAdded",t.ComboUpdated="ComboUpdated",t.ComboRemoved="ComboRemoved"}(fu||(fu={})),function(t){t.DRAW="draw",t.COLLAPSE="collapse",t.EXPAND="expand",t.TRANSFORM="transform"}(pu||(pu={})),function(t){t.CLICK="canvas:click",t.DBLCLICK="canvas:dblclick",t.POINTER_OVER="canvas:pointerover",t.POINTER_LEAVE="canvas:pointerleave",t.POINTER_ENTER="canvas:pointerenter",t.POINTER_MOVE="canvas:pointermove",t.POINTER_OUT="canvas:pointerout",t.POINTER_DOWN="canvas:pointerdown",t.POINTER_UP="canvas:pointerup",t.CONTEXT_MENU="canvas:contextmenu",t.DRAG_START="canvas:dragstart",t.DRAG="canvas:drag",t.DRAG_END="canvas:dragend",t.DRAG_ENTER="canvas:dragenter",t.DRAG_OVER="canvas:dragover",t.DRAG_LEAVE="canvas:dragleave",t.DROP="canvas:drop",t.WHEEL="canvas:wheel"}(gu||(gu={})),function(t){t.CLICK="combo:click",t.DBLCLICK="combo:dblclick",t.POINTER_OVER="combo:pointerover",t.POINTER_LEAVE="combo:pointerleave",t.POINTER_ENTER="combo:pointerenter",t.POINTER_MOVE="combo:pointermove",t.POINTER_OUT="combo:pointerout",t.POINTER_DOWN="combo:pointerdown",t.POINTER_UP="combo:pointerup",t.CONTEXT_MENU="combo:contextmenu",t.DRAG_START="combo:dragstart",t.DRAG="combo:drag",t.DRAG_END="combo:dragend",t.DRAG_ENTER="combo:dragenter",t.DRAG_OVER="combo:dragover",t.DRAG_LEAVE="combo:dragleave",t.DROP="combo:drop"}(vu||(vu={})),function(t){t.CLICK="click",t.DBLCLICK="dblclick",t.POINTER_OVER="pointerover",t.POINTER_LEAVE="pointerleave",t.POINTER_ENTER="pointerenter",t.POINTER_MOVE="pointermove",t.POINTER_OUT="pointerout",t.POINTER_DOWN="pointerdown",t.POINTER_UP="pointerup",t.CONTEXT_MENU="contextmenu",t.DRAG_START="dragstart",t.DRAG="drag",t.DRAG_END="dragend",t.DRAG_ENTER="dragenter",t.DRAG_OVER="dragover",t.DRAG_LEAVE="dragleave",t.DROP="drop",t.KEY_DOWN="keydown",t.KEY_UP="keyup",t.WHEEL="wheel"}(mu||(mu={})),function(t){t.KEY_DOWN="keydown",t.KEY_UP="keyup"}(yu||(yu={})),function(t){t.CLICK="edge:click",t.DBLCLICK="edge:dblclick",t.POINTER_OVER="edge:pointerover",t.POINTER_LEAVE="edge:pointerleave",t.POINTER_ENTER="edge:pointerenter",t.POINTER_MOVE="edge:pointermove",t.POINTER_OUT="edge:pointerout",t.POINTER_DOWN="edge:pointerdown",t.POINTER_UP="edge:pointerup",t.CONTEXT_MENU="edge:contextmenu",t.DRAG_ENTER="edge:dragenter",t.DRAG_OVER="edge:dragover",t.DRAG_LEAVE="edge:dragleave",t.DROP="edge:drop"}(bu||(bu={})),function(t){t.BEFORE_CANVAS_INIT="beforecanvasinit",t.AFTER_CANVAS_INIT="aftercanvasinit",t.BEFORE_SIZE_CHANGE="beforesizechange",t.AFTER_SIZE_CHANGE="aftersizechange",t.BEFORE_ELEMENT_CREATE="beforeelementcreate",t.AFTER_ELEMENT_CREATE="afterelementcreate",t.BEFORE_ELEMENT_UPDATE="beforeelementupdate",t.AFTER_ELEMENT_UPDATE="afterelementupdate",t.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",t.AFTER_ELEMENT_DESTROY="afterelementdestroy",t.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",t.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",t.BEFORE_DRAW="beforedraw",t.AFTER_DRAW="afterdraw",t.BEFORE_RENDER="beforerender",t.AFTER_RENDER="afterrender",t.BEFORE_ANIMATE="beforeanimate",t.AFTER_ANIMATE="afteranimate",t.BEFORE_LAYOUT="beforelayout",t.AFTER_LAYOUT="afterlayout",t.BEFORE_STAGE_LAYOUT="beforestagelayout",t.AFTER_STAGE_LAYOUT="afterstagelayout",t.BEFORE_TRANSFORM="beforetransform",t.AFTER_TRANSFORM="aftertransform",t.BATCH_START="batchstart",t.BATCH_END="batchend",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.BEFORE_RENDERER_CHANGE="beforerendererchange",t.AFTER_RENDERER_CHANGE="afterrendererchange"}(xu||(xu={})),function(t){t.UNDO="undo",t.REDO="redo",t.CANCEL="cancel",t.ADD="add",t.CLEAR="clear",t.CHANGE="change"}(Eu||(Eu={})),function(t){t.CLICK="node:click",t.DBLCLICK="node:dblclick",t.POINTER_OVER="node:pointerover",t.POINTER_LEAVE="node:pointerleave",t.POINTER_ENTER="node:pointerenter",t.POINTER_MOVE="node:pointermove",t.POINTER_OUT="node:pointerout",t.POINTER_DOWN="node:pointerdown",t.POINTER_UP="node:pointerup",t.CONTEXT_MENU="node:contextmenu",t.DRAG_START="node:dragstart",t.DRAG="node:drag",t.DRAG_END="node:dragend",t.DRAG_ENTER="node:dragenter",t.DRAG_OVER="node:dragover",t.DRAG_LEAVE="node:dragleave",t.DROP="node:drop"}(wu||(wu={}));const ku="combo",Mu="tree";var Nu;!function(t){t.NODE="node",t.EDGE="edge",t.COMBO="combo",t.THEME="theme",t.PALETTE="palette",t.LAYOUT="layout",t.BEHAVIOR="behavior",t.PLUGIN="plugin",t.ANIMATION="animation",t.TRANSFORM="transform",t.SHAPE="shape"}(Nu||(Nu={}));const Ou={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function Su(t,e){var n;const r=null===(n=Ou[t])||void 0===n?void 0:n[e];if(r)return r}function Tu(t){return`[G6 v5.0.28] ${t}`}const _u=t=>{console.warn(Tu(t))};function Au(t){const{theme:e}=t;if(!e)return{};const n=Su(Nu.THEME,e);return n||(_u(`The theme of ${e} is not registered.`),{})}function Cu(t,e){if(Array.isArray(t)&&0===t.length)return null;const n=Array.isArray(t)?t[0]:t,r=Array.isArray(t)?t.slice(1):e||[];return new Proxy(n,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([n.finished,...r.map((t=>t.finished))]):Reflect.get(t,e):(...n)=>{t[e](...n),r.forEach((t=>{var r;return null===(r=t[e])||void 0===r?void 0:r.call(t,...n)}))},set:(t,e,n)=>(["onframe","onfinish"].includes(e)||r.forEach((t=>{t[e]=n})),Reflect.set(t,e,n))})}function Pu(t){const e=t.reduce(((t,e)=>(Object.entries(e).forEach((([e,n])=>{void 0===t[e]?t[e]=[n]:t[e].push(n)})),t)),{});Object.entries(e).forEach((([n,r])=>{(r.length!==t.length||r.some((t=>qt(t)))||r.every((t=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Se(t,r[0]))))&&delete e[n]}));const n=Object.entries(e).reduce(((t,[e,n])=>(n.forEach(((n,r)=>{t[r]?t[r][e]=n:t[r]={[e]:n}})),t)),[]);return 0!==t.length&&0===n.length&&n.push({_:0},{_:0}),n}function Du(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function Ru(t,e){const{animation:n}=t;if(!1===n||!1===e)return!1;const r=Object.assign({},hu);return Kt(n)&&Object.assign(r,n),Kt(e)&&Object.assign(r,e),r}function Lu(t,e,n,r){var i,o;const{animation:a}=t,s=null===(i=null==t?void 0:t[e])||void 0===i?void 0:i.animation;if(!1===s)return[];const l=null==s?void 0:s[n];if(!1===l)return[];if(!1===a||!1===r)return[];const c=null===(o=Au(t)[e])||void 0===o?void 0:o.animation,u=(t=[])=>function(t){if("string"==typeof t){return Su(Nu.ANIMATION,t)||(_u(`The animation of ${t} is not registered.`),[])}return t}(t).map((t=>Object.assign(Object.assign(Object.assign(Object.assign({},du),Kt(a)&&a),t),Kt(r)&&r)));if(l)return u(l);if(!c)return[];const h=c[n];return!1===h?[]:u(h)}function Iu(t,e,n,r){if(Array.isArray(r)){let i=!1;const o=[];for(let a=0;a<r.length;a++){const s=r[a];if("translate"===s[0]){if(s[1]===t&&s[2]===e)return null;i=!0,o.push(["translate",t,e])}else if("translate3d"===s[0]){if(s[1]===t&&s[2]===e&&s[3]===n)return null;i=!0,o.push(["translate3d",t,e,n])}else o.push(s)}return i||o.splice(0,0,0===n?["translate",t,e]:["translate3d",t,e,n]),o}const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===n?`translate(${t}, ${e})${i}`:`translate3d(${t}, ${e}, ${n})${i}`}var ju=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Fu=(t,e,n)=>{if(!n.length)return null;const[r,i]=e;let o;const a=n.map((e=>{var{fields:n,shape:a,states:s}=e,l=ju(e,["fields","shape","states"]);const c=(e=>{var n;if(e){const o=t.getShape(e);if(!o)return null;const a=`get${pe(e)}Style`,s=(null===(n=null==t?void 0:t[a])||void 0===n?void 0:n.bind(t))||(t=>t);return{shape:o,fromStyle:(null==s?void 0:s(r))||{},toStyle:(null==s?void 0:s(i))||{}}}return{shape:t,fromStyle:r,toStyle:i}})(a);if(!c)return null;const{shape:u,fromStyle:h,toStyle:d}=c,f=[{},{}];if(n.forEach((t=>{var e,n;Object.assign(f[0],{[t]:null!==(e=h[t])&&void 0!==e?e:Du(t)}),Object.assign(f[1],{[t]:null!==(n=d[t])&&void 0!==n?n:Du(t)})})),f.some((t=>Object.keys(t).some((t=>["x","y","z"].includes(t)))))){const{x:t=0,y:e=0,z:n=0,transform:r=""}=u.attributes||{};f.forEach((i=>{i.transform=Iu(i.x||t,i.y||e,i.z||n,r)}))}const p=u.animate(Pu(f),l);return void 0===a&&(o=p),p})).filter(Boolean),s=o||(null==a?void 0:a[0]);return s?Cu(s,a.filter((t=>t!=t))):null},Bu=[{fields:["x","y"]}],zu=Bu,Vu=[{fields:["sourceNode","targetNode"]}],Gu=Vu,Wu=[{fields:["childrenNode","x","y"]}],$u=Wu;function Hu(t){return t instanceof Float32Array||!(!Array.isArray(t)||2!==t.length&&3!==t.length)&&t.every((t=>"number"==typeof t))}function Uu(t,e,n){return t>=e&&t<=n}function Yu(t=0){if(Array.isArray(t)){const[e=0,n=e,r=e,i=n]=t;return[e,n,r,i]}return[t,t,t,t]}function qu(t=0){const e=Yu(t);return e[0]+e[2]}function Xu(t){return t.max[0]-t.min[0]}function Ku(t){return t.max[1]-t.min[1]}function Zu(t){return[Xu(t),Ku(t)]}function Ju(t,e){const n=Hu(t)?Qu(t):t.getShape("key").getBounds();return e?th(n,e):n}function Qu(t){const[e,n,r=0]=t,i=new Yr;return i.setMinMax([e,n,r],[e,n,r]),i}function th(t,e){const[n,r,i,o]=Yu(e),[a,s,l]=t.min,[c,u,h]=t.max,d=new Yr;return d.setMinMax([a-o,s-n,l],[c+r,u+i,h]),d}function eh(t){if(0===t.length)return new Yr;if(1===t.length)return t[0];const e=new Yr;e.setMinMax(t[0].min,t[0].max);for(let n=1;n<t.length;n++){const r=t[n];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function nh(t,e){return Uu(t[0],e.min[0],e.max[0])&&Uu(t[1],e.min[1],e.max[1])}function rh(t,e,n=!1){const{min:[r,i],max:[o,a]}=e,s=(t[1]===i||t[1]===a)&&(n||Uu(t[0],r,o)),l=(t[0]===r||t[0]===o)&&(n||Uu(t[1],i,a));return s||l}function ih(t,e){const{center:n}=e;return t[0]===n[0]&&t[1]===n[1]}function oh(t,e){const[n,r]=t,[i,o]=e.min,[a,s]=e.max,l=n-i,c=a-n,u=r-o,h=s-r,d=Math.min(l,c,u,h);return d===l?"left":d===c?"right":d===u?"top":d===h?"bottom":"left"}function ah(t,e){const n=be(t);if(nh(t,e)){switch(oh(t,e)){case"left":n[0]=e.min[0];break;case"right":n[0]=e.max[0];break;case"top":n[1]=e.min[1];break;case"bottom":n[1]=e.max[1]}}else{const[r,i]=t,[o,a]=e.min,[s,l]=e.max;n[0]=Uu(r,o,s)?r:r<o?o:s,n[1]=Uu(i,a,l)?i:i<a?a:l}return n}var sh=function(t,e){return t===e},lh=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),ch=function(){function t(t){void 0===t&&(t=sh),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new lh(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new lh(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},t.prototype.find=function(t){var e=t.value,n=void 0===e?void 0:e,r=t.callback,i=void 0===r?void 0:r;if(!this.head)return null;for(var o=this.head;o;){if(i&&i(o.value))return o;if(void 0!==n&&this.compare(o.value,n))return o;o=o.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach((function(t){return e.append(t)})),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map((function(e){return e.toString(t)})).toString()},t}(),uh=function(t,e,n){void 0===e&&(e=[]);var r=e.filter((function(e){return e.source===t||e.target===t}));if("target"===n){return r.filter((function(e){return e.source===t})).map((function(t){return t.target}))}if("source"===n){return r.filter((function(e){return e.target===t})).map((function(t){return t.source}))}return r.map((function(e){return e.source===t?e.target:e.source}))},hh={}.toString,dh=function(t,e){return hh.call(t)==="[object "+e+"]"},fh=function(t){return dh(t,"Function")},ph=function(t){return Array.isArray?Array.isArray(t):dh(t,"Array")};var gh,vh=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return function(t,e){var n,r;if(t)if(ph(t))for(var i=0,o=t.length;i<o&&!1!==e(t[i],i);i++);else if(r=typeof(n=t),null!==n&&"object"===r||"function"===r)for(var a in t)if(t.hasOwnProperty(a)&&!1===e(t[a],a))break}(t,(function(n,r){fh(t)&&"prototype"===r||e.push(n)})),e};!function(t,e){if(!fh(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return gh||(gh=document.createElement("canvas").getContext("2d")),gh.font=[o,a,i,n+"px",r].join(" "),gh.measureText(function(t){return dh(t,"String")}(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}([t],vh(e)).join("")}));function mh(t,e,n,r){if(t===e)return[t];if(r[e])return r[e];for(var i=[],o=0,a=n[e];o<a.length;o++){var s=mh(t,a[o],n,r);if(!s)return;for(var l=0,c=s;l<c.length;l++){var u=c[l];ph(u)?i.push($e($e([],u,!0),[e],!1)):i.push([u,e])}}return r[e]=i,r[e]}var yh,bh=function(t,e,n,r,i){var o=function(t,e,n,r){var i=t.nodes,o=void 0===i?[]:i,a=t.edges,s=void 0===a?[]:a,l={},c={},u={};o.forEach((function(t,n){var r=t.id;c[r]=1/0,r===e&&(c[r]=0)}));for(var h=o.length,d=function(t){var e=function(t,e,n){for(var r,i=1/0,o=0;o<e.length;o++){var a=e[o].id;!n[a]&&t[a]<=i&&(i=t[a],r=e[o])}return r}(c,o,l),i=e.id;if(l[i]=!0,c[i]===1/0)return"continue";var a=[];a=n?function(t,e){return e.filter((function(e){return e.source===t}))}(i,s):function(t,e){return e.filter((function(e){return e.source===t||e.target===t}))}(i,s),a.forEach((function(t){var n=t.target,o=t.source,a=n===i?o:n,s=r&&t[r]?t[r]:1;c[a]>c[e.id]+s?(c[a]=c[e.id]+s,u[a]=[e.id]):c[a]===c[e.id]+s&&u[a].push(e.id)}))},f=0;f<h;f++)d();u[e]=[e];var p={};for(var g in c)c[g]!==1/0&&mh(e,g,u,p);var v={};for(var g in p)v[g]=p[g][0];return{length:c,path:v,allPath:p}}(t,e,r,i),a=o.length,s=o.path,l=o.allPath;return{length:a[n],path:s[n],allPath:l[n]}};!function(t){t.EuclideanDistance="euclideanDistance"}(yh||(yh={}));function xh(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return`${t.source}-${t.target}`;throw new Error(Tu("The datum does not have available id."))}function Eh(t){return t.combo}function wh(t,e){const n={nodes:(t.nodes||[]).map(xh),edges:(t.edges||[]).map(xh),combos:(t.combos||[]).map(xh)};return e?Object.values(n).flat():n}!function(){function t(t){void 0===t&&(t=10),this.linkedList=new ch,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map((function(t){return t.value}))},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();const kh=(t,e,n)=>{var r;switch(n.type){case"degree":{const i=new Map;return null===(r=t.nodes)||void 0===r||r.forEach((t=>{const r=e(xh(t),n.direction).length;i.set(xh(t),r)})),i}case"betweenness":return Nh(t,n.directed,n.weightPropertyName);case"closeness":return Oh(t,n.directed,n.weightPropertyName);case"eigenvector":return Th(t,n.directed);case"pagerank":return Sh(t,n.epsilon,n.linkProb);default:return Mh(t)}},Mh=t=>{var e;const n=new Map;return null===(e=t.nodes)||void 0===e||e.forEach((t=>{n.set(xh(t),0)})),n},Nh=(t,e,n)=>{const r=Mh(t),{nodes:i=[]}=t;return i.forEach((o=>{i.forEach((i=>{if(o!==i){const{allPath:a}=bh(t,xh(o),xh(i),e,n),s=a.length;a.flat().forEach((t=>{t!==xh(o)&&t!==xh(i)&&r.set(t,r.get(t)+1/s)}))}}))})),r},Oh=(t,e,n)=>{const r=new Map,{nodes:i=[]}=t;return i.forEach((o=>{const a=i.reduce(((r,i)=>{if(o!==i){const{length:a}=bh(t,xh(o),xh(i),e,n);r+=a}return r}),0);r.set(xh(o),1/a)})),r},Sh=(t,e,n)=>{var r;const i=new Map,o=function(t,e,n){"number"!=typeof e&&(e=1e-6),"number"!=typeof n&&(n=.85);for(var r,i=1,o=0,a=1e3,s=t.nodes,l=void 0===s?[]:s,c=t.edges,u=void 0===c?[]:c,h=l.length,d={},f={},p=0;p<h;++p)d[v=(E=l[p]).id]=1/h,f[v]=1/h;for(var g=function(t){var e={},n=t.nodes,r=void 0===n?[]:n,i=t.edges,o=void 0===i?[]:i;return r.forEach((function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}})),o.forEach((function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++})),e}(t);a>0&&i>e;){for(o=0,p=0;p<h;++p){var v=(E=l[p]).id;if(r=0,0===g[E.id].inDegree)d[v]=0;else{for(var m=uh(v,u,"source"),y=0;y<m.length;++y){var b=m[y],x=g[b].outDegree;x>0&&(r+=f[b]/x)}d[v]=n*r,o+=d[v]}}for(o=(1-o)/h,i=0,p=0;p<h;++p){var E;r=d[v=(E=l[p]).id]+o,i+=Math.abs(r-f[v]),f[v]=r}a-=1}return f}(t,e,n);return null===(r=t.nodes)||void 0===r||r.forEach((t=>{i.set(xh(t),o[xh(t)])})),i},Th=(t,e)=>{const{nodes:n=[]}=t,r=_h(t,e),i=Ah(r,n.length),o=new Map;return n.forEach(((t,e)=>{o.set(xh(t),i[e])})),o},_h=(t,e)=>{const{nodes:n=[],edges:r=[]}=t,i=Array(n.length).fill(null).map((()=>Array(n.length).fill(0)));return r.forEach((({source:t,target:r})=>{const o=n.findIndex((e=>xh(e)===t)),a=n.findIndex((t=>xh(t)===r));e?i[o][a]=1:(i[o][a]=1,i[a][o]=1)})),i},Ah=(t,e,n=100,r=1e-6)=>{let i=Array(e).fill(1),o=1/0;for(let a=0;a<n&&o>r;a++){const n=Array(e).fill(0);for(let r=0;r<e;r++)for(let o=0;o<e;o++)n[r]+=t[r][o]*i[o];const r=Math.sqrt(n.reduce(((t,e)=>t+e*e),0));for(let t=0;t<e;t++)n[t]/=r;o=Math.sqrt(n.reduce(((t,e,n)=>t+(e-i[n])*e),0)),i=n}return i};function Ch(t,e,n,r=Se){const i=new Map(t.map((t=>[n(t),t]))),o=new Map(e.map((t=>[n(t),t]))),a=new Set(i.keys()),s=new Set(o.keys()),l=[],c=[],u=[],h=[];return s.forEach((t=>{a.has(t)?r(i.get(t),o.get(t))?h.push(o.get(t)):c.push(o.get(t)):l.push(o.get(t))})),a.forEach((t=>{s.has(t)||u.push(i.get(t))})),{enter:l,exit:u,keep:h,update:c}}const Ph=new WeakMap;function Dh(t,e,n=!1,r){if(void 0===e)return;const i=(o,a=e)=>{const s=(t=a)=>o.childNodes.forEach((e=>i(e,t)));if(r&&!r(o))return s();if(n||o!==t){Ph.has(o)||Ph.set(o,o.style.visibility);const t="hidden"===a||"hidden"===function(t){return Ph.has(t)?Ph.get(t):t.style.visibility}(o)?"hidden":"visible";o.style.visibility=t,s(t)}else t.style.visibility=e,Ph.delete(t),s(e)};i(t)}class Rh{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=function(t,e,n){const r={},i=t=>(t in r||(r[t]=0),`${e}-${t}-${r[t]++}`);return n.map((e=>"string"==typeof e?{type:e,key:i(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:i(e.type)})))}(this.context.graph,this.category,t),{enter:n,update:r,exit:i,keep:o}=Ch(this.extensions,e,(t=>t.key));this.createExtensions(n),this.updateExtensions([...r,...o]),this.destroyExtensions(i),this.extensions=e}createExtension(t){const{category:e}=this,{key:n,type:r}=t,i=Su(e,r);if(!i)return _u(`The extension ${r} of ${e} is not registered.`);const o=new i(this.context,t);this.extensionMap[n]=o}createExtensions(t){t.forEach((t=>this.createExtension(t)))}updateExtension(t){const{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach((t=>this.updateExtension(t)))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach((({key:t})=>this.destroyExtension(t)))}destroy(){Object.values(this.extensionMap).forEach((t=>t.destroy())),this.context={},this.extensions=[],this.extensionMap={}}}class Lh{constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class Ih extends Lh{}class jh extends Ih{constructor(t,e){super(t,Object.assign({},jh.defaultOptions,e)),this.isOverlapping=(t,e)=>e.some((e=>t.intersects(e))),this.occupiedBounds=[],this.detectLabelCollision=t=>{const e=this.context.viewport,n={show:[],hide:[]};return this.occupiedBounds=[],t.forEach((t=>{const r=t.getShape("label").getRenderBounds();e.isInViewport(r,!0)&&!this.isOverlapping(r,this.occupiedBounds)?(n.show.push(t),this.occupiedBounds.push(th(r,this.options.padding))):n.hide.push(t)})),n},this.hideLabelIfExceedViewport=(t,e)=>{const{exit:n}=Ch(t,e,(t=>t.id));null==n||n.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(t,e)=>{const{model:n}=this.context,r=n.getData(),i=n.getRelatedEdgesData.bind(n);return t.map((t=>(this.nodeCentralities.has(t.id)||(this.nodeCentralities=kh(r,i,e)),{node:t,centrality:this.nodeCentralities.get(t.id)}))).sort(((t,e)=>e.centrality-t.centrality)).map((t=>t.node))},this.sortLabelElementsInView=t=>{const{sort:e,sortNode:n,sortCombo:r,sortEdge:i}=this.options,{model:o}=this.context;if(Yt(e))return t.sort(((t,n)=>e(o.getElementDataById(t.id),o.getElementDataById(n.id))));const{node:a=[],edge:s=[],combo:l=[]}=ae(t,(t=>t.type)),c=Yt(r)?l.sort(((t,e)=>r(...o.getComboData([t.id,e.id])))):l,u=Yt(n)?a.sort(((t,e)=>n(...o.getNodeData([t.id,e.id])))):this.sortNodesByCentrality(a,n),h=Yt(i)?s.sort(((t,e)=>i(...o.getEdgeData([t.id,e.id])))):s;return[...c,...u,...h]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=t=>{var e;if("zIndex"===(null===(e=t.data)||void 0===e?void 0:e.stage))return;if(!this.validate(t))return void(this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear()));const n=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,n),this.labelElementsInView=n;const r=this.sortLabelElementsInView(this.labelElementsInView),{show:i,hide:o}=this.detectLabelCollision(r);for(let t=i.length-1;t>=0;t--)this.showLabel(i[t]);o.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=t=>{const e=t.getShape("label");e&&Dh(e,"hidden"),this.hiddenElements.set(t.id,t)},this.showLabel=t=>{const e=t.getShape("label");e&&Dh(e,"visible"),t.toFront(),this.hiddenElements.delete(t.id)},this.onTransform=De(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=t=>{this.enableToggle&&this.onToggleVisibility(t)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=t=>{this.onToggleVisibility(t),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const n in t){const r=t[n];r.isVisible()&&r.getShape("label")&&e.push(r)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter((e=>t.isInViewport(e.getShape("key").getRenderBounds())))}bindEvents(){const{graph:t}=this.context;t.on(xu.BEFORE_RENDER,this.onBeforeRender),t.on(xu.AFTER_RENDER,this.onAfterRender),t.on(xu.AFTER_DRAW,this.toggle),t.on(xu.AFTER_LAYOUT,this.toggle),t.on(xu.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(xu.BEFORE_RENDER,this.onBeforeRender),t.off(xu.AFTER_RENDER,this.onAfterRender),t.off(xu.AFTER_DRAW,this.toggle),t.off(xu.AFTER_LAYOUT,this.toggle),t.off(xu.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}jh.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Fh=[0,0,0];function Bh(t,e){return t.map(((t,n)=>t+e[n]))}function zh(t,e){return t.map(((t,n)=>t-e[n]))}function Vh(t,e){return"number"==typeof e?t.map((t=>t*e)):t.map(((t,n)=>t*e[n]))}function Gh(t,e){return"number"==typeof e?t.map((t=>t/e)):t.map(((t,n)=>t/e[n]))}function Wh(t,e){return t.map((t=>t*e))}function $h(t,e){return Math.sqrt(t.reduce(((t,n,r)=>t+Math.pow(n-e[r]||0,2)),0))}function Hh(t,e){return t.reduce(((t,n,r)=>t+Math.abs(n-e[r])),0)}function Uh(t){const e=t.reduce(((t,e)=>t+Math.pow(e,2)),0);return t.map((t=>t/Math.sqrt(e)))}function Yh(t,e,n=!1){const r=t[0]*e[1]-t[1]*e[0];let i=Math.acos(Vh(t,e).reduce(((t,e)=>t+e),0)/($h(t,Fh)*$h(e,Fh)));return n&&r<0&&(i=2*Math.PI-i),i}function qh(t,e=!0){return e?[-t[1],t[0]]:[t[1],-t[0]]}function Xh(t){return[t[0],t[1]]}function Kh(t){return 2===t.length?[t[0],t[1],0]:t}function Zh(t){const[e,n]=t;return e||n?Math.atan2(n,e):0}function Jh(t,e){const[n,r]=t,[i,o]=e;return function(t,e){const n=Kh(t),r=Kh(e);return[n[1]*r[2]-n[2]*r[1],n[2]*r[0]-n[0]*r[2],n[0]*r[1]-n[1]*r[0]]}(zh(n,r),zh(i,o)).every((t=>0===t))}function Qh(t,e,n=!1){if(Jh(t,e))return;const[r,i]=t,[o,a]=e,s=((r[0]-o[0])*(o[1]-a[1])-(r[1]-o[1])*(o[0]-a[0]))/((r[0]-i[0])*(o[1]-a[1])-(r[1]-i[1])*(o[0]-a[0])),l=a[0]-o[0]?(r[0]-o[0]+s*(i[0]-r[0]))/(a[0]-o[0]):(r[1]-o[1]+s*(i[1]-r[1]))/(a[1]-o[1]);return n||Uu(s,0,1)&&Uu(l,0,1)?[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])]:void 0}function td(t){if(Array.isArray(t))return Uu(t[0],0,1)&&Uu(t[1],0,1)?t:[.5,.5];const e=t.split("-");return[e.includes("left")?0:e.includes("right")?1:.5,e.includes("top")?0:e.includes("bottom")?1:.5]}function ed(t){const{x:e=0,y:n=0,z:r=0}=t.style||{};return[+e,+n,+r]}function nd(t){const{x:e,y:n,z:r}=t.style||{};return void 0!==e||void 0!==n||void 0!==r}function rd(t,e="center"){return function(t,e){const[n,r]=e,{min:i,max:o}=t;return[i[0]+n*(o[0]-i[0]),i[1]+r*(o[1]-i[1])]}(t,td(e))}function id(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function od(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function ad(t,e=0){return t.map((t=>parseFloat(t.toFixed(e))))}function sd(t,e,n,r=!1){if(Se(t,e))return t;const i=Uh(r?zh(t,e):zh(e,t)),o=[i[0]*n,i[1]*n];return Bh(Xh(t),o)}function ld(t,e){return t[1]===e[1]}function cd(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function ud(t,e,n,r=!0,i=!1){for(let o=0;o<n.length;o++){let a=n[o],s=n[(o+1)%n.length];r&&(a=Bh(e,a),s=Bh(e,s));const l=Qh([e,i?cd(t,e):t],[a,s]);if(l)return{point:l,line:[a,s]}}return{point:e,line:void 0}}function hd(t,e,n=!1){const r=e.center,i=zh(n?cd(t,r):t,e.center),o=Math.atan2(i[1],i[0]);if(isNaN(o))return r;const a=Xu(e)/2,s=Ku(e)/2;return[r[0]+a*Math.cos(o),r[1]+s*Math.sin(o)]}function dd(t,e){let n=1/0,r=[[0,0],[0,0]];return e.forEach((e=>{const i=function(t,e){const n=fd(t,e);return $h(t,n)}(t,e);i<n&&(n=i,r=e)})),r}function fd(t,e){const[n,r]=e[0],[i,o]=e[1],[a,s]=t,l=i-n,c=o-r;if(0===l&&0===c)return[n,r];let u=((a-n)*l+(s-r)*c)/(l*l+c*c);u>1?u=1:u<0&&(u=0);return[n+u*l,r+u*c]}function pd(t,e=!0){const n=function(t){const e=t.reduce(((t,e)=>Bh(t,e)),[0,0]);return Gh(e,t.length)}(t);return t.sort((([t,r],[i,o])=>{const a=Math.atan2(r-n[1],t-n[0]),s=Math.atan2(o-n[1],i-n[0]);return e?s-a:a-s}))}function gd(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}const vd=t=>t.map((t=>ie(t)?t.toLocaleLowerCase():t));class md{constructor(t){this.map=new Map,this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(mu.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(mu.DRAG,t)},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){0!==t.length&&this.map.set(t,e)}unbind(t,e){this.map.forEach(((n,r)=>{Se(r,t)&&(e&&e!==n||this.map.delete(r))}))}unbindAll(){this.map.clear()}match(t){const e=vd(Array.from(this.recordKey)).sort(),n=vd(t).sort();return Se(e,n)}bindEvents(){var t;const{emitter:e}=this;e.on(mu.KEY_DOWN,this.onKeyDown),e.on(mu.KEY_UP,this.onKeyUp),e.on(mu.WHEEL,this.onWheel),e.on(mu.DRAG,this.onDrag),null===(t=globalThis.addEventListener)||void 0===t||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach(((e,n)=>{this.match(n)&&e(t)}))}triggerExtendKey(t,e){this.map.forEach(((n,r)=>{r.includes(t)&&Se(Array.from(this.recordKey),r.filter((e=>e!==t)))&&n(e)}))}destroy(){var t;this.unbindAll(),this.emitter.off(mu.KEY_DOWN,this.onKeyDown),this.emitter.off(mu.KEY_UP,this.onKeyUp),this.emitter.off(mu.WHEEL,this.onWheel),this.emitter.off(mu.DRAG,this.onDrag),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"blur",this.onFocus)}}class yd extends Ih{constructor(t,e){super(t,Me({},yd.defaultOptions,e)),this.shortcut=new md(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:n}=this.context,r=Object.assign({},this.options.style);this.options.style.lineWidth&&(r.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Kl({id:"g6-brush-select",style:r}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:n,mode:r}=this.options;this.endPoint=bd(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&"default"===r&&this.updateElementsStates(gd(this.startPoint,this.endPoint))}onPointerUp(t){this.startPoint&&(this.endPoint?(this.endPoint=bd(t),this.updateElementsStates(gd(this.startPoint,this.endPoint)),this.clearBrush()):this.clearBrush())}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce(((t,e)=>Object.assign({},t,e.reduce(((t,e)=>(t[xh(e)]=[],t)),{}))),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:n,state:r,mode:i,onSelect:o}=this.options,a=this.selector(e,t,n);let s={};switch(i){case"union":a.forEach((t=>{s[t]=[...e.getElementState(t),r]}));break;case"diff":a.forEach((t=>{const n=e.getElementState(t);s[t]=n.includes(r)?n.filter((t=>t!==r)):[...n,r]}));break;case"intersect":a.forEach((t=>{const n=e.getElementState(t);s[t]=n.includes(r)?[r]:[]}));break;default:a.forEach((t=>{s[t]=[r]}))}Yt(o)&&(s=o(s)),e.setElementState(s,this.options.animation)}selector(t,e,n){if(!n||0===n.length)return[];const r=[],i=t.getData();if(n.forEach((n=>{i[`${n}s`].forEach((n=>{const i=xh(n);"hidden"!==t.getElementVisibility(i)&&function(t,e,n,r){const i=t[0],o=t[1];let a=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);const s=r-n;for(let t=0,r=s-1;t<s;r=t++){const s=e[t+n][0],l=e[t+n][1],c=e[r+n][0],u=e[r+n][1];l>o!=u>o&&i<(c-s)*(o-l)/(u-l)+s&&(a=!a)}return a}(t.getElementPosition(i),e)&&r.push(i)}))})),n.includes("edge")){const t=i.edges;null==t||t.forEach((t=>{const{source:e,target:n}=t;r.includes(e)&&r.includes(n)&&r.push(xh(t))}))}return r}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter((t=>"drag"!==t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}bindEvents(){const{graph:t}=this.context;t.on(mu.POINTER_DOWN,this.onPointerDown),t.on(mu.POINTER_MOVE,this.onPointerMove),t.on(mu.POINTER_UP,this.onPointerUp),t.on(gu.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(mu.POINTER_DOWN,this.onPointerDown),t.off(mu.POINTER_MOVE,this.onPointerMove),t.off(mu.POINTER_UP,this.onPointerUp),t.off(gu.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=Me(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}yd.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const bd=t=>[t.canvas.x,t.canvas.y],xd=.8,Ed=["node","edge","combo"];function wd(t,e,n,r,i=0){"TB"===r&&e(t,i);const o=n(t);if(o)for(const t of o)wd(t,e,n,r,i+1);"BT"===r&&e(t,i)}function kd(t,e,n,r,i="both"){if("combo"===e||"node"===e)return Md(t,n,r,i);const o=t.getEdgeData(n);if(!o)return[];const a=Md(t,o.source,r-1,i),s=Md(t,o.target,r-1,i);return Array.from(new Set([...a,...s,n]))}function Md(t,e,n,r="both"){const i=new Set,o=new Set,a=new Set;return function(t,e,n){const r=[[t,0]];for(;r.length;){const[t,i]=r.shift();e(t,i);const o=n(t);if(o)for(const t of o)r.push([t,i+1])}}(e,((e,i)=>{i>n||(a.add(e),t.getRelatedEdgesData(e,r).forEach((t=>{const e=xh(t);!o.has(e)&&i<n&&(a.add(e),o.add(e))})))}),(e=>t.getRelatedEdgesData(e,r).map((t=>t.source===e?t.target:t.source)).filter((t=>!i.has(t)&&(i.add(t),!0))))),Array.from(a)}function Nd(t){return t.states||[]}var Od=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class Sd extends Ih{constructor(t,e){super(t,Object.assign({},Sd.defaultOptions,e)),this.onClickSelect=t=>Od(this,void 0,void 0,(function*(){var e,n;this.validate(t)&&(yield this.updateState(t),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))})),this.onClickCanvas=t=>Od(this,void 0,void 0,(function*(){var e,n;this.validate(t)&&(yield this.clearState(),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))})),this.shortcut=new md(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ed.forEach((e=>{t.on(`${e}:${mu.CLICK}`,this.onClickSelect)})),t.on(gu.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:n}=t,{graph:r}=this.context,{degree:i}=this.options;return kd(r,n,e.id,"function"==typeof i?i(t):i).filter((t=>t!==e.id))}updateState(t){return Od(this,void 0,void 0,(function*(){const{state:e,unselectedState:n,neighborState:r,animation:i}=this.options;if(!e&&!r&&!n)return;const{target:o}=t,{graph:a}=this.context,s=Nd(a.getElementData(o.id)).includes(e)?"unselect":"select",l={},c=this.isMultipleSelect,u=[o.id],h=this.getNeighborIds(t);if(c)if(Object.assign(l,this.getDataStates()),"select"===s){const t=(t,e)=>{t.forEach((t=>{const r=new Set(a.getElementState(t));r.add(e),r.delete(n),l[t]=Array.from(r)}))};t(u,e),t(h,r),n&&Object.keys(l).forEach((t=>{const i=l[t];i.includes(e)||i.includes(r)||i.includes(n)||l[t].push(n)}))}else{const t=l[o.id];l[o.id]=t.filter((t=>t!==e&&t!==r)),t.includes(n)||l[o.id].push(n),h.forEach((t=>{l[t]=l[t].filter((t=>t!==r)),l[t].includes(e)||l[t].push(n)}))}else if("select"===s){Object.assign(l,this.getClearStates(!!n));const t=(t,e)=>{t.forEach((t=>{l[t]||(l[t]=a.getElementState(t)),l[t].push(e)}))};t(u,e),t(h,r),n&&Object.keys(l).forEach((t=>{u.includes(t)||h.includes(t)||l[t].push(n)}))}else Object.assign(l,this.getClearStates());yield a.setElementState(l,i)}))}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:n,combos:r}=t.getData(),i={};return[...e,...n,...r].forEach((t=>{i[xh(t)]=Nd(t)})),i}getClearStates(t=!1){const{graph:e}=this.context,{state:n,unselectedState:r,neighborState:i}=this.options,o=new Set([n,r,i]),{nodes:a,edges:s,combos:l}=e.getData(),c={};return[...a,...s,...l].forEach((e=>{const n=Nd(e),r=n.filter((t=>!o.has(t)));(t||r.length!==n.length)&&(c[xh(e)]=r)})),c}clearState(){return Od(this,void 0,void 0,(function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ed.forEach((e=>{t.off(`${e}:${mu.CLICK}`,this.onClickSelect)})),t.off(gu.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}function Td(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}function _d(t,e){if(!t.startsWith(e))return!1;const n=t[e.length];return n>="A"&&n<="Z"}function Ad(t,e,n=!0){if(!e)return t;if(!_d(t,e))return t;const r=t.slice(e.length);return n?function(t){var e=fe(t);return e.charAt(0).toLowerCase()+e.substring(1)}(r):r}function Cd(t,e){const n=Object.entries(t).reduce(((t,[n,r])=>("className"===n||"class"===n||_d(n,e)&&Object.assign(t,{[Ad(n,e)]:r}),t)),{});if("opacity"in t){const r=function(t,e){return`${e}${pe(t)}`}("opacity",e),i=t.opacity;if(r in t){const e=t[r];Object.assign(n,{opacity:i*e})}else Object.assign(n,{opacity:i})}return n}function Pd(t,e){const n=e.length;return Object.keys(t).reduce(((r,i)=>{if(i.startsWith(e)){r[i.slice(n)]=t[i]}return r}),{})}function Dd(t,e){const n="string"==typeof e?[e]:e,r={};return Object.keys(t).forEach((e=>{n.find((t=>e.startsWith(t)))||(r[e]=t[e])})),r}function Rd(t=0){if("number"==typeof t)return[t,t,t];const[e,n=e,r=e]=t;return[e,n,r]}Sd.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};var Ld=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Id(t,e){const{datum:n,graph:r}=e;return"function"==typeof t?t.call(r,n):Object.fromEntries(Object.entries(t).map((([t,e])=>"function"==typeof e?[t,e.call(r,n)]:[t,e])))}function jd(t,e){const n=(null==t?void 0:t.style)||{},r=(null==e?void 0:e.style)||{};return Object.assign({},t,e,{style:Object.assign({},n,r)})}const Fd=new WeakMap;function Bd(t,e,n){Fd.has(t)||Fd.set(t,{});const r=Fd.get(t);if(!r[e])return r[e]=n,!0;const i=r[e];return!zd(i,n)&&(r[e]=n,!0)}const zd=(t,e,n=2)=>{if("object"!=typeof t||"object"!=typeof e)return t===e;const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const i of r){const r=t[i],o=e[i];if(n>1&&"object"==typeof r&&"object"==typeof o){if(!zd(r,o,n-1))return!1}else if(r!==o)return!1}return!0};function Vd(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function Gd(t){const e="string"==typeof t?Su("palette",t):t;if("function"!=typeof e)return e}function Wd(t,e){let n=2*t;return"string"==typeof e?n=t*Number(e.replace("%",""))/100:"number"==typeof e&&(n=e),isNaN(n)&&(n=2*t),n}function $d(t,e,n=1,r=!1){const i=r?n:1;return Wd((t.max[0]-t.min[0])*i,e)}class Hd extends Il{constructor(t){super(t),this.shapeMap={},this.animateMap={},this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,n,r,i){var o,a,s,l,c,u,h,d;const f=this.shapeMap[t];if(!1===n)return void(f&&(null===(o=null==i?void 0:i.beforeDestroy)||void 0===o||o.call(i,f),r.removeChild(f),delete this.shapeMap[t],null===(a=null==i?void 0:i.afterDestroy)||void 0===a||a.call(i,f)));const p="string"==typeof e?Su(Nu.SHAPE,e):e;if(!p)throw new Error(Tu(`Shape ${e} not found`));if(!f||f.destroyed||!(f instanceof p)){f&&(null===(s=null==i?void 0:i.beforeDestroy)||void 0===s||s.call(i,f),null==f||f.destroy(),null===(l=null==i?void 0:i.afterDestroy)||void 0===l||l.call(i,f)),null===(c=null==i?void 0:i.beforeCreate)||void 0===c||c.call(i);const e=new p({className:t,style:n});return r.appendChild(e),this.shapeMap[t]=e,null===(u=null==i?void 0:i.afterCreate)||void 0===u||u.call(i,e),e}return null===(h=null==i?void 0:i.beforeUpdate)||void 0===h||h.call(i,f),Wg(f,n),null===(d=null==i?void 0:i.afterUpdate)||void 0===d||d.call(i,f),f}transformPosition(t){if("x"in t||"y"in t||"z"in t){const{x:e=0,y:n=0,z:r=0,transform:i}=t,o=Iu(+e,+n,+r,i);o&&(this.style.transform=o)}}update(t={}){const e=Object.assign({},this.attributes,t);this.attr(e),this.render(e,this),this.transformPosition(e),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){return Ld(t,["x","y","z","class","className","transform","transformOrigin","context","zIndex","visibility"])}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;const n=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){const{x:e=0,y:n=0,z:r=0}=this.attributes;t.forEach((t=>{const{x:i=e,y:o=n,z:a=r}=t;Object.assign(t,{transform:a?[["translate3d",i,o,a]]:[["translate",i,o]]})}))}const r=super.animate(t,e);if(r&&(Ud(this,r),n.push(r)),Array.isArray(t)&&t.length>0){const r=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some((t=>!r.includes(t)))){Object.entries(this.shapeMap).forEach((([r,i])=>{const o=this[`get${pe(r)}Style`];if(Yt(o)){const r=t.map((t=>o.call(this,Object.assign(Object.assign({},this.attributes),t)))),a=i.animate(Pu(r),e);a&&(Ud(i,a),n.push(a))}}));const r=(r,i)=>{if(!Oe(r)){const o=this[`get${pe(i)}Style`];if(Yt(o)){const i=t.map((t=>o.call(this,Object.assign(Object.assign({},this.attributes),t))));Object.entries(i[0]).map((([t])=>{const o=i.map((e=>e[t])),a=r[t];if(a){const t=a.animate(Pu(o),e);t&&(Ud(a,t),n.push(t))}}))}}};this.compositeShapes.forEach((([t,e])=>{const n=Pd(this.shapeMap,e);r(n,t)}))}}return Cu(n)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Dh(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function Ud(t,e){null==e||e.finished.then((()=>{const n=t.activeAnimations.findIndex((t=>t===e));n>-1&&t.activeAnimations.splice(n,1)}))}var Yd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class qd extends Hd{constructor(t){super(jd({style:qd.defaultStyleProps},t))}isTextStyle(t){return _d(t,"label")}isBackgroundStyle(t){return _d(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t);return Dd(Yd(e,["padding"]),"background")}getBackgroundStyle(t){if(!1===t.background)return!1;const e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:r,padding:i}=e,o=Cd(e,"background"),{min:[a,s],center:[l,c],halfExtents:[u,h]}=this.shapeMap.text.getGeometryBounds(),[d,f,p,g]=Yu(i),v=2*u+g+f,{width:m,height:y}=o;m&&y?Object.assign(o,{x:l-Number(m)/2,y:c-Number(y)/2}):Object.assign(o,{x:a-g,y:s-d,width:n?Math.min(v,r+g+f):v,height:2*h+d+p});const{radius:b}=o;if("string"==typeof b&&b.endsWith("%")){const t=Number(b.replace("%",""))/100;o.radius=Math.min(+o.width,+o.height)*t}return o}render(t=this.parsedAttributes,e=this){this.upsert("text",Jl,this.getTextStyle(t),e),this.upsert("background",Kl,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}qd.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class Xd extends Hd{constructor(t){super(jd({style:Xd.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",qd,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}Xd.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};const Kd={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function Zd(t){const e=[],n="string"==typeof t?function(t){const e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),n=[];let r="",i={};for(;e.length>0;){let t=e.shift();t in Kd?r=t:e.unshift(t),i={type:r},Kd[r].forEach((n=>{t=e.shift(),i[n]=t})),"M"===r?r="L":"m"===r&&(r="l");const[o,...a]=Object.values(i);n.push([o,...a.map(Number)])}return n}(t):t;return n.forEach((t=>{const n=t[0];if("Z"!==n)if("A"!==n)for(let n=1;n<t.length;n+=2)e.push([t[n],t[n+1],0]);else{const n=t.length;e.push([t[n-2],t[n-1],0])}else e.push(e[0])})),e}const Jd=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];const e=t[0],n=t[1],r=t[t.length-1],i=t[t.length-2];t.unshift(i,r),t.push(e,n);const o=[["M",r[0],r[1]]];for(let e=1;e<t.length-2;e+=1){const[n,r]=t[e-1],[i,a]=t[e],[s,l]=t[e+1],[c,u]=e!==t.length-2?t[e+2]:[s,l],h=i+(s-n)/6,d=a+(l-r)/6,f=s-(c-i)/6,p=l-(u-a)/6;o.push(["C",h,d,f,p,s,l])}return o};var Qd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class tf extends Hd{constructor(t){super(jd({style:tf.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;const e=Cd(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:r,offsetY:i,autoRotate:o,placement:a,closeToPath:s}=e,l=Qd(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,u=null==c?void 0:c.getRenderBounds();return Object.assign(function(t,e,n,r,i,o,a){const[s,l]=rd(t,e),c={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",s+n,l+r]]};if("center"===e||!i)return c;const u=Zd(o);if(!u||u.length<=3)return c;const h=u.map(((t,e)=>{const n=t,r=u[(e+1)%u.length];return Se(n,r)?null:[n,r]})).filter(Boolean),d=dd([s,l],h),f=fd([s,l],d);if(f&&d&&(c.transform=[["translate",f[0]+n,f[1]+r]],a)){const t=Math.atan((d[0][1]-d[1][1])/(d[0][0]-d[1][0]));c.transform.push(["rotate",t/Math.PI*180]),c.textAlign="center","right"!==e&&"left"!==e||(c.textBaseline=t>0?"right"===e?"bottom":"top":"right"===e?"top":"bottom")}return c}(u,a,r,i,s,t.d,o),{wordWrapWidth:$d(u,n)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",Hl,this.getKeyStyle(t),e),this.upsert("label",qd,this.getLabelStyle(t),e)}}tf.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};let ef=class extends Vl{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},rf=this,this.isMutationObserved=!0,this.addEventListener(Ws.MOUNTED,this.onMounted),this.addEventListener(Ws.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:n=0,height:r=0}=this.attributes;if(t&&n&&r){const[i,o]=this.getBounds().min,a={x:i,y:o,radius:t,width:n,height:r};if(e)Object.assign(this.parsedStyle.clipPath.style,a);else{const t=new Kl({style:a});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}};const nf=new WeakMap;let rf=null;const of=t=>{if(rf&&function(t){const e=[];let n=t.parentNode;for(;n;)e.push(n),n=n.parentNode;return e}(rf).includes(t)){const e=nf.get(t);e?e.includes(rf)||e.push(rf):nf.set(t,[rf])}},af=t=>{const e=nf.get(t);e&&e.forEach((t=>t.handleRadius()))};class sf extends Hd{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:n=0}=t,r=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},r):Object.assign({textBaseline:"middle",textAlign:"center"},r)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?ef:Jl,this.getIconStyle(t),e)}}class lf extends Hd{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then((()=>this.onframe()))),n}}var cf=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class uf extends lf{constructor(t){super(jd({style:uf.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return Rd(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(Dd(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Cd(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:r,offsetX:i,offsetY:o}=e,a=cf(e,["placement","maxWidth","offsetX","offsetY"]),s=this.getShape("key").getLocalBounds();return Object.assign(Gg(s,n,i,o),{wordWrapWidth:$d(s,r)},a)}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),{fill:n}=e,r=cf(e,["fill"]),i=Cd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},r),{stroke:n}),i)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;const e=Cd(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){const n=Rd(t);let r={};return e.text&&!e.fontSize&&(r={fontSize:.5*Math.min(...n)}),!e.src||e.width&&e.height||(r={width:.5*n[0],height:.5*n[1]}),r}(t.size,e),e)}getBadgesStyle(t){var e;const n=Pd(this.shapeMap,"badge-"),r={};if(Object.keys(n).forEach((t=>{r[t]=!1})),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return r;const{badges:i=[],badgePalette:o,opacity:a=1}=t,s=cf(t,["badges","badgePalette","opacity"]),l=Gd(o),c=Cd(this.getGraphicStyle(s),"badge");return i.forEach(((t,e)=>{r[e]=Object.assign(Object.assign({backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:a},c),this.getBadgeStyle(t))})),r}getBadgeStyle(t){const e=this.getShape("key"),{placement:n="top",offsetX:r,offsetY:i}=t,o=cf(t,["placement","offsetX","offsetY"]),a=Gg(e.getLocalBounds(),n,r,i,!0);return Object.assign(Object.assign({},a),o)}getPortsStyle(t){var e;const n=this.getPorts(),r={};if(Object.keys(n).forEach((t=>{r[t]=!1})),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return r;const i=Cd(this.getGraphicStyle(t),"port"),{ports:o=[]}=t;return o.forEach(((e,n)=>{const o=e.key||n,a=Object.assign(Object.assign({},i),e);if(Ig(a))r[o]=!1;else{const[n,i]=this.getPortXY(t,e);r[o]=Object.assign({transform:[["translate",n,i]]},a)}})),r}getPortXY(t,e){const{placement:n="left"}=e,r=this.getShape("key");return Rg(function(t,e){if(!t)return e.getLocalBounds();const n=t.canvas.getLayer(),r=e.cloneNode();Dh(r,"hidden"),n.appendChild(r);const i=r.getLocalBounds();return r.destroy(),i}(this.context,r),n)}getPorts(){return Pd(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){return function(t,e,n=!1){return ud(t,rd(e,"center"),[rd(e,"left-top"),rd(e,"right-top"),rd(e,"right-bottom"),rd(e,"left-bottom")],!1,n).point}(t,this.getShape("key").getBounds(),e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);if(!Bd(this,"halo",n))return;const r=this.getShape("key");this.upsert("halo",r.constructor,n,e)}drawIconShape(t,e){const n=this.getIconStyle(t);Bd(this,"icon",n)&&(this.upsert("icon",sf,n,e),of(this))}drawBadgeShapes(t,e){const n=this.getBadgesStyle(t);Object.keys(n).forEach((t=>{const r=n[t];Bd(this,`badge-${t}`,r)&&this.upsert(`badge-${t}`,Xd,r,e)}))}drawPortShapes(t,e){const n=this.getPortsStyle(t);Object.keys(n).forEach((t=>{const r=n[t],i=`port-${t}`;Bd(this,i,r)&&this.upsert(i,Rl,r,e)}))}drawLabelShape(t,e){const n=this.getLabelStyle(t);Bd(this,"label",n)&&this.upsert("label",qd,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&af(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}uf.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};let hf=class t extends uf{constructor(e){super(jd({style:t.defaultStyleProps},e))}drawKeyShape(t,e){return this.upsert("key",Rl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,r=2*n*xd;return!!e&&Object.assign({width:r,height:r},e)}getIntersectPoint(t,e=!1){return hd(t,this.getShape("key").getBounds(),e)}};hf.defaultStyleProps={size:32};let df=class extends uf{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",Yl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var n,r;const{points:i}=this.getShape("key").attributes;return ud(t,[+((null===(n=this.attributes)||void 0===n?void 0:n.x)||0),+((null===(r=this.attributes)||void 0===r?void 0:r.y)||0)],i,!0,e).point}};var ff=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class pf extends hf{constructor(t){super(jd({style:pf.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...Rd(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return ie(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:n}=t;if(!(null==n?void 0:n.length))return;const r=n.map((t=>le(t)?{value:t}:t)),i=Cd(this.getGraphicStyle(t),"donut"),o=Gd(t.donutPalette);if(!o)return;const a=r.reduce(((t,e)=>{var n;return t+(null!==(n=e.value)&&void 0!==n?n:0)}),0),s=this.parseOuterR(),l=this.parseInnerR();let c=0;r.forEach(((t,n)=>{const{value:u=0,color:h=o[n%o.length]}=t,d=ff(t,["value","color"]),f=360*(0===a?1/r.length:u/a);this.upsert(`round${n}`,Hl,Object.assign(Object.assign(Object.assign({},i),{d:vf(s,l,c,c+f),fill:h}),d),e),c+=f}))}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}pf.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const gf=(t,e,n,r)=>[t+Math.sin(r)*n,e-Math.cos(r)*n],vf=(t=0,e=0,n,r)=>{const[i,o]=[0,0];return Math.abs(n-r)%360<1e-6?((t,e,n,r)=>r<=0||n<=r?[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"]]:[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"],["M",t+r,e],["A",r,r,0,1,0,t-r,e],["A",r,r,0,1,0,t+r,e],["Z"]])(i,o,t,e):((t,e,n,r,i,o)=>{const[a,s]=[i/360*2*Math.PI,o/360*2*Math.PI],l=[gf(t,e,r,a),gf(t,e,n,a),gf(t,e,n,s),gf(t,e,r,s)],c=s-a>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",n,n,0,c,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",r,r,0,c,0,l[0][0],l[0][1]],["Z"]]})(i,o,t,e,n,r)};let mf=class t extends uf{constructor(e){super(jd({style:t.defaultStyleProps},e))}drawKeyShape(t,e){return this.upsert("key",jl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,r]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:r/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:n,ry:r}=this.getShape("key").attributes,i=2*Math.min(+n,+r)*xd;return!!e&&Object.assign({width:i,height:i},e)}getIntersectPoint(t,e=!1){return hd(t,this.getShape("key").getBounds(),e)}};mf.defaultStyleProps={size:[45,35]};
/*!
   * @antv/g-plugin-canvas-path-generator
   * @description A G plugin of path generator with Canvas2D API
   * @version 2.1.1
   * @date 11/5/2024, 10:47:01 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */
function yf(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,o=void 0===i?0:i,a=e.r;t.arc(r,o,a,0,2*Math.PI,!1)}function bf(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,o=void 0===i?0:i,a=e.rx,s=e.ry;if(t.ellipse)t.ellipse(r,o,a,s,0,0,2*Math.PI,!1);else{var l=a>s?a:s,c=a>s?1:a/s,u=a>s?s/a:1;t.save(),t.scale(c,u),t.arc(r,o,l,0,2*Math.PI)}}function xf(t,e){var n,r,i=e.x1,o=e.y1,a=e.x2,s=e.y2,l=e.markerStart,c=e.markerEnd,u=e.markerStartOffset,h=e.markerEndOffset,d=0,f=0,p=0,g=0,v=0;l&&Tl(l)&&u&&(n=a-i,r=s-o,v=Math.atan2(r,n),d=Math.cos(v)*(u||0),f=Math.sin(v)*(u||0)),c&&Tl(c)&&h&&(n=i-a,r=o-s,v=Math.atan2(r,n),p=Math.cos(v)*(h||0),g=Math.sin(v)*(h||0)),t.moveTo(i+d,o+f),t.lineTo(a+p,s+g)}function Ef(t,e){var n,r,i=e.markerStart,o=e.markerEnd,a=e.markerStartOffset,s=e.markerEndOffset,l=e.d,c=l.absolutePath,u=l.segments,h=0,d=0,f=0,p=0,g=0;if(i&&Tl(i)&&a){var v=x(i.parentNode.getStartTangent(),2),m=v[0],y=v[1];n=m[0]-y[0],r=m[1]-y[1],g=Math.atan2(r,n),h=Math.cos(g)*(a||0),d=Math.sin(g)*(a||0)}if(o&&Tl(o)&&s){var b=x(o.parentNode.getEndTangent(),2),E=b[0],w=b[1];n=E[0]-w[0],r=E[1]-w[1],g=Math.atan2(r,n),f=Math.cos(g)*(s||0),p=Math.sin(g)*(s||0)}for(var k=0;k<c.length;k++){var M=c[k],N=M[0],O=c[k+1],S=0===k&&(0!==h||0!==d),T=(k===c.length-1||O&&("M"===O[0]||"Z"===O[0]))&&0!==f&&0!==p,_=x(S?[h,d]:[0,0],2),A=_[0],C=_[1],P=x(T?[f,p]:[0,0],2),D=P[0],R=P[1];switch(N){case"M":t.moveTo(M[1]+A,M[2]+C);break;case"L":t.lineTo(M[1]+D,M[2]+R);break;case"Q":t.quadraticCurveTo(M[1],M[2],M[3]+D,M[4]+R);break;case"C":t.bezierCurveTo(M[1],M[2],M[3],M[4],M[5]+D,M[6]+R);break;case"A":var L=u[k].arcParams,I=L.cx,j=L.cy,F=L.rx,B=L.ry,z=L.startAngle,V=L.endAngle,G=L.xRotation,W=L.sweepFlag;if(t.ellipse)t.ellipse(I,j,F,B,G,z,V,!!(1-W));else{var $=F>B?F:B,H=F>B?1:F/B,U=F>B?B/F:1;t.translate(I,j),t.rotate(G),t.scale(H,U),t.arc(0,0,$,z,V,!!(1-W)),t.scale(1/H,1/U),t.rotate(-G),t.translate(-I,-j)}T&&t.lineTo(M[6]+f,M[7]+p);break;case"Z":t.closePath()}}}function wf(t,e){var n,r,i=e.markerStart,o=e.markerEnd,a=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,c=l.length,u=l[0][0],h=l[0][1],d=l[c-1][0],f=l[c-1][1],p=0,g=0,v=0,m=0,y=0;i&&Tl(i)&&a&&(n=l[1][0]-l[0][0],r=l[1][1]-l[0][1],y=Math.atan2(r,n),p=Math.cos(y)*(a||0),g=Math.sin(y)*(a||0)),o&&Tl(o)&&s&&(n=l[c-1][0]-l[0][0],r=l[c-1][1]-l[0][1],y=Math.atan2(r,n),v=Math.cos(y)*(s||0),m=Math.sin(y)*(s||0)),t.moveTo(u+(p||v),h+(g||m));for(var b=1;b<c-1;b++){var x=l[b];t.lineTo(x[0],x[1])}t.lineTo(d,f)}function kf(t,e){var n,r,i=e.markerStart,o=e.markerEnd,a=e.markerStartOffset,s=e.markerEndOffset,l=e.points.points,c=l.length,u=l[0][0],h=l[0][1],d=l[c-1][0],f=l[c-1][1],p=0,g=0,v=0,m=0,y=0;i&&Tl(i)&&a&&(n=l[1][0]-l[0][0],r=l[1][1]-l[0][1],y=Math.atan2(r,n),p=Math.cos(y)*(a||0),g=Math.sin(y)*(a||0)),o&&Tl(o)&&s&&(n=l[c-2][0]-l[c-1][0],r=l[c-2][1]-l[c-1][1],y=Math.atan2(r,n),v=Math.cos(y)*(s||0),m=Math.sin(y)*(s||0)),t.moveTo(u+p,h+g);for(var b=1;b<c-1;b++){var x=l[b];t.lineTo(x[0],x[1])}t.lineTo(d+v,f+m)}function Mf(t,e){var n=e.x,r=void 0===n?0:n,i=e.y,o=void 0===i?0:i,a=e.radius,s=e.width,l=e.height,c=s,u=l;if(a&&a.some((function(t){return 0!==t}))){var h=s>0?1:-1,d=l>0?1:-1,f=h+d===0,p=x(a.map((function(t){return se(t,0,Math.min(Math.abs(c)/2,Math.abs(u)/2))})),4),g=p[0],v=p[1],m=p[2],y=p[3];t.moveTo(h*g+r,o),t.lineTo(c-h*v+r,o),0!==v&&t.arc(c-h*v+r,d*v+o,v,-d*Math.PI/2,h>0?0:Math.PI,f),t.lineTo(c+r,u-d*m+o),0!==m&&t.arc(c-h*m+r,u-d*m+o,m,h>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,f),t.lineTo(h*y+r,u+o),0!==y&&t.arc(h*y+r,u-d*y+o,y,d>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,f),t.lineTo(r,d*g+o),0!==g&&t.arc(h*g+r,d*g+o,g,h>0?Math.PI:0,d>0?1.5*Math.PI:Math.PI/2,f)}else t.rect(r,o,c,u)}var Nf=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="canvas-path-generator",t}return b(e,t),u(e,[{key:"init",value:function(){var t,e=(o(o(o(o(o(o(o(o(o(o(t={},jr.CIRCLE,yf),jr.ELLIPSE,bf),jr.RECT,Mf),jr.LINE,xf),jr.POLYLINE,kf),jr.POLYGON,wf),jr.PATH,Ef),jr.TEXT,void 0),jr.GROUP,void 0),jr.IMAGE,void 0),o(o(o(t,jr.HTML,void 0),jr.MESH,void 0),jr.FRAGMENT,void 0));this.context.pathGeneratorFactory=e}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(Br),Of=ft(),Sf=ft(),Tf=ft(),_f=A(),Af=function(){function t(){var e=this;l(this,t),this.isHit=function(t,n,r,i){var o=e.context.pointInPathPickerFactory[t.nodeName];if(o){var a=j(_f,r),s=Ot(Sf,yt(Tf,n[0],n[1],0),a);if(o(t,new Zr(s[0],s[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var r=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),i=e.context.pathGeneratorFactory[t.nodeName];return i&&(r.beginPath(),i(r,t.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y)}}return u(t,[{key:"apply",value:function(e,n){var r,i=this,o=e.renderingService,a=e.renderingContext;this.context=e,this.runtime=n;var s=null===(r=a.root)||void 0===r?void 0:r.ownerDocument;o.hooks.pick.tapPromise(t.tag,function(){var t=Pr(Ar().mark((function t(e){return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.pick(s,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),o.hooks.pickSync.tap(t.tag,(function(t){return i.pick(s,t)}))}},{key:"pick",value:function(t,e){var n,r=e.topmost,i=e.position,o=i.x,a=i.y,s=yt(Of,o,a,0),l=[],c=Dr(t.elementsFromBBox(s[0],s[1],s[0],s[1]));try{for(c.s();!(n=c.n()).done;){var u=n.value,h=u.getWorldTransform();if(this.isHit(u,s,h,!1)){var d=za(u);if(d){var f=d.parsedStyle.clipPath;if(this.isHit(f,s,f.getWorldTransform(),!0)){if(r)return e.picked=[u],e;l.push(u)}}else{if(r)return e.picked=[u],e;l.push(u)}}}}catch(t){c.e(t)}finally{c.f()}return e.picked=l,e}}])}();
/*!
   * @antv/g-plugin-canvas-picker
   * @description A G plugin for picking in canvas
   * @version 2.1.1
   * @date 11/5/2024, 10:49:03 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */function Cf(t,e,n){var r=t.parsedStyle,i=r.cx,o=void 0===i?0:i,a=r.cy,s=void 0===a?0:a,l=r.r,c=r.fill,u=r.stroke,h=r.lineWidth,d=void 0===h?1:h,f=r.increasedLineWidthForHitTesting,p=void 0===f?0:f,g=r.pointerEvents,v=void 0===g?"auto":g,m=(d+p)/2,y=dr(o,s,e.x,e.y),b=x(Ha(v,c,u),2),E=b[0],w=b[1];return E&&w||n?y<=l+m:E?y<=l:!!w&&(y>=l-m&&y<=l+m)}function Pf(t,e,n,r){return t/(n*n)+e/(r*r)}function Df(t,e,n){var r=t.parsedStyle,i=r.cx,o=void 0===i?0:i,a=r.cy,s=void 0===a?0:a,l=r.rx,c=r.ry,u=r.fill,h=r.stroke,d=r.lineWidth,f=void 0===d?1:d,p=r.increasedLineWidthForHitTesting,g=void 0===p?0:p,v=r.pointerEvents,m=void 0===v?"auto":v,y=e.x,b=e.y,E=x(Ha(m,u,h),2),w=E[0],k=E[1],M=(f+g)/2,N=(y-o)*(y-o),O=(b-s)*(b-s);return w&&k||n?Pf(N,O,l+M,c+M)<=1:w?Pf(N,O,l,c)<=1:!!k&&(Pf(N,O,l-M,c-M)>=1&&Pf(N,O,l+M,c+M)<=1)}function Rf(t,e,n,r,i,o){return i>=t&&i<=t+n&&o>=e&&o<=e+r}function Lf(t,e,n,r,i,o,a,s){var l=(Math.atan2(s-e,a-t)+2*Math.PI)%(2*Math.PI),c={x:t+n*Math.cos(l),y:e+n*Math.sin(l)};return dr(c.x,c.y,a,s)<=o/2}function If(t,e,n,r,i,o,a){var s=Math.min(t,n),l=Math.max(t,n),c=Math.min(e,r),u=Math.max(e,r),h=i/2;return o>=s-h&&o<=l+h&&a>=c-h&&a<=u+h&&xr(t,e,n,r,o,a)<=i/2}function jf(t,e,n,r,i){var o=t.length;if(o<2)return!1;for(var a=0;a<o-1;a++){if(If(t[a][0],t[a][1],t[a+1][0],t[a+1][1],e,n,r))return!0}if(i){var s=t[0],l=t[o-1];if(If(s[0],s[1],l[0],l[1],e,n,r))return!0}return!1}Af.tag="CanvasPicker";function Ff(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function Bf(t,e,n){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function zf(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=t[o],s=t[(o+1)%i];if(Bf(a,s,[e,n]))return!0;Ff(a[1]-n)>0!=Ff(s[1]-n)>0&&Ff(e-(n-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}function Vf(t,e,n){for(var r=!1,i=0;i<t.length;i++){if(r=zf(t[i],e,n))break}return r}function Gf(t,e,n){var r=t.parsedStyle,i=r.x1,o=r.y1,a=r.x2,s=r.y2,l=r.lineWidth,c=void 0===l?1:l,u=r.increasedLineWidthForHitTesting,h=void 0===u?0:u,d=r.pointerEvents;return!(!x(Ha(void 0===d?"auto":d,r.fill,r.stroke),2)[1]&&!n||!c)&&If(i,o,a,s,c+h,e.x,e.y)}function Wf(t,e,n,r,i,o){var a=t.parsedStyle,s=a.lineWidth,l=void 0===s?1:s,c=a.increasedLineWidthForHitTesting,u=void 0===c?0:c,h=a.stroke,d=a.fill,f=a.d,p=a.pointerEvents,g=void 0===p?"auto":p,v=f.segments,m=f.hasArc,y=f.polylines,b=f.polygons,E=x(Ha(g,(null==b?void 0:b.length)&&d,h),2),w=E[0],k=E[1],M=Do(t),N=!1;return w||n?N=m?r(t,e):Vf(b,e.x,e.y)||Vf(y,e.x,e.y):((k||n)&&(N=function(t,e,n,r,i){for(var o=!1,a=e/2,s=0;s<t.length;s++){var l=t[s],c=l.currentPoint,u=l.params,h=l.prePoint,d=l.box;if(!d||Rf(d.x-a,d.y-a,d.width+e,d.height+e,n,r))switch(l.command){case"L":case"Z":if(o=If(h[0],h[1],c[0],c[1],e,n,r))return!0;break;case"Q":if(o=_r(h[0],h[1],u[1],u[2],u[3],u[4],n,r)<=e/2)return!0;break;case"C":if(o=Mr(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],n,r,i)<=e/2)return!0;break;case"A":l.cubicParams||(l.cubicParams=hn(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var f=l.cubicParams,p=h,g=0;g<f.length;g+=6){var v=Mr(p[0],p[1],f[g],f[g+1],f[g+2],f[g+3],f[g+4],f[g+5],n,r,i);if(p=[f[g+4],f[g+5]],o=v<=e/2)return!0}}}return o}(v,l+u,e.x,e.y,M)),N)}function $f(t,e,n){var r=t.parsedStyle,i=r.stroke,o=r.fill,a=r.lineWidth,s=void 0===a?1:a,l=r.increasedLineWidthForHitTesting,c=void 0===l?0:l,u=r.points,h=r.pointerEvents,d=x(Ha(void 0===h?"auto":h,o,i),2),f=d[0],p=!1;return(d[1]||n)&&(p=jf(u.points,s+c,e.x,e.y,!0)),p||!f&&!n||(p=zf(u.points,e.x,e.y)),p}function Hf(t,e,n){var r=t.parsedStyle,i=r.lineWidth,o=void 0===i?1:i,a=r.increasedLineWidthForHitTesting,s=void 0===a?0:a,l=r.points,c=r.pointerEvents;return!(!x(Ha(void 0===c?"auto":c,r.fill,r.stroke),2)[1]&&!n||!o)&&jf(l.points,o+s,e.x,e.y,!1)}function Uf(t,e,n,r,i){var o=t.parsedStyle,a=o.radius,s=o.fill,l=o.stroke,c=o.lineWidth,u=void 0===c?1:c,h=o.increasedLineWidthForHitTesting,d=void 0===h?0:h,f=o.x,p=void 0===f?0:f,g=o.y,v=void 0===g?0:g,m=o.width,y=o.height,b=o.pointerEvents,E=x(Ha(void 0===b?"auto":b,s,l),2),w=E[0],k=E[1],M=u+d;if(a&&a.some((function(t){return 0!==t}))){var N=!1;return(k||n)&&(N=function(t,e,n,r,i,o,a,s){var l=x(i,4),c=l[0],u=l[1],h=l[2],d=l[3];return If(t+c,e,t+n-u,e,o,a,s)||If(t+n,e+u,t+n,e+r-h,o,a,s)||If(t+n-h,e+r,t+d,e+r,o,a,s)||If(t,e+r-d,t,e+c,o,a,s)||Lf(t+n-u,e+u,u,Math.PI,Math.PI,o,a,s)||Lf(t+n-h,e+r-h,h,0,Math.PI,o,a,s)||Lf(t+d,e+r-d,d,Math.PI,Math.PI,o,a,s)||Lf(t+c,e+c,c,Math.PI,Math.PI,o,a,s)}(p,v,m,y,a.map((function(t){return se(t,0,Math.min(Math.abs(m)/2,Math.abs(y)/2))})),M,e.x,e.y)),N||!w&&!n||(N=r(t,e)),N}var O=M/2;return w&&k||n?Rf(p-O,v-O,m+O,y+O,e.x,e.y):w?Rf(p,v,m,y,e.x,e.y):!!k&&function(t,e,n,r,i,o,a){var s=i/2;return Rf(t-s,e-s,n,i,o,a)||Rf(t+n-s,e-s,i,r,o,a)||Rf(t+s,e+r-s,n,i,o,a)||Rf(t-s,e+s,i,r,o,a)}(p,v,m,y,M,e.x,e.y)}function Yf(t,e,n,r,i,o){var a=t.parsedStyle,l=a.pointerEvents,c=void 0===l?"auto":l,u=a.x,h=void 0===u?0:u,d=a.y,f=void 0===d?0:d,p=a.width,g=a.height;if("non-transparent-pixel"===c){var v=i.config.offscreenCanvas,m=o.offscreenCanvasCreator.getOrCreateCanvas(v),y=o.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});return m.width=p,m.height=g,i.defaultStyleRendererFactory[jr.IMAGE].render(y,s(s({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),y.getImageData(e.x-h,e.y-f,1,1).data.every((function(t){return 0!==t}))}return!0}function qf(t,e,n,r){var i=t.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}var Xf=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="canvas-picker",t}return b(e,t),u(e,[{key:"init",value:function(){var t,e=(o(o(o(o(o(o(o(o(o(o(t={},jr.CIRCLE,Cf),jr.ELLIPSE,Df),jr.RECT,Uf),jr.LINE,Gf),jr.POLYLINE,Hf),jr.POLYGON,$f),jr.PATH,Wf),jr.TEXT,qf),jr.GROUP,null),jr.IMAGE,Yf),o(o(t,jr.HTML,null),jr.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new Af)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(Br);function Kf(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Zf=0;function Jf(t){return"__private_"+Zf+++"_"+t}
/*!
   * @antv/g-plugin-image-loader
   * @description A G plugin for loading image
   * @version 2.1.1
   * @date 11/5/2024, 10:47:27 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */var Qf=Jf("cacheStore"),tp=function(){return u((function t(){l(this,t),Object.defineProperty(this,Qf,{writable:!0,value:new Map})}),[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return Kf(this,Qf)[Qf].has(t)}},{key:"put",value:function(t,e,n){return!Kf(this,Qf)[Qf].has(t)&&(Kf(this,Qf)[Qf].set(t,{value:e,counter:new Set([n])}),this.onRefAdded(n),!0)}},{key:"get",value:function(t,e){var n=Kf(this,Qf)[Qf].get(t);return n?(n.counter.has(e)||(n.counter.add(e),this.onRefAdded(e)),n.value):null}},{key:"update",value:function(t,e,n){var r=Kf(this,Qf)[Qf].get(t);return!!r&&(r.value=s(s({},r.value),e),r.counter.has(n)||(r.counter.add(n),this.onRefAdded(n)),!0)}},{key:"release",value:function(t,e){var n=Kf(this,Qf)[Qf].get(t);return!!n&&(n.counter.delete(e),n.counter.size<=0&&Kf(this,Qf)[Qf].delete(t),!0)}},{key:"releaseRef",value:function(t){var e=this;Kf(this,Qf)[Qf].keys().forEach((function(n){e.release(n,t)}))}},{key:"getSize",value:function(){return Kf(this,Qf)[Qf].size}},{key:"clear",value:function(){Kf(this,Qf)[Qf].clear()}}])}(),ep=[],np=[],rp=function(){function t(){l(this,t)}return u(t,null,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;t.rafId&&(e.cancelAnimationFrame(t.rafId),t.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;ep.length<=0&&np.length<=0||(np.forEach((function(t){return t()})),np=ep.splice(0,t.TASK_NUM_PER_FRAME),t.rafId=e.requestAnimationFrame((function(){t.executeTask(e)})))}},{key:"sliceImage",value:function(e,n,r){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.api,a=e.naturalWidth||e.width,s=e.naturalHeight||e.height,l=n-i,c=r-i,u=Math.ceil(a/l),h=Math.ceil(s/c),d={tileSize:[n,r],gridSize:[h,u],tiles:Array(h).fill(null).map((function(){return Array(u).fill(null)}))},f=function(t){for(var i=function(i){ep.push((function(){var u=i*l,h=t*c,f=[Math.min(n,a-u),Math.min(r,s-h)],p=f[0],g=f[1],v=o.createCanvas();v.width=n,v.height=r,v.getContext("2d").drawImage(e,u,h,p,g,0,0,p,g),d.tiles[t][i]={x:u,y:h,tileX:i,tileY:t,data:v}}))},h=0;h<u;h++)i(h)},p=0;p<h;p++)f(p);return t.stop(),t.executeTask(),d}}])}();rp.TASK_NUM_PER_FRAME=10;var ip=new tp;ip.onRefAdded=function(t){var e=this;t.addEventListener(Ws.DESTROY,(function(){e.releaseRef(t)}),{once:!0})};var op=function(){return u((function t(e,n){l(this,t),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=n}),[{key:"getImageSync",value:function(t,e,n){var r=ie(t)?t:t.src;if(ip.has(r)){var i=ip.get(r,e);if(i.img.complete)return null==n||n(i),i}return this.getOrCreateImage(t,e).then((function(t){null==n||n(t)})).catch((function(){})),null}},{key:"getOrCreateImage",value:function(t,e){var n=ie(t)?t:t.src;if(!ie(t)&&!ip.has(n)){var r={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:ap(t)};ip.put(n,r,e)}if(ip.has(n)){var i=ip.get(n,e);return i.img.complete?Promise.resolve(i):new Promise((function(t,e){i.img.addEventListener("load",(function(){i.tileSize=ap(i.img),t(i)})),i.img.addEventListener("error",(function(t){e(t)}))}))}var o=this.context.config.createImage;return new Promise((function(t,r){var i;if(o?i=o(n):ja&&(i=new window.Image),i){var a={img:i,size:[0,0],tileSize:ap(i)};ip.put(n,a,e),i.onload=function(){a.size=[i.naturalWidth||i.width,i.naturalHeight||i.height],a.tileSize=ap(a.img),t(a)},i.onerror=function(t){r(t)},i.crossOrigin="Anonymous",i.src=n}}))}},{key:"createDownSampledImage",value:(e=Pr(Ar().mark((function t(e,n){var r,i,o,a,l,c,u,h,d,f,p,g,v,m;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,n);case 2:if(void 0===(r=t.sent).downSamplingRate){t.next=5;break}return t.abrupt("return",r);case 5:if(i=this.context.config.enableLargeImageOptimization,a=(o="boolean"==typeof i?{}:i).maxDownSampledImageSize,l=void 0===a?2048:a,c=o.downSamplingRateThreshold,u=void 0===c?.5:c,h=this.runtime.globalThis.createImageBitmap,d=x(r.size,2),f=d[0],p=d[1],g=r.img,v=Math.min((l+l)/(f+p),Math.max(.01,Math.min(u,.5))),m=s(s({},r),{},{downSamplingRate:v}),ip.update(r.img.src,m,n),!h){t.next=25;break}return t.prev=14,t.next=17,h(r.img,{resizeWidth:f*v,resizeHeight:p*v});case 17:g=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14),v=1;case 23:t.next=26;break;case 25:v=1;case 26:return m=s(s({},this.getImageSync(e,n)),{},{downSampled:g,downSamplingRate:v}),ip.update(r.img.src,m,n),t.abrupt("return",m);case 29:case"end":return t.stop()}}),t,this,[[14,20]])}))),function(t,n){return e.apply(this,arguments)})},{key:"createImageTiles",value:(t=Pr(Ar().mark((function t(e,n,r){var i,o,a,l,c;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,r);case 2:return i=t.sent,o=r.ownerDocument.defaultView,a=o.requestAnimationFrame,l=o.cancelAnimationFrame,rp.api={requestAnimationFrame:a,cancelAnimationFrame:l,createCanvas:function(){return Fs.createCanvas()}},c=s(s({},i),rp.sliceImage(i.img,i.tileSize[0],i.tileSize[0])),ip.update(i.img.src,c,r),t.abrupt("return",c);case 8:case"end":return t.stop()}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"releaseImage",value:function(t,e){ip.release(ie(t)?t:t.src,e)}},{key:"releaseImageRef",value:function(t){ip.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,e,n,r,i,o,a){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var l,c=e.image,u=e.repetition,h=e.transform,d=!1;if(ie(c)){var f=this.getImageSync(c,t,a);l=null==f?void 0:f.img}else r?(l=r,d=!0):l=c;var p,g=l&&n.createPattern(l,u);g&&(p=h?vs(ea(h),new Dl({})):L(A()),d&&V(p,p,[1/i,1/i,1]),g.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+o[0],f:p[13]+o[1]}));return s&&g&&(this.patternCache[s]=g),g}},{key:"getOrCreateGradient",value:function(t,e){var n=this.generateGradientKey(t),r=t.type,i=t.steps,o=t.min,a=t.width,s=t.height,l=t.angle,c=t.cx,u=t.cy,h=t.size;if(this.gradientCache[n])return this.gradientCache[n];var d=null;if(r===zi.LinearGradient){var f=function(t,e,n,r){var i=oi(r.value),o=0+e/2,a=0+n/2,s=Math.abs(e*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:t[0]+o-Math.cos(i)*s/2,y1:t[1]+a-Math.sin(i)*s/2,x2:t[0]+o+Math.cos(i)*s/2,y2:t[1]+a+Math.sin(i)*s/2}}(o,a,s,l),p=f.x1,g=f.y1,v=f.x2,m=f.y2;d=e.createLinearGradient(p,g,v,m)}else if(r===zi.RadialGradient){var y=function(t,e,n,r,i,o){var a=r.value,s=i.value;r.unit===_i.kPercentage&&(a=r.value/100*e),i.unit===_i.kPercentage&&(s=i.value/100*n);var l=Math.max(vn([0,0],[a,s]),vn([0,n],[a,s]),vn([e,n],[a,s]),vn([e,0],[a,s]));return o&&(o instanceof $i?l=o.value:o instanceof Gi&&("closest-side"===o.value?l=Math.min(a,e-a,s,n-s):"farthest-side"===o.value?l=Math.max(a,e-a,s,n-s):"closest-corner"===o.value&&(l=Math.min(vn([0,0],[a,s]),vn([0,n],[a,s]),vn([e,n],[a,s]),vn([e,0],[a,s]))))),{x:a+t[0],y:s+t[1],r:l}}(o,a,s,c,u,h),b=y.x,x=y.y,E=y.r;d=e.createRadialGradient(b,x,0,b,x,E)}return d&&(i.forEach((function(t){var e,n=t.offset,r=t.color;n.unit===_i.kPercentage&&(null===(e=d)||void 0===e||e.addColorStop(n.value/100,r.toString()))})),this.gradientCache[n]=d),this.gradientCache[n]}},{key:"generateGradientKey",value:function(t){var e=t.type,n=t.min,r=t.width,i=t.height,o=t.steps,a=t.angle,s=t.cx,l=t.cy,c=t.size;return"gradient-".concat(e,"-").concat((null==a?void 0:a.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==c?void 0:c.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(r,"-").concat(i,"-").concat(o.map((function(t){var e=t.offset,n=t.color;return"".concat(e).concat(n)})).join("-"))}},{key:"generatePatternKey",value:function(t){var e=t.image,n=t.repetition;return ie(e)?"pattern-".concat(e,"-").concat(n):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(n):void 0}}]);var t,e}();function ap(t){if(!t.complete)return[0,0];var e=t.naturalWidth||t.width,n=t.naturalHeight||t.height,r=256;return[256,512].forEach((function(t){Math.ceil(n/t)*Math.ceil(e/t)<1e3&&(r=t)})),[r,r]}op.isSupportTile=!!Fs.createCanvas();var sp=function(){function t(){l(this,t)}return u(t,[{key:"apply",value:function(e){var n=e.renderingService,r=e.renderingContext,i=e.imagePool,o=r.root.ownerDocument.defaultView,a=function(t,e,n){var r=t.parsedStyle,i=r.width,o=r.height;i&&!o?t.setAttribute("height",n/e*i):!i&&o&&t.setAttribute("width",e/n*o)},s=function(t){var e=t.target,r=e.nodeName,o=e.attributes;if(r===jr.IMAGE){var s=o.src,l=o.keepAspectRatio;ie(s)&&i.getImageSync(s,e,(function(t){var r=t.img,i=r.width,o=r.height;l&&a(e,i,o),e.renderable.dirty=!0,n.dirtify()}))}},l=function(t){var e=t.target,r=t.attrName,o=t.prevValue,s=t.newValue;e.nodeName===jr.IMAGE&&"src"===r&&(o!==s&&i.releaseImage(o,e),ie(s)&&i.getOrCreateImage(s,e).then((function(t){var r=t.img,i=r.width,o=r.height;e.attributes.keepAspectRatio&&a(e,i,o),e.renderable.dirty=!0,n.dirtify()})).catch((function(){})))};n.hooks.init.tap(t.tag,(function(){o.addEventListener(Ws.MOUNTED,s),o.addEventListener(Ws.ATTR_MODIFIED,l)})),n.hooks.destroy.tap(t.tag,(function(){o.removeEventListener(Ws.MOUNTED,s),o.removeEventListener(Ws.ATTR_MODIFIED,l)}))}}])}();sp.tag="LoadImage";var lp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="image-loader",t}return b(e,t),u(e,[{key:"init",value:function(t){this.context.imagePool=new op(this.context,t),this.addRenderingPlugin(new sp)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Br),cp=Jf("renderState"),up=function(){function t(e){l(this,t),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,cp,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=A(),this.dprMatrix=A(),this.tmpMat4=A(),this.vec3a=ft(),this.vec3b=ft(),this.vec3c=ft(),this.vec3d=ft(),this.canvasRendererPluginOptions=e}return u(t,[{key:"apply",value:function(e,n){var r=this;this.context=e;var i=this.context,o=i.config,a=i.camera,s=i.renderingService,l=i.renderingContext,c=i.rBushRoot,u=i.pathGeneratorFactory,h=o.renderer.getConfig().enableRenderingOptimization;o.renderer.getConfig().enableDirtyCheck=!1,o.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=c,this.pathGeneratorFactory=u;var d=e.contextService,p=l.root.ownerDocument.defaultView,g=function(t){var e=t.target.rBushNode;e.aabb&&r.removedRBushNodeAABBs.push(e.aabb)},v=function(t){var e=t.target.rBushNode;e.aabb&&r.removedRBushNodeAABBs.push(e.aabb)};s.hooks.init.tap(t.tag,(function(){p.addEventListener(Ws.UNMOUNTED,g),p.addEventListener(Ws.CULLED,v);var t=d.getDPR(),e=o.width,n=o.height,i=d.getContext();r.clearRect(i,0,0,e*t,n*t,o.background)})),s.hooks.destroy.tap(t.tag,(function(){p.removeEventListener(Ws.UNMOUNTED,g),p.removeEventListener(Ws.CULLED,v),r.renderQueue=[],r.removedRBushNodeAABBs=[],Kf(r,cp)[cp]={restoreStack:[],prevObject:null,currentContext:null}})),s.hooks.beginFrame.tap(t.tag,(function(){var t,e=d.getContext(),n=d.getDPR(),i=o.width,a=o.height,l=r.canvasRendererPluginOptions,c=l.dirtyObjectNumThreshold,u=l.dirtyObjectRatioThreshold,h=s.getStats(),f=h.total,g=h.rendered,v=g/f;r.clearFullScreen=r.clearFullScreenLastFrame||!(null!==(t=p.context.renderingPlugins[1])&&void 0!==t&&t.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||g>c&&v>u,e&&("function"==typeof e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(e,0,0,i*n,a*n,o.background))}));var m=function(t,e){for(var i=[t];i.length>0;){var o=i.pop();o.isVisible()&&!o.isCulled()&&(h?r.renderDisplayObjectOptimized(o,e,r.context,Kf(r,cp)[cp],n):r.renderDisplayObject(o,e,r.context,Kf(r,cp)[cp],n));for(var a=o.sortable.sorted||o.childNodes,s=a.length-1;s>=0;s--)i.push(a[s])}};s.hooks.endFrame.tap(t.tag,(function(){if(0!==l.root.childNodes.length){h=o.renderer.getConfig().enableRenderingOptimization,Kf(r,cp)[cp]={restoreStack:[],prevObject:null,currentContext:Kf(r,cp)[cp].currentContext},Kf(r,cp)[cp].currentContext.clear(),r.clearFullScreenLastFrame=!1;var t=d.getContext(),e=d.getDPR();if(H(r.dprMatrix,[e,e,1]),B(r.vpMatrix,r.dprMatrix,a.getOrthoMatrix()),r.clearFullScreen)h?(t.save(),m(l.root,t),t.restore()):m(l.root,t),r.removedRBushNodeAABBs=[];else{var i=r.safeMergeAABB.apply(r,[r.mergeDirtyAABBs(r.renderQueue)].concat(f(r.removedRBushNodeAABBs.map((function(t){var e=t.minX,n=t.minY,r=t.maxX,i=t.maxY,o=new Yr;return o.setMinMax([e,n,0],[r,i,0]),o})))));if(r.removedRBushNodeAABBs=[],Yr.isEmpty(i))return void(r.renderQueue=[]);var s=r.convertAABB2Rect(i),c=s.x,u=s.y,g=s.width,v=s.height,y=Ot(r.vec3a,[c,u,0],r.vpMatrix),b=Ot(r.vec3b,[c+g,u,0],r.vpMatrix),x=Ot(r.vec3c,[c,u+v,0],r.vpMatrix),E=Ot(r.vec3d,[c+g,u+v,0],r.vpMatrix),w=Math.min(y[0],b[0],E[0],x[0]),k=Math.min(y[1],b[1],E[1],x[1]),M=Math.max(y[0],b[0],E[0],x[0]),N=Math.max(y[1],b[1],E[1],x[1]),O=Math.floor(w),S=Math.floor(k),T=Math.ceil(M-w),_=Math.ceil(N-k);t.save(),r.clearRect(t,O,S,T,_,o.background),t.beginPath(),t.rect(O,S,T,_),t.clip(),t.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]),o.renderer.getConfig().enableDirtyRectangleRenderingDebug&&p.dispatchEvent(new Ds(ac.DIRTY_RECTANGLE,{dirtyRect:{x:O,y:S,width:T,height:_}})),r.searchDirtyObjects(i).sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})).forEach((function(e){e&&e.isVisible()&&!e.isCulled()&&r.renderDisplayObject(e,t,r.context,Kf(r,cp)[cp],n)})),t.restore(),r.renderQueue.forEach((function(t){r.saveDirtyAABB(t)})),r.renderQueue=[]}Kf(r,cp)[cp].restoreStack.forEach((function(){t.restore()})),Kf(r,cp)[cp].restoreStack=[]}else r.clearFullScreenLastFrame=!0})),s.hooks.render.tap(t.tag,(function(t){r.clearFullScreen||r.renderQueue.push(t)}))}},{key:"clearRect",value:function(t,e,n,r,i,o){t.clearRect(e,n,r,i),o&&(t.fillStyle=o,t.fillRect(e,n,r,i))}},{key:"renderDisplayObjectOptimized",value:function(t,e,n,r,i){var o=t.nodeName,a=!1,s=this.context.styleRendererFactory[o],l=this.pathGeneratorFactory[o],c=t.parsedStyle.clipPath;if(c){(!r.prevObject||!ct(c.getWorldTransform(),r.prevObject.getWorldTransform()))&&(this.applyWorldTransform(e,c),r.prevObject=null);var u=this.pathGeneratorFactory[c.nodeName];u&&(e.save(),a=!0,e.beginPath(),u(e,c.parsedStyle),e.closePath(),e.clip())}if(s){(!r.prevObject||!ct(t.getWorldTransform(),r.prevObject.getWorldTransform()))&&this.applyWorldTransform(e,t);var h=!r.prevObject;if(!h){var d=r.prevObject.nodeName;h=o===jr.TEXT?d!==jr.TEXT:o===jr.IMAGE?d!==jr.IMAGE:d===jr.TEXT||d===jr.IMAGE}s.applyStyleToContext(e,t,h,r),r.prevObject=t}l&&(e.beginPath(),l(e,t.parsedStyle),o!==jr.LINE&&o!==jr.PATH&&o!==jr.POLYLINE&&e.closePath()),s&&s.drawToContext(e,t,Kf(this,cp)[cp],this,i),a&&e.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,e,n,r,i){var o=t.nodeName,a=r.restoreStack[r.restoreStack.length-1];!a||t.compareDocumentPosition(a)&Is.DOCUMENT_POSITION_CONTAINS||(e.restore(),r.restoreStack.pop());var s=this.context.styleRendererFactory[o],l=this.pathGeneratorFactory[o],c=t.parsedStyle.clipPath;if(c){this.applyWorldTransform(e,c);var u=this.pathGeneratorFactory[c.nodeName];u&&(e.save(),r.restoreStack.push(t),e.beginPath(),u(e,c.parsedStyle),e.closePath(),e.clip())}s&&(this.applyWorldTransform(e,t),e.save(),s.applyAttributesToContext(e,t)),l&&(e.beginPath(),l(e,t.parsedStyle),o!==jr.LINE&&o!==jr.PATH&&o!==jr.POLYLINE&&e.closePath()),s&&(s.render(e,t.parsedStyle,t,n,this,i),e.restore()),t.renderable.dirty=!1}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),n=t.getMax(),r=Math.floor(e[0]),i=Math.floor(e[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i}}},{key:"mergeDirtyAABBs",value:function(t){var e=new Yr;return t.forEach((function(t){var n=t.getRenderBounds();e.add(n);var r=t.renderable.dirtyRenderBounds;r&&e.add(r)})),e}},{key:"searchDirtyObjects",value:function(t){var e=x(t.getMin(),2),n=e[0],r=e[1],i=x(t.getMax(),2),o=i[0],a=i[1];return this.rBush.search({minX:n,minY:r,maxX:o,maxY:a}).map((function(t){return t.displayObject}))}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new Yr);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)}},{key:"applyWorldTransform",value:function(t,e,n){n?(P(this.tmpMat4,e.getLocalTransform()),B(this.tmpMat4,n,this.tmpMat4),B(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(P(this.tmpMat4,e.getWorldTransform()),B(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new Yr,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){t.add(e)})),t}}])}();
/*!
   * @antv/g-plugin-canvas-renderer
   * @description A G plugin of renderer implementation with Canvas2D API
   * @version 2.2.1
   * @date 11/5/2024, 10:48:13 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */function hp(t,e,n,r,i,o,a){var s,l;if("rect"===t.image.nodeName){var c=t.image.parsedStyle,u=c.width,h=c.height;l=r.contextService.getDPR();var d=r.config.offscreenCanvas;(s=o.offscreenCanvasCreator.getOrCreateCanvas(d)).width=u*l,s.height=h*l;var f=o.offscreenCanvasCreator.getOrCreateContext(d),p={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach((function(t){i.renderDisplayObject(t,f,r,p,o)})),p.restoreStack.forEach((function(){f.restore()}))}return a.getOrCreatePatternSync(e,t,n,s,l,e.getGeometryBounds().min,(function(){e.renderable.dirty=!0,r.renderingService.dirtify()}))}function dp(t,e,n,r){var i;if(t.type===zi.LinearGradient||t.type===zi.RadialGradient){var o=e.getGeometryBounds(),a=o&&2*o.halfExtents[0]||1,l=o&&2*o.halfExtents[1]||1,c=o&&o.min||[0,0];i=r.getOrCreateGradient(s(s({type:t.type},t.value),{},{min:c,width:a,height:l}),n)}return i}up.tag="CanvasRenderer";var fp=["shadowBlur","shadowOffsetX","shadowOffsetY"],pp=["lineCap","lineJoin","miterLimit"],gp={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},vp={};function mp(t,e,n,r){var i=r.has(e)?r.get(e):gp[e];return i!==n&&("lineDash"===e?t.setLineDash(n):t[e]=n,r.set(e,n)),i}var yp=function(){return u((function t(e){l(this,t),this.imagePool=e}),[{key:"applyAttributesToContext",value:function(t,e){}},{key:"render",value:function(t,e,n,r,i,o){}},{key:"applyCommonStyleToContext",value:function(t,e,n,r){var i=n?vp:r.prevObject.parsedStyle,o=e.parsedStyle;(n||o.opacity!==i.opacity)&&mp(t,"globalAlpha",qt(o.opacity)?gp.globalAlpha:o.opacity,r.currentContext),(n||o.blend!==i.blend)&&mp(t,"globalCompositeOperation",qt(o.blend)?gp.globalCompositeOperation:o.blend,r.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,e,n,r){var i=n?vp:r.prevObject.parsedStyle,o=e.parsedStyle,a=o.lineWidth,s=void 0===a?gp.lineWidth:a,l=o.fill&&!o.fill.isNone;if(o.stroke&&!o.stroke.isNone&&s>0){if(n||e.attributes.stroke!==r.prevObject.attributes.stroke)mp(t,"strokeStyle",qt(o.stroke)||Array.isArray(o.stroke)||o.stroke.isNone?gp.strokeStyle:e.attributes.stroke,r.currentContext);(n||o.lineWidth!==i.lineWidth)&&mp(t,"lineWidth",qt(o.lineWidth)?gp.lineWidth:o.lineWidth,r.currentContext),(n||o.lineDash!==i.lineDash)&&mp(t,"lineDash",o.lineDash||gp.lineDash,r.currentContext),(n||o.lineDashOffset!==i.lineDashOffset)&&mp(t,"lineDashOffset",qt(o.lineDashOffset)?gp.lineDashOffset:o.lineDashOffset,r.currentContext);for(var c=0;c<pp.length;c++){var u=pp[c];(n||o[u]!==i[u])&&mp(t,u,qt(o[u])?gp[u]:o[u],r.currentContext)}}l&&(n||e.attributes.fill!==r.prevObject.attributes.fill)&&mp(t,"fillStyle",qt(o.fill)||Array.isArray(o.fill)||o.fill.isNone?gp.fillStyle:e.attributes.fill,r.currentContext)}},{key:"applyStyleToContext",value:function(t,e,n,r){var i=e.nodeName;this.applyCommonStyleToContext(t,e,n,r),i===jr.IMAGE||this.applyStrokeFillStyleToContext(t,e,n,r)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,e,n,r){var i=e.parsedStyle;if(n){mp(t,"shadowColor",i.shadowColor.toString(),r.currentContext);for(var o=0;o<fp.length;o++){var a=fp[o];mp(t,a,i[a]||gp[a],r.currentContext)}}i.filter&&i.filter.length&&mp(t,"filter",e.attributes.filter,r.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){mp(t,"shadowColor",gp.shadowColor,r.currentContext);for(var o=0;o<fp.length;o++){var a=fp[o];mp(t,a,gp[a],r.currentContext)}}if(n)if(e&&i){var s=t.filter;!qt(s)&&s.indexOf("drop-shadow")>-1&&mp(t,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||gp.filter,r.currentContext)}else mp(t,"filter",gp.filter,r.currentContext)}},{key:"fillToContext",value:function(t,e,n,r,i){var o=this,a=e.parsedStyle,s=a.fill,l=a.fillRule,c=null;if(Array.isArray(s)&&s.length>0)s.forEach((function(r){var i,a=mp(t,"fillStyle",dp(r,e,t,o.imagePool),n.currentContext);c=null!==(i=c)&&void 0!==i?i:a,l?t.fill(l):t.fill()}));else{if(uo(s)){var u=hp(s,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);u&&(t.fillStyle=u,c=!0)}l?t.fill(l):t.fill()}null!==c&&mp(t,"fillStyle",c,n.currentContext)}},{key:"strokeToContext",value:function(t,e,n,r,i){var o=this,a=e.parsedStyle.stroke,s=null;if(Array.isArray(a)&&a.length>0)a.forEach((function(r){var i,a=mp(t,"strokeStyle",dp(r,e,t,o.imagePool),n.currentContext);s=null!==(i=s)&&void 0!==i?i:a,t.stroke()}));else{if(uo(a)){var l=hp(a,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);if(l){var c,u=mp(t,"strokeStyle",l,n.currentContext);s=null!==(c=s)&&void 0!==c?c:u}}t.stroke()}null!==s&&mp(t,"strokeStyle",s,n.currentContext)}},{key:"drawToContext",value:function(t,e,n,r,i){var o,a=e.nodeName,s=e.parsedStyle,l=s.opacity,c=void 0===l?gp.globalAlpha:l,u=s.fillOpacity,h=void 0===u?gp.fillOpacity:u,d=s.strokeOpacity,f=void 0===d?gp.strokeOpacity:d,p=s.lineWidth,g=void 0===p?gp.lineWidth:p,v=s.fill&&!s.fill.isNone,m=s.stroke&&!s.stroke.isNone&&g>0;if(v||m){var y=!qt(s.shadowColor)&&s.shadowBlur>0,b="inner"===s.shadowType,x=0===(null===(o=s.fill)||void 0===o?void 0:o.alpha),E=!(!s.filter||!s.filter.length),w=y&&m&&(a===jr.PATH||a===jr.LINE||a===jr.POLYLINE||x||b),k=null;if(v)w||this.applyShadowAndFilterStyleToContext(t,e,y,n),k=mp(t,"globalAlpha",c*h,n.currentContext),this.fillToContext(t,e,n,r,i),w||this.clearShadowAndFilterStyleForContext(t,y,E,n);if(m){var M=!1,N=mp(t,"globalAlpha",c*f,n.currentContext);if(k=v?k:N,w&&(this.applyShadowAndFilterStyleToContext(t,e,y,n),M=!0,b)){var O=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,e,n,r,i),t.globalCompositeOperation=O,this.clearShadowAndFilterStyleForContext(t,y,E,n,!0)}this.strokeToContext(t,e,n,r,i),M&&this.clearShadowAndFilterStyleForContext(t,y,E,n)}null!==k&&mp(t,"globalAlpha",k,n.currentContext)}}}])}(),bp=function(t){function e(){return l(this,e),m(this,e,arguments)}return b(e,t),u(e,[{key:"applyAttributesToContext",value:function(t,e){var n=e.parsedStyle,r=n.stroke,i=n.fill,o=n.opacity,a=n.lineDash,s=n.lineDashOffset;a&&t.setLineDash(a),qt(s)||(t.lineDashOffset=s),qt(o)||(t.globalAlpha*=o),qt(r)||Array.isArray(r)||r.isNone||(t.strokeStyle=e.attributes.stroke),qt(i)||Array.isArray(i)||i.isNone||(t.fillStyle=e.attributes.fill)}},{key:"render",value:function(t,e,n,r,i,o){var a=e.fill,s=e.fillRule,l=e.opacity,c=void 0===l?1:l,u=e.fillOpacity,h=void 0===u?1:u,d=e.stroke,f=e.strokeOpacity,p=void 0===f?1:f,g=e.lineWidth,v=void 0===g?1:g,m=e.lineCap,y=e.lineJoin,b=e.shadowType,x=e.shadowColor,E=e.shadowBlur,w=e.filter,k=e.miterLimit,M=a&&!a.isNone,N=d&&!d.isNone&&v>0,O=0===(null==a?void 0:a.alpha),S=!(!w||!w.length),T=!qt(x)&&E>0,_=n.nodeName,A="inner"===b,C=N&&T&&(_===jr.PATH||_===jr.LINE||_===jr.POLYLINE||O||A);M&&(t.globalAlpha=c*h,C||xp(n,t,T),Ep(t,n,a,s,r,i,o,this.imagePool),C||this.clearShadowAndFilter(t,S,T)),N&&(t.globalAlpha=c*p,t.lineWidth=v,qt(k)||(t.miterLimit=k),qt(m)||(t.lineCap=m),qt(y)||(t.lineJoin=y),C&&(A&&(t.globalCompositeOperation="source-atop"),xp(n,t,!0),A&&(wp(t,n,d,r,i,o,this.imagePool),t.globalCompositeOperation=gp.globalCompositeOperation,this.clearShadowAndFilter(t,S,!0))),wp(t,n,d,r,i,o,this.imagePool))}},{key:"clearShadowAndFilter",value:function(t,e,n){if(n&&(t.shadowColor="transparent",t.shadowBlur=0),e){var r=t.filter;!qt(r)&&r.indexOf("drop-shadow")>-1&&(t.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(yp);function xp(t,e,n){var r=t.parsedStyle,i=r.filter,o=r.shadowColor,a=r.shadowBlur,s=r.shadowOffsetX,l=r.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),n&&(e.shadowColor=o.toString(),e.shadowBlur=a||0,e.shadowOffsetX=s||0,e.shadowOffsetY=l||0)}function Ep(t,e,n,r,i,o,a,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(n)?n.forEach((function(n){t.fillStyle=dp(n,e,t,s),l||(r?t.fill(r):t.fill())})):(uo(n)&&(t.fillStyle=hp(n,e,t,i,o,a,s)),l||(r?t.fill(r):t.fill()))}function wp(t,e,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(n)?n.forEach((function(n){t.strokeStyle=dp(n,e,t,a),s||t.stroke()})):(uo(n)&&(t.strokeStyle=hp(n,e,t,r,i,o,a)),s||t.stroke())}var kp=function(t){function e(){return l(this,e),m(this,e,arguments)}return b(e,t),u(e,[{key:"renderDownSampled",value:function(t,e,n,r){var i=r.src,o=r.imageCache;o.downSampled?t.drawImage(o.downSampled,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3])):this.imagePool.createDownSampledImage(i,n).then((function(t){n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify()})).catch((function(){}))}},{key:"renderTile",value:function(t,e,n,r){var i=r.src,o=r.imageCache,a=r.imageRect,s=r.drawRect,l=o.size,c=t.getTransform(),u=c.a,h=c.b,d=c.c,f=c.d,p=c.e,g=c.f;if(t.resetTransform(),null!=o&&o.gridSize){for(var v=[l[0]/a[2],l[1]/a[3]],m=[o.tileSize[0]/v[0],o.tileSize[1]/v[1]],y=[Math.floor((s[0]-a[0])/m[0]),Math.ceil((s[0]+s[2]-a[0])/m[0])],b=y[0],x=y[1],E=[Math.floor((s[1]-a[1])/m[1]),Math.ceil((s[1]+s[3]-a[1])/m[1])],w=E[1],k=E[0];k<=w;k++)for(var M=b;M<=x;M++){var N=o.tiles[k][M];if(N){var O=[Math.floor(a[0]+N.tileX*m[0]),Math.floor(a[1]+N.tileY*m[1]),Math.ceil(m[0]),Math.ceil(m[1])];t.drawImage(N.data,O[0],O[1],O[2],O[3])}}t.setTransform(u,h,d,f,p,g)}else this.imagePool.createImageTiles(i,[],n).then((function(){n.renderable.dirty=!0,n.ownerDocument.defaultView.context.renderingService.dirtify()})).catch((function(){}))}},{key:"render",value:function(t,n,r){var i=n.x,o=void 0===i?0:i,a=n.y,s=void 0===a?0:a,l=n.width,c=n.height,u=n.src,h=n.shadowColor,d=n.shadowBlur,f=this.imagePool.getImageSync(u,r),p=null==f?void 0:f.img,g=l,v=c;if(p){var m,y,b,E,w,k,M,N,O,S,T,_,A,C,P;g||(g=p.width),v||(v=p.height),xp(r,t,!qt(h)&&d>0);try{var R=r.ownerDocument.defaultView.getContextService().getDomElement(),L=R.width,I=R.height,j=t.getTransform(),F=j.a,B=j.b,z=function(t,e){var n=Ot(ft(),[t[0],t[1],0],e),r=Ot(ft(),[t[0]+t[2],t[1],0],e),i=Ot(ft(),[t[0],t[1]+t[3],0],e),o=Ot(ft(),[t[0]+t[2],t[1]+t[3],0],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0])-Math.min(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])-Math.min(n[1],r[1],i[1],o[1])]}([o,s,g,v],D(F,j.c,0,0,B,j.d,0,0,0,0,1,0,j.e,j.f,0,1)),V=(m=z,y=x([0,0,L,I],4),b=y[0],E=y[1],w=y[2],k=y[3],M=x(m,4),N=M[0],O=M[1],S=M[2],T=M[3],_=Math.max(b,N),A=Math.max(E,O),C=Math.min(b+w,N+S),P=Math.min(E+k,O+T),C<=_||P<=A?null:[_,A,C-_,P-A]);if(!V)return;if(!r.ownerDocument.defaultView.getConfig().enableLargeImageOptimization)return void e.renderFull(t,n,r,{image:p,drawRect:[o,s,g,v]});if(z[2]/f.size[0]<(f.downSamplingRate||.5))return void this.renderDownSampled(t,n,r,{src:u,imageCache:f,drawRect:[o,s,g,v]});if(!op.isSupportTile)return void e.renderFull(t,n,r,{image:p,drawRect:[o,s,g,v]});this.renderTile(t,n,r,{src:u,imageCache:f,imageRect:z,drawRect:V})}catch(t){}}}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e)}}],[{key:"renderFull",value:function(t,e,n,r){t.drawImage(r.image,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]))}}])}(bp),Mp=function(t){function e(){return l(this,e),m(this,e,arguments)}return b(e,t),u(e,[{key:"render",value:function(t,e,n,r,i,o){n.getBounds();var a=e.lineWidth,s=void 0===a?1:a,l=e.textAlign,c=void 0===l?"start":l,u=e.textBaseline,h=void 0===u?"alphabetic":u,d=e.lineJoin,f=void 0===d?"miter":d,p=e.miterLimit,g=void 0===p?10:p,v=e.letterSpacing,m=void 0===v?0:v,y=e.stroke,b=e.fill,x=e.fillRule,E=e.fillOpacity,w=void 0===E?1:E,k=e.strokeOpacity,M=void 0===k?1:k,N=e.opacity,O=void 0===N?1:N,S=e.metrics,T=e.x,_=void 0===T?0:T,A=e.y,C=void 0===A?0:A,P=e.dx,D=e.dy,R=e.shadowColor,L=e.shadowBlur,I=S.font,j=S.lines,F=S.height,B=S.lineHeight,z=S.lineMetrics;t.font=I,t.lineWidth=s,t.textAlign="middle"===c?"center":c;var V=h;"alphabetic"===V&&(V="bottom"),t.lineJoin=f,qt(g)||(t.miterLimit=g);var G=C;"middle"===h?G+=-F/2-B/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?G+=-F:"top"!==h&&"hanging"!==h||(G+=-B);var W=_+(P||0);G+=D||0,1===j.length&&("bottom"===V?(V="middle",G-=.5*F):"top"===V&&(V="middle",G+=.5*F)),t.textBaseline=V,xp(n,t,!qt(R)&&L>0);for(var $=0;$<j.length;$++){var H=s/2+W;G+=B,qt(y)||y.isNone||!s||this.drawLetterSpacing(t,n,j[$],z[$],c,H,G,m,b,x,w,y,M,O,!0,r,i,o),qt(b)||this.drawLetterSpacing(t,n,j[$],z[$],c,H,G,m,b,x,w,y,M,O,!1,r,i,o)}}},{key:"drawLetterSpacing",value:function(t,e,n,r,i,o,a,s,l,c,u,h,d,f,p,g,v,m){if(0!==s){var y=t.textAlign;t.textAlign="left";var b=o;"center"===i||"middle"===i?b=o-r.width/2:"right"!==i&&"end"!==i||(b=o-r.width);for(var x=Array.from(n),E=t.measureText(n).width,w=0,k=0;k<x.length;++k){var M=x[k];p?this.strokeText(t,e,M,b,a,h,d,g,v,m):this.fillText(t,e,M,b,a,l,c,u,f,g,v,m),b+=E-(w=t.measureText(n.substring(k+1)).width)+s,E=w}t.textAlign=y}else p?this.strokeText(t,e,n,o,a,h,d,g,v,m):this.fillText(t,e,n,o,a,l,c,u,f,g,v,m)}},{key:"fillText",value:function(t,e,n,r,i,o,a,s,l,c,u,h){var d;Ep(t,e,o,a,c,u,h,this.imagePool,!0);var f=!qt(s)&&1!==s;f&&(d=t.globalAlpha,t.globalAlpha=s*l),t.fillText(n,r,i),f&&(t.globalAlpha=d)}},{key:"strokeText",value:function(t,e,n,r,i,o,a,s,l,c){var u;wp(t,e,o,s,l,c,this.imagePool,!0);var h=!qt(a)&&1!==a;h&&(u=t.globalAlpha,t.globalAlpha=a),t.strokeText(n,r,i),h&&(t.globalAlpha=u)}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e,e.ownerDocument.defaultView.context,r,i)}}])}(bp),Np=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=m(this,e)).name="canvas-renderer",t.options=n,t}return b(e,t),u(e,[{key:"init",value:function(){var t,e=s({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new bp(n),i=(o(o(o(o(o(o(o(o(o(o(t={},jr.CIRCLE,r),jr.ELLIPSE,r),jr.RECT,r),jr.IMAGE,new kp(n)),jr.TEXT,new Mp(n)),jr.LINE,r),jr.POLYLINE,r),jr.POLYGON,r),jr.PATH,r),jr.GROUP,void 0),o(o(o(t,jr.HTML,void 0),jr.MESH,void 0),jr.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=i,this.context.styleRendererFactory=i,this.addRenderingPlugin(new up(e))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(Br),Op=function(){function t(){l(this,t)}return u(t,[{key:"apply",value:function(e,n){var r=this,i=e.renderingService,o=e.renderingContext,a=e.config;this.context=e;var s=o.root.ownerDocument.defaultView,l=function(t){i.hooks.pointerMove.call(t)},c=function(t){i.hooks.pointerUp.call(t)},u=function(t){i.hooks.pointerDown.call(t)},h=function(t){i.hooks.pointerOver.call(t)},d=function(t){i.hooks.pointerOut.call(t)},f=function(t){i.hooks.pointerCancel.call(t)},p=function(t){i.hooks.pointerWheel.call(t)},g=function(t){i.hooks.click.call(t)};i.hooks.init.tap(t.tag,(function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?function(t){n.globalThis.document.addEventListener("pointermove",l,!0),t.addEventListener("pointerdown",u,!0),t.addEventListener("pointerleave",d,!0),t.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.addEventListener("mousemove",l,!0),t.addEventListener("mousedown",u,!0),t.addEventListener("mouseout",d,!0),t.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.addEventListener("touchstart",u,!0),t.addEventListener("touchend",c,!0),t.addEventListener("touchmove",l,!0),t.addEventListener("touchcancel",f,!0)}(t),a.useNativeClickEvent&&t.addEventListener("click",g,!0),t.addEventListener("wheel",p,{passive:!0,capture:!0})})),i.hooks.destroy.tap(t.tag,(function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?function(t){n.globalThis.document.removeEventListener("pointermove",l,!0),t.removeEventListener("pointerdown",u,!0),t.removeEventListener("pointerleave",d,!0),t.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",f,!0)}(t):function(t){n.globalThis.document.removeEventListener("mousemove",l,!0),t.removeEventListener("mousedown",u,!0),t.removeEventListener("mouseout",d,!0),t.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",u,!0),t.removeEventListener("touchend",c,!0),t.removeEventListener("touchmove",l,!0),t.removeEventListener("touchcancel",f,!0)}(t),a.useNativeClickEvent&&t.removeEventListener("click",g,!0),t.removeEventListener("wheel",p,!0)}))}}])}();Op.tag="DOMInteraction";var Sp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="dom-interaction",t}return b(e,t),u(e,[{key:"init",value:function(){this.addRenderingPlugin(new Op)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Br),Tp=function(){function t(){l(this,t),this.displayObjectHTMLElementMap=new WeakMap}return u(t,[{key:"joinTransformMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")}},{key:"apply",value:function(e,n){var r=this,i=e.camera,o=e.renderingContext,a=e.renderingService;this.context=e;var s=o.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,c=function(t,e){e.style.transform=r.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},u=function(t){var e=t.target;if(e.nodeName===jr.HTML){r.$camera||(r.$camera=r.createCamera(i));var n=r.getOrCreateEl(e);r.$camera.appendChild(n),Object.keys(e.attributes).forEach((function(t){r.updateAttribute(t,e)})),c(e,n),l.set(n,e)}},h=function(t){var e=t.target;if(e.nodeName===jr.HTML&&r.$camera){var n=r.getOrCreateEl(e);n&&(n.remove(),l.delete(n))}},d=function(t){var e=t.target;if(e.nodeName===jr.HTML){var n=t.attrName;r.updateAttribute(n,e)}},f=function(t){var e=t.target;(e.nodeName===jr.FRAGMENT?e.childNodes:[e]).forEach((function(t){if(t.nodeName===jr.HTML){var e=r.getOrCreateEl(t);c(t,e)}}))},p=function(){if(r.$camera){var t=r.context.config,e=t.width,n=t.height;r.$camera.parentElement.style.width="".concat(e||0,"px"),r.$camera.parentElement.style.height="".concat(n||0,"px")}};a.hooks.init.tap(t.tag,(function(){s.addEventListener(ac.RESIZE,p),s.addEventListener(Ws.MOUNTED,u),s.addEventListener(Ws.UNMOUNTED,h),s.addEventListener(Ws.ATTR_MODIFIED,d),s.addEventListener(Ws.BOUNDS_CHANGED,f)})),a.hooks.endFrame.tap(t.tag,(function(){r.$camera&&o.renderReasons.has(Bs.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))})),a.hooks.destroy.tap(t.tag,(function(){r.$camera&&r.$camera.remove(),s.removeEventListener(ac.RESIZE,p),s.removeEventListener(Ws.MOUNTED,u),s.removeEventListener(Ws.UNMOUNTED,h),s.removeEventListener(Ws.ATTR_MODIFIED,d),s.removeEventListener(Ws.BOUNDS_CHANGED,f)}))}},{key:"createCamera",value:function(t){var e=this.context.config,n=e.document,r=e.width,i=e.height,o=this.context.contextService.getDomElement(),a=o.parentNode;if(a){var s="g-canvas-camera",l=a.querySelector("#".concat(s));if(!l){var c=(n||document).createElement("div");c.style.overflow="hidden",c.style.pointerEvents="none",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="".concat(r||0,"px"),c.style.height="".concat(i||0,"px");var u=(n||document).createElement("div");l=u,u.id=s,u.style.position="absolute",u.style.left="".concat(o.offsetLeft||0,"px"),u.style.top="".concat(o.offsetTop||0,"px"),u.style.transformOrigin="left top",u.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),u.style.pointerEvents="none",u.style.width="100%",u.style.height="100%",c.appendChild(u),a.appendChild(c)}return l}return null}},{key:"getOrCreateEl",value:function(t){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(t);return n||(n=(e||document).createElement("div"),t.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(t,n),t.id&&(n.id=t.id),t.name&&n.setAttribute("name",t.name),t.className&&(n.className=t.className),n.style.position="absolute",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),n}},{key:"updateAttribute",value:function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var r=e.parsedStyle.innerHTML;ie(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"x":n.style.left="".concat(e.parsedStyle.x,"px");break;case"y":n.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(i[0].buildCSSText(null,null,"")," ").concat(i[1].buildCSSText(null,null,""));break;case"width":var o=e.parsedStyle.width;n.style.width=le(o)?"".concat(o,"px"):o.toString();break;case"height":var a=e.parsedStyle.height;n.style.height=le(a)?"".concat(a,"px"):a.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]="".concat(s);break;case"visibility":var l=e.parsedStyle.visibility;n.style.visibility=l;break;case"pointerEvents":var c=e.parsedStyle.pointerEvents,u=void 0===c?"auto":c;n.style.pointerEvents=u;break;case"opacity":var h=e.parsedStyle.opacity;n.style.opacity="".concat(h);break;case"fill":var d=e.parsedStyle.fill,f="";ho(d)?f=d.isNone?"transparent":e.getAttribute("fill"):Array.isArray(d)?f=e.getAttribute("fill"):uo(d),n.style.background=f;break;case"stroke":var p=e.parsedStyle.stroke,g="";ho(p)?g=p.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(p)?g=e.getAttribute("stroke"):uo(p),n.style["border-color"]=g,n.style["border-style"]="solid";break;case"lineWidth":var v=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(v||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var m=e.style.filter;n.style.filter=m;break;default:qt(e.style[t])||""===e.style[t]||(n.style[t]=e.style[t])}}}])}();
/*!
   * @antv/g-plugin-html-renderer
   * @description A G plugin for rendering HTML
   * @version 2.1.6
   * @date 11/5/2024, 10:47:23 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */Tp.tag="HTMLRendering";var _p=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="html-renderer",t}return b(e,t),u(e,[{key:"init",value:function(){this.addRenderingPlugin(new Tp)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Br),Ap=function(){return u((function t(e){l(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}),[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=ie(e)?document.getElementById(e):e,this.$container)){var r=document.createElement("canvas");this.$container.appendChild(r),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=r}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var n=this.canvasConfig.devicePixelRatio||ja&&window.devicePixelRatio||1;n=n>=1?Math.ceil(n):1,this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){ja&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)),this.renderingContext.renderReasons.add(Bs.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:(t=Pr(Ar().mark((function t(){var e,n,r,i=arguments;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=i.length>0&&void 0!==i[0]?i[0]:{}).type,r=e.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(n,r));case 3:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),Cp=function(t){function e(){var t;l(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=m(this,e,[].concat(r))).name="canvas-context-register",t}return b(e,t),u(e,[{key:"init",value:function(){this.context.ContextService=Ap}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(Br),Pp=function(t){function e(t){var n;return l(this,e),(n=m(this,e,[t])).registerPlugin(new Cp),n.registerPlugin(new lp),n.registerPlugin(new Nf),n.registerPlugin(new Np),n.registerPlugin(new Sp),n.registerPlugin(new Xf),n.registerPlugin(new _p),n}return b(e,t),u(e)}(zr),Dp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};
/*!
   * @antv/g-canvas
   * @description A renderer implemented by Canvas 2D API
   * @version 2.0.22
   * @date 11/5/2024, 10:49:48 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */let Rp=class t extends uf{constructor(e){super(Object.assign(Object.assign({},e),{style:Object.assign({},t.defaultStyleProps,e.style)})),this.rootPointerEvent=new Cs(null),this.forwardEvents=t=>{const e=this.context.canvas,n=e.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,n).forEach((r=>{const i=this.bootstrapEvent(this.rootPointerEvent,r,n,t);_e(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(i)}))}}get eventService(){return this.context.canvas.context.eventService}get events(){return[mu.CLICK,mu.POINTER_DOWN,mu.POINTER_MOVE,mu.POINTER_UP,mu.POINTER_OVER,mu.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){const e=Ce(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:r=0}=e,i=Dp(e,["dx","dy"]),[o,a]=this.getSize(t);return Object.assign(Object.assign({x:n,y:r},i),{width:o,height:a})}drawKeyShape(t,e){const n=this.getKeyStyle(t),{x:r,y:i,width:o=0,height:a=0}=n,s=this.upsert("key-container",Kl,{x:r,y:i,width:o,height:a,opacity:0},e);return this.upsert("key",zl,n,s)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Pp))return;const t=this.getDomElement();this.events.forEach((e=>{t.addEventListener(e,this.forwardEvents)}))}attributeChangedCallback(t,e,n){"zIndex"===t&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const t=this.getDomElement();this.events.forEach((e=>{t.removeEventListener(e,this.forwardEvents)})),super.destroy()}normalizeToPointerEvent(t,e){const n=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){const r=t.changedTouches[e];ye(r.button)&&(r.button=0),ye(r.buttons)&&(r.buttons=1),ye(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),ye(r.width)&&(r.width=r.radiusX||1),ye(r.height)&&(r.height=r.radiusY||1),ye(r.tiltX)&&(r.tiltX=0),ye(r.tiltY)&&(r.tiltY=0),ye(r.pointerType)&&(r.pointerType="touch"),ye(r.pointerId)&&(r.pointerId=r.identifier||0),ye(r.pressure)&&(r.pressure=r.force||.5),ye(r.twist)&&(r.twist=0),ye(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){const e=t;ye(e.isPrimary)&&(e.isPrimary=!0),ye(e.width)&&(e.width=1),ye(e.height)&&(e.height=1),ye(e.tiltX)&&(e.tiltX=0),ye(e.tiltY)&&(e.tiltY=0),ye(e.pointerType)&&(e.pointerType="mouse"),ye(e.pointerId)&&(e.pointerId=1),ye(e.pressure)&&(e.pressure=.5),ye(e.twist)&&(e.twist=0),ye(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0,n.push(e)}else n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:i,y:o}=this.getViewportXY(e);t.viewport.x=i,t.viewport.y=o;const[a,s]=this.context.canvas.getCanvasByViewport([i,o]);return t.canvas.x=a,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,n;const{offsetX:r,offsetY:i,clientX:o,clientY:a}=t;if(!this.context.canvas.context.config.supportsCSSTransform||qt(r)||qt(i)){const t=this.eventService.client2Viewport({x:o,y:a});e=t.x,n=t.y}else e=r,n=i;return{x:e,y:n}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}};Rp.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var Lp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};let Ip=class t extends uf{constructor(e){super(jd({style:t.defaultStyleProps},e))}getKeyStyle(t){const[e,n]=this.getSize(t),r=super.getKeyStyle(t),{fillOpacity:i,opacity:o=i}=r,a=Lp(r,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:o},a),{width:e,height:n,x:-e/2,y:-n/2})}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getShape("key").attributes;Lp(e,["fill","stroke"]);const n=Cd(this.getGraphicStyle(t),"halo"),r=Number(n.lineWidth),[i,o]=Bh(this.getSize(t),[r,r]);return Object.assign(Object.assign({},n),{width:i,height:o,fill:"transparent",x:-i/2,y:-o/2})}getIconStyle(t){const e=super.getIconStyle(t),[n,r]=this.getSize(t);return!!e&&Object.assign({width:n*xd,height:r*xd},e)}drawKeyShape(t,e){const n=this.upsert("key",ef,this.getKeyStyle(t),e);return of(this),n}drawHaloShape(t,e){this.upsert("halo",Kl,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&af(this)}};Ip.defaultStyleProps={size:32};let jp=class extends uf{constructor(t){super(t)}getKeyStyle(t){const[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:n,height:r}=this.getShape("key").attributes;return!!e&&Object.assign({width:n*xd,height:r*xd},e)}drawKeyShape(t,e){return this.upsert("key",Kl,this.getKeyStyle(t),e)}};class Fp extends df{constructor(t){super(jd({style:Fp.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[n,r]=this.getSize(t);return function(t,e,n){const r=e/2,i=t/2,o={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return o[n]||o.up}(n,r,e)}getPortXY(t,e){const{direction:n}=t,{placement:r="top"}=e,i=this.getShape("key").getLocalBounds(),[o,a]=this.getSize(t),s=function(t,e,n){const r=e/2,i=t/2,o={};"down"===n?(o.bottom=o.default=[0,r],o.right=[i,-r],o.left=[-i,-r]):"left"===n?(o.top=[i,-r],o.bottom=[i,r],o.left=o.default=[-i,0]):"right"===n?(o.top=[-i,-r],o.bottom=[-i,r],o.right=o.default=[i,0]):(o.left=[-i,r],o.top=o.default=[0,-r],o.right=[i,r]);return o}(o,a,n);return Rg(i,r,s,!1)}getIconStyle(t){const{icon:e,iconText:n,iconSrc:r,direction:i}=t;if(!1===e||Oe(n||r))return!1;const o=Cd(this.getGraphicStyle(t),"icon"),a=this.getShape("key").getLocalBounds(),[s,l]=function(t,e){const{center:n}=t,[r,i]=Zu(t);return["up"===e||"down"===e?n[0]:"right"===e?n[0]-r/6:n[0]+r/6,"left"===e||"right"===e?n[1]:"down"===e?n[1]-i/6:n[1]+i/6]}(a,i),c=2*function(t,e){let[n,r]=Zu(t);return[n,r]="up"===e||"down"===e?[n,r]:[r,n],(Math.pow(r,2)-Math.pow(Math.sqrt(Math.pow(n/2,2)+Math.pow(r,2))-n/2,2))/(2*r)}(a,i)*xd;return Object.assign({x:s,y:l,width:c,height:c},o)}}Fp.defaultStyleProps={size:40,direction:"up"};var Bp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class zp extends uf{constructor(t){super(jd({style:zp.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:n=[]}=t;return 0===n.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:n}=t,[r,i,o,a]=Yu(e);return Bh(Rd(n),[a+i,r+o,0])}getCollapsedKeySize(t){return Rd(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[Xu(e),Ku(e),0]}getContentBBox(t){const{context:e,childrenNode:n=[],padding:r}=t,i=n.map((t=>e.element.getElement(t))).filter(Boolean);if(0===i.length){const e=new Yr,{x:n=0,y:r=0,size:i}=t,[o,a]=Rd(i);return e.setMinMax([n-o/2,r-a/2,0],[n+o/2,r+a/2,0]),e}const o=eh(i.map((t=>t.getBounds())));return r?th(o,r):o}drawCollapsedMarkerShape(t,e){const n=this.getCollapsedMarkerStyle(t);Bd(this,"collapsedMarker",n)&&(this.upsert("collapsed-marker",sf,n,e),of(this))}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=Cd(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,r=Bp(e,["type"]),i=this.getShape("key"),[o,a]=rd(i.getLocalBounds(),"center"),s=Object.assign(Object.assign({},r),{x:o,y:a});if(n){const e=this.getCollapsedMarkerText(n,t);Object.assign(s,{text:e})}return s}getCollapsedMarkerText(t,e){const{context:n,childrenData:r=[]}=e,{model:i}=n;return"descendant-count"===t?i.getDescendantsData(this.id).length.toString():"child-count"===t?r.length.toString():"node-count"===t?i.getDescendantsData(this.id).filter((t=>"node"===i.getElementType(xh(t)))).length.toString():Yt(t)?t(r):""}getComboZIndex(t){return(this.context.model.getAncestorsData(this.id,ku)||[]).length}getComboPosition(t){const{x:e=0,y:n=0,collapsed:r,context:i,childrenData:o=[]}=t;if(0===o.length)return[+e,+n,0];if(r){const{model:t}=i,r=t.getDescendantsData(this.id).filter((e=>!t.isCombo(xh(e))));if(r.length>0&&r.some(nd)){return Gh(r.reduce(((t,e)=>Bh(t,ed(e))),[0,0,0]),r.length)}return[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){const{zIndex:e=this.getComboZIndex(t)}=t,[n,r]=this.getComboPosition(t);return{x:n,y:r,transform:[["translate",n,r]],zIndex:e}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:n,y:r}=e;this.context.model.syncComboDatum({id:this.id,style:{x:n,y:r}}),af(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(this.attributes.collapsed?t:t.map((t=>Bp(t,["x","y","z","transform"]))),e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then((()=>this.onframe())),Reflect.set(t,e,n))}):n}}zp.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};const Vp={padding:10};function Gp(t,e,n,r,i,o){const{padding:a}=Object.assign(Vp,o),s=Ju(n,a),l=Ju(r,a),c=[t,...i,e];let u=null;const h=[];for(let t=0,e=c.length;t<e-1;t++){const n=t+1,r=c[t],i=c[n],o=ld(d=r,f=i)||function(t,e){return t[0]===e[0]}(d,f);let p=null;if(0===t)if(n===e-1)if(s.intersects(l))p=Zp(r,i,s,l);else if(ih(r,s)||ih(i,l))o||(p=Kp(r,i,s,l));else{const t=ah(r,s),e=ah(i,l);p=Yp(t,e,Hp(t,e)),p.points.unshift(t),p.points.push(e)}else nh(i,s)?p=Zp(r,i,s,Ju(i,a),u):o||(p=qp(r,i,s));else n===e-1?nh(r,l)?p=Zp(r,i,Ju(r,a),l,u):o||(p=Xp(r,i,l,u)):o||(p=Yp(r,i,u));p?(h.push(...p.points),u=p.direction):u=Hp(r,i),n<e-1&&h.push(i)}var d,f;return h.map(Xh)}const Wp={N:"S",S:"N",W:"E",E:"W"},$p={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function Hp(t,e){const[n,r]=t,[i,o]=e;return n===i?r>o?"N":"S":r===o?n>i?"W":"E":null}function Up(t,e){return"N"===e||"S"===e?Ku(t):Xu(t)}function Yp(t,e,n){const r=[t[0],e[1]],i=[e[0],t[1]],o=Hp(t,r),a=Hp(t,i),s=n?Wp[n]:null,l=o===n||o!==s&&a!==n?r:i;return{points:[l],direction:Hp(l,e)}}function qp(t,e,n){if(ih(t,n)){const r=Jp(t,e,n);return{points:[r],direction:Hp(r,e)}}{const r=ah(t,n),i=["left","right"].includes(oh(t,n))?[e[0],r[1]]:[r[0],e[1]];return{points:[i],direction:Hp(i,e)}}}function Xp(t,e,n,r){const i=ih(e,n)?e:ah(e,n),o=[[i[0],t[1]],[t[0],i[1]]],a=o.filter((t=>function(t,e){return!nh(t,e)}(t,n)&&!rh(t,n,!0))),s=a.filter((e=>Hp(e,t)!==r));if(s.length>0){const n=s.find((e=>Hp(t,e)===r))||s[0];return{points:[n],direction:Hp(n,e)}}{const i=sd(e,Ut(o,a)[0],Up(n,r)/2);return{points:[Jp(i,t,n),i],direction:Hp(i,e)}}}function Kp(t,e,n,r){let i=qp(t,e,n);const o=Kh(i.points[0]);if(nh(o,r)){i=qp(e,t,r);const a=Kh(i.points[0]);if(nh(a,n)){const s=sd(t,o,Up(n,Hp(t,o))/2),l=sd(e,a,Up(r,Hp(e,a))/2),c=[(s[0]+l[0])/2,(s[1]+l[1])/2],u=qp(t,c,n),h=Xp(c,e,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function Zp(t,e,n,r,i){const o=.01,a=eh([n,r]),s=$h(e,a.center)>$h(t,a.center),[l,c]=s?[e,t]:[t,e],u=Ku(a)+Xu(a);let h;if(i){const t=[l[0]+u*Math.cos($p[i]),l[1]+u*Math.sin($p[i])];h=sd(ah(t,a),t,o)}else h=sd(ah(l,a),l,-.01);let d=Jp(h,c,a),f=[ad(h,2),ad(d,2)];if(Se(ad(h),ad(d))){const t=Yh(zh(h,l),[1,0,0])+Math.PI/2;d=[c[0]+u*Math.cos(t),c[1]+u*Math.sin(t),0],d=ad(sd(ah(d,a),c,-.01),2);f=[h,Jp(h,d,a),d]}return{points:s?f.reverse():f,direction:Hp(s?h:d,e)}}function Jp(t,e,n){let r=[t[0],e[1]];return nh(r,n)&&(r=[e[0],t[1]]),r}function Qp(t,e,n,r,i){let o="number"==typeof e?e:.5;"start"===e&&(o=0),"end"===e&&(o=.99);const a=id(t.getPoint(o)),s=id(t.getPoint(o+.01));let l="start"===e?"left":"end"===e?"right":"center";if(ld(a,s)||!n){const[e,n]=tg(t,o,r,i);return{transform:[["translate",e,n]],textAlign:l}}let c=Math.atan2(s[1]-a[1],s[0]-a[0]);s[0]<a[0]&&(l="center"===l?l:"left"===l?"right":"left",r*=-1,c+=Math.PI);const[u,h]=tg(t,o,r,i,c);return{textAlign:l,transform:[["translate",u,h],["rotate",c/Math.PI*180]]}}function tg(t,e,n,r,i){const[o,a]=id(t.getPoint(e));let s=n,l=r;return i&&(s=n*Math.cos(i)-r*Math.sin(i),l=n*Math.sin(i)+r*Math.cos(i)),[o+s,a+l]}function eg(t,e,n,r){if(Se(t,e))return t;const i=zh(e,t),o=[t[0]+n*i[0],t[1]+n*i[1]],a=Uh(qh(i,!1));return o[0]+=r*a[0],o[1]+=r*a[1],o}function ng(t,e,n){return[["M",t[0],t[1]],["C",n[0][0],n[0][1],n[1][0],n[1][1],e[0],e[1]]]}function rg(t,e=0,n=!1){const r=t[0],i=t[t.length-1],o=t.slice(1,t.length-1),a=[["M",r[0],r[1]]];return o.forEach(((t,n)=>{const s=o[n-1]||r,l=o[n+1]||i;if(!Jh([s,c=t],[c,l])&&e){const[n,r]=function(t,e,n,r){const i=Hh(t,e),o=Hh(n,e),a=Math.min(r,Math.min(i,o)/2),s=[e[0]-a/i*(e[0]-t[0]),e[1]-a/i*(e[1]-t[1])],l=[e[0]-a/o*(e[0]-n[0]),e[1]-a/o*(e[1]-n[1])];return[s,l]}(s,t,l,e);a.push(["L",n[0],n[1]],["Q",t[0],t[1],r[0],r[1]],["L",r[0],r[1]])}else a.push(["L",t[0],t[1]]);var c})),a.push(["L",i[0],i[1]]),n&&a.push(["Z"]),a}function ig(t,e,n,r,i){const o=Ju(t),a=t.getCenter();let s=r&&jg(r),l=i&&jg(i);if(!s||!l){const r=(t=>{const e=Math.PI/2,n=Ku(t)/2,r=Xu(t)/2,i=Math.atan2(n,r)/2,o=Math.atan2(r,n)/2;return{top:[-e-o,-e+o],"top-right":[-e+o,-i],"right-top":[-e+o,-i],right:[-i,i],"bottom-right":[i,e-o],"right-bottom":[i,e-o],bottom:[e-o,e+o],"bottom-left":[e+o,Math.PI-i],"left-bottom":[e+o,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-o],"left-top":[Math.PI+i,-e-o]}})(o),i=r[e][0],c=r[e][1],[u,h]=Zu(o),d=Math.max(u,h),f=Bh(a,[d*Math.cos(i),d*Math.sin(i),0]),p=Bh(a,[d*Math.cos(c),d*Math.sin(c),0]);s=Vg(t,f),l=Vg(t,p),n||([s,l]=[l,s])}return[s,l]}function og(t,e,n,r,i,o){const a=t.getPorts()[i||o],s=t.getPorts()[o||i];let[l,c]=ig(t,e,n,a,s);const u=function(t,e,n,r){const i=t.getCenter();if(Se(e,n)){const t=zh(e,i),o=[r*Math.sign(t[0])||r/2,r*Math.sign(t[1])||-r/2,0];return[Bh(e,o),Bh(n,Vh(o,[1,-1,1]))]}return[sd(i,e,$h(i,e)+r),sd(i,n,$h(i,n)+r)]}(t,l,c,r);return a&&(l=zg(a,u[0])),s&&(c=zg(s,u[u.length-1])),ng(l,c,u)}function ag(t,e,n,r,i,o,a){const s=Lg(t),l=s[o||a],c=s[a||o];let[u,h]=ig(t,n,r,l,c);const d=function(t,e,n,r){const i=[],o=Ju(t);if(Se(e,n)){switch(oh(e,o)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]])}}else{const t=oh(e,o),a=oh(n,o);if(t===a){let o,a;switch(t){case"left":o=Math.min(e[0],n[0])-r,i.push([o,e[1]]),i.push([o,n[1]]);break;case"right":o=Math.max(e[0],n[0])+r,i.push([o,e[1]]),i.push([o,n[1]]);break;case"top":a=Math.min(e[1],n[1])-r,i.push([e[0],a]),i.push([n[0],a]);break;case"bottom":a=Math.max(e[1],n[1])+r,i.push([e[0],a]),i.push([n[0],a])}}else{const s=(t,e)=>({left:[e[0]-r,e[1]],right:[e[0]+r,e[1]],top:[e[0],e[1]-r],bottom:[e[0],e[1]+r]}[t]),l=s(t,e),c=s(a,n),u=Jp(l,c,o);i.push(l,u,c)}}return i}(t,u,h,i);return l&&(u=zg(l,d[0])),c&&(h=zg(c,d[d.length-1])),rg([u,...d,h],e)}function sg(t,e){const n=new Set,r=new Set,i=new Set;return t.forEach((o=>{e(o).forEach((e=>{n.add(e),t.includes(e.source)&&t.includes(e.target)?r.add(e):i.add(e)}))})),{edges:Array.from(n),internal:Array.from(r),external:Array.from(i)}}function lg(t,e){const n=[];let r=t;for(;r;){n.push(r);const t=e(xh(r));if(!t)break;r=t}if(n.some((t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed}))){const t=n.reverse().findIndex(Td);return n[t]||n.at(-1)}return t}const cg=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]];var ug=Object.freeze({__proto__:null,circle:(t,e)=>{const n=Math.max(t,e)/2;return[["M",-t/2,0],["A",n,n,0,1,0,2*n-t/2,0],["A",n,n,0,1,0,-t/2,0],["Z"]]},diamond:(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],rect:(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],simple:(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]],triangle:cg,triangleRect:(t,e)=>{const n=t/2,r=t/7,i=t-r;return[["M",-n,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-n,-e/2],["L",i+r-n,-e/2],["L",i+r-n,e/2],["L",i-n,e/2],["Z"]]},vee:(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]]}),hg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class dg extends lf{constructor(t){super(jd({style:dg.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{context:t,sourceNode:e}=this.parsedAttributes;return t.element.getElement(e)}get targetNode(){const{context:t,targetNode:e}=this.parsedAttributes;return t.element.getElement(e)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:n}=e,r=hg(e,["loop"]),{sourceNode:i,targetNode:o}=this,a=n&&(l=o,(s=i)&&l&&s===l)?this.getLoopPath(t):this.getKeyPath(t);var s,l;return Object.assign({d:a},Dd(r,["halo","label","startArrow","endArrow"]))}getLoopPath(t){const{sourcePort:e,targetPort:n}=t,r=this.sourceNode,i=Ju(r),o=Math.max(Xu(i),Ku(i)),{placement:a,clockwise:s,dist:l=o}=Cd(this.getGraphicStyle(t),"loop");return og(r,a,s,l,e,n)}getEndpoints(t,e=!0,n=[]){const{sourcePort:r,targetPort:i}=t,{sourceNode:o,targetNode:a}=this,[s,l]=function(t,e,n,r){const i=Fg(t,e,n,r),o=Fg(e,t,r,n);return[i,o]}(o,a,r,i);if(!e){return[s?jg(s):o.getCenter(),l?jg(l):a.getCenter()]}const c="function"==typeof n?n():n;return[Bg(s||o,c[0]||l||a),Bg(l||a,c[c.length-1]||s||o)]}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),n=Cd(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Cd(this.getGraphicStyle(t),"label"),{placement:n,offsetX:r,offsetY:i,autoRotate:o,maxWidth:a}=e,s=hg(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=Qp(this.shapeMap.key,n,o,r,i),c=this.shapeMap.key.getLocalBounds(),u=function(t,e,n=1){return Wd($h(t[0],t[1])*n,e)}([c.min,c.max],a);return Object.assign({wordWrapWidth:u},l,s)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;const e=Cd(t,"badge"),{offsetX:n,offsetY:r,placement:i}=e,o=hg(e,["offsetX","offsetY","placement"]);return Object.assign(o,function(t,e,n,r,i){var o,a;const s=2*(null===(o=t.badge)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])||0,l=2*(null===(a=t.label)||void 0===a?void 0:a.getGeometryBounds().halfExtents[0])||0;return Qp(t.key,n,!0,(l?(l/2+s/2)*("suffix"===e?1:-1):0)+r,i)}(this.shapeMap,i,t.labelPlacement,n,r))}drawArrow(t,e){var n;const r="start"===e,i=t["start"===e?"startArrow":"endArrow"],o=this.shapeMap.key;if(i){const n=this.getArrowStyle(t,r);if(!Bd(this,`arrow-${e}`,n))return;const[i,a,s]=r?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],l=o.parsedStyle[i];if(l)l.attr(n);else{const t=new(n.src?Vl:Hl)({style:n});o.style[i]=t}o.style[a]=t[s]||n.width/2+ +n.lineWidth}else{const t=r?"markerStart":"markerEnd";null===(n=o.style[t])||void 0===n||n.destroy(),o.style[t]=null}}getArrowStyle(t,e){const n=this.getShape("key").attributes,r=e?"startArrow":"endArrow",i=Cd(this.getGraphicStyle(t),r),{size:o,type:a}=i,s=hg(i,["size","type"]),[l,c]=Rd(function(t,e){return e||(t<4?10:4===t?12:2.5*t)}(n.lineWidth,o)),u=(Yt(a)?a:ug[a]||cg)(l,c);return Object.assign(Ce(n,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:c},Object.assign({},u&&{d:u,fill:"simple"===a?"":n.stroke}),s)}drawLabelShape(t,e){const n=this.getLabelStyle(t);Bd(this,"label",n)&&this.upsert("label",qd,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);Bd(this,"halo",n)&&this.upsert("halo",Hl,n,e)}drawBadgeShape(t,e){const n=this.getBadgeStyle(t);Bd(this,"badge",n)&&this.upsert("badge",Xd,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const n=this.getKeyStyle(t);if(Bd(this,"key",n))return this.upsert("key",Hl,n,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(t,e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then((()=>this.onframe())),Reflect.set(t,e,n))}):n}}dg.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class fg extends dg{constructor(t){super(jd({style:fg.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t),{controlPoints:r,curvePosition:i,curveOffset:o}=t,a=this.getControlPoints(e,n,function(t){return le(t)?[t,1-t]:t}(i),function(t){return le(t)?[t,-t]:t}(o),r);return ng(e,n,a)}getControlPoints(t,e,n,r,i){return 2===(null==i?void 0:i.length)?i:[eg(t,e,n[0],r[0]),eg(t,e,n[1],r[1])]}}fg.defaultStyleProps={curvePosition:.5,curveOffset:20};class pg extends fg{constructor(t){super(jd({style:pg.defaultStyleProps},t))}getControlPoints(t,e,n,r){const i=e[0]-t[0];return[[t[0]+i*n[0]+r[0],t[1]],[e[0]-i*n[1]+r[1],e[1]]]}}pg.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class gg extends fg{constructor(t){super(jd({style:gg.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=ed(this.ref);return[this.sourceNode.getIntersectPoint(e,!0),this.targetNode.getIntersectPoint(e)]}toRadialCoordinate(t){const e=ed(this.ref);return[$h(t,e),Zh(zh(t,e))]}getControlPoints(t,e,n,r){const[i,o]=this.toRadialCoordinate(t),[a]=this.toRadialCoordinate(e),s=a-i;return[[t[0]+(s*n[0]+r[0])*Math.cos(o),t[1]+(s*n[0]+r[0])*Math.sin(o)],[e[0]-(s*n[1]-r[0])*Math.cos(o),e[1]-(s*n[1]-r[0])*Math.sin(o)]]}}gg.defaultStyleProps={curvePosition:.5,curveOffset:20};class vg extends fg{constructor(t){super(jd({style:vg.defaultStyleProps},t))}getControlPoints(t,e,n,r){const i=e[1]-t[1];return[[t[0],t[1]+i*n[0]+r[0]],[e[0],e[1]-i*n[1]+r[1]]]}}vg.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let mg=class t extends dg{constructor(e){super(jd({style:t.defaultStyleProps},e))}getKeyPath(t){const[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}};mg.defaultStyleProps={};const yg={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Hh},bg=t=>`${Math.round(t[0])}|||${Math.round(t[1])}`;function xg(t,e){const n=t=>Math.round(t/e);return le(t)?n(t):t.map(n)}function Eg(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n||r?Math.atan2(r,n):0}function wg(t,e,n,r){const i=Eg(t,e),o=n[bg(t)];return function(t,e){const n=Math.abs(t-e);return n>Math.PI?2*Math.PI-n:n}(Eg(o||r,t),i)}function kg(t,e,n){return Math.min(...e.map((e=>n(t,e))))}const Mg=(t,e,n,r)=>{if(!e)return[t];const{directionMap:i,offset:o}=r,a=th(e.getRenderBounds(),o),s=Object.keys(i).reduce(((e,r)=>{if(n.includes(r)){const n=i[r],[o,s]=Zu(a),l=[t[0]+n.stepX*o,t[1]+n.stepY*s],c=function(t){const{min:[e,n],max:[r,i]}=t,o=[e,i],a=[r,i],s=[r,n],l=[e,n];return[[o,a],[a,s],[s,l],[l,o]]}(a);for(let n=0;n<c.length;n++){const r=Qh([t,l],c[n]);r&&rh(r,a)&&e.push(r)}}return e}),[]);return nh(t,a)||s.push(t),s.map((t=>xg(t,r.gridSize)))},Ng=(t,e,n,r,i,o,a)=>{const s=[];let l=[o[0]===r[0]?r[0]:t[0]*a,o[1]===r[1]?r[1]:t[1]*a];s.unshift(l);let c=t,u=e[bg(c)];for(;u;){const t=u,r=c;wg(t,r,e,n)&&(l=[t[0]===r[0]?l[0]:t[0]*a,t[1]===r[1]?l[1]:t[1]*a],s.unshift(l)),u=e[bg(t)],c=t}const h=i.map((t=>[t[0]*a,t[1]*a])),d=function(t,e,n){let r=t[0],i=n(t[0],e);for(let o=0;o<t.length;o++){const a=t[o],s=n(a,e);s<i&&(r=a,i=s)}return r}(h,l,Hh);return s.unshift(d),s};function Og(t,e,n,r){const i=Xh(t.getCenter()),o=Xh(e.getCenter()),a=Object.assign(yg,r),{gridSize:s}=a,l=((t,e)=>{const{offset:n,gridSize:r}=e,i={};return t.forEach((t=>{if(!t||t.destroyed||!t.isVisible())return;const e=th(t.getRenderBounds(),n);for(let t=xg(e.min[0],r);t<=xg(e.max[0],r);t+=1)for(let n=xg(e.min[1],r);n<=xg(e.max[1],r);n+=1)i[`${t}|||${n}`]=!0})),i})(a.enableObstacleAvoidance?n:[t,e],a),c=xg(i,s),u=xg(o,s),h=Mg(i,t,a.startDirections,a),d=Mg(o,e,a.endDirections,a);h.forEach((t=>delete l[bg(t)])),d.forEach((t=>delete l[bg(t)]));const f={},p={},g={},v={},m={},y=new Sg;for(let t=0;t<h.length;t++){const e=h[t],n=bg(e);f[n]=e,v[n]=0,m[n]=kg(e,d,a.distFunc),y.add({id:n,value:m[n]})}const b=d.map((t=>bg(t)));let x,E=a.maximumLoops,w=1/0;for(const[t,e]of Object.entries(f))m[t]<=w&&(w=m[t],x=e);for(;Object.keys(f).length>0&&E>0;){const t=y.minId(!1);if(!t)break;x=f[t];const e=bg(x);if(b.includes(e))return Ng(x,g,c,o,h,u,s);delete f[e],y.remove(e),p[e]=!0;for(const t of Object.values(a.directionMap)){const n=Bh(x,[t.stepX,t.stepY]),r=bg(n);if(p[r])continue;const i=wg(x,n,g,c);if(i>a.maxAllowedDirectionChange)continue;if(l[r])continue;f[r]||(f[r]=n);const o=a.penalties[i],u=a.distFunc(x,n)+(isNaN(o)?s:o),h=v[e]+u,b=v[r];b&&h>=b||(g[r]=x,v[r]=h,m[r]=h+kg(n,d,a.distFunc),y.add({id:r,value:m[r]}))}E-=1}return[]}class Sg{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let n=0,r=e-1;for(;r-n>1;){const e=Math.floor((n+r)/2);if(this.arr[e].value>t.value)r=e;else{if(!(this.arr[e].value<t.value))return this.arr.splice(e,0,t),void(this.map[t.id]=!0);n=e}}this.arr.splice(r,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value)return this.arr.push(t),void(this.map[t.id]=!0);this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}let Tg=class t extends dg{constructor(e){super(jd({style:t.defaultStyleProps},e))}getControlPoints(t){const{router:e}=t,{sourceNode:n,targetNode:r}=this,[i,o]=this.getEndpoints(t,!1);let a=[];if(e)if("shortest-path"===e.type){a=Og(n,r,this.context.element.getNodes(),e),a.length||(a=Gp(i,o,n,r,t.controlPoints,{padding:e.offset}))}else"orth"===e.type&&(a=Gp(i,o,n,r,t.controlPoints,e));else a=t.controlPoints;return a}getPoints(t){const e=this.getControlPoints(t),[n,r]=this.getEndpoints(t,!0,e);return[n,...e,r]}getKeyPath(t){return rg(this.getPoints(t),t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:n,radius:r}=t,i=this.sourceNode,o=Ju(i),a=Math.max(Xu(o),Ku(o))/4,{placement:s,clockwise:l,dist:c=a}=Cd(this.getGraphicStyle(t),"loop");return ag(i,r,s,l,c,e,n)}};Tg.defaultStyleProps={radius:0,controlPoints:[],router:!1};class _g extends dg{constructor(t){super(jd({style:_g.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:n}=t,[r,i]=this.getEndpoints(t);return function(t,e,n){return[["M",t[0],t[1]],["Q",n[0],n[1],e[0],e[1]]]}(r,i,t.controlPoint||eg(r,i,e,n))}}function Ag(t){return t instanceof uf&&"node"===t.type}function Cg(t){return t instanceof dg}function Pg(t){return t instanceof zp}_g.defaultStyleProps={curvePosition:.5,curveOffset:30};const Dg={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function Rg(t,e,n=Dg,r=!0){const i=[.5,.5],o=ie(e)?Te(n,e.toLocaleLowerCase(),i):e;if(!r&&ie(e))return o;const[a,s]=o||i;return[t.min[0]+Xu(t)*a,t.min[1]+Ku(t)*s]}function Lg(t){if(!t)return{};const e=t.getPorts();return(t.attributes.ports||[]).forEach(((n,r)=>{var i;const{key:o,placement:a}=n;Ig(n)&&(e[i=o||r]||(e[i]=rd(t.getShape("key").getBounds(),a)))})),e}function Ig(t){const{r:e}=t;return!e||0===Number(e)}function jg(t){return Hu(t)?t:t.getPosition()}function Fg(t,e,n,r){const i=Lg(t);if(n)return i[n];const o=Object.values(i);if(0===o.length)return;const a=o.map((t=>jg(t))),s=function(t,e){const n=Lg(t);if(e)return[jg(n[e])];const r=Object.values(n);return r.length>0?r.map((t=>jg(t))):[t.getCenter()]}(e,r),[l]=function(t,e){let n=1/0,r=[t[0],e[0]];return t.forEach((t=>{e.forEach((e=>{const i=$h(t,e);i<n&&(n=i,r=[t,e])}))})),r}(a,s);return o.find((t=>jg(t)===l))}function Bg(t,e){return Pg(t)||Ag(t)?Vg(t,e):zg(t,e)}function zg(t,e){if(!t||!e)return[0,0,0];if(Hu(t))return t;if(t.attributes.linkToCenter)return t.getPosition();return hd(Hu(e)?e:Ag(e)?e.getCenter():e.getPosition(),t.getBounds())}function Vg(t,e){if(!t||!e)return[0,0,0];const n=Hu(e)?e:Ag(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(n)||t.getCenter()}function Gg(t,e="bottom",n=0,r=0,i=!1){const o=e.split("-"),[a,s]=rd(t,e),l=o.includes("left")?"right":o.includes("right")?"left":"center";let c=o.includes("top")?"bottom":o.includes("bottom")?"top":"middle";return i&&(c="top"===c?"bottom":"bottom"===c?"top":c),{transform:[["translate",a+n,s+r]],textBaseline:c,textAlign:l}}function Wg(t,e){"update"in t?t.update(e):t.attr(e)}function $g(t){return Te(t,"__to_be_destroyed__",!1)}var Hg=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class Ug extends Ih{constructor(t,e){super(t,Object.assign({},Ug.defaultOptions,e)),this.onCollapseExpand=t=>Hg(this,void 0,void 0,(function*(){if(!this.validate(t))return;const{target:e}=t;if(!(Ag(n=e)||Cg(n)||Pg(n)))return;var n;const r=e.id,{model:i,graph:o}=this.context,a=i.getElementDataById(r);if(!a)return!1;const{onCollapse:s,onExpand:l,animation:c}=this.options;Td(a)?(yield o.expandElement(r,c),null==l||l(r)):(yield o.collapseElement(r,c),null==s||s(r))})),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}Ug.defaultOptions={enable:!0,animation:!0,trigger:mu.DBLCLICK};var Yg=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};const qg="g6-create-edge-assist-node-id";class Xg extends Ih{constructor(t,e){super(t,Object.assign({},Xg.defaultOptions,e)),this.drop=t=>Yg(this,void 0,void 0,(function*(){const{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()})),this.handleCreateEdge=t=>Yg(this,void 0,void 0,(function*(){var e,n,r;if(!this.validate(t))return;const{graph:i,canvas:o,batch:a,element:s}=this.context,{style:l}=this.options;if(this.source)return this.createEdge(t),void(yield this.cancelEdge());a.startBatch(),o.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0];const c=i.getElementData(this.source);i.addNodeData([{id:qg,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(e=c.style)||void 0===e?void 0:e.x,y:null===(n=c.style)||void 0===n?void 0:n.y}}]),i.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:qg,style:Object.assign({pointerEvents:"none"},l)}]),yield null===(r=s.draw({animation:!1}))||void 0===r?void 0:r.finished})),this.updateAssistEdge=t=>Yg(this,void 0,void 0,(function*(){var e;if(!this.source)return;const{model:n,element:r}=this.context;n.translateNodeTo(qg,[t.canvas.x,t.canvas.y]),yield null===(e=r.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished})),this.createEdge=t=>{var e,n;const{graph:r}=this.context,{style:i,onFinish:o,onCreate:a}=this.options;if(void 0===(null===(e=t.target)||void 0===e?void 0:e.id)||void 0===this.source)return;const s=null===(n=this.getSelectedNodeIDs([t.target.id]))||void 0===n?void 0:n[0];var l;const c=a({id:`${this.source}-${s}-${Re[l=l||"g"]?Re[l]+=1:Re[l]=1,l+Re[l]}`,source:this.source,target:s,style:i});r.addEdgeData([c]),o(c)},this.cancelEdge=()=>Yg(this,void 0,void 0,(function*(){var t;if(!this.source)return;const{graph:e,element:n,batch:r}=this.context;e.removeNodeData([qg]),this.source=void 0,yield null===(t=n.draw({animation:!1}))||void 0===t?void 0:t.finished,r.endBatch()})),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(wu.CLICK,this.handleCreateEdge),t.on(vu.CLICK,this.handleCreateEdge),t.on(gu.CLICK,this.cancelEdge),t.on(bu.CLICK,this.cancelEdge)):(t.on(wu.DRAG_START,this.handleCreateEdge),t.on(vu.DRAG_START,this.handleCreateEdge),t.on(mu.POINTER_UP,this.drop)),t.on(mu.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((t=>t.id)).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;t.off(wu.CLICK,this.handleCreateEdge),t.off(vu.CLICK,this.handleCreateEdge),t.off(gu.CLICK,this.cancelEdge),t.off(bu.CLICK,this.cancelEdge),t.off(wu.DRAG_START,this.handleCreateEdge),t.off(vu.DRAG_START,this.handleCreateEdge),t.off(mu.POINTER_UP,this.drop),t.off(mu.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Xg.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};var Kg=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class Zg extends Ih{constructor(t,e){super(t,Object.assign({},Zg.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{if(!this.isDragging)return;const{x:e,y:n}=t.movement;e|n&&this.translate([e,n],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=xe((()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)}),300),this.shortcut=new md(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(Kt(t)){const{up:e=[],down:n=[],left:r=[],right:i=[]}=t;this.shortcut.bind(e,(t=>this.onTranslate([0,1],t))),this.shortcut.bind(n,(t=>this.onTranslate([0,-1],t))),this.shortcut.bind(r,(t=>this.onTranslate([1,0],t))),this.shortcut.bind(i,(t=>this.onTranslate([-1,0],t)))}else{const{graph:t}=this.context;t.on(mu.DRAG_START,this.onDragStart),t.on(mu.DRAG,this.onDrag),t.on(mu.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return Kg(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{sensitivity:n}=this.options,r=-1*n;yield this.translate(Vh(t,r),this.options.animation),this.invokeOnFinish()}))}translate(t,e){return Kg(this,void 0,void 0,(function*(){t=this.clampByDirection(t),t=this.clampByRange(t),yield this.context.graph.translateBy(t,e)}))}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:r}=this.context,[i,o]=r.getSize(),[a,s,l,c]=Yu(this.options.range),u=[o*a,i*s,o*l,i*c],h=th(Qu(n.getCanvasCenter()),u),d=zh(n.getViewportCenter(),[t,e,0]);if(!nh(d,h)){const{min:[n,r],max:[i,o]}=h;(d[0]<n&&t>0||d[0]>i&&t<0)&&(t=0),(d[1]<r&&e>0||d[1]>o&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(mu.DRAG_START,this.onDragStart),t.off(mu.DRAG,this.onDrag),t.off(mu.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}Zg.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};var Jg=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class Qg extends Ih{constructor(t,e){super(t,Object.assign({},Qg.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>Jg(this,void 0,void 0,(function*(){var e;if("link"!==this.options.dropEffect)return;const{model:n,element:r}=this.context,i=t.target.id;this.target.forEach((t=>{const e=n.getParentData(t,ku);e&&xh(e)===i&&n.refreshComboData(i),n.setParent(t,i,ku)})),yield null===(e=null==r?void 0:r.draw({animation:!0}))||void 0===e?void 0:e.finished})),this.setCursor=t=>{if(this.isDragging)return;const{type:e}=t,{canvas:n}=this.context,{cursor:r}=this.options;e===mu.POINTER_ENTER?n.setCursor((null==r?void 0:r.grab)||"grab"):n.setCursor((null==r?void 0:r.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((e=>{t.on(`${e}:${mu.DRAG_START}`,this.onDragStart),t.on(`${e}:${mu.DRAG}`,this.onDrag),t.on(`${e}:${mu.DRAG_END}`,this.onDragEnd),t.on(`${e}:${mu.POINTER_ENTER}`,this.setCursor),t.on(`${e}:${mu.POINTER_LEAVE}`,this.setCursor)})),["link"].includes(this.options.dropEffect)&&(t.on(vu.DROP,this.onDrop),t.on(gu.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map((t=>t.id)).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return Gh([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:n,canvas:r}=this.context;r.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:t=0,y:e=0}=this.shadow.attributes,[n,r]=zh([+t,+e],this.shadowOrigin);this.moveElement(this.target,[n,r])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);const{batch:r,canvas:i}=this.context;r.endBatch(),i.setCursor((null===(n=this.options.cursor)||void 0===n?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}moveElement(t,e){return Jg(this,void 0,void 0,(function*(){const{graph:n,model:r}=this.context,{dropEffect:i}=this.options;"move"===i&&t.forEach((t=>r.refreshComboData(t))),n.translateElementBy(Object.fromEntries(t.map((t=>[t,e]))),!1)}))}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:n=0}=this.shadow.attributes,[r,i]=t;this.shadow.attr({x:+e+r,y:+n+i})}createShadow(t){const e=Cd(this.options,"shadow"),n=eh(t.map((t=>this.context.element.getElement(t).getBounds()))),[r,i]=n.min;this.shadowOrigin=[r,i];const[o,a]=Zu(n),s={width:o,height:a,x:r,y:i};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),s),{visibility:"visible"})):(this.shadow=new Kl({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),s),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;const{graph:n}=this.context;this.hiddenEdges="all"===t?n.getEdgeData().map(xh):Array.from(new Set(this.target.map((e=>n.getRelatedEdgesData(e,t).map(xh))).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t,canvas:e}=this.context,n=e.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach((e=>{t.off(`${e}:${mu.DRAG_START}`,this.onDragStart),t.off(`${e}:${mu.DRAG}`,this.onDrag),t.off(`${e}:${mu.DRAG_END}`,this.onDragEnd),t.off(`${e}:${mu.POINTER_ENTER}`,this.setCursor),t.off(`${e}:${mu.POINTER_LEAVE}`,this.setCursor)})),t.off(`combo:${mu.DROP}`,this.onDrop),t.off(`canvas:${mu.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}}Qg.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var tv=function(){function t(){this._events={}}return t.prototype.on=function(t,e,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!n}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this._events[t]||[],o=this._events["*"]||[],a=function(r){for(var i=r.length,o=0;o<i;o++)if(r[o]){var a=r[o],s=a.callback;a.once&&(r.splice(o,1),0===r.length&&delete e._events[t],i--,o--),s.apply(e,n)}};a(i),a(o)},t.prototype.off=function(t,e){if(t)if(e){for(var n=this._events[t]||[],r=n.length,i=0;i<r;i++)n[i].callback===e&&(n.splice(i,1),r--,i--);0===n.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function ev(t,e,n,r){for(;t.length;){const i=t.shift();if(n(i))return!0;e.add(i.id),r(i.id).forEach((n=>{e.has(n.id)||(e.add(n.id),t.push(n))}))}return!1}function nv(t,e,n,r){if(n(t))return!0;e.add(t.id);for(const i of r(t.id))if(!e.has(i.id)&&nv(i,e,n,r))return!0;return!1}const rv=()=>!0;class iv{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(t){this.graph=t.graph;const e=t.nodeFilter||rv,n=t.edgeFilter||rv;this.nodeFilter=e,this.edgeFilter=t=>{const{source:r,target:i}=this.graph.getEdgeDetail(t.id);return!(!e(r)||!e(i))&&n(t,r,i)},"auto"===t.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===t.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map((t=>t.id)))};updateCache=t=>{const e=new Set;t.forEach((t=>{const n=this.bothEdgesMap.get(t);if(n&&n.forEach((t=>e.add(t.id))),this.hasNode(t)){const n=this.graph.getRelatedEdges(t,"in").filter(this.edgeFilter),r=this.graph.getRelatedEdges(t,"out").filter(this.edgeFilter),i=Array.from(new Set([...n,...r]));i.forEach((t=>e.add(t.id))),this.inEdgesMap.set(t,n),this.outEdgesMap.set(t,r),this.bothEdgesMap.set(t,i),this.allNodesMap.set(t,this.graph.getNode(t))}else this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.bothEdgesMap.delete(t),this.allNodesMap.delete(t)})),e.forEach((t=>{this.hasEdge(t)?this.allEdgesMap.set(t,this.graph.getEdge(t)):this.allEdgesMap.delete(t)}))};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}handleGraphChanged=t=>{const e=new Set;t.changes.forEach((n=>{switch(n.type){case"NodeAdded":case"NodeRemoved":e.add(n.value.id);break;case"NodeDataUpdated":e.add(n.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(n.value.source),e.add(n.value.target);break;case"EdgeUpdated":"source"!==n.propertyName&&"target"!==n.propertyName||(e.add(n.oldValue),e.add(n.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(n.id)){const r=t.graph.getEdge(n.id);e.add(r.source),e.add(r.target)}}})),this.updateCache(e)};checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),this.cacheEnabled)return"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t);return this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const n=this.graph.getParent(t,e);return n&&this.nodeFilter(n)?n:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];ev([this.getNode(t)],new Set,e,r)}dfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];nv(this.getNode(t),new Set,e,r)}}let ov=class t extends tv{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach((t=>{switch(t.type){case"NodeRemoved":{let n=!1;e=e.filter((e=>{if("NodeAdded"===e.type){const r=e.value.id===t.value.id;return r&&(n=!0),!r}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id})),n||e.push(t);break}case"EdgeRemoved":{let n=!1;e=e.filter((e=>{if("EdgeAdded"===e.type){const r=e.value.id===t.value.id;return r&&(n=!0),!r}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id})),n||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const n=e.findIndex((e=>e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName))),r=e[n];r?void 0!==t.propertyName?r.newValue=t.newValue:(e.splice(n,1),e.push(t)):e.push(t);break}case"TreeStructureDetached":e=e.filter((e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)),e.push(t);break;case"TreeStructureChanged":{const n=e.find((e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId));n?n.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}})),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some((e=>e.id===t))}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map((t=>this.getNode(t.target)));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map((t=>this.getNode(t.source)));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach((e=>{e.childrenMap.set(t.id,new Set)})),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch((()=>{for(const e of t)this.doAddNode(e)}))}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),n=this.bothEdgesMap.get(t);n?.forEach((t=>this.doRemoveEdge(t.id))),this.nodeMap.delete(t),this.treeIndices.forEach((n=>{n.childrenMap.get(t)?.forEach((t=>{n.parentMap.delete(t.id)}));const r=n.parentMap.get(t);r&&n.childrenMap.get(r.id)?.delete(e),n.parentMap.delete(t),n.childrenMap.delete(t)})),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch((()=>{t.forEach((t=>this.doRemoveNode(t)))}))}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,n){const r=this.getNode(t);this.batch((()=>{const i=r.data[e],o=n;r.data[e]=o,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:o})}))}mergeNodeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,n])=>{this.updateNodeDataProperty(t,e,n)}))}))}updateNodeData(...t){const e=t[0],n=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let r;if("function"==typeof t[1]){const e=t[1];r=e(n.data)}else"object"==typeof t[1]&&(r=t[1]);this.batch((()=>{const t=n.data,i=r;n.data=r,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:i})}))}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),r=this.bothEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),r.add(t),i.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch((()=>{for(const e of t)this.doAddEdge(e)}))}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),n=this.outEdgesMap.get(e.source),r=this.inEdgesMap.get(e.target),i=this.bothEdgesMap.get(e.source),o=this.bothEdgesMap.get(e.target);n.delete(e),r.delete(e),i.delete(e),o.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch((()=>{t.forEach((t=>this.doRemoveEdge(t)))}))}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const r=n.source,i=e;this.outEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.outEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.source=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:r,newValue:i})}))}updateEdgeTarget(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const r=n.target,i=e;this.inEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.inEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.target=e,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:r,newValue:i})}))}updateEdgeDataProperty(t,e,n){const r=this.getEdge(t);this.batch((()=>{const i=r.data[e],o=n;r.data[e]=o,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:o})}))}updateEdgeData(...t){const e=t[0],n=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let r;if("function"==typeof t[1]){const e=t[1];r=e(n.data)}else"object"==typeof t[1]&&(r=t[1]);this.batch((()=>{const t=n.data,i=r;n.data=r,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:i})}))}mergeEdgeData(t,e){this.batch((()=>{Object.entries(e).forEach((([e,n])=>{this.updateEdgeDataProperty(t,e,n)}))}))}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})})))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})}))}addTree(t,e){this.batch((()=>{this.attachTreeStructure(e);const n=[],r=Array.isArray(t)?t:[t];for(;r.length;){const t=r.shift();n.push(t),t.children&&r.push(...t.children)}this.addNodes(n),n.forEach((t=>{t.children?.forEach((n=>{this.setParent(n.id,t.id,e)}))}))}))}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter((e=>!this.getParent(e.id,t)))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}getParent(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);return this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const n=[];let r,i=this.getNode(t);for(;r=this.getParent(i.id,e);)n.push(r),i=r;return n}setParent(t,e,n){this.checkTreeExistence(n);const r=this.treeIndices.get(n),i=this.getNode(t),o=r.parentMap.get(t);if(o?.id===e)return;if(void 0===e)return o&&r.childrenMap.get(o.id)?.delete(i),void r.parentMap.delete(t);const a=this.getNode(e);r.parentMap.set(t,a),o&&r.childrenMap.get(o.id)?.delete(i);let s=r.childrenMap.get(a.id);s||(s=new Set,r.childrenMap.set(a.id,s)),s.add(i),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:o?.id,newParentId:a.id})}))}dfsTree(t,e,n){return nv(this.getNode(t),new Set,e,(t=>this.getChildren(t,n)))}bfsTree(t,e,n){return ev([this.getNode(t)],new Set,e,(t=>this.getChildren(t,n)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return ev([this.getNode(t)],new Set,e,r)}dfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return nv(this.getNode(t),new Set,e,r)}clone(){const e=this.getAllNodes().map((t=>({...t,data:{...t.data}}))),n=this.getAllEdges().map((t=>({...t,data:{...t.data}}))),r=new t({nodes:e,edges:n});return this.treeIndices.forEach((({parentMap:t,childrenMap:e},n)=>{const i=new Map;t.forEach(((t,e)=>{i.set(e,r.getNode(t.id))}));const o=new Map;e.forEach(((t,e)=>{o.set(e,new Set(Array.from(t).map((t=>r.getNode(t.id)))))})),r.treeIndices.set(n,{parentMap:i,childrenMap:o})})),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new iv({graph:this,...t})}};class av{constructor(t,e){this.context=t,this.options=e||{}}}var sv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},lv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function cv(t){const{nodes:e,edges:n}=t,r={nodes:[],edges:[],combos:[]};return e.forEach((t=>{const e=t.data._isCombo?r.combos:r.nodes,{x:n,y:i,z:o=0}=t.data;null==e||e.push({id:t.id,style:{x:n,y:i,z:o}})})),n.forEach((t=>{const{id:e,source:n,target:i,data:{points:o=[],controlPoints:a=o.slice(1,o.length-1)}}=t;r.edges.push({id:e,source:n,target:i,style:Object.assign({},(null==a?void 0:a.length)?{controlPoints:a.map(id)}:{})})})),r}function uv(t,e,...n){if(e in t)return t[e](...n);if("instance"in t){const r=t.instance;if(e in r)return r[e](...n)}return null}function hv(t,e){if(e in t)return t[e];if("instance"in t){const n=t.instance;if(e in n)return n[e]}return null}var dv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};var fv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class pv extends Ih{constructor(t,e){super(t,Object.assign({},pv.defaultOptions,e)),this.isZoomEvent=t=>Boolean(t.data&&"scale"in t.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=t=>fv(this,void 0,void 0,(function*(){if(!this.validate(t))return;const{graph:e}=this.context,{state:n,nodeFilter:r,edgeFilter:i,comboFilter:o}=this.options,a=(n?e.getElementDataByState("node",n):e.getNodeData()).filter(r),s=(n?e.getElementDataByState("edge",n):e.getEdgeData()).filter(i),l=(n?e.getElementDataByState("combo",n):e.getComboData()).filter(o),c=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,u=[...a,...l];u.length>0&&u.forEach((t=>this.fixNodeLike(t,c))),this.updateRelatedEdges(),s.length>0&&s.forEach((t=>this.fixEdge(t,c)))})),this.cachedStyles=new Map,this.getOriginalFieldValue=(t,e,n)=>{var r;const i=this.cachedStyles.get(t)||[],o=(null===(r=i.find((t=>t.shape===e)))||void 0===r?void 0:r.style)||{};return n in o||(o[n]=e.attributes[n],this.cachedStyles.set(t,[...i.filter((t=>t.shape!==e)),{shape:e,style:o}])),o[n]},this.scaleEntireElement=(t,e,n)=>{e.setLocalScale(1/n);const r=this.cachedStyles.get(t)||[];r.push({shape:e}),this.cachedStyles.set(t,r)},this.scaleSpecificShapes=(t,e,n)=>{const r=function(t){const e=[],n=t=>{(null==t?void 0:t.children.length)&&t.children.forEach((t=>{e.push(t),n(t)}))};return n(t),e}(t);(Array.isArray(n)?n:[n]).forEach((n=>{const{shape:i,fields:o}=n,a="function"==typeof i?i(r):t.getShape(i);a&&(o?o.forEach((n=>{const r=this.getOriginalFieldValue(t.id,a,n);le(r)&&(a.style[n]=r/e)})):this.scaleEntireElement(t.id,a,e))}))},this.skipIfExceedViewport=t=>{const{viewport:e}=this.context;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},this.fixNodeLike=(t,e)=>{const n=xh(t),{element:r,model:i}=this.context,o=r.getElement(n);if(!o||this.skipIfExceedViewport(o))return;i.getRelatedEdgesData(n).forEach((t=>this.relatedEdgeToUpdate.add(xh(t))));const a=this.options[o.type];a?this.scaleSpecificShapes(o,e,a):this.scaleEntireElement(n,o,e)},this.fixEdge=(t,e)=>{const n=xh(t),r=this.context.element.getElement(n);if(!r||this.skipIfExceedViewport(r))return;const i=this.options.edge;if(!i)return r.style.transformOrigin="center",void this.scaleEntireElement(n,r,e);this.scaleSpecificShapes(r,e,i)},this.updateRelatedEdges=()=>{const{element:t}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach((e=>{const n=t.getElement(e);null==n||n.update({})})),this.relatedEdgeToUpdate.clear()},this.resetTransform=t=>fv(this,void 0,void 0,(function*(){var e;(null===(e=t.data)||void 0===e?void 0:e.firstRender)||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))})),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach((t=>{t.forEach((({shape:t,style:e})=>{if(Oe(e))t.setLocalScale(1);else{if(this.options.state)return;Object.entries(e).forEach((([e,n])=>t.style[e]=n))}}))}));const{graph:t,element:e}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter((e=>e&&"node"===t.getElementType(e)));if(n.length>0){const r=new Set;n.forEach((e=>{t.getRelatedEdgesData(e).forEach((t=>r.add(xh(t))))})),r.forEach((t=>{const n=null==e?void 0:e.getElement(t);null==n||n.update({})}))}}}bindEvents(){const{graph:t}=this.context;t.on(xu.AFTER_DRAW,this.resetTransform),t.on(xu.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:t}=this.context;t.off(xu.AFTER_DRAW,this.resetTransform),t.off(xu.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}pv.defaultOptions={enable:t=>t.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var gv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class vv extends Ih{constructor(t,e){super(t,Object.assign({},vv.defaultOptions,e)),this.focus=t=>gv(this,void 0,void 0,(function*(){if(!this.validate(t))return;const{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)})),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ed.forEach((e=>{t.on(`${e}:${mu.CLICK}`,this.focus)}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ed.forEach((e=>{t.off(`${e}:${mu.CLICK}`,this.focus)}))}destroy(){this.unbindEvents(),super.destroy()}}vv.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class mv extends Ih{constructor(t,e){super(t,Object.assign({},mv.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;const e=t.type===mu.POINTER_ENTER;this.updateElementsState(t,e);const{onHover:n,onHoverEnd:r}=this.options;e?null==n||n(t):null==r||r(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:n}=this.context,{state:r,animation:i,inactiveState:o}=this.options,a=this.getActiveIds(t),s={};if(r&&Object.assign(s,this.getElementsState(a,r,e)),o){const t=wh(n.getData(),!0).filter((t=>!a.includes(t)));Object.assign(s,this.getElementsState(t,o,e))}n.setElementState(s,i)},this.getElementsState=(t,e,n)=>{const{graph:r}=this.context,i={};return t.forEach((t=>{const o=r.getElementState(t);i[t]=n?o.includes(e)?o:[...o,e]:o.filter((t=>t!==e))})),i},this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Ed.forEach((e=>{t.on(`${e}:${mu.POINTER_ENTER}`,this.hoverElement),t.on(`${e}:${mu.POINTER_LEAVE}`,this.hoverElement)}));const e=this.context.canvas.document;e.addEventListener(`${mu.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${mu.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:n,direction:r}=this.options,i=t.target.id;return n?kd(e,t.targetType,i,"function"==typeof n?n(t):n,r):[i]}validate(t){if(this.destroyed||this.isFrozen||$g(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}unbindEvents(){const{graph:t}=this.context;Ed.forEach((e=>{t.off(`${e}:${mu.POINTER_ENTER}`,this.hoverElement),t.off(`${e}:${mu.POINTER_LEAVE}`,this.hoverElement)}));const e=this.context.canvas.document;e.removeEventListener(`${mu.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${mu.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}mv.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class yv extends Ih{constructor(t,e){super(t,Object.assign({},yv.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(t,e,n)=>{t.filter(Boolean).forEach((t=>{"hidden"!==e||t.isVisible()?"visible"===e&&this.hiddenShapes.includes(t)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(t),1):Dh(t,e,!1,n):this.hiddenShapes.push(t)}))},this.filterShapes=(t,e)=>{if(Yt(e))return n=>!e(t,n);const n=null==e?void 0:e[t];return t=>!t.className||!(null==n?void 0:n.includes(t.className))},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;const{element:e}=this.context,{shapes:n={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",this.filterShapes("node",n)),this.setElementsVisibility(e.getEdges(),"hidden",this.filterShapes("edge",n)),this.setElementsVisibility(e.getCombos(),"hidden",this.filterShapes("combo",n)),this.isVisible=!1},this.showShapes=xe((t=>{if(!this.validate(t)||this.isVisible)return;const{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0}),this.options.debounce),this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(xu.BEFORE_TRANSFORM,this.hideShapes),t.on(xu.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(xu.BEFORE_TRANSFORM,this.hideShapes),t.off(xu.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}yv.defaultOptions={enable:!0,debounce:200,shapes:t=>"node"===t};var bv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class xv extends Ih{constructor(t,e){super(t,Object.assign({},xv.defaultOptions,e)),this.onWheel=t=>bv(this,void 0,void 0,(function*(){this.options.preventDefault&&t.preventDefault();const e=t.deltaX,n=t.deltaY;yield this.scroll([-e,-n],t)})),this.shortcut=new md(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Kt(n)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(mu.WHEEL,this.onWheel);const{up:e=[],down:r=[],left:i=[],right:o=[]}=n;this.shortcut.bind(e,(t=>this.scroll([0,-10],t))),this.shortcut.bind(r,(t=>this.scroll([0,10],t))),this.shortcut.bind(i,(t=>this.scroll([-10,0],t))),this.shortcut.bind(o,(t=>this.scroll([10,0],t)))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(mu.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=Vh(t,e),t=this.clampByDirection(t),t=this.clampByRange(t)}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:r}=this.context,[i,o]=r.getSize(),[a,s,l,c]=Yu(this.options.range),u=[o*a,i*s,o*l,i*c],h=th(Qu(n.getCanvasCenter()),u),d=zh(n.getViewportCenter(),[t,e,0]);if(!nh(d,h)){const{min:[n,r],max:[i,o]}=h;(d[0]<n&&t>0||d[0]>i&&t<0)&&(t=0),(d[1]<r&&e>0||d[1]>o&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return bv(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{onFinish:n}=this.options,r=this.context.graph,i=this.formatDisplacement(t);yield r.translateBy(i,!1),null==n||n()}))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(mu.WHEEL,this.onWheel),super.destroy()}}xv.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var Ev,wv,kv,Mv,Nv,Ov,Sv,Tv,_v,Av,Cv,Pv,Dv,Rv,Lv,Iv,jv,Fv,Bv,zv,Vv,Gv,Wv,$v,Hv,Uv,Yv,qv,Xv=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class Kv extends Ih{constructor(t,e){super(t,Object.assign({},Kv.defaultOptions,e)),this.zoom=(t,e,n)=>Xv(this,void 0,void 0,(function*(){if(!this.validate(e))return;const{graph:r}=this.context;let i;"viewport"in e&&(i=id(e.viewport));const{sensitivity:o,onFinish:a}=this.options,s=1+se(t,-50,50)*o/100,l=r.getZoom();yield r.zoomTo(l*s,n,i),null==a||a()})),this.onReset=()=>Xv(this,void 0,void 0,(function*(){yield this.context.graph.zoomTo(1,this.options.animation)})),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new md(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t;const{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e)&&(null===(t=this.context.canvas.getContainer())||void 0===t||t.addEventListener(mu.WHEEL,this.preventDefault),this.shortcut.bind([...e,mu.WHEEL],(t=>{const{deltaX:e,deltaY:n}=t;this.zoom(-(null!=n?n:e),t,!1)}))),"object"==typeof e){const{zoomIn:t=[],zoomOut:n=[],reset:r=[]}=e;this.shortcut.bind(t,(t=>this.zoom(10,t,this.options.animation))),this.shortcut.bind(n,(t=>this.zoom(-10,t,this.options.animation))),this.shortcut.bind(r,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Yt(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(mu.WHEEL,this.preventDefault),super.destroy()}}function Zv(){if(wv)return Ev;return wv=1,Ev={assign:Object.assign,getHeight:function(t,e,n,r){return void 0===r&&(r="height"),"center"===n?(t[r]+e[r])/2:t.height}}}function Jv(){if(Mv)return kv;Mv=1;var t=Zv(),e={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function n(t,e){var r=this;if(r.vgap=r.hgap=0,t instanceof n)return t;r.data=t;var i=e.getHGap(t),o=e.getVGap(t);return r.preH=e.getPreH(t),r.preV=e.getPreV(t),r.width=e.getWidth(t),r.height=e.getHeight(t),r.width+=r.preH,r.height+=r.preV,r.id=e.getId(t),r.x=r.y=0,r.depth=0,r.children||(r.children=[]),r.addGap(i,o),r}return t.assign(n.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){var n=this;n.hgap+=t,n.vgap+=e,n.width+=2*t,n.height+=2*e},eachNode:function(t){for(var e,n=[this];e=n.shift();)t(e),n=e.children.concat(n)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,n=[this];e=n.shift();)t(e),n=n.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)})),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode((function(n){n.x+=t,n.y+=e,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.x=t.x-2*(t.x-e.left)-t.width})),t.translate(e.width,0)},bottom2top:function(){var t=this,e=t.getBoundingBox();t.eachNode((function(t){t.y=t.y-2*(t.y-e.top)-t.height})),t.translate(0,e.height)}}),kv=function(r,i,o){void 0===i&&(i={});var a,s=new n(r,i=t.assign({},e,i)),l=[s];if(!o&&!r.collapsed)for(;a=l.shift();)if(!a.data.collapsed){var c=i.getChildren(a.data),u=c?c.length:0;if(a.children=new Array(u),c&&u)for(var h=0;h<u;h++){var d=new n(c[h],i);a.children[h]=d,l.push(d),d.parent=a,d.depth=a.depth+1}}return s},kv}function Qv(){if(Ov)return Nv;Ov=1;var t=Jv(),e=function(){function e(e,n){void 0===n&&(n={});this.options=n,this.rootNode=t(e,n)}return e.prototype.execute=function(){throw new Error("please override this method")},e}();return Nv=e}function tm(){if(Tv)return Sv;function t(t,e,n,r){void 0===r&&(r=[]);var i=this;i.w=t||0,i.h=e||0,i.y=n||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}function e(t,n,r){r?t.y+=n:t.x+=n,t.children.forEach((function(t){e(t,n,r)}))}function n(t,e){var r=e?t.y:t.x;return t.children.forEach((function(t){r=Math.min(n(t,e),r)})),r}function r(t,r){e(t,-n(t,r),r)}function i(t,e,n){n?e.y=t.x:e.x=t.x,t.c.forEach((function(t,r){i(t,e.children[r],n)}))}function o(t,e,n){void 0===n&&(n=0),e?(t.x=n,n+=t.width):(t.y=n,n+=t.height),t.children.forEach((function(t){o(t,e,n)}))}return Tv=1,t.fromNode=function(e,n){if(!e)return null;var r=[];return e.children.forEach((function(e){r.push(t.fromNode(e,n))})),n?new t(e.height,e.width,e.x,r):new t(e.width,e.height,e.y,r)},Sv=function(e,n){void 0===n&&(n={});var a=n.isHorizontal;function s(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function l(t,e,n){for(var r=t.c[e-1],i=r.mod,o=t.c[e],a=o.mod;null!==r&&null!==o;){d(r)>n.low&&(n=n.nxt);var s=i+r.prelim+r.w-(a+o.prelim);s>0&&(a+=s,c(t,e,n.index,s));var l=d(r),f=d(o);l<=f&&null!==(r=h(r))&&(i+=r.mod),l>=f&&null!==(o=u(o))&&(a+=o.mod)}!r&&o?function(t,e,n,r){var i=t.c[0].el;i.tl=n;var o=r-n.mod-t.c[0].msel;i.mod+=o,i.prelim-=o,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,o,a):r&&!o&&function(t,e,n,r){var i=t.c[e].er;i.tr=n;var o=r-n.mod-t.c[e].mser;i.mod+=o,i.prelim-=o,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,r,i)}function c(t,e,n,r){t.c[e].mod+=r,t.c[e].msel+=r,t.c[e].mser+=r,function(t,e,n,r){if(n!==e-1){var i=e-n;t.c[n+1].shift+=r/i,t.c[e].shift-=r/i,t.c[e].change-=r-r/i}}(t,e,n,r)}function u(t){return 0===t.cs?t.tl:t.c[0]}function h(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function d(t){return t.y+t.h}function f(t,e,n){for(;null!==n&&t>=n.low;)n=n.nxt;return{low:t,index:e,nxt:n}}o(e,a);var p=t.fromNode(e,a);return function t(e){if(0!==e.cs){t(e.c[0]);for(var n=f(d(e.c[0].el),0,null),r=1;r<e.cs;++r){t(e.c[r]);var i=d(e.c[r].er);l(e,r,n),n=f(i,r,n)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(e),s(e)}else s(e)}(p),function t(e,n){n+=e.mod,e.x=e.prelim+n,function(t){for(var e=0,n=0,r=0;r<t.cs;r++)n+=(e+=t.c[r].shift)+t.c[r].change,t.c[r].mod+=n}(e);for(var r=0;r<e.cs;r++)t(e.c[r],n)}(p,0),i(p,e,a),r(e,a),e},Sv}function em(){if(Av)return _v;Av=1;var t=Jv();return _v=function(e,n){for(var r=t(e.data,n,!0),i=t(e.data,n,!0),o=e.children.length,a=Math.round(o/2),s=n.getSide||function(t,e){return e<a?"right":"left"},l=0;l<o;l++){var c=e.children[l];"right"===s(c,l)?i.children.push(c):r.children.push(c)}return r.eachNode((function(t){t.isRoot()||(t.side="left")})),i.eachNode((function(t){t.isRoot()||(t.side="right")})),{left:r,right:i}},_v}function nm(){if(Pv)return Cv;Pv=1;var t=em(),e=["LR","RL","TB","BT","H","V"],n=["LR","RL","H"],r=e[0];return Cv=function(i,o,a){var s=o.direction||r;if(o.isHorizontal=function(t){return n.indexOf(t)>-1}(s),s&&-1===e.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===e[0])a(i,o);else if(s===e[1])a(i,o),i.right2left();else if(s===e[2])a(i,o);else if(s===e[3])a(i,o),i.bottom2top();else if(s===e[4]||s===e[5]){var l=t(i,o),c=l.left,u=l.right;a(c,o),a(u,o),o.isHorizontal?c.right2left():c.bottom2top(),u.translate(c.x-u.x,c.y-u.y),i.x=c.x,i.y=u.y;var h=i.getBoundingBox();o.isHorizontal?h.top<0&&i.translate(0,-h.top):h.left<0&&i.translate(-h.left,0)}var d=o.fixedRoot;return void 0===d&&(d=!0),d&&i.translate(-(i.x+i.width/2+i.hgap),-(i.y+i.height/2+i.vgap)),function(t,e){if(e.radial){var n=e.isHorizontal?["x","y"]:["y","x"],r=n[0],i=n[1],o={x:1/0,y:1/0},a={x:-1/0,y:-1/0},s=0;t.DFTraverse((function(t){s++;var e=t.x,n=t.y;o.x=Math.min(o.x,e),o.y=Math.min(o.y,n),a.x=Math.max(a.x,e),a.y=Math.max(a.y,n)}));var l=a[i]-o[i];if(0===l)return;var c=2*Math.PI/s;t.DFTraverse((function(e){var n=(e[i]-o[i])/l*(2*Math.PI-c)+c,a=e[r]-t[r];e.x=Math.cos(n)*a,e.y=Math.sin(n)*a}))}}(i,o),i},Cv}function rm(){if(Rv)return Dv;function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}Rv=1;var e=Qv(),n=tm(),r=nm(),i=Zv(),o=function(e){function i(){return e.apply(this,arguments)||this}var o,a;return a=e,(o=i).prototype=Object.create(a.prototype),o.prototype.constructor=o,t(o,a),i.prototype.execute=function(){return r(this.rootNode,this.options,n)},i}(e),a={};return Dv=function(t,e){return e=i.assign({},a,e),new o(t,e).execute()},Dv}function im(){if(Iv)return Lv;Iv=1;var t=Zv();function e(t,e){void 0===e&&(e=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=e}var n={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function r(t,e,n){n?(e.x=t.x,e.y=t.y):(e.x=t.y,e.y=t.x),t.children.forEach((function(t,i){r(t,e.children[i],n)}))}return Lv=function(i,o){void 0===o&&(o={}),o=t.assign({},n,o);var a,s=0;var l=function t(n){if(!n)return null;n.width=0,n.depth&&n.depth>s&&(s=n.depth);var r=n.children,i=r.length,o=new e(n.height,[]);return r.forEach((function(e,n){var r=t(e);o.children.push(r),0===n&&(o.leftChild=r),n===i-1&&(o.rightChild=r)})),o.originNode=n,o.isLeaf=n.isLeaf(),o}(i);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=s;else{var n=e.children.map((function(e){return t(e)})),r=Math.min.apply(null,n);e.drawingDepth=r-1}return e.drawingDepth}(l),function t(e){e.x=e.drawingDepth*o.rankSep,e.isLeaf?(e.y=0,a&&(e.y=a.y+a.height+o.nodeSep,e.originNode.parent!==a.originNode.parent&&(e.y+=o.subTreeSep)),a=e):(e.children.forEach((function(e){t(e)})),e.y=(e.leftChild.y+e.rightChild.y)/2)}(l),r(l,i,o.isHorizontal),i},Lv}function om(){if(Fv)return jv;function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}Fv=1;var e=Qv(),n=im(),r=nm(),i=Zv(),o=function(e){function i(){return e.apply(this,arguments)||this}var o,a;return a=e,(o=i).prototype=Object.create(a.prototype),o.prototype.constructor=o,t(o,a),i.prototype.execute=function(){var t=this;return t.rootNode.width=0,r(t.rootNode,t.options,n)},i}(e),a={};return jv=function(t,e){return e=i.assign({},a,e),new o(t,e).execute()},jv}function am(){if(zv)return Bv;zv=1;var t=Zv();return Bv=function(e,n,r,i){var o=null;e.eachNode((function(e){!function(e,n,r,i,o){var a=("function"==typeof r?r(e):r)*e.depth;if(!i)try{if(e.id===e.parent.children[0].id)return e.x+=a,void(e.y=n?n.y:0)}catch(t){}if(e.x+=a,n){if(e.y=n.y+t.getHeight(n,e,o),n.parent&&e.parent.id!==n.parent.id){var s=n.parent,l=s.y+t.getHeight(s,e,o);e.y=l>e.y?l:e.y}}else e.y=0}(e,o,n,r,i),o=e}))},Bv}function sm(){if(Gv)return Vv;function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}Gv=1;var e=Qv(),n=am(),r=em(),i=Zv(),o=["LR","RL","H"],a=o[0],s=function(e){function i(){return e.apply(this,arguments)||this}var s,l;return l=e,(s=i).prototype=Object.create(l.prototype),s.prototype.constructor=s,t(s,l),i.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var i=t.indent,s=void 0===i?20:i,l=t.dropCap,c=void 0===l||l,u=t.direction,h=void 0===u?a:u,d=t.align;if(h&&-1===o.indexOf(h))throw new TypeError("Invalid direction: "+h);if(h===o[0])n(e,s,c,d);else if(h===o[1])n(e,s,c,d),e.right2left();else if(h===o[2]){var f=r(e,t),p=f.left,g=f.right;n(p,s,c,d),p.right2left(),n(g,s,c,d);var v=p.getBoundingBox();g.translate(v.width,0),e.x=g.x-e.width/2}return e},i}(e),l={};return Vv=function(t,e){return e=i.assign({},l,e),new s(t,e).execute()},Vv}function lm(){if($v)return Wv;$v=1;var t=Zv();function e(t,n){var r=0;return t.children.length?t.children.forEach((function(t){r+=e(t,n)})):r=t.height,t._subTreeSep=n.getSubTreeSep(t.data),t.totalHeight=Math.max(t.height,r)+2*t._subTreeSep,t.totalHeight}function n(t){var e=t.children,r=e.length;if(r){e.forEach((function(t){n(t)}));var i=e[0],o=e[r-1],a=o.y-i.y+o.height,s=0;if(e.forEach((function(t){s+=t.totalHeight})),a>t.height)t.y=i.y+a/2-t.height/2;else if(1!==e.length||t.height>s){var l=t.y+(t.height-a)/2-i.y;e.forEach((function(t){t.translate(0,l)}))}else t.y=(i.y+i.height/2+o.y+o.height/2)/2-t.height/2}}var r={getSubTreeSep:function(){return 0}};return Wv=function(i,o){void 0===o&&(o={}),o=t.assign({},r,o),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse((function(t){t.x=t.parent.x+t.parent.width})),i.parent=null,e(i,o),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode((function(t){var e=t.children,n=e.length;if(n){var r=e[0];if(r.startY=t.startY+t._subTreeSep,1===n)r.y=t.y+t.height/2-r.height/2;else{r.y=r.startY+r.totalHeight/2-r.height/2;for(var i=1;i<n;i++){var o=e[i];o.startY=e[i-1].startY+e[i-1].totalHeight,o.y=o.startY+o.totalHeight/2-o.height/2}}}})),n(i)},Wv}function cm(){if(Uv)return Hv;function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}Uv=1;var e=Qv(),n=lm(),r=nm(),i=Zv(),o=function(e){function i(){return e.apply(this,arguments)||this}var o,a;return a=e,(o=i).prototype=Object.create(a.prototype),o.prototype.constructor=o,t(o,a),i.prototype.execute=function(){return r(this.rootNode,this.options,n)},i}(e),a={};return Hv=function(t,e){return e=i.assign({},a,e),new o(t,e).execute()},Hv}Kv.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var um=function(){if(qv)return Yv;qv=1;var t={compactBox:rm(),dendrogram:om(),indented:sm(),mindmap:cm()};return Yv=t}();const hm=(t,e)=>{if("next"!==t&&"prev"!==t)return e},dm=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};let fm=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return dm(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&dm(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let n=e.prev;for(;n!==e;)t.push(JSON.stringify(n,hm)),n=null==n?void 0:n.prev;return`[${t.join(", ")}]`}};class pm extends fm{}const gm=()=>1,vm=(t,e,n)=>{let r=[];const i=e[e.length-1],o=e[0];let a;for(;t.getAllNodes().length;){for(;a=o.dequeue();)mm(t,e,n,a);for(;a=i.dequeue();)mm(t,e,n,a);if(t.getAllNodes().length)for(let i=e.length-2;i>0;--i)if(a=e[i].dequeue(),a){r=r.concat(mm(t,e,n,a,!0));break}}return r},mm=(t,e,n,r,i)=>{var o,a;const s=[];return t.hasNode(r.v)&&(null===(o=t.getRelatedEdges(r.v,"in"))||void 0===o||o.forEach((r=>{const o=r.data.weight,a=t.getNode(r.source);i&&s.push({v:r.source,w:r.target,in:0,out:0}),void 0===a.data.out&&(a.data.out=0),a.data.out-=o,bm(e,n,Object.assign({v:a.id},a.data))})),null===(a=t.getRelatedEdges(r.v,"out"))||void 0===a||a.forEach((r=>{const i=r.data.weight,o=r.target,a=t.getNode(o);void 0===a.data.in&&(a.data.in=0),a.data.in-=i,bm(e,n,Object.assign({v:a.id},a.data))})),t.removeNode(r.v)),i?s:void 0},ym=(t,e)=>{const n=new ov;let r=0,i=0;t.getAllNodes().forEach((t=>{n.addNode({id:t.id,data:{v:t.id,in:0,out:0}})})),t.getAllEdges().forEach((t=>{const o=n.getRelatedEdges(t.source,"out").find((e=>e.target===t.target)),a=(null==e?void 0:e(t))||1;o?n.updateEdgeData(null==o?void 0:o.id,Object.assign(Object.assign({},o.data),{weight:o.data.weight+a})):n.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:a}}),i=Math.max(i,n.getNode(t.source).data.out+=a),r=Math.max(r,n.getNode(t.target).data.in+=a)}));const o=[],a=i+r+3;for(let t=0;t<a;t++)o.push(new pm);const s=r+1;return n.getAllNodes().forEach((t=>{bm(o,s,Object.assign({v:t.id},n.getNode(t.id).data))})),{buckets:o,zeroIdx:s,graph:n}},bm=(t,e,n)=>{n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)},xm=(t,e)=>{const n="greedy"===e?((t,e)=>{var n;if(t.getAllNodes().length<=1)return[];const r=ym(t,e||gm);return null===(n=vm(r.graph,r.buckets,r.zeroIdx).map((e=>t.getRelatedEdges(e.v,"out").filter((({target:t})=>t===e.w)))))||void 0===n?void 0:n.flat()})(t,(t=>t.data.weight||1)):Em(t);null==n||n.forEach((e=>{const n=e.data;t.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},n)})}))},Em=t=>{const e=[],n={},r={},i=o=>{r[o]||(r[o]=!0,n[o]=!0,t.getRelatedEdges(o,"out").forEach((t=>{n[t.target]?e.push(t):i(t.target)})),delete n[o])};return t.getAllNodes().forEach((t=>i(t.id))),e},wm=(t,e,n,r)=>{let i;do{i=`${r}${Math.random()}`}while(t.hasNode(i));return n.dummy=e,t.addNode({id:i,data:n}),i},km=t=>{const e=new ov;return t.getAllNodes().forEach((n=>{t.getChildren(n.id).length||e.addNode(Object.assign({},n))})),t.getAllEdges().forEach((t=>{e.addEdge(t)})),e},Mm=(t,e)=>{const n=Number(t.x),r=Number(t.y),i=Number(e.x)-n,o=Number(e.y)-r;let a,s,l=Number(t.width)/2,c=Number(t.height)/2;return i||o?(Math.abs(o)*l>Math.abs(i)*c?(o<0&&(c=-c),a=c*i/o,s=c):(i<0&&(l=-l),a=l,s=l*o/i),{x:n+a,y:r+s}):{x:0,y:0}},Nm=t=>{const e=[],n=Sm(t)+1;for(let t=0;t<n;t++)e.push([]);t.getAllNodes().forEach((t=>{const n=t.data.rank;void 0!==n&&e[n]&&e[n].push(t.id)}));for(let r=0;r<n;r++)e[r]=e[r].sort(((e,n)=>{return r=t.getNode(e).data.order,i=t.getNode(n).data.order,Number(r)-Number(i);var r,i}));return e},Om=(t,e,n,r)=>{const i={width:0,height:0};return le(n)&&le(r)&&(i.rank=n,i.order=r),wm(t,"border",i,e)},Sm=t=>{let e;return t.getAllNodes().forEach((t=>{const n=t.data.rank;void 0!==n&&(void 0===e||n>e)&&(e=n)})),e||(e=0),e},Tm=(t,e)=>t.reduce(((t,n)=>e(t)>e(n)?n:t)),_m=(t,e,n,r,i,o)=>{r.includes(e.id)||(r.push(e.id),n||o.push(e.id),i(e.id).forEach((e=>_m(t,e,n,r,i,o))),n&&o.push(e.id))},Am=(t,e,n,r)=>{const i=Array.isArray(e)?e:[e],o=e=>t.getNeighbors(e),a=[],s=[];return i.forEach((e=>{if(!t.hasNode(e.id))throw new Error(`Graph does not have node: ${e}`);_m(t,e,"post"===n,s,o,a)})),a},Cm=(t,e,n,r,i,o)=>{const a={rank:o,borderType:e,width:0,height:0},s=i.data[e][o-1],l=wm(t,"border",a,n);i.data[e][o]=l,t.setParent(l,r),s&&t.addEdge({id:`e${Math.random()}`,source:s,target:l,data:{weight:1}})},Pm=t=>{t.getAllNodes().forEach((t=>{Dm(t)})),t.getAllEdges().forEach((t=>{Dm(t)}))},Dm=t=>{const e=t.data.width;t.data.width=t.data.height,t.data.height=e},Rm=t=>{t.getAllNodes().forEach((t=>{Lm(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>Lm(t))),t.data.hasOwnProperty("y")&&Lm(t.data)}))},Lm=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},Im=t=>{t.getAllNodes().forEach((t=>{jm(t.data)})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>jm(t))),t.data.hasOwnProperty("x")&&jm(t.data)}))},jm=t=>{const e=t.x;t.x=t.y,t.y=e},Fm=(t,e,n,r,i,o,a)=>{const s=t.getChildren(a);if(!(null==s?void 0:s.length))return void(a!==e&&t.addEdge({id:`e${Math.random()}`,source:e,target:a,data:{weight:0,minlen:n}}));const l=Om(t,"_bt"),c=Om(t,"_bb"),u=t.getNode(a);t.setParent(l,a),u.data.borderTop=l,t.setParent(c,a),u.data.borderBottom=c,null==s||s.forEach((s=>{Fm(t,e,n,r,i,o,s.id);const u=s.data.borderTop?s.data.borderTop:s.id,h=s.data.borderBottom?s.data.borderBottom:s.id,d=s.data.borderTop?r:2*r,f=u!==h?1:i-o[a]+1;t.addEdge({id:`e${Math.random()}`,source:l,target:u,data:{minlen:f,weight:d,nestingEdge:!0}}),t.addEdge({id:`e${Math.random()}`,source:h,target:c,data:{minlen:f,weight:d,nestingEdge:!0}})})),t.getParent(a)||t.addEdge({id:`e${Math.random()}`,source:e,target:l,data:{weight:0,minlen:i+o[a]}})},Bm=t=>{const e={},n=(r,i)=>{const o=t.getChildren(r);null==o||o.forEach((t=>n(t.id,i+1))),e[r]=i};return t.getRoots().forEach((t=>n(t.id,1))),e},zm=t=>{let e=0;return t.getAllEdges().forEach((t=>{e+=t.data.weight})),e},Vm="edge-label",Gm=(t,e,n)=>{let r=e.source,i=t.getNode(r).data.rank;const o=e.target,a=t.getNode(o).data.rank,s=e.data.labelRank;if(a===i+1)return;let l,c,u;for(t.removeEdge(e.id),u=0,++i;i<a;++u,++i)e.data.points=[],c={originalEdge:e,width:0,height:0,rank:i},l=wm(t,"edge",c,"_d"),i===s&&(c.width=e.data.width,c.height=e.data.height,c.dummy=Vm,c.labelpos=e.data.labelpos),t.addEdge({id:`e${Math.random()}`,source:r,target:l,data:{weight:e.data.weight}}),0===u&&n.push(l),r=l;t.addEdge({id:`e${Math.random()}`,source:r,target:o,data:{weight:e.data.weight}})},Wm=t=>{let e;for(;t.hasNode(e=`_root${Math.random()}`););return e},$m=(t,e,n)=>{const r=((t,e)=>null==t?void 0:t.reduce(((t,n,r)=>(t[n]=e[r],t)),{}))(n,n.map(((t,e)=>e))),i=e.map((e=>{const n=t.getRelatedEdges(e,"out").map((t=>({pos:r[t.target]||0,weight:t.data.weight})));return null==n?void 0:n.sort(((t,e)=>t.pos-e.pos))})),o=i.flat().filter((t=>void 0!==t));let a=1;for(;a<n.length;)a<<=1;const s=2*a-1;a-=1;const l=Array(s).fill(0,0,s);let c=0;return null==o||o.forEach((t=>{if(t){let e=t.pos+a;l[e]+=t.weight;let n=0;for(;e>0;)e%2&&(n+=l[e+1]),e=e-1>>1,l[e]+=t.weight;c+=t.weight*n}})),c},Hm=(t,e)=>{let n=0;for(let r=1;r<(null==e?void 0:e.length);r+=1)n+=$m(t,e[r-1],e[r]);return n},Um=t=>{const e={},n=t.getAllNodes(),r=n.map((t=>{var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),i=Math.max(...r),o=[];for(let t=0;t<i+1;t++)o.push([]);const a=n.sort(((e,n)=>t.getNode(e.id).data.rank-t.getNode(n.id).data.rank)),s=a.filter((e=>void 0!==t.getNode(e.id).data.fixorder)).sort(((e,n)=>t.getNode(e.id).data.fixorder-t.getNode(n.id).data.fixorder));return null==s||s.forEach((n=>{isNaN(t.getNode(n.id).data.rank)||o[t.getNode(n.id).data.rank].push(n.id),e[n.id]=!0})),null==a||a.forEach((n=>t.dfsTree(n.id,(t=>{if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||o[t.data.rank].push(t.id)})))),o},Ym=t=>{var e,n;const r=[];for(;null==t?void 0:t.length;){const i=t.pop();r.push(i),null===(e=i.in.reverse())||void 0===e||e.forEach((t=>{return(e=i,t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&qm(e,t)})(t);var e})),null===(n=i.out)||void 0===n||n.forEach((e=>{return(n=i,e=>{e.in.push(n),0==--e.indegree&&t.push(e)})(e);var n}))}const i=r.filter((t=>!t.merged)),o=["vs","i","barycenter","weight"];return i.map((t=>{const e={};return null==o||o.forEach((n=>{void 0!==t[n]&&(e[n]=t[n])})),e}))},qm=(t,e)=>{var n;let r=0,i=0;t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),t.vs=null===(n=e.vs)||void 0===n?void 0:n.concat(t.vs),t.barycenter=r/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0},Xm=(t,e,n)=>{let r,i=n;for(;e.length&&(r=e[e.length-1]).i<=i;)e.pop(),null==t||t.push(r.vs),i++;return i},Km=(t,e)=>(n,r)=>{if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(e&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return t?r.i-n.i:n.i-r.i},Zm=(t,e,n,r,i,o)=>{var a,s,l,c;let u=t.getChildren(e).map((t=>t.id));const h=t.getNode(e),d=h?h.data.borderLeft:void 0,f=h?h.data.borderRight:void 0,p={};d&&(u=null==u?void 0:u.filter((t=>t!==d&&t!==f)));const g=((t,e)=>e.map((e=>{const n=t.getRelatedEdges(e,"in");if(!(null==n?void 0:n.length))return{v:e};const r={sum:0,weight:0};return null==n||n.forEach((e=>{const n=t.getNode(e.source);r.sum+=e.data.weight*n.data.order,r.weight+=e.data.weight})),{v:e,barycenter:r.sum/r.weight,weight:r.weight}})))(t,u||[]);null==g||g.forEach((e=>{var i;if(null===(i=t.getChildren(e.v))||void 0===i?void 0:i.length){const i=Zm(t,e.v,n,r,o);p[e.v]=i,i.hasOwnProperty("barycenter")&&Qm(e,i)}}));const v=((t,e)=>{var n,r,i;const o={};null==t||t.forEach(((t,e)=>{o[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};const n=o[t.v];void 0!==t.barycenter&&(n.barycenter=t.barycenter,n.weight=t.weight)})),null===(n=e.getAllEdges())||void 0===n||n.forEach((t=>{const e=o[t.source],n=o[t.target];void 0!==e&&void 0!==n&&(n.indegree++,e.out.push(o[t.target]))}));const a=null===(i=(r=Object.values(o)).filter)||void 0===i?void 0:i.call(r,(t=>!t.indegree));return Ym(a)})(g,n);Jm(v,p),null===(a=v.filter((t=>t.vs.length>0)))||void 0===a||a.forEach((e=>{const n=t.getNode(e.vs[0]);n&&(e.fixorder=n.data.fixorder,e.order=n.data.order)}));const m=((t,e,n,r)=>{const i=((t,e)=>{const n={lhs:[],rhs:[]};return null==t||t.forEach((t=>{e(t)?n.lhs.push(t):n.rhs.push(t)})),n})(t,(t=>{const e=t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder);return r?!e&&t.hasOwnProperty("barycenter"):e||t.hasOwnProperty("barycenter")})),o=i.lhs,a=i.rhs.sort(((t,e)=>-t.i- -e.i)),s=[];let l=0,c=0,u=0;null==o||o.sort(Km(!!e,!!n)),u=Xm(s,a,u),null==o||o.forEach((t=>{var e;u+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),l+=t.barycenter*t.weight,c+=t.weight,u=Xm(s,a,u)}));const h={vs:s.flat()};return c&&(h.barycenter=l/c,h.weight=c),h})(v,r,i,o);if(d&&(m.vs=[d,m.vs,f].flat(),null===(s=t.getPredecessors(d))||void 0===s?void 0:s.length)){const e=t.getNode((null===(l=t.getPredecessors(d))||void 0===l?void 0:l[0].id)||""),n=t.getNode((null===(c=t.getPredecessors(f))||void 0===c?void 0:c[0].id)||"");m.hasOwnProperty("barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+e.data.order+n.data.order)/(m.weight+2),m.weight+=2}return m},Jm=(t,e)=>{null==t||t.forEach((t=>{var n;const r=null===(n=t.vs)||void 0===n?void 0:n.map((t=>e[t]?e[t].vs:t));t.vs=r.flat()}))},Qm=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},ty=(t,e,n)=>e.map((e=>((t,e,n)=>{const r=Wm(t),i=new ov({tree:[{id:r,children:[],data:{}}]});return t.getAllNodes().forEach((o=>{const a=t.getParent(o.id);(o.data.rank===e||o.data.minRank<=e&&e<=o.data.maxRank)&&(i.hasNode(o.id)||i.addNode(Object.assign({},o)),(null==a?void 0:a.id)&&!i.hasNode(null==a?void 0:a.id)&&i.addNode(Object.assign({},a)),i.setParent(o.id,(null==a?void 0:a.id)||r),t.getRelatedEdges(o.id,n).forEach((e=>{const n=e.source===o.id?e.target:e.source;i.hasNode(n)||i.addNode(Object.assign({},t.getNode(n)));const r=i.getRelatedEdges(n,"out").find((({target:t})=>t===o.id)),a=void 0!==r?r.data.weight:0;r?i.updateEdgeData(r.id,Object.assign(Object.assign({},r.data),{weight:e.data.weight+a})):i.addEdge({id:e.id,source:n,target:o.id,data:{weight:e.data.weight+a}})})),o.data.hasOwnProperty("minRank")&&i.updateNodeData(o.id,Object.assign(Object.assign({},o.data),{borderLeft:o.data.borderLeft[e],borderRight:o.data.borderRight[e]})))})),i})(t,e,n))),ey=(t,e,n,r)=>{const i=new ov;null==t||t.forEach((t=>{var o;const a=t.getRoots()[0].id,s=Zm(t,a,i,e,n,r);for(let e=0;e<(null===(o=s.vs)||void 0===o?void 0:o.length);e++){const n=t.getNode(s.vs[e]);n&&(n.data.order=e)}((t,e,n)=>{const r={};let i;null==n||n.forEach((n=>{let o,a,s=t.getParent(n);for(;s;){if(o=t.getParent(s.id),o?(a=r[o.id],r[o.id]=s.id):(a=i,i=s.id),a&&a!==s.id)return e.hasNode(a)||e.addNode({id:a,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),void(e.hasEdge(`e${a}-${s.id}`)||e.addEdge({id:`e${a}-${s.id}`,source:a,target:s.id,data:{}}));s=o}}))})(t,i,s.vs)}))},ny=(t,e)=>{null==e||e.forEach((e=>{null==e||e.forEach(((e,n)=>{t.getNode(e).data.order=n}))}))},ry=(t,e)=>{const n=(t=>{const e={};let n=0;const r=i=>{const o=n;t.getChildren(i).forEach((t=>r(t.id))),e[i]={low:o,lim:n++}};return t.getRoots().forEach((t=>r(t.id))),e})(t);e.forEach((e=>{var r,i;let o=e,a=t.getNode(o);const s=a.data.originalEdge;if(!s)return;const l=((t,e,n,r)=>{var i,o;const a=[],s=[],l=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);let u,h;u=n;do{u=null===(i=t.getParent(u))||void 0===i?void 0:i.id,a.push(u)}while(u&&(e[u].low>l||c>e[u].lim));for(h=u,u=r;u&&u!==h;)s.push(u),u=null===(o=t.getParent(u))||void 0===o?void 0:o.id;return{lca:h,path:a.concat(s.reverse())}})(t,n,s.source,s.target),c=l.path,u=l.lca;let h=0,d=c[h],f=!0;for(;o!==s.target;){if(a=t.getNode(o),f){for(;d!==u&&(null===(r=t.getNode(d))||void 0===r?void 0:r.data.maxRank)<a.data.rank;)h++,d=c[h];d===u&&(f=!1)}if(!f){for(;h<c.length-1&&(null===(i=t.getNode(c[h+1]))||void 0===i?void 0:i.data.minRank)<=a.data.rank;)h++;d=c[h]}t.hasNode(d)&&t.setParent(o,d),o=t.getSuccessors(o)[0].id}}))},iy=(t,e)=>{const n={};function r(e,r){const i=function(t){return JSON.stringify(t.slice(1))}(e);r.get(i)||(!function(e,r,i,o,a){var s,l;let c;for(let u=r;u<i;u++)c=e[u],(null===(s=t.getNode(c))||void 0===s?void 0:s.data.dummy)&&(null===(l=t.getPredecessors(c))||void 0===l||l.forEach((e=>{const r=t.getNode(e.id);r.data.dummy&&(r.data.order<o||r.data.order>a)&&ay(n,e.id,c)})))}(...e),r.set(i,!0))}const i=(e,n)=>{let i,o=-1,a=0;const s=new Map;return null==n||n.forEach(((l,c)=>{var u;if("border"===(null===(u=t.getNode(l))||void 0===u?void 0:u.data.dummy)){const e=t.getPredecessors(l)||[];e.length&&(i=t.getNode(e[0].id).data.order,r([n,a,c,o,i],s),a=c,o=i)}r([n,a,n.length,i,e.length],s)})),n};return(null==e?void 0:e.length)&&e.reduce(i),n},oy=(t,e)=>{var n,r;if(null===(n=t.getNode(e))||void 0===n?void 0:n.data.dummy)return null===(r=t.getPredecessors(e))||void 0===r?void 0:r.find((e=>t.getNode(e.id).data.dummy))},ay=(t,e,n)=>{let r=e,i=n;if(r>i){const t=r;r=i,i=t}let o=t[r];o||(t[r]=o={}),o[i]=!0},sy=(t,e,n)=>{let r=e,i=n;if(r>n){r=n,i=e}return!!t[r]},ly=(t,e,n,r,i,o)=>{const a=new ov,s=cy(r,i,o);return null==e||e.forEach((e=>{let r;null==e||e.forEach((e=>{const i=n[e];if(a.hasNode(i)||a.addNode({id:i,data:{}}),r){const o=n[r],l=a.getRelatedEdges(o,"out").find((t=>t.target===i));l?a.updateEdgeData(l.id,Object.assign(Object.assign({},l.data),{weight:Math.max(s(t,e,r),l.data.weight||0)})):a.addEdge({id:`e${Math.random()}`,source:o,target:i,data:{weight:Math.max(s(t,e,r),0)}})}r=e}))})),a};const cy=(t,e,n)=>(r,i,o)=>{const a=r.getNode(i),s=r.getNode(o);let l=0,c=0;if(l+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":c=-a.data.width/2;break;case"r":c=a.data.width/2}if(c&&(l+=n?c:-c),c=0,l+=(a.data.dummy?e:t)/2,l+=(s.data.dummy?e:t)/2,l+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":c=s.data.width/2;break;case"r":c=-s.data.width/2}return c&&(l+=n?c:-c),c=0,l},uy=(t,e)=>t.getNode(e).data.width||0,hy=(t,e)=>{const{align:n,nodesep:r=0,edgesep:i=0}=e||{},o=Nm(t),a=Object.assign(((t,e)=>{const n={},r=(e,r)=>{let i=0,o=0;const a=e.length,s=null==r?void 0:r[(null==r?void 0:r.length)-1];return null==r||r.forEach(((e,l)=>{var c;const u=oy(t,e),h=u?t.getNode(u.id).data.order:a;(u||e===s)&&(null===(c=r.slice(o,l+1))||void 0===c||c.forEach((e=>{var r;null===(r=t.getPredecessors(e))||void 0===r||r.forEach((r=>{var o;const a=t.getNode(r.id),s=a.data.order;!(s<i||h<s)||a.data.dummy&&(null===(o=t.getNode(e))||void 0===o?void 0:o.data.dummy)||ay(n,r.id,e)}))})),o=l+1,i=h)})),r};return(null==e?void 0:e.length)&&e.reduce(r),n})(t,o),iy(t,o)),s={};let l=[];["u","d"].forEach((e=>{l="u"===e?o:Object.values(o).reverse(),["l","r"].forEach((n=>{"r"===n&&(l=l.map((t=>Object.values(t).reverse())));const o=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),c=((t,e,n,r)=>{const i={},o={},a={};return null==e||e.forEach((t=>{null==t||t.forEach(((t,e)=>{i[t]=t,o[t]=t,a[t]=e}))})),null==e||e.forEach((t=>{let e=-1;null==t||t.forEach((t=>{let s=r(t).map((t=>t.id));if(s.length){s=s.sort(((t,e)=>a[t]-a[e]));const r=(s.length-1)/2;for(let l=Math.floor(r),c=Math.ceil(r);l<=c;++l){const r=s[l];o[t]===t&&e<a[r]&&!sy(n,t,r)&&(o[r]=t,o[t]=i[t]=i[r],e=a[r])}}}))})),{root:i,align:o}})(0,l,a,o),u=((t,e,n,r,i,o,a)=>{var s;const l={},c=ly(t,e,n,i,o,a),u=a?"borderLeft":"borderRight",h=(t,e)=>{let n=c.getAllNodes(),r=n.pop();const i={};for(;r;)i[r.id]?t(r.id):(i[r.id]=!0,n.push(r),n=n.concat(e(r.id))),r=n.pop()};return h((t=>{l[t]=(c.getRelatedEdges(t,"in")||[]).reduce(((t,e)=>Math.max(t,(l[e.source]||0)+e.data.weight)),0)}),c.getPredecessors.bind(c)),h((e=>{const n=(c.getRelatedEdges(e,"out")||[]).reduce(((t,e)=>Math.min(t,(l[e.target]||0)-e.data.weight)),Number.POSITIVE_INFINITY),r=t.getNode(e);n!==Number.POSITIVE_INFINITY&&r.data.borderType!==u&&(l[e]=Math.max(l[e],n))}),c.getSuccessors.bind(c)),null===(s=Object.values(r))||void 0===s||s.forEach((t=>{l[t]=l[n[t]]})),l})(t,l,c.root,c.align,r,i,"r"===n);"r"===n&&Object.keys(u).forEach((t=>u[t]=-u[t])),s[e+n]=u}))}));const c=((t,e)=>Tm(Object.values(e),(e=>{var n;let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return null===(n=Object.keys(e))||void 0===n||n.forEach((n=>{const o=e[n],a=uy(t,n)/2;r=Math.max(o+a,r),i=Math.min(o-a,i)})),r-i})))(t,s);return c&&function(t,e){const n=Object.values(e),r=Math.min(...n),i=Math.max(...n);["u","d"].forEach((n=>{["l","r"].forEach((o=>{const a=n+o,s=t[a];let l;if(s===e)return;const c=Object.values(s);l="l"===o?r-Math.min(...c):i-Math.max(...c),l&&(t[a]={},Object.keys(s).forEach((e=>{t[a][e]=s[e]+l})))}))}))}(s,c),((t,e)=>{const n={};return Object.keys(t.ul).forEach((r=>{if(e)n[r]=t[e.toLowerCase()][r];else{const e=Object.values(t).map((t=>t[r]));n[r]=(e[0]+e[1])/2}})),n})(s,n)},dy=(t,e)=>{var n;const r=km(t);((t,e)=>{const{ranksep:n=0}=e||{},r=Nm(t);let i=0;null==r||r.forEach((e=>{const r=e.map((e=>t.getNode(e).data.height)),o=Math.max(...r,0);null==e||e.forEach((e=>{t.getNode(e).data.y=i+o/2})),i+=o+n}))})(r,e);const i=hy(r,e);null===(n=Object.keys(i))||void 0===n||n.forEach((t=>{r.getNode(t).data.x=i[t]}))},fy=t=>{const e={},n=r=>{var i;const o=t.getNode(r);if(!o)return 0;if(e[r])return o.data.rank;let a;return e[r]=!0,null===(i=t.getRelatedEdges(r,"out"))||void 0===i||i.forEach((t=>{const e=n(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)})),a||(a=0),o.data.rank=a,a};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>n(t.id)))},py=(t,e)=>t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen,gy=(t,e)=>{const n=r=>{e.getRelatedEdges(r,"both").forEach((i=>{const o=i.source,a=r===o?i.target:o;t.hasNode(a)||py(e,i)||(t.addNode({id:a,data:{}}),t.addEdge({id:i.id,source:r,target:a,data:{}}),n(a))}))};return t.getAllNodes().forEach((t=>n(t.id))),t.getAllNodes().length},vy=(t,e)=>{const n=r=>{var i;null===(i=e.getRelatedEdges(r,"both"))||void 0===i||i.forEach((i=>{const o=i.source,a=r===o?i.target:o;t.hasNode(a)||void 0===e.getNode(a).data.layer&&py(e,i)||(t.addNode({id:a,data:{}}),t.addEdge({id:i.id,source:r,target:a,data:{}}),n(a))}))};return t.getAllNodes().forEach((t=>n(t.id))),t.getAllNodes().length},my=(t,e)=>Tm(e.getAllEdges(),(n=>t.hasNode(n.source)!==t.hasNode(n.target)?py(e,n):1/0)),yy=(t,e,n)=>{t.getAllNodes().forEach((t=>{const r=e.getNode(t.id);r.data.rank||(r.data.rank=0),r.data.rank+=n}))},by=t=>{const e=(t=>{const e=new ov;return t.getAllNodes().forEach((t=>{e.addNode(Object.assign({},t))})),t.getAllEdges().forEach((t=>{const n=e.getRelatedEdges(t.source,"out").find((e=>e.target===t.target));n?e.updateEdgeData(null==n?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})})),e})(t);fy(e);const n=(t=>{const e=new ov({tree:[]}),n=t.getAllNodes()[0],r=t.getAllNodes().length;let i,o;for(e.addNode(n);gy(e,t)<r;)i=my(e,t),o=e.hasNode(i.source)?py(t,i):-py(t,i),yy(e,t,o);return e})(e);let r,i;for(ky(n),xy(n,e);r=Ny(n);)i=Oy(n,e,r),Sy(n,e,r,i)},xy=(t,e)=>{let n=Am(t,t.getAllNodes(),"post");n=n.slice(0,(null==n?void 0:n.length)-1),n.forEach((n=>{Ey(t,e,n)}))},Ey=(t,e,n)=>{const r=t.getNode(n).data.parent;t.getRelatedEdges(n,"both").find((t=>t.target===r||t.source===r)).data.cutvalue=wy(t,e,n)},wy=(t,e,n)=>{const r=t.getNode(n).data.parent;let i=!0,o=e.getRelatedEdges(n,"out").find((t=>t.target===r)),a=0;return o||(i=!1,o=e.getRelatedEdges(r,"out").find((t=>t.target===n))),a=o.data.weight,e.getRelatedEdges(n,"both").forEach((e=>{const o=e.source===n,s=o?e.target:e.source;if(s!==r){const r=o===i,l=e.data.weight;if(a+=r?l:-l,_y(t,n,s)){const e=t.getRelatedEdges(n,"both").find((t=>t.source===s||t.target===s)).data.cutvalue;a+=r?-e:e}}})),a},ky=(t,e=t.getAllNodes()[0].id)=>{My(t,{},1,e)},My=(t,e,n,r,i)=>{var o;const a=n;let s=n;const l=t.getNode(r);return e[r]=!0,null===(o=t.getNeighbors(r))||void 0===o||o.forEach((n=>{e[n.id]||(s=My(t,e,s,n.id,r))})),l.data.low=a,l.data.lim=s++,i?l.data.parent=i:delete l.data.parent,s},Ny=t=>t.getAllEdges().find((t=>t.data.cutvalue<0)),Oy=(t,e,n)=>{let r=n.source,i=n.target;e.getRelatedEdges(r,"out").find((t=>t.target===i))||(r=n.target,i=n.source);const o=t.getNode(r),a=t.getNode(i);let s=o,l=!1;o.data.lim>a.data.lim&&(s=a,l=!0);const c=e.getAllEdges().filter((e=>l===Ay(t.getNode(e.source),s)&&l!==Ay(t.getNode(e.target),s)));return Tm(c,(t=>py(e,t)))},Sy=(t,e,n,r)=>{const i=t.getRelatedEdges(n.source,"both").find((t=>t.source===n.target||t.target===n.target));i&&t.removeEdge(i.id),t.addEdge({id:`e${Math.random()}`,source:r.source,target:r.target,data:{}}),ky(t),xy(t,e),Ty(t,e)},Ty=(t,e)=>{const n=t.getAllNodes().find((t=>!t.data.parent));let r=Am(t,n,"pre");r=r.slice(1),r.forEach((n=>{const r=t.getNode(n).data.parent;let i=e.getRelatedEdges(n,"out").find((t=>t.target===r)),o=!1;!i&&e.hasNode(r)&&(i=e.getRelatedEdges(r,"out").find((t=>t.target===n)),o=!0),e.getNode(n).data.rank=(e.hasNode(r)&&e.getNode(r).data.rank||0)+(o?null==i?void 0:i.data.minlen:-(null==i?void 0:i.data.minlen))}))},_y=(t,e,n)=>t.getRelatedEdges(e,"both").find((t=>t.source===n||t.target===n)),Ay=(t,e)=>e.data.low<=t.data.lim&&t.data.lim<=e.data.lim,Cy=fy,Py=t=>{(t=>{const e={};let n;const r=i=>{var o;const a=t.getNode(i);if(!a)return 0;if(e[i])return a.data.rank;let s;return e[i]=!0,null===(o=t.getRelatedEdges(i,"out"))||void 0===o||o.forEach((t=>{const e=r(t.target)-t.data.minlen;e&&(void 0===s||e<s)&&(s=e)})),s||(s=0),(void 0===n||s<n)&&(n=s),a.data.rank=s,s};t.getAllNodes().filter((e=>0===t.getRelatedEdges(e.id,"in").length)).forEach((t=>{t&&r(t.id)})),void 0===n&&(n=0);const i={},o=(e,n)=>{var r;const a=t.getNode(e),s=isNaN(a.data.layer)?n:a.data.layer;(void 0===a.data.rank||a.data.rank<s)&&(a.data.rank=s),i[e]||(i[e]=!0,null===(r=t.getRelatedEdges(e,"out"))||void 0===r||r.forEach((t=>{o(t.target,s+t.data.minlen)})))};t.getAllNodes().forEach((t=>{const e=t.data;e&&(isNaN(e.layer)?e.rank-=n:o(t.id,e.layer))}))})(t),(t=>{const e=new ov({tree:[]}),n=t.getAllNodes()[0],r=t.getAllNodes().length;let i,o;for(e.addNode(n);vy(e,t)<r;)i=my(e,t),o=e.hasNode(i.source)?py(t,i):-py(t,i),yy(e,t,o)})(t)},Dy=t=>{by(t)},Ry=(t,e)=>{const{acyclicer:n,ranker:r,rankdir:i="tb",nodeOrder:o,keepNodeOrder:a,align:s,nodesep:l=50,edgesep:c=20,ranksep:u=50}=e;Jy(t),xm(t,n);const{nestingRoot:h,nodeRankFactor:d}=(t=>{const e=wm(t,"root",{},"_root"),n=Bm(t);let r=Math.max(...Object.values(n));Math.abs(r)===1/0&&(r=1);const i=r-1,o=2*i+1;t.getAllEdges().forEach((t=>{t.data.minlen*=o}));const a=zm(t)+1;return t.getRoots().forEach((r=>{Fm(t,e,o,a,i,n,r.id)})),{nestingRoot:e,nodeRankFactor:o}})(t);((t,e)=>{switch(e){case"network-simplex":Dy(t);break;case"tight-tree":default:Py(t);break;case"longest-path":Cy(t)}})(km(t),r),$y(t),((t,e=0)=>{const n=t.getAllNodes(),r=n.filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),i=Math.min(...r),o=[];n.forEach((t=>{const e=(t.data.rank||0)-i;o[e]||(o[e]=[]),o[e].push(t.id)}));let a=0;for(let n=0;n<o.length;n++){const r=o[n];void 0===r?n%e!=0&&(a-=1):a&&(null==r||r.forEach((e=>{const n=t.getNode(e);n&&(n.data.rank=n.data.rank||0,n.data.rank+=a)})))}})(t,d),((t,e)=>{e&&t.removeNode(e),t.getAllEdges().forEach((e=>{e.data.nestingEdge&&t.removeEdge(e.id)}))})(t,h),(t=>{const e=t.getAllNodes().filter((t=>void 0!==t.data.rank)).map((t=>t.data.rank)),n=Math.min(...e);t.getAllNodes().forEach((t=>{t.data.hasOwnProperty("rank")&&n!==1/0&&(t.data.rank-=n)}))})(t),Hy(t),Uy(t);const f=[];((t,e)=>{t.getAllEdges().forEach((n=>Gm(t,n,e)))})(t,f),ry(t,f),(t=>{const e=n=>{const r=t.getChildren(n),i=t.getNode(n);if((null==r?void 0:r.length)&&r.forEach((t=>e(t.id))),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let e=i.data.minRank,r=i.data.maxRank+1;e<r;e+=1)Cm(t,"borderLeft","_bl",n,i,e),Cm(t,"borderRight","_br",n,i,e)}};t.getRoots().forEach((t=>e(t.id)))})(t),a&&((t,e)=>{const n=t.getAllNodes().filter((e=>{var n;return!(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length)})).map((t=>t.data.rank)),r=Math.max(...n),i=[];for(let t=0;t<r+1;t++)i[t]=[];null==e||e.forEach((e=>{const n=t.getNode(e);n&&!n.data.dummy&&(isNaN(n.data.rank)||(n.data.fixorder=i[n.data.rank].length,i[n.data.rank].push(e)))}))})(t,o),((t,e)=>{const n=Sm(t),r=[],i=[];for(let t=1;t<n+1;t++)r.push(t);for(let t=n-1;t>-1;t--)i.push(t);const o=ty(t,r,"in"),a=ty(t,i,"out");let s=Um(t);ny(t,s);let l,c=Number.POSITIVE_INFINITY;for(let n=0,r=0;r<4;++n,++r){ey(n%2?o:a,n%4>=2,!1,e),s=Nm(t);const i=Hm(t,s);i<c&&(r=0,l=be(s),c=i)}s=Um(t),ny(t,s);for(let n=0,r=0;r<4;++n,++r){ey(n%2?o:a,n%4>=2,!0,e),s=Nm(t);const i=Hm(t,s);i<c&&(r=0,l=be(s),c=i)}ny(t,l)})(t,a),Qy(t),((t,e)=>{const n=e.toLowerCase();"lr"!==n&&"rl"!==n||Pm(t)})(t,i),dy(t,{align:s,nodesep:l,edgesep:c,ranksep:u}),tb(t),Zy(t),((t,e)=>{e.forEach((e=>{let n=t.getNode(e);const{data:r}=n,i=r.originalEdge;let o;i&&t.addEdge(i);let a=e;for(;n.data.dummy;)o=t.getSuccessors(a)[0],t.removeNode(a),i.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===Vm&&(i.data.x=n.data.x,i.data.y=n.data.y,i.data.width=n.data.width,i.data.height=n.data.height),a=o.id,n=t.getNode(a)}))})(t,f),Xy(t),((t,e)=>{const n=e.toLowerCase();"bt"!==n&&"rl"!==n||Rm(t),"lr"!==n&&"rl"!==n||(Im(t),Pm(t))})(t,i);const{width:p,height:g}=Yy(t);return qy(t),Ky(t),(t=>{t.getAllEdges().forEach((e=>{const n=e.data;if(n.reversed){t.removeEdge(e.id);const r=n.forwardName;delete n.reversed,delete n.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},n),{forwardName:r})})}}))})(t),{width:p,height:g}},Ly=(t,e)=>{t.getAllNodes().forEach((n=>{const r=t.getNode(n.id);if(e.hasNode(n.id)){const t=e.getNode(n.id);r.data.fixorder=t.data._order,delete t.data._order}else delete r.data.fixorder}))},Iy=(t,e)=>{t.getAllNodes().forEach((n=>{var r;const i=t.getNode(n.id);if(i){const t=e.getNode(n.id);i.data.x=t.data.x,i.data.y=t.data.y,i.data._order=t.data.order,i.data._rank=t.data.rank,(null===(r=e.getChildren(n.id))||void 0===r?void 0:r.length)&&(i.data.width=t.data.width,i.data.height=t.data.height)}})),t.getAllEdges().forEach((n=>{const r=t.getEdge(n.id),i=e.getEdge(n.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(r.data.x=i.data.x,r.data.y=i.data.y)}))},jy=["width","height","layer","fixorder"],Fy={width:0,height:0},By=["minlen","weight","width","height","labeloffset"],zy={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Vy=["labelpos"],Gy=t=>{const e=new ov({tree:[]});return t.getAllNodes().forEach((n=>{const r=nb(t.getNode(n.id).data),i=Object.assign(Object.assign({},Fy),r),o=eb(i,jy);e.hasNode(n.id)||e.addNode({id:n.id,data:Object.assign({},o)});const a=t.hasTreeStructure("combo")?t.getParent(n.id,"combo"):t.getParent(n.id);qt(a)||(e.hasNode(a.id)||e.addNode(Object.assign({},a)),e.setParent(n.id,a.id))})),t.getAllEdges().forEach((n=>{const r=nb(t.getEdge(n.id).data),i={};null==Vy||Vy.forEach((t=>{void 0!==r[t]&&(i[t]=r[t])})),e.addEdge({id:n.id,source:n.source,target:n.target,data:Object.assign({},zy,eb(r,By),i)})})),e},Wy=(t,e)=>{const{ranksep:n=0,rankdir:r}=e;return t.getAllNodes().forEach((t=>{isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)})),t.getAllEdges().forEach((t=>{var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===r||"BT"===r?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)})),n/2},$y=t=>{t.getAllEdges().forEach((e=>{if(e.data.width&&e.data.height){const n=t.getNode(e.source),r={e:e,rank:(t.getNode(e.target).data.rank-n.data.rank)/2+n.data.rank};wm(t,"edge-proxy",r,"_ep")}}))},Hy=t=>{let e=0;return t.getAllNodes().forEach((n=>{var r,i;n.data.borderTop&&(n.data.minRank=null===(r=t.getNode(n.data.borderTop))||void 0===r?void 0:r.data.rank,n.data.maxRank=null===(i=t.getNode(n.data.borderBottom))||void 0===i?void 0:i.data.rank,e=Math.max(e,n.data.maxRank||-1/0))})),e},Uy=t=>{t.getAllNodes().forEach((e=>{"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))}))},Yy=(t,e)=>{let n,r,i=0,o=0;const{marginx:a=0,marginy:s=0}={},l=t=>{if(!t.data)return;const e=t.data.x,a=t.data.y,s=t.data.width,l=t.data.height;isNaN(e)||isNaN(s)||(void 0===n&&(n=e-s/2),n=Math.min(n,e-s/2),i=Math.max(i,e+s/2)),isNaN(a)||isNaN(l)||(void 0===r&&(r=a-l/2),r=Math.min(r,a-l/2),o=Math.max(o,a+l/2))};return t.getAllNodes().forEach((t=>{l(t)})),t.getAllEdges().forEach((t=>{(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)})),n-=a,r-=s,t.getAllNodes().forEach((t=>{t.data.x-=n,t.data.y-=r})),t.getAllEdges().forEach((t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach((t=>{t.x-=n,t.y-=r})),t.data.hasOwnProperty("x")&&(t.data.x-=n),t.data.hasOwnProperty("y")&&(t.data.y-=r)})),{width:i-n+a,height:o-r+s}},qy=t=>{t.getAllEdges().forEach((e=>{const n=t.getNode(e.source),r=t.getNode(e.target);let i,o;e.data.points?(i=e.data.points[0],o=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:r.data.x,y:r.data.y},o={x:n.data.x,y:n.data.y}),e.data.points.unshift(Mm(n.data,i)),e.data.points.push(Mm(r.data,o))}))},Xy=t=>{t.getAllEdges().forEach((t=>{if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}}))},Ky=t=>{t.getAllEdges().forEach((t=>{var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())}))},Zy=t=>{t.getAllNodes().forEach((e=>{var n,r,i;if(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length){const n=t.getNode(e.id),o=t.getNode(n.data.borderTop),a=t.getNode(n.data.borderBottom),s=t.getNode(n.data.borderLeft[(null===(r=n.data.borderLeft)||void 0===r?void 0:r.length)-1]),l=t.getNode(n.data.borderRight[(null===(i=n.data.borderRight)||void 0===i?void 0:i.length)-1]);n.data.width=Math.abs((null==l?void 0:l.data.x)-(null==s?void 0:s.data.x))||10,n.data.height=Math.abs((null==a?void 0:a.data.y)-(null==o?void 0:o.data.y))||10,n.data.x=((null==s?void 0:s.data.x)||0)+n.data.width/2,n.data.y=((null==o?void 0:o.data.y)||0)+n.data.height/2}})),t.getAllNodes().forEach((e=>{"border"===e.data.dummy&&t.removeNode(e.id)}))},Jy=t=>{t.getAllEdges().forEach((e=>{if(e.source===e.target){const n=t.getNode(e.source);n.data.selfEdges||(n.data.selfEdges=[]),n.data.selfEdges.push(e),t.removeEdge(e.id)}}))},Qy=t=>{const e=Nm(t);null==e||e.forEach((e=>{let n=0;null==e||e.forEach(((e,r)=>{var i;const o=t.getNode(e);o.data.order=r+n,null===(i=o.data.selfEdges)||void 0===i||i.forEach((e=>{wm(t,"selfedge",{width:e.data.width,height:e.data.height,rank:o.data.rank,order:r+ ++n,e:e},"_se")})),delete o.data.selfEdges}))}))},tb=t=>{t.getAllNodes().forEach((e=>{const n=t.getNode(e.id);if("selfedge"===n.data.dummy){const r=t.getNode(n.data.e.source),i=r.data.x+r.data.width/2,o=r.data.y,a=n.data.x-i,s=r.data.height/2;t.hasEdge(n.data.e.id)?t.updateEdgeData(n.data.e.id,n.data.e.data):t.addEdge({id:n.data.e.id,source:n.data.e.source,target:n.data.e.target,data:n.data.e.data}),t.removeNode(e.id),n.data.e.data.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{y:o,x:i+a},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.data.e.data.x=n.data.x,n.data.e.data.y=n.data.y}}))},eb=(t,e)=>{const n={};return null==e||e.forEach((e=>{void 0!==t[e]&&(n[e]=+t[e])})),n},nb=(t={})=>{const e={};return Object.keys(t).forEach((n=>{e[n.toLowerCase()]=t[n]})),e},rb=Array.isArray,ib=t=>{const e=[],n=t.length;for(let r=0;r<n;r+=1){e[r]=[];for(let i=0;i<n;i+=1)r===i?e[r][i]=0:0!==t[r][i]&&t[r][i]?e[r][i]=t[r][i]:e[r][i]=1/0}for(let t=0;t<n;t+=1)for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)e[r][i]>e[r][t]+e[t][i]&&(e[r][i]=e[r][t]+e[t][i]);return e},ob=(t,e)=>{const{nodes:n,edges:r}=t,i=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(((t,e)=>{o[t.id]=e;i.push([])})),null==r||r.forEach((t=>{const{source:e,target:n}=t,r=o[e],a=o[n];void 0!==r&&void 0!==a&&(i[r][a]=1,i[a][r]=1)})),i},ab=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),sb=(t,e,n,r="TB",i,o={})=>{if(!(null==e?void 0:e.length))return;const{stopBranchFn:a,stopAllFn:s}=o;for(let l=0;l<e.length;l++){const c=e[l];if(t.hasNode(c.id)&&!(null==a?void 0:a(c))){if(null==s?void 0:s(c))return;"TB"===r&&n(c),sb(t,t.getChildren(c.id,i),n,r,i,o),"TB"!==r&&n(c)}}},lb=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){const e=[];return t.forEach((t=>{e.push(t)})),e.map((t=>lb(t)))}if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=lb(t[n])})),e}return t},cb=(t,e)=>{const n=lb(t);return n.data=n.data||{},e&&(le(n.data.x)||(n.data.x=Math.random()*e[0]),le(n.data.y)||(n.data.y=Math.random()*e[1])),n};function ub(t){if(!t)return[0,0,0];if(le(t))return[t,t,t];if(0===t.length)return[0,0,0];const[e,n=e,r=e]=t;return[e,n,r]}function hb(t,e){let n;return n=Yt(e)?e:le(e)?()=>e:()=>t,n}function db(t,e,n=!0){return e||0===e?Yt(e)?e:le(e)?()=>e:Array.isArray(e)?()=>n?Math.max(...e)||t:e:Kt(e)&&e.width&&e.height?()=>n?Math.max(e.width,e.height)||t:[e.width,e.height]:()=>t:e=>{const{size:r}=e.data||{};return r?Array.isArray(r)?n?Math.max(...r)||t:r:Kt(r)&&r.width&&r.height?n?Math.max(r.width,r.height)||t:[r.width,r.height]:r:t}}const fb=(t,e,n=10)=>{let r;const i="function"==typeof e?e:()=>e||0;r=t?Array.isArray(t)?e=>t:Yt(t)?t:e=>t:t=>{var e,r,i;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(r=t.data)||void 0===r?void 0:r.bboxSize;if(null===(i=t.data)||void 0===i?void 0:i.size){const e=t.data.size;return Array.isArray(e)?e:Kt(e)?[e.width,e.height]:e}return n};return t=>{const e=r(t),n=i(t);return Math.max(...ub(e))+n}},pb={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};const gb=(t,e,n,r,i,o,a)=>{let s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&n){let{x:t,y:l}=e.data,{x:c,y:u}=n.data;if(i&&(t=e.data.y,l=e.data.x,c=n.data.y,u=n.data.x),u!==l&&t!==c){const h=r.indexOf(l),d=r[h+1];if(d){const t=s[0],e=i?{x:(l+d)/2,y:(null==t?void 0:t.y)||c}:{x:(null==t?void 0:t.x)||c,y:(l+d)/2};t&&!o(t,e)||s.unshift(e)}const f=r.indexOf(u),p=Math.abs(f-h);if(1===p)s=a(s,e.data,n.data),s.length||s.push(i?{x:(l+u)/2,y:t}:{x:t,y:(l+u)/2});else if(p>1){const e=r[f-1];if(e){const n=s[s.length-1],r=i?{x:(u+e)/2,y:(null==n?void 0:n.y)||c}:{x:(null==n?void 0:n.x)||t,y:(u+e)/2};n&&!o(n,r)||s.push(r)}}}}return s},vb=(t,e,n)=>{const r=t.getAllNodes(),i=t.getAllEdges();if(!(null==r?void 0:r.length)){return{nodes:[],edges:i}}if(1===r.length){e&&t.mergeNodeData(r[0].id,{x:n[0],y:n[1]});return{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:n[0],y:n[1]})})],edges:i}}},mb={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};const yb=(t,e,n=!1)=>{const r=[cb(e[0])],i={},o=e.length;i[e[0].id]=!0;let a=0;return e.forEach(((s,l)=>{if(0!==l)if(l!==o-1&&t.getDegree(s.id,"both")===t.getDegree(e[l+1].id,"both")&&!t.areNeighbors(r[a].id,s.id)||i[s.id]){const l=n?t.getSuccessors(r[a].id):t.getNeighbors(r[a].id);let c=!1;for(let e=0;e<l.length;e++){const n=l[e];if(t.getDegree(n.id)===t.getDegree(s.id)&&!i[n.id]){r.push(cb(n)),i[n.id]=!0,c=!0;break}}let u=0;for(;!c&&(i[e[u].id]||(r.push(cb(e[u])),i[e[u].id]=!0,c=!0),u++,u!==o););}else r.push(cb(s)),i[s.id]=!0,a++})),r};const bb=(t,e,n)=>{let r=t,i=e,o=n;return r||"undefined"==typeof window||(r=window.innerWidth),i||"undefined"==typeof window||(i=window.innerHeight),o||(o=[r/2,i/2]),[r,i,o]},xb={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Eb{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},xb),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericConcentricLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericConcentricLayout(!0,t,e)}))}genericConcentricLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i,width:o,height:a,sortBy:s,maxLevelDiff:l,sweep:c,clockwise:u,equidistant:h,preventOverlap:d,startAngle:f=1.5*Math.PI,nodeSize:p,nodeSpacing:g}=r,v=e.getAllNodes(),m=e.getAllEdges(),y=o||"undefined"==typeof window?o:window.innerWidth,b=a||"undefined"==typeof window?a:window.innerHeight,x=i||[y/2,b/2];if(!(null==v?void 0:v.length)||1===v.length)return vb(e,t,x);const E=[];let w,k=0;rb(p)?w=Math.max(p[0],p[1]):Yt(p)?(w=-1/0,v.forEach((t=>{const e=Math.max(...ub(p(t)));e>w&&(w=e)}))):w=p,rb(g)?k=Math.max(g[0],g[1]):le(g)&&(k=g),v.forEach((t=>{const e=cb(t);E.push(e);let n=w;const{data:r}=e;rb(r.size)?n=Math.max(r.size[0],r.size[1]):le(r.size)?n=r.size:Kt(r.size)&&(n=Math.max(r.size.width,r.size.height)),w=Math.max(w,n),Yt(g)&&(k=Math.max(g(t),k))}));const M={};E.forEach(((t,e)=>{M[t.id]=e}));let N=s;ie(N)&&void 0!==E[0].data[N]||(N="degree"),"degree"===N?E.sort(((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both"))):E.sort(((t,e)=>e.data[N]-t.data[N]));const O=E[0],S=(l||("degree"===N?e.getDegree(O.id,"both"):O.data[N]))/4,T=[{nodes:[]}];let _=T[0];E.forEach((t=>{if(_.nodes.length>0){const n="degree"===N?Math.abs(e.getDegree(_.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(_.nodes[0].data[N]-t.data[N]);S&&n>=S&&(_={nodes:[]},T.push(_))}_.nodes.push(t)}));let A=w+k;if(!d){const t=T.length>0&&T[0].nodes.length>1,e=(Math.min(y,b)/2-A)/(T.length+(t?1:0));A=Math.min(A,e)}let C=0;if(T.forEach((t=>{const e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&d){const e=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),r=Math.sqrt(A*A/(e*e+n*n));C=Math.max(r,C)}t.r=C,C+=A})),h){let t=0,e=0;for(let n=0;n<T.length;n++){const r=(T[n].r||0)-e;t=Math.max(t,r)}e=0,T.forEach(((n,r)=>{0===r&&(e=n.r||0),n.r=e,e+=t}))}T.forEach((t=>{const e=t.dTheta||0,n=t.r||0;t.nodes.forEach(((t,r)=>{const i=f+(u?1:-1)*e*r;t.data.x=x[0]+n*Math.cos(i),t.data.y=x[1]+n*Math.sin(i)}))})),t&&E.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:E,edges:m}}))}}function wb(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,c,u,h,d,f=t._root,p={data:r},g=t._x0,v=t._y0,m=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((c=e>=(o=(g+m)/2))?g=o:m=o,(u=n>=(a=(v+y)/2))?v=a:y=a,i=f,!(f=f[h=u<<1|c]))return i[h]=p,t;if(s=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===s&&n===l)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+m)/2))?g=o:m=o,(u=n>=(a=(v+y)/2))?v=a:y=a}while((h=u<<1|c)==(d=(l>=a)<<1|s>=o));return i[d]=f,i[h]=p,t}function kb(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Mb(t){return t[0]}function Nb(t){return t[1]}function Ob(t,e,n){var r=new Sb(null==e?Mb:e,null==n?Nb:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Sb(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Tb(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var _b=Ob.prototype=Sb.prototype;function Ab(t,e,n,r,i){if(isNaN(e)||isNaN(n)||isNaN(r))return t;var o,a,s,l,c,u,h,d,f,p,g,v,m=t._root,y={data:i},b=t._x0,x=t._y0,E=t._z0,w=t._x1,k=t._y1,M=t._z1;if(!m)return t._root=y,t;for(;m.length;)if((d=e>=(a=(b+w)/2))?b=a:w=a,(f=n>=(s=(x+k)/2))?x=s:k=s,(p=r>=(l=(E+M)/2))?E=l:M=l,o=m,!(m=m[g=p<<2|f<<1|d]))return o[g]=y,t;if(c=+t._x.call(null,m.data),u=+t._y.call(null,m.data),h=+t._z.call(null,m.data),e===c&&n===u&&r===h)return y.next=m,o?o[g]=y:t._root=y,t;do{o=o?o[g]=new Array(8):t._root=new Array(8),(d=e>=(a=(b+w)/2))?b=a:w=a,(f=n>=(s=(x+k)/2))?x=s:k=s,(p=r>=(l=(E+M)/2))?E=l:M=l}while((g=p<<2|f<<1|d)==(v=(h>=l)<<2|(u>=s)<<1|c>=a));return o[v]=m,o[g]=y,t}function Cb(t,e,n,r,i,o,a){this.node=t,this.x0=e,this.y0=n,this.z0=r,this.x1=i,this.y1=o,this.z1=a}function Pb(t){return t[0]}function Db(t){return t[1]}function Rb(t){return t[2]}function Lb(t,e,n,r){var i=new Ib(null==e?Pb:e,null==n?Db:n,null==r?Rb:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Ib(t,e,n,r,i,o,a,s,l){this._x=t,this._y=e,this._z=n,this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=s,this._z1=l,this._root=void 0}function jb(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}_b.copy=function(){var t,e,n=new Sb(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Tb(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Tb(e));return n},_b.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return wb(this.cover(e,n),e,n,t)},_b.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>u&&(u=r),i<c&&(c=i),i>h&&(h=i));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)wb(this,a[n],s[n],t[n]);return this},_b.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n||1,c=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=c,c=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},_b.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},_b.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},_b.find=function(t,e,n){var r,i,o,a,s,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new kb(g,u,h,d,f)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(i=l.x0)>d||(o=l.y0)>f||(a=l.x1)<u||(s=l.y1)<h))if(g.length){var v=(i+a)/2,m=(o+s)/2;p.push(new kb(g[3],v,m,a,s),new kb(g[2],i,m,v,s),new kb(g[1],v,o,a,m),new kb(g[0],i,o,v,m)),(c=(e>=m)<<1|t>=v)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var y=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=y*y+b*b;if(x<n){var E=Math.sqrt(n=x);u=t-E,h=e-E,d=t+E,f=e+E,r=g.data}}return r},_b.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,v=this._x1,m=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(s=(p+v)/2))?p=s:v=s,(u=a>=(l=(g+m)/2))?g=l:m=l,e=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},_b.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},_b.root=function(){return this._root},_b.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},_b.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new kb(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var c=(r+o)/2,u=(i+a)/2;(n=l[3])&&s.push(new kb(n,c,u,o,a)),(n=l[2])&&s.push(new kb(n,r,u,c,a)),(n=l[1])&&s.push(new kb(n,c,i,o,u)),(n=l[0])&&s.push(new kb(n,r,i,c,u))}return this},_b.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new kb(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,c=e.y1,u=(a+l)/2,h=(s+c)/2;(o=i[0])&&n.push(new kb(o,a,s,u,h)),(o=i[1])&&n.push(new kb(o,u,s,l,h)),(o=i[2])&&n.push(new kb(o,a,h,u,c)),(o=i[3])&&n.push(new kb(o,u,h,l,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},_b.x=function(t){return arguments.length?(this._x=t,this):this._x},_b.y=function(t){return arguments.length?(this._y=t,this):this._y};var Fb=Lb.prototype=Ib.prototype;Fb.copy=function(){var t,e,n=new Ib(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=jb(r),n;for(t=[{source:r,target:n._root=new Array(8)}];r=t.pop();)for(var i=0;i<8;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(8)}):r.target[i]=jb(e));return n},Fb.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t),r=+this._z.call(null,t);return Ab(this.cover(e,n,r),e,n,r,t)},Fb.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e),r=new Float64Array(e),i=new Float64Array(e);let o=1/0,a=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h,d,f,p,g=0;g<e;++g)isNaN(d=+this._x.call(null,h=t[g]))||isNaN(f=+this._y.call(null,h))||isNaN(p=+this._z.call(null,h))||(n[g]=d,r[g]=f,i[g]=p,d<o&&(o=d),d>l&&(l=d),f<a&&(a=f),f>c&&(c=f),p<s&&(s=p),p>u&&(u=p));if(o>l||a>c||s>u)return this;this.cover(o,a,s).cover(l,c,u);for(let o=0;o<e;++o)Ab(this,n[o],r[o],i[o],t[o]);return this},Fb.cover=function(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,o=this._z0,a=this._x1,s=this._y1,l=this._z1;if(isNaN(r))a=(r=Math.floor(t))+1,s=(i=Math.floor(e))+1,l=(o=Math.floor(n))+1;else{for(var c,u,h=a-r||1,d=this._root;r>t||t>=a||i>e||e>=s||o>n||n>=l;)switch(u=(n<o)<<2|(e<i)<<1|t<r,(c=new Array(8))[u]=d,d=c,h*=2,u){case 0:a=r+h,s=i+h,l=o+h;break;case 1:r=a-h,s=i+h,l=o+h;break;case 2:a=r+h,i=s-h,l=o+h;break;case 3:r=a-h,i=s-h,l=o+h;break;case 4:a=r+h,s=i+h,o=l-h;break;case 5:r=a-h,s=i+h,o=l-h;break;case 6:a=r+h,i=s-h,o=l-h;break;case 7:r=a-h,i=s-h,o=l-h}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=s,this._z1=l,this},Fb.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Fb.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Fb.find=function(t,e,n,r){var i,o,a,s,l,c,u,h,d,f=this._x0,p=this._y0,g=this._z0,v=this._x1,m=this._y1,y=this._z1,b=[],x=this._root;for(x&&b.push(new Cb(x,f,p,g,v,m,y)),null==r?r=1/0:(f=t-r,p=e-r,g=n-r,v=t+r,m=e+r,y=n+r,r*=r);h=b.pop();)if(!(!(x=h.node)||(o=h.x0)>v||(a=h.y0)>m||(s=h.z0)>y||(l=h.x1)<f||(c=h.y1)<p||(u=h.z1)<g))if(x.length){var E=(o+l)/2,w=(a+c)/2,k=(s+u)/2;b.push(new Cb(x[7],E,w,k,l,c,u),new Cb(x[6],o,w,k,E,c,u),new Cb(x[5],E,a,k,l,w,u),new Cb(x[4],o,a,k,E,w,u),new Cb(x[3],E,w,s,l,c,k),new Cb(x[2],o,w,s,E,c,k),new Cb(x[1],E,a,s,l,w,k),new Cb(x[0],o,a,s,E,w,k)),(d=(n>=k)<<2|(e>=w)<<1|t>=E)&&(h=b[b.length-1],b[b.length-1]=b[b.length-1-d],b[b.length-1-d]=h)}else{var M=t-+this._x.call(null,x.data),N=e-+this._y.call(null,x.data),O=n-+this._z.call(null,x.data),S=M*M+N*N+O*O;if(S<r){var T=Math.sqrt(r=S);f=t-T,p=e-T,g=n-T,v=t+T,m=e+T,y=n+T,i=x.data}}return i},Fb.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,n,r,i,o,a,s,l,c,u,h,d,f,p,g,v=this._root,m=this._x0,y=this._y0,b=this._z0,x=this._x1,E=this._y1,w=this._z1;if(!v)return this;if(v.length)for(;;){if((h=o>=(l=(m+x)/2))?m=l:x=l,(d=a>=(c=(y+E)/2))?y=c:E=c,(f=s>=(u=(b+w)/2))?b=u:w=u,e=v,!(v=v[p=f<<2|d<<1|h]))return this;if(!v.length)break;(e[p+1&7]||e[p+2&7]||e[p+3&7]||e[p+4&7]||e[p+5&7]||e[p+6&7]||e[p+7&7])&&(n=e,g=p)}for(;v.data!==t;)if(r=v,!(v=v.next))return this;return(i=v.next)&&delete v.next,r?(i?r.next=i:delete r.next,this):e?(i?e[p]=i:delete e[p],(v=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&v===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!v.length&&(n?n[g]=v:this._root=v),this):(this._root=i,this)},Fb.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Fb.root=function(){return this._root},Fb.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Fb.visit=function(t){var e,n,r,i,o,a,s,l,c=[],u=this._root;for(u&&c.push(new Cb(u,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=c.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.z0,a=e.x1,s=e.y1,l=e.z1)&&u.length){var h=(r+a)/2,d=(i+s)/2,f=(o+l)/2;(n=u[7])&&c.push(new Cb(n,h,d,f,a,s,l)),(n=u[6])&&c.push(new Cb(n,r,d,f,h,s,l)),(n=u[5])&&c.push(new Cb(n,h,i,f,a,d,l)),(n=u[4])&&c.push(new Cb(n,r,i,f,h,d,l)),(n=u[3])&&c.push(new Cb(n,h,d,o,a,s,f)),(n=u[2])&&c.push(new Cb(n,r,d,o,h,s,f)),(n=u[1])&&c.push(new Cb(n,h,i,o,a,d,f)),(n=u[0])&&c.push(new Cb(n,r,i,o,h,d,f))}return this},Fb.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Cb(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.z0,c=e.x1,u=e.y1,h=e.z1,d=(a+c)/2,f=(s+u)/2,p=(l+h)/2;(o=i[0])&&n.push(new Cb(o,a,s,l,d,f,p)),(o=i[1])&&n.push(new Cb(o,d,s,l,c,f,p)),(o=i[2])&&n.push(new Cb(o,a,f,l,d,u,p)),(o=i[3])&&n.push(new Cb(o,d,f,l,c,u,p)),(o=i[4])&&n.push(new Cb(o,a,s,p,d,f,h)),(o=i[5])&&n.push(new Cb(o,d,s,p,c,f,h)),(o=i[6])&&n.push(new Cb(o,a,f,p,d,u,h)),(o=i[7])&&n.push(new Cb(o,d,f,p,c,u,h))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},Fb.x=function(t){return arguments.length?(this._x=t,this):this._x},Fb.y=function(t){return arguments.length?(this._y=t,this):this._y},Fb.z=function(t){return arguments.length?(this._z=t,this):this._z};function Bb(t,e,n,r,i=2){const o=e/n,a=t.getAllNodes(),s=a.map(((t,e)=>{const{nodeStrength:n,x:r,y:i,z:a,size:s}=t.data;return{x:r,y:i,z:a,size:s,index:e,id:t.id,vx:0,vy:0,vz:0,weight:o*n}})),l=(2===i?Ob(s,(t=>t.x),(t=>t.y)):Lb(s,(t=>t.x),(t=>t.y),(t=>t.z))).visitAfter(zb),c=new Map;return s.forEach((t=>{c.set(t.id,t),function(t,e,n){e.visit(((e,r,i,o,a)=>Vb(e,r,i,o,a,t,n)))}(t,l,i)})),s.map(((t,e)=>{const{id:n,data:i}=a[e],{mass:o=1}=i;r[n]={x:t.vx/o,y:t.vy/o,z:t.vz/o}})),r}function zb(t){let e=0,n=0,r=0,i=0,o=0;const a=t.length;if(a){for(let s=0;s<a;s++){const a=t[s];a&&a.weight&&(e+=a.weight,n+=a.x*a.weight,r+=a.y*a.weight,i+=a.z*a.weight,o+=a.size*a.weight)}t.x=n/e,t.y=r/e,t.z=i/e,t.size=o/e,t.weight=e}else{const e=t;t.x=e.data.x,t.y=e.data.y,t.z=e.data.z,t.size=e.data.size,t.weight=e.data.weight}}const Vb=(t,e,n,r,i,o,a)=>{var s;if((null===(s=t.data)||void 0===s?void 0:s.id)===o.id)return;const l=[n,r,i][a-1],c=o.x-t.x||.1,u=o.y-t.y||.1,h=o.z-t.z||.1,d=[c,u,h],f=l-e;let p=0;for(let t=0;t<a;t++)p+=d[t]*d[t];const g=Math.sqrt(p)*p;if(f*f*.81<p){const e=t.weight/g;return o.vx+=c*e,o.vy+=u*e,o.vz+=h*e,!0}if(t.length)return!1;if(t.data!==o){const e=t.data.weight/g;o.vx+=c*e,o.vy+=u*e,o.vz+=h*e}};const Gb={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class Wb{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},Gb),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericForceLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericForceLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<t;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericForceLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),i=e.getAllNodes(),o=e.getAllEdges(),a=this.formatOptions(r,e),{dimensions:s,width:l,height:c,nodeSize:u,getMass:h,nodeStrength:d,edgeStrength:f,linkDistance:p}=a,g=i.map(((t,e)=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:le(t.data.x)?t.data.x:Math.random()*l,y:le(t.data.y)?t.data.y:Math.random()*c,z:le(t.data.z)?t.data.z:Math.random()*Math.sqrt(l*c),size:u(t)||30,mass:h(t),nodeStrength:d(t)})}))),v=o.map((t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:f(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})})));if(!(null==i?void 0:i.length))return this.lastResult={nodes:[],edges:o},{nodes:[],edges:o};const m={};i.forEach(((t,e)=>{m[t.id]={x:0,y:0,z:0}}));const y=new ov({nodes:g,edges:v});this.formatCentripetal(a,y);const{maxIteration:b,minMovement:x,onTick:E}=a;if(this.lastLayoutNodes=g,this.lastLayoutEdges=v,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=y,this.lastOptions=a,this.lastVelMap=m,"undefined"==typeof window)return;let w=0;return new Promise((n=>{this.timeInterval=window.setInterval((()=>{i&&this.running||n({nodes:qb(e,g),edges:o}),this.runOneStep(y,e,w,m,a),this.updatePosition(e,y,m,a),t&&g.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===s?t.data.z:void 0}))),null==E||E({nodes:qb(e,g),edges:o}),w++,(w>=b||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),n({nodes:qb(e,g),edges:o}))}),0),this.running=!0}))}))}formatOptions(t,e){const n=Object.assign({},t),{width:r,height:i,getMass:o}=t;n.width=r||"undefined"==typeof window?r:window.innerWidth,n.height=i||"undefined"==typeof window?i:window.innerHeight,t.center||(n.center=[n.width/2,n.height/2]),o||(n.getMass=t=>{let n=1;le(null==t?void 0:t.data.mass)&&(n=null==t?void 0:t.data.mass);const r=e.getDegree(t.id,"both");return!r||r<5?n:5*r*n}),n.nodeSize=fb(t.nodeSize,t.nodeSpacing);const a=t.linkDistance?hb(1,t.linkDistance):t=>1+n.nodeSize(e.getNode(t.source))+n.nodeSize(e.getNode(t.target));return n.linkDistance=a,n.nodeStrength=hb(1,t.nodeStrength),n.edgeStrength=hb(1,t.edgeStrength),n}formatCentripetal(t,e){const{dimensions:n,centripetalOptions:r,center:i,clusterNodeStrength:o,leafCluster:a,clustering:s,nodeClusterBy:l}=t,c=e.getAllNodes(),u=r||{leaf:2,single:2,others:1,center:t=>({x:i[0],y:i[1],z:3===n?i[2]:void 0})};let h,d;if("function"!=typeof o&&(t.clusterNodeStrength=t=>o),a&&l&&(h=$b(e,l),d=Array.from(new Set(null==c?void 0:c.map((t=>t.data[l]))))||[],t.centripetalOptions=Object.assign(u,{single:100,leaf:e=>{const{siblingLeaves:n,sameTypeLeaves:r}=h[e.id]||{};return(null==r?void 0:r.length)===(null==n?void 0:n.length)||1===(null==d?void 0:d.length)?1:t.clusterNodeStrength(e)},others:1,center:t=>{const n=e.getDegree(t.id,"both");if(!n)return{x:100,y:100,z:0};let r;if(1===n){const{sameTypeLeaves:e=[]}=h[t.id]||{};1===e.length?r=void 0:e.length>1&&(r=Yb(e))}else r=void 0;return{x:null==r?void 0:r.x,y:null==r?void 0:r.y,z:null==r?void 0:r.z}}})),s&&l){h||(h=$b(e,l)),d||(d=Array.from(new Set(c.map((t=>t.data[l]))))),d=d.filter((t=>void 0!==t));const n={};d.forEach((t=>{const r=c.filter((e=>e.data[l]===t)).map((t=>e.getNode(t.id)));n[t]=Yb(r)})),t.centripetalOptions=Object.assign(u,{single:e=>t.clusterNodeStrength(e),leaf:e=>t.clusterNodeStrength(e),others:e=>t.clusterNodeStrength(e),center:t=>{const e=n[t.data[l]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}const{leaf:f,single:p,others:g}=t.centripetalOptions||{};f&&"function"!=typeof f&&(t.centripetalOptions.leaf=()=>f),p&&"function"!=typeof p&&(t.centripetalOptions.single=()=>p),g&&"function"!=typeof g&&(t.centripetalOptions.others=()=>g)}runOneStep(t,e,n,r,i){const o={},a=t.getAllNodes(),s=t.getAllEdges();if(!(null==a?void 0:a.length))return;const{monitor:l}=i;if(this.calRepulsive(t,o,i),s&&this.calAttractive(t,o,i),this.calGravity(t,e,o,i),this.updateVelocity(t,o,r,i),l){l({energy:this.calTotalEnergy(o,a),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}}calTotalEnergy(t,e){if(!(null==e?void 0:e.length))return 0;let n=0;return e.forEach(((e,r)=>{const i=t[e.id].x,o=t[e.id].y,a=3===this.options.dimensions?t[e.id].z:0,s=i*i+o*o+a*a,{mass:l=1}=e.data;n+=l*s*.5})),n}calRepulsive(t,e,n){const{dimensions:r,factor:i,coulombDisScale:o}=n;Bb(t,i,o*o,e,r)}calAttractive(t,e,n){const{dimensions:r,nodeSize:i}=n;t.getAllEdges().forEach(((n,o)=>{const{source:a,target:s}=n,l=t.getNode(a),c=t.getNode(s);if(!l||!c)return;let u=c.data.x-l.data.x,h=c.data.y-l.data.y,d=3===r?c.data.z-l.data.z:0;u||h||(u=.01*Math.random(),h=.01*Math.random(),3!==r||d||(d=.01*Math.random()));const f=Math.sqrt(u*u+h*h+d*d);if(f<i(l)+i(c))return;const p=u/f,g=h/f,v=d/f,{linkDistance:m=200,edgeStrength:y=200}=n.data||{},b=(m-f)*y,x=1/(l.data.mass||1),E=1/(c.data.mass||1),w=p*b,k=g*b,M=v*b;e[a].x-=w*x,e[a].y-=k*x,e[a].z-=M*x,e[s].x+=w*E,e[s].y+=k*E,e[s].z+=M*E}))}calGravity(t,e,n,r){const{getCenter:i}=r,o=t.getAllNodes(),a=e.getAllNodes(),s=e.getAllEdges(),{width:l,height:c,center:u,gravity:h,centripetalOptions:d}=r;o&&o.forEach((r=>{const{id:o,data:f}=r,{mass:p,x:g,y:v,z:m}=f,y=e.getNode(o);let b=0,x=0,E=0,w=h;const k=t.getDegree(o,"in"),M=t.getDegree(o,"out"),N=t.getDegree(o,"both"),O=null==i?void 0:i(y,N);if(O){const[t,e,n]=O;b=g-t,x=v-e,w=n}else b=g-u[0],x=v-u[1],E=m-u[2];if(w&&(n[o].x-=w*b/p,n[o].y-=w*x/p,n[o].z-=w*E/p),d){const{leaf:t,single:e,others:r,center:i}=d,{x:u,y:h,z:f,centerStrength:b}=(null==i?void 0:i(y,a,s,l,c))||{x:0,y:0,z:0,centerStrength:0};if(!le(u)||!le(h))return;const x=(g-u)/p,E=(v-h)/p,w=(m-f)/p;if(b&&(n[o].x-=b*x,n[o].y-=b*E,n[o].z-=b*w),0===N){const t=e(y);if(!t)return;return n[o].x-=t*x,n[o].y-=t*E,void(n[o].z-=t*w)}if(0===k||0===M){const e=t(y,a,s);if(!e)return;return n[o].x-=e*x,n[o].y-=e*E,void(n[o].z-=e*w)}const O=r(y);if(!O)return;n[o].x-=O*x,n[o].y-=O*E,n[o].z-=O*w}}))}updateVelocity(t,e,n,r){const{damping:i,maxSpeed:o,interval:a,dimensions:s}=r,l=t.getAllNodes();(null==l?void 0:l.length)&&l.forEach((t=>{const{id:r}=t;let l=(n[r].x+e[r].x*a)*i||.01,c=(n[r].y+e[r].y*a)*i||.01,u=3===s?(n[r].z+e[r].z*a)*i||.01:0;const h=Math.sqrt(l*l+c*c+u*u);if(h>o){const t=o/h;l*=t,c*=t,u*=t}n[r]={x:l,y:c,z:u}}))}updatePosition(t,e,n,r){const{distanceThresholdMode:i,interval:o,dimensions:a}=r,s=e.getAllNodes();if(!(null==s?void 0:s.length))return void(this.judgingDistance=0);let l=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach((r=>{const{id:s}=r,c=t.getNode(s);if(le(c.data.fx)&&le(c.data.fy))return void e.mergeNodeData(s,{x:c.data.fx,y:c.data.fy,z:3===a?c.data.fz:void 0});const u=n[s].x*o,h=n[s].y*o,d=3===a?n[s].z*o:0;e.mergeNodeData(s,{x:r.data.x+u,y:r.data.y+h,z:r.data.z+d});const f=Math.sqrt(u*u+h*h+d*d);switch(i){case"max":this.judgingDistance<f&&(this.judgingDistance=f);break;case"min":this.judgingDistance>f&&(this.judgingDistance=f);break;default:l+=f}})),i&&"mean"!==i||(this.judgingDistance=l/s.length)}}const $b=(t,e)=>{const n=t.getAllNodes();if(!(null==n?void 0:n.length))return{};const r={};return n.forEach(((n,i)=>{1===t.getDegree(n.id,"both")&&(r[n.id]=Hb(t,"leaf",n,e))})),r},Hb=(t,e,n,r)=>{const i=t.getDegree(n.id,"in"),o=t.getDegree(n.id,"out");let a=n,s=[];0===i?(a=t.getSuccessors(n.id)[0],s=t.getNeighbors(a.id)):0===o&&(a=t.getPredecessors(n.id)[0],s=t.getNeighbors(a.id)),s=s.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")));return{coreNode:a,siblingLeaves:s,sameTypeLeaves:Ub(t,e,r,n,s)}},Ub=(t,e,n,r,i)=>{const o=r.data[n]||"";let a=(null==i?void 0:i.filter((t=>t.data[n]===o)))||[];return a=a.filter((e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"))),a},Yb=t=>{const e={x:0,y:0};t.forEach((t=>{const{x:n,y:r}=t.data;e.x+=n||0,e.y+=r||0}));const n=t.length||1;return{x:e.x/n,y:e.y/n}},qb=(t,e)=>e.map((e=>{const{id:n,data:r}=e,i=t.getNode(n);return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{x:r.x,y:r.y,z:r.z})})}));var Xb={};const Kb=Object.prototype.toString;function Zb(t){const e=Kb.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var Jb=w(Object.freeze({__proto__:null,isAnyArray:Zb}));var Qb,tx=Object.freeze({__proto__:null,default:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Zb(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!Zb(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Zb(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]<a&&(a=t[s]);return a}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Zb(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]>a&&(a=t[s]);return a}(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,a=void 0===o?n.autoMinMax?r:0:o,s=n.max,l=void 0===s?n.autoMinMax?i:1:s;if(a>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-a)/(i-r),u=0;u<t.length;u++)e[u]=(t[u]-r)*c+a;return e}}),ex=w(tx);function nx(){if(Qb)return Xb;Qb=1,Object.defineProperty(Xb,"__esModule",{value:!0});var t=Jb,e=ex;const n=" ".repeat(2),r=" ".repeat(4);function i(t,e={}){const{maxRows:i=15,maxColumns:a=10,maxNumSize:s=8,padMinus:l="auto"}=e;return`${t.constructor.name} {\n${n}[\n${r}${function(t,e,n,i,a){const{rows:s,columns:l}=t,c=Math.min(s,e),u=Math.min(l,n),h=[];if("auto"===a){a=!1;t:for(let e=0;e<c;e++)for(let n=0;n<u;n++)if(t.get(e,n)<0){a=!0;break t}}for(let e=0;e<c;e++){let n=[];for(let r=0;r<u;r++)n.push(o(t.get(e,r),i,a));h.push(`${n.join(" ")}`)}u!==l&&(h[h.length-1]+=` ... ${l-n} more columns`);c!==s&&h.push(`... ${s-e} more rows`);return h.join(`\n${r}`)}(t,i,a,s,l)}\n${n}]\n${n}rows: ${t.rows}\n${n}columns: ${t.columns}\n}`}function o(t,e,n){return(t>=0&&n?` ${a(t,e-1)}`:a(t,e)).padEnd(e)}function a(t,e){let n=t.toString();if(n.length<=e)return n;let r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function s(t,e,n){let r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function l(t,e,n){let r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function c(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function u(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function h(e,n){if(!t.isAnyArray(n))throw new TypeError("row indices must be an array");for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.rows)throw new RangeError("row indices are out of range")}function d(e,n){if(!t.isAnyArray(n))throw new TypeError("column indices must be an array");for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.columns)throw new RangeError("column indices are out of range")}function f(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(g("startRow",e),g("endRow",n),g("startColumn",r),g("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function p(t,e=0){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function g(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function v(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class m{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let r=new b(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n[i*e+t]);return r}static rowVector(t){let e=new b(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new b(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new b(t,e)}static ones(t,e){return new b(t,e).fill(1)}static rand(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let i=new b(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)i.set(n,t,r());return i}static randInt(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:r=0,max:i=1e3,random:o=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(r>=i)throw new RangeError("min must be smaller than max");let a=i-r,s=new b(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=r+Math.round(o()*a);s.set(n,t,e)}return s}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let r=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<r;t++)i.set(t,t,n);return i}static diag(t,e,n){let r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);let i=Math.min(r,e,n),o=this.zeros(e,n);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new b(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.min(t.get(o,n),e.get(o,n)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new this(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.max(t.get(o,n),e.get(o,n)));return i}static checkMatrix(t){return m.isMatrix(t)?t:new b(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);let i=t.get(e,n);for(let r=n;r<t.columns;r++)t.set(e,r,t.get(e,r)/i);for(let r=e+1;r<t.rows;r++){let i=t.get(r,n)/t.get(e,n);t.set(r,n,0);for(let o=n+1;o<t.columns;o++)t.set(r,o,t.get(r,o)-t.get(e,o)*i)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(0===t.maxRow(r))r--;else{let i=0,o=!1;for(;i<n&&!1===o;)1===t.get(r,i)?o=!0:i++;for(let n=0;n<r;n++){let o=t.get(n,i);for(let a=i;a<e;a++){let e=t.get(n,a)-o*t.get(r,a);t.set(n,a,e)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new b(this.rows*e,this.columns*n);for(let t=0;t<e;t++)for(let e=0;e<n;e++)r.setSubMatrix(this,this.rows*t,this.columns*e);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){s(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return b.rowVector(this.getRow(t))}setRow(t,e){s(this,t),e=c(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){s(this,t),s(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){l(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return b.columnVector(this.getColumn(t))}setColumn(t,e){l(this,t),e=u(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l(this,t),l(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=c(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){s(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){v(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){v(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(s(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){s(this,t),v(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(s(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){s(this,t),v(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l(this,t),v(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l(this,t),v(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){m.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=b.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,i=new b(e,r),o=new Float64Array(n);for(let a=0;a<r;a++){for(let e=0;e<n;e++)o[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let r=0;r<n;r++)e+=this.get(t,r)*o[r];i.set(t,a,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=b.eye(this.rows),n=this;for(let r=t;r>1;r/=2)1&r&&(e=e.mmul(n)),n=n.mmul(n);return e}strassen2x2(t){t=b.checkMatrix(t);let e=new b(2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),l=this.get(1,1),c=t.get(1,1),u=(n+l)*(r+c),h=(a+l)*r,d=n*(o-c),f=l*(s-r),p=(n+i)*c,g=u+f-p+(i-l)*(s+c),v=d+p,m=h+f,y=u-h+d+(a-n)*(r+o);return e.set(0,0,g),e.set(0,1,v),e.set(1,0,m),e.set(1,1,y),e}strassen3x3(t){t=b.checkMatrix(t);let e=new b(3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),h=t.get(0,0),d=t.get(0,1),f=t.get(0,2),p=t.get(1,0),g=t.get(1,1),v=t.get(1,2),m=t.get(2,0),y=t.get(2,1),x=t.get(2,2),E=(n-o)*(-d+g),w=(-n+o+a)*(h-d+g),k=(o+a)*(-h+d),M=n*h,N=(-n+l+c)*(h-f+v),O=(-n+l)*(f-v),S=(l+c)*(-h+f),T=(-i+c+u)*(g+m-y),_=(i-u)*(g-y),A=i*m,C=(c+u)*(-m+y),P=(-i+a+s)*(v+m-x),D=(i-s)*(v-x),R=(a+s)*(-m+x),L=M+A+r*p,I=(n+r+i-o-a-c-u)*g+w+k+M+T+A+C,j=M+N+S+(n+r+i-a-s-l-c)*v+A+P+R,F=E+a*(-h+d+p-g-v-m+x)+w+M+A+P+D,B=E+w+k+M+s*y,z=A+P+D+R+o*f,V=M+N+O+c*(-h+f+p-g-v-m+y)+T+_+A,G=T+_+A+C+l*d,W=M+N+O+S+u*x;return e.set(0,0,L),e.set(0,1,I),e.set(0,2,j),e.set(1,0,F),e.set(1,1,B),e.set(1,2,z),e.set(2,0,V),e.set(2,1,G),e.set(2,2,W),e}mmulStrassen(t){t=b.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,i=t.rows,o=t.columns;function a(t,e,n){let r=t.rows,i=t.columns;if(r===e&&i===n)return t;{let r=m.zeros(e,n);return r=r.setSubMatrix(t,0,0),r}}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${o} matrix: dimensions do not match.`);let s=Math.max(n,i),l=Math.max(r,o);return e=a(e,s,l),function t(e,n,r,i){if(r<=512||i<=512)return e.mmul(n);r%2==1&&i%2==1?(e=a(e,r+1,i+1),n=a(n,r+1,i+1)):r%2==1?(e=a(e,r+1,i),n=a(n,r+1,i)):i%2==1&&(e=a(e,r,i+1),n=a(n,r,i+1));let o=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),l=e.subMatrix(0,o-1,0,s-1),c=n.subMatrix(0,o-1,0,s-1),u=e.subMatrix(0,o-1,s,e.columns-1),h=n.subMatrix(0,o-1,s,n.columns-1),d=e.subMatrix(o,e.rows-1,0,s-1),f=n.subMatrix(o,n.rows-1,0,s-1),p=e.subMatrix(o,e.rows-1,s,e.columns-1),g=n.subMatrix(o,n.rows-1,s,n.columns-1),v=t(m.add(l,p),m.add(c,g),o,s),y=t(m.add(d,p),c,o,s),b=t(l,m.sub(h,g),o,s),x=t(p,m.sub(f,c),o,s),E=t(m.add(l,u),g,o,s),w=t(m.sub(d,l),m.add(c,h),o,s),k=t(m.sub(u,p),m.add(f,g),o,s),M=m.add(v,x);M.sub(E),M.add(k);let N=m.add(b,E),O=m.add(y,x),S=m.sub(v,y);S.add(b),S.add(w);let T=m.zeros(2*M.rows,2*M.columns);return T=T.setSubMatrix(M,0,0),T=T.setSubMatrix(N,M.rows,0),T=T.setSubMatrix(O,0,M.columns),T=T.setSubMatrix(S,M.rows,M.columns),T.subMatrix(0,r-1,0,i-1)}(e,t=a(t,s,l),s,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:n=0,max:r=1}=t;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(n>=r)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&e(o,{min:n,max:r,output:o}),i.setRow(t,o)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:n=0,max:r=1}=t;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(n>=r)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&e(o,{min:n,max:r,output:o}),i.setColumn(t,o)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),r=this.get(e,this.columns-1-n);this.set(e,n,r),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),r=this.get(this.rows-1-n,e);this.set(n,e,r),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=b.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new b(e*r,n*i);for(let a=0;a<e;a++)for(let e=0;e<n;e++)for(let n=0;n<r;n++)for(let s=0;s<i;s++)o.set(r*a+n,i*e+s,this.get(a,e)*t.get(n,s));return o}kroneckerSum(t){if(t=b.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(b.eye(n,n)),i=b.eye(e,e).kroneckerProduct(t);return r.add(i)}transpose(){let t=new b(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=y){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=y){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){f(this,t,e,n,r);let i=new b(e-t+1,r-n+1);for(let o=t;o<=e;o++)for(let e=n;e<=r;e++)i.set(o-t,e-n,this.get(o,e));return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new b(t.length,n-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=n;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new b(n-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=n;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){if((t=b.checkMatrix(t)).isEmpty())return this;f(this,e,e+t.rows-1,n,n+t.columns-1);for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}selection(t,e){h(this,t),d(this,e);let n=new b(t.length,e.length);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<e.length;t++){let o=e[t];n.set(r,t,this.get(i,o))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new b(this.rows,this.columns))}static copy(t,e){for(const[n,r,i]of t.entries())e.set(n,r,i);return e}sum(t){switch(t){case"row":return function(t){let e=p(t.rows);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){let e=p(t.columns);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=p(t.rows,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){let e=p(t.columns,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(e)}=n;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,o=[];for(let a=0;a<r;a++){let r=0,s=0,l=0;for(let e=0;e<i;e++)l=t.get(a,e)-n[a],r+=l,s+=l*l;e?o.push((s-r*r/i)/(i-1)):o.push((s-r*r/i)/i)}return o}(this,r,i);case"column":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,o=[];for(let a=0;a<i;a++){let i=0,s=0,l=0;for(let e=0;e<r;e++)l=t.get(e,a)-n[a],i+=l,s+=l*l;e?o.push((s-i*i/r)/(r-1)):o.push((s-i*i/r)/r)}return o}(this,r,i);case void 0:if("number"!=typeof i)throw new TypeError("mean must be a number");return function(t,e,n){const r=t.rows,i=t.columns,o=r*i;let a=0,s=0,l=0;for(let e=0;e<r;e++)for(let r=0;r<i;r++)l=t.get(e,r)-n,a+=l,s+=l*l;return e?(s-a*a/o)/(o-1):(s-a*a/o)/o}(this,r,i);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let t=0;t<n.length;t++)n[t]=Math.sqrt(n[t]);return n}center(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");const{center:r=this.mean(e)}=n;switch(e){case"row":if(!t.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}(this,r),this;case"column":if(!t.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}(this,r),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");let r=n.scale;switch(e){case"row":if(void 0===r)r=function(t){const e=[];for(let n=0;n<t.rows;n++){let r=0;for(let e=0;e<t.columns;e++)r+=t.get(n,e)**2/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!t.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let n=0;n<t.columns;n++){let r=0;for(let e=0;e<t.rows;e++)r+=t.get(e,n)**2/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!t.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let n=0;for(let r=0;r<t.columns;r++)for(let i=0;i<t.rows;i++)n+=t.get(i,r)**2/e;return Math.sqrt(n)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}(this,r),this;default:throw new Error(`invalid option: ${e}`)}}toString(t){return i(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function y(t,e){return t-e}m.prototype.klass="Matrix","undefined"!=typeof Symbol&&(m.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return i(this)}),m.random=m.rand,m.randomInt=m.randInt,m.diagonal=m.diag,m.prototype.diagonal=m.prototype.diag,m.identity=m.eye,m.prototype.negate=m.prototype.neg,m.prototype.tensorProduct=m.prototype.kroneckerProduct;class b extends m{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,n){if(super(),b.isMatrix(e))this.#t(e.rows,e.columns),b.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,n);else{if(!t.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(n=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(t[r].length!==n)throw new RangeError("Inconsistent array dimensions");if(!t[r].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[r]))}this.rows=e,this.columns=n}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return s(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),s(this,t,!0),e=Float64Array.from(c(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){l(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let r=0;r<t;r++)n[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)n[r-1]=this.data[e][r];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),l(this,t,!0),e=u(this,e);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t.get(e,n));return this}}(m,b);class x extends m{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return b.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),b.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=b.copy(t,new b(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new b(t,t);else if(this.#e=new b(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new x(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())t.set(e,n,r);return t}toMatrix(){return new b(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,r]of t.entries())r||e.push(n);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=++r);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const r=new x(n);for(let i=0,o=0,a=0;a<e;a++)r.set(i,o,t[a]),++i>=n&&(i=++o);return r}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}x.prototype.klassType="SymmetricMatrix";class E extends x{static isDistanceMatrix(t){return x.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new x(this)}clone(){const t=new E(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())e!==n&&t.set(e,n,r);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=1+ ++r);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const r=new this(n);for(let i=1,o=0,a=0;a<e;a++)r.set(i,o,t[a]),++i>=n&&(i=1+ ++o);return r}}E.prototype.klassSubType="DistanceMatrix";class w extends m{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class k extends w{constructor(t,e,n){h(t,e),d(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class M extends m{constructor(t,e={}){const{rows:n=1}=e;if(t.length%n!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let r=this._calculateIndex(t,e);return this.data[r]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class N extends m{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class O{constructor(t){let e,n,r,i,o,a,s,l,c,u=(t=N.checkMatrix(t)).clone(),h=u.rows,d=u.columns,f=new Float64Array(h),p=1;for(e=0;e<h;e++)f[e]=e;for(l=new Float64Array(h),n=0;n<d;n++){for(e=0;e<h;e++)l[e]=u.get(e,n);for(e=0;e<h;e++){for(c=Math.min(e,n),o=0,r=0;r<c;r++)o+=u.get(e,r)*l[r];l[e]-=o,u.set(e,n,l[e])}for(i=n,e=n+1;e<h;e++)Math.abs(l[e])>Math.abs(l[i])&&(i=e);if(i!==n){for(r=0;r<d;r++)a=u.get(i,r),u.set(i,r,u.get(n,r)),u.set(n,r,a);s=f[i],f[i]=f[n],f[n]=s,p=-p}if(n<h&&0!==u.get(n,n))for(e=n+1;e<h;e++)u.set(e,n,u.get(e,n)/u.get(n,n))}this.LU=u,this.pivotVector=f,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=b.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,r,i,o=t.columns,a=t.subMatrixRow(this.pivotVector,0,o-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<o;r++)a.set(n,r,a.get(n,r)-a.get(i,r)*e.get(n,i));for(i=s-1;i>=0;i--){for(r=0;r<o;r++)a.set(i,r,a.get(i,r)/e.get(i,i));for(n=0;n<i;n++)for(r=0;r<o;r++)a.set(n,r,a.get(n,r)-a.get(i,r)*e.get(n,i))}return a}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new b(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i>e?r.set(i,e,t.get(i,e)):i===e?r.set(i,e,1):r.set(i,e,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new b(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i<=e?r.set(i,e,t.get(i,e)):r.set(i,e,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function S(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class T{constructor(t){let e,n,r,i,o=(t=N.checkMatrix(t)).clone(),a=t.rows,s=t.columns,l=new Float64Array(s);for(r=0;r<s;r++){let t=0;for(e=r;e<a;e++)t=S(t,o.get(e,r));if(0!==t){for(o.get(r,r)<0&&(t=-t),e=r;e<a;e++)o.set(e,r,o.get(e,r)/t);for(o.set(r,r,o.get(r,r)+1),n=r+1;n<s;n++){for(i=0,e=r;e<a;e++)i+=o.get(e,r)*o.get(e,n);for(i=-i/o.get(r,r),e=r;e<a;e++)o.set(e,n,o.get(e,n)+i*o.get(e,r))}}l[r]=-t}this.QR=o,this.Rdiag=l}solve(t){t=b.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r,i,o,a,s=t.columns,l=t.clone(),c=e.columns;for(o=0;o<c;o++)for(i=0;i<s;i++){for(a=0,r=o;r<n;r++)a+=e.get(r,o)*l.get(r,i);for(a=-a/e.get(o,o),r=o;r<n;r++)l.set(r,i,l.get(r,i)+a*e.get(r,o))}for(o=c-1;o>=0;o--){for(i=0;i<s;i++)l.set(o,i,l.get(o,i)/this.Rdiag[o]);for(r=0;r<o;r++)for(i=0;i<s;i++)l.set(r,i,l.get(r,i)-l.get(o,i)*e.get(r,o))}return l.subMatrix(0,c-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,r=n.columns,i=new b(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?i.set(t,e,n.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,n,r,i=this.QR,o=i.rows,a=i.columns,s=new b(o,a);for(n=a-1;n>=0;n--){for(t=0;t<o;t++)s.set(t,n,0);for(s.set(n,n,1),e=n;e<a;e++)if(0!==i.get(n,n)){for(r=0,t=n;t<o;t++)r+=i.get(t,n)*s.get(t,e);for(r=-r/i.get(n,n),t=n;t<o;t++)s.set(t,e,s.get(t,e)+r*i.get(t,n))}}return s}}class _{constructor(t,e={}){if((t=N.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:a=!1}=e;let s,l=Boolean(i),c=Boolean(o),u=!1;if(n<r)if(a){s=t.transpose(),n=s.rows,r=s.columns,u=!0;let e=l;l=c,c=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let h=Math.min(n,r),d=Math.min(n+1,r),f=new Float64Array(d),p=new b(n,h),g=new b(r,r),v=new Float64Array(r),m=new Float64Array(n),y=new Float64Array(d);for(let t=0;t<d;t++)y[t]=t;let x=Math.min(n-1,r),E=Math.max(0,Math.min(r-2,n)),w=Math.max(x,E);for(let t=0;t<w;t++){if(t<x){f[t]=0;for(let e=t;e<n;e++)f[t]=S(f[t],s.get(e,t));if(0!==f[t]){s.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<n;e++)s.set(e,t,s.get(e,t)/f[t]);s.set(t,t,s.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<r;e++){if(t<x&&0!==f[t]){let r=0;for(let i=t;i<n;i++)r+=s.get(i,t)*s.get(i,e);r=-r/s.get(t,t);for(let i=t;i<n;i++)s.set(i,e,s.get(i,e)+r*s.get(i,t))}v[e]=s.get(t,e)}if(l&&t<x)for(let e=t;e<n;e++)p.set(e,t,s.get(e,t));if(t<E){v[t]=0;for(let e=t+1;e<r;e++)v[t]=S(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<r;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<n&&0!==v[t]){for(let e=t+1;e<n;e++)m[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)m[e]+=v[n]*s.get(e,n);for(let e=t+1;e<r;e++){let r=-v[e]/v[t+1];for(let i=t+1;i<n;i++)s.set(i,e,s.get(i,e)+r*m[i])}}if(c)for(let e=t+1;e<r;e++)g.set(e,t,v[e])}}let k=Math.min(r,n+1);if(x<r&&(f[x]=s.get(x,x)),n<k&&(f[k-1]=0),E+1<k&&(v[E]=s.get(E,k-1)),v[k-1]=0,l){for(let t=x;t<h;t++){for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=x-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<h;e++){let r=0;for(let i=t;i<n;i++)r+=p.get(i,t)*p.get(i,e);r=-r/p.get(t,t);for(let i=t;i<n;i++)p.set(i,e,p.get(i,e)+r*p.get(i,t))}for(let e=t;e<n;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}}if(c)for(let t=r-1;t>=0;t--){if(t<E&&0!==v[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=g.get(i,t)*g.get(i,e);n=-n/g.get(t+1,t);for(let i=t+1;i<r;i++)g.set(i,e,g.get(i,e)+n*g.get(i,t))}for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}let M=k-1,O=Number.EPSILON;for(;k>0;){let t,e;for(t=k-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+O*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===k-2)e=4;else{let n;for(n=k-1;n>=t&&n!==t;n--){let e=(n!==k?Math.abs(v[n]):0)+(n!==t+1?Math.abs(v[n-1]):0);if(Math.abs(f[n])<=O*e){f[n]=0;break}}n===t?e=3:n===k-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=v[k-2];v[k-2]=0;for(let n=k-2;n>=t;n--){let i=S(f[n],e),o=f[n]/i,a=e/i;if(f[n]=i,n!==t&&(e=-a*v[n-1],v[n-1]=o*v[n-1]),c)for(let t=0;t<r;t++)i=o*g.get(t,n)+a*g.get(t,k-1),g.set(t,k-1,-a*g.get(t,n)+o*g.get(t,k-1)),g.set(t,n,i)}break}case 2:{let e=v[t-1];v[t-1]=0;for(let r=t;r<k;r++){let i=S(f[r],e),o=f[r]/i,a=e/i;if(f[r]=i,e=-a*v[r],v[r]=o*v[r],l)for(let e=0;e<n;e++)i=o*p.get(e,r)+a*p.get(e,t-1),p.set(e,t-1,-a*p.get(e,r)+o*p.get(e,t-1)),p.set(e,r,i)}break}case 3:{const e=Math.max(Math.abs(f[k-1]),Math.abs(f[k-2]),Math.abs(v[k-2]),Math.abs(f[t]),Math.abs(v[t])),i=f[k-1]/e,o=f[k-2]/e,a=v[k-2]/e,s=f[t]/e,u=v[t]/e,h=((o+i)*(o-i)+a*a)/2,d=i*a*(i*a);let m=0;0===h&&0===d||(m=h<0?0-Math.sqrt(h*h+d):Math.sqrt(h*h+d),m=d/(h+m));let y=(s+i)*(s-i)+m,b=s*u;for(let e=t;e<k-1;e++){let i=S(y,b);0===i&&(i=Number.MIN_VALUE);let o=y/i,a=b/i;if(e!==t&&(v[e-1]=i),y=o*f[e]+a*v[e],v[e]=o*v[e]-a*f[e],b=a*f[e+1],f[e+1]=o*f[e+1],c)for(let t=0;t<r;t++)i=o*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+o*g.get(t,e+1)),g.set(t,e,i);if(i=S(y,b),0===i&&(i=Number.MIN_VALUE),o=y/i,a=b/i,f[e]=i,y=o*v[e]+a*f[e+1],f[e+1]=-a*v[e]+o*f[e+1],b=a*v[e+1],v[e+1]=o*v[e+1],l&&e<n-1)for(let t=0;t<n;t++)i=o*p.get(t,e)+a*p.get(t,e+1),p.set(t,e+1,-a*p.get(t,e)+o*p.get(t,e+1)),p.set(t,e,i)}v[k-2]=y;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,c))for(let e=0;e<=M;e++)g.set(e,t,-g.get(e,t));for(;t<M&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,c&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);if(l&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);t++}k--}}if(u){let t=g;g=p,p=t}this.m=n,this.n=r,this.s=f,this.U=p,this.V=g}solve(t){let e=t,n=this.threshold,r=this.s.length,i=b.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,a=this.rightSingularVectors,s=a.mmul(i),l=a.rows,c=o.rows,u=b.zeros(l,c);for(let t=0;t<l;t++)for(let e=0;e<c;e++){let n=0;for(let i=0;i<r;i++)n+=s.get(t,i)*o.get(e,i);u.set(t,e,n)}return u.mmul(e)}solveForDiagonal(t){return this.solve(b.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,i=new b(n,this.s.length);for(let o=0;o<n;o++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e&&i.set(o,n,t.get(o,n)/this.s[n]);let o=this.U,a=o.rows,s=o.columns,l=new b(n,a);for(let t=0;t<n;t++)for(let e=0;e<a;e++){let n=0;for(let r=0;r<s;r++)n+=i.get(t,r)*o.get(e,r);l.set(t,e,n)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return b.diag(this.s)}}function A(t,e,n=!1){return t=N.checkMatrix(t),e=N.checkMatrix(e),n?new _(t).solve(e):t.isSquare()?new O(t).solve(e):new T(t).solve(e)}function C(t,e){let n=[];for(let r=0;r<t;r++)r!==e&&n.push(r);return n}function P(t,e,n,r=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<r&&t.set(e,0,0);return t.to1DArray()}}class D{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=N.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r,i,o=t.columns,a=new b(o,o),s=new Float64Array(o),l=new Float64Array(o),c=t,u=!1;if(u=!!n||t.isSymmetric(),u){for(r=0;r<o;r++)for(i=0;i<o;i++)a.set(r,i,c.get(r,i));!function(t,e,n,r){let i,o,a,s,l,c,u,h;for(l=0;l<t;l++)n[l]=r.get(t-1,l);for(s=t-1;s>0;s--){for(h=0,a=0,c=0;c<s;c++)h+=Math.abs(n[c]);if(0===h)for(e[s]=n[s-1],l=0;l<s;l++)n[l]=r.get(s-1,l),r.set(s,l,0),r.set(l,s,0);else{for(c=0;c<s;c++)n[c]/=h,a+=n[c]*n[c];for(i=n[s-1],o=Math.sqrt(a),i>0&&(o=-o),e[s]=h*o,a-=i*o,n[s-1]=i-o,l=0;l<s;l++)e[l]=0;for(l=0;l<s;l++){for(i=n[l],r.set(l,s,i),o=e[l]+r.get(l,l)*i,c=l+1;c<=s-1;c++)o+=r.get(c,l)*n[c],e[c]+=r.get(c,l)*i;e[l]=o}for(i=0,l=0;l<s;l++)e[l]/=a,i+=e[l]*n[l];for(u=i/(a+a),l=0;l<s;l++)e[l]-=u*n[l];for(l=0;l<s;l++){for(i=n[l],o=e[l],c=l;c<=s-1;c++)r.set(c,l,r.get(c,l)-(i*e[c]+o*n[c]));n[l]=r.get(s-1,l),r.set(s,l,0)}}n[s]=a}for(s=0;s<t-1;s++){if(r.set(t-1,s,r.get(s,s)),r.set(s,s,1),a=n[s+1],0!==a){for(c=0;c<=s;c++)n[c]=r.get(c,s+1)/a;for(l=0;l<=s;l++){for(o=0,c=0;c<=s;c++)o+=r.get(c,s+1)*r.get(c,l);for(c=0;c<=s;c++)r.set(c,l,r.get(c,l)-o*n[c])}}for(c=0;c<=s;c++)r.set(c,s+1,0)}for(l=0;l<t;l++)n[l]=r.get(t-1,l),r.set(t-1,l,0);r.set(t-1,t-1,1),e[0]=0}(o,l,s,a),function(t,e,n,r){let i,o,a,s,l,c,u,h,d,f,p,g,v,m,y,b;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;let x=0,E=0,w=Number.EPSILON;for(c=0;c<t;c++){for(E=Math.max(E,Math.abs(n[c])+Math.abs(e[c])),u=c;u<t&&!(Math.abs(e[u])<=w*E);)u++;if(u>c)do{for(i=n[c],h=(n[c+1]-i)/(2*e[c]),d=S(h,1),h<0&&(d=-d),n[c]=e[c]/(h+d),n[c+1]=e[c]*(h+d),f=n[c+1],o=i-n[c],a=c+2;a<t;a++)n[a]-=o;for(x+=o,h=n[u],p=1,g=p,v=p,m=e[c+1],y=0,b=0,a=u-1;a>=c;a--)for(v=g,g=p,b=y,i=p*e[a],o=p*h,d=S(h,e[a]),e[a+1]=y*d,y=e[a]/d,p=h/d,h=p*n[a]-y*i,n[a+1]=o+y*(p*i+y*n[a]),l=0;l<t;l++)o=r.get(l,a+1),r.set(l,a+1,y*r.get(l,a)+p*o),r.set(l,a,p*r.get(l,a)-y*o);h=-y*b*v*m*e[c]/f,e[c]=y*h,n[c]=p*h}while(Math.abs(e[c])>w*E);n[c]=n[c]+x,e[c]=0}for(a=0;a<t-1;a++){for(l=a,h=n[a],s=a+1;s<t;s++)n[s]<h&&(l=s,h=n[s]);if(l!==a)for(n[l]=n[a],n[a]=h,s=0;s<t;s++)h=r.get(s,a),r.set(s,a,r.get(s,l)),r.set(s,l,h)}}(o,l,s,a)}else{let t=new b(o,o),e=new Float64Array(o);for(i=0;i<o;i++)for(r=0;r<o;r++)t.set(r,i,c.get(r,i));!function(t,e,n,r){let i,o,a,s,l,c,u,h=0,d=t-1;for(c=h+1;c<=d-1;c++){for(u=0,s=c;s<=d;s++)u+=Math.abs(e.get(s,c-1));if(0!==u){for(a=0,s=d;s>=c;s--)n[s]=e.get(s,c-1)/u,a+=n[s]*n[s];for(o=Math.sqrt(a),n[c]>0&&(o=-o),a-=n[c]*o,n[c]=n[c]-o,l=c;l<t;l++){for(i=0,s=d;s>=c;s--)i+=n[s]*e.get(s,l);for(i/=a,s=c;s<=d;s++)e.set(s,l,e.get(s,l)-i*n[s])}for(s=0;s<=d;s++){for(i=0,l=d;l>=c;l--)i+=n[l]*e.get(s,l);for(i/=a,l=c;l<=d;l++)e.set(s,l,e.get(s,l)-i*n[l])}n[c]=u*n[c],e.set(c,c-1,u*o)}}for(s=0;s<t;s++)for(l=0;l<t;l++)r.set(s,l,s===l?1:0);for(c=d-1;c>=h+1;c--)if(0!==e.get(c,c-1)){for(s=c+1;s<=d;s++)n[s]=e.get(s,c-1);for(l=c;l<=d;l++){for(o=0,s=c;s<=d;s++)o+=n[s]*r.get(s,l);for(o=o/n[c]/e.get(c,c-1),s=c;s<=d;s++)r.set(s,l,r.get(s,l)+o*n[s])}}}(o,t,e,a),function(t,e,n,r,i){let o,a,s,l,c,u,h,d,f,p,g,v,m,y,b,x=t-1,E=0,w=t-1,k=Number.EPSILON,M=0,N=0,O=0,S=0,T=0,_=0,A=0,C=0;for(o=0;o<t;o++)for((o<E||o>w)&&(n[o]=i.get(o,o),e[o]=0),a=Math.max(o-1,0);a<t;a++)N+=Math.abs(i.get(o,a));for(;x>=E;){for(l=x;l>E&&(_=Math.abs(i.get(l-1,l-1))+Math.abs(i.get(l,l)),0===_&&(_=N),!(Math.abs(i.get(l,l-1))<k*_));)l--;if(l===x)i.set(x,x,i.get(x,x)+M),n[x]=i.get(x,x),e[x]=0,x--,C=0;else if(l===x-1){if(h=i.get(x,x-1)*i.get(x-1,x),O=(i.get(x-1,x-1)-i.get(x,x))/2,S=O*O+h,A=Math.sqrt(Math.abs(S)),i.set(x,x,i.get(x,x)+M),i.set(x-1,x-1,i.get(x-1,x-1)+M),d=i.get(x,x),S>=0){for(A=O>=0?O+A:O-A,n[x-1]=d+A,n[x]=n[x-1],0!==A&&(n[x]=d-h/A),e[x-1]=0,e[x]=0,d=i.get(x,x-1),_=Math.abs(d)+Math.abs(A),O=d/_,S=A/_,T=Math.sqrt(O*O+S*S),O/=T,S/=T,a=x-1;a<t;a++)A=i.get(x-1,a),i.set(x-1,a,S*A+O*i.get(x,a)),i.set(x,a,S*i.get(x,a)-O*A);for(o=0;o<=x;o++)A=i.get(o,x-1),i.set(o,x-1,S*A+O*i.get(o,x)),i.set(o,x,S*i.get(o,x)-O*A);for(o=E;o<=w;o++)A=r.get(o,x-1),r.set(o,x-1,S*A+O*r.get(o,x)),r.set(o,x,S*r.get(o,x)-O*A)}else n[x-1]=d+O,n[x]=d+O,e[x-1]=A,e[x]=-A;x-=2,C=0}else{if(d=i.get(x,x),f=0,h=0,l<x&&(f=i.get(x-1,x-1),h=i.get(x,x-1)*i.get(x-1,x)),10===C){for(M+=d,o=E;o<=x;o++)i.set(o,o,i.get(o,o)-d);_=Math.abs(i.get(x,x-1))+Math.abs(i.get(x-1,x-2)),d=f=.75*_,h=-.4375*_*_}if(30===C&&(_=(f-d)/2,_=_*_+h,_>0)){for(_=Math.sqrt(_),f<d&&(_=-_),_=d-h/((f-d)/2+_),o=E;o<=x;o++)i.set(o,o,i.get(o,o)-_);M+=_,d=f=h=.964}for(C+=1,c=x-2;c>=l&&(A=i.get(c,c),T=d-A,_=f-A,O=(T*_-h)/i.get(c+1,c)+i.get(c,c+1),S=i.get(c+1,c+1)-A-T-_,T=i.get(c+2,c+1),_=Math.abs(O)+Math.abs(S)+Math.abs(T),O/=_,S/=_,T/=_,c!==l)&&!(Math.abs(i.get(c,c-1))*(Math.abs(S)+Math.abs(T))<k*(Math.abs(O)*(Math.abs(i.get(c-1,c-1))+Math.abs(A)+Math.abs(i.get(c+1,c+1)))));)c--;for(o=c+2;o<=x;o++)i.set(o,o-2,0),o>c+2&&i.set(o,o-3,0);for(s=c;s<=x-1&&(y=s!==x-1,s!==c&&(O=i.get(s,s-1),S=i.get(s+1,s-1),T=y?i.get(s+2,s-1):0,d=Math.abs(O)+Math.abs(S)+Math.abs(T),0!==d&&(O/=d,S/=d,T/=d)),0!==d);s++)if(_=Math.sqrt(O*O+S*S+T*T),O<0&&(_=-_),0!==_){for(s!==c?i.set(s,s-1,-_*d):l!==c&&i.set(s,s-1,-i.get(s,s-1)),O+=_,d=O/_,f=S/_,A=T/_,S/=O,T/=O,a=s;a<t;a++)O=i.get(s,a)+S*i.get(s+1,a),y&&(O+=T*i.get(s+2,a),i.set(s+2,a,i.get(s+2,a)-O*A)),i.set(s,a,i.get(s,a)-O*d),i.set(s+1,a,i.get(s+1,a)-O*f);for(o=0;o<=Math.min(x,s+3);o++)O=d*i.get(o,s)+f*i.get(o,s+1),y&&(O+=A*i.get(o,s+2),i.set(o,s+2,i.get(o,s+2)-O*T)),i.set(o,s,i.get(o,s)-O),i.set(o,s+1,i.get(o,s+1)-O*S);for(o=E;o<=w;o++)O=d*r.get(o,s)+f*r.get(o,s+1),y&&(O+=A*r.get(o,s+2),r.set(o,s+2,r.get(o,s+2)-O*T)),r.set(o,s,r.get(o,s)-O),r.set(o,s+1,r.get(o,s+1)-O*S)}}}if(0===N)return;for(x=t-1;x>=0;x--)if(O=n[x],S=e[x],0===S)for(l=x,i.set(x,x,1),o=x-1;o>=0;o--){for(h=i.get(o,o)-O,T=0,a=l;a<=x;a++)T+=i.get(o,a)*i.get(a,x);if(e[o]<0)A=h,_=T;else if(l=o,0===e[o]?i.set(o,x,0!==h?-T/h:-T/(k*N)):(d=i.get(o,o+1),f=i.get(o+1,o),S=(n[o]-O)*(n[o]-O)+e[o]*e[o],u=(d*_-A*T)/S,i.set(o,x,u),i.set(o+1,x,Math.abs(d)>Math.abs(A)?(-T-h*u)/d:(-_-f*u)/A)),u=Math.abs(i.get(o,x)),k*u*u>1)for(a=o;a<=x;a++)i.set(a,x,i.get(a,x)/u)}else if(S<0)for(l=x-1,Math.abs(i.get(x,x-1))>Math.abs(i.get(x-1,x))?(i.set(x-1,x-1,S/i.get(x,x-1)),i.set(x-1,x,-(i.get(x,x)-O)/i.get(x,x-1))):(b=R(0,-i.get(x-1,x),i.get(x-1,x-1)-O,S),i.set(x-1,x-1,b[0]),i.set(x-1,x,b[1])),i.set(x,x-1,0),i.set(x,x,1),o=x-2;o>=0;o--){for(p=0,g=0,a=l;a<=x;a++)p+=i.get(o,a)*i.get(a,x-1),g+=i.get(o,a)*i.get(a,x);if(h=i.get(o,o)-O,e[o]<0)A=h,T=p,_=g;else if(l=o,0===e[o]?(b=R(-p,-g,h,S),i.set(o,x-1,b[0]),i.set(o,x,b[1])):(d=i.get(o,o+1),f=i.get(o+1,o),v=(n[o]-O)*(n[o]-O)+e[o]*e[o]-S*S,m=2*(n[o]-O)*S,0===v&&0===m&&(v=k*N*(Math.abs(h)+Math.abs(S)+Math.abs(d)+Math.abs(f)+Math.abs(A))),b=R(d*T-A*p+S*g,d*_-A*g-S*p,v,m),i.set(o,x-1,b[0]),i.set(o,x,b[1]),Math.abs(d)>Math.abs(A)+Math.abs(S)?(i.set(o+1,x-1,(-p-h*i.get(o,x-1)+S*i.get(o,x))/d),i.set(o+1,x,(-g-h*i.get(o,x)-S*i.get(o,x-1))/d)):(b=R(-T-f*i.get(o,x-1),-_-f*i.get(o,x),A,S),i.set(o+1,x-1,b[0]),i.set(o+1,x,b[1]))),u=Math.max(Math.abs(i.get(o,x-1)),Math.abs(i.get(o,x))),k*u*u>1)for(a=o;a<=x;a++)i.set(a,x-1,i.get(a,x-1)/u),i.set(a,x,i.get(a,x)/u)}for(o=0;o<t;o++)if(o<E||o>w)for(a=o;a<t;a++)r.set(o,a,i.get(o,a));for(a=t-1;a>=E;a--)for(o=E;o<=w;o++){for(A=0,s=E;s<=Math.min(a,w);s++)A+=r.get(o,s)*i.get(s,a);r.set(o,a,A)}}(o,l,s,a,t)}this.n=o,this.e=l,this.d=s,this.V=a}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,r=this.e,i=this.d,o=new b(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o.set(t,e,0);o.set(t,t,i[t]),r[t]>0?o.set(t,t+1,r[t]):r[t]<0&&o.set(t,t-1,r[t])}return o}}function R(t,e,n,r){let i,o;return Math.abs(n)>Math.abs(r)?(i=r/n,o=n+i*r,[(t+i*e)/o,(e-i*t)/o]):(i=n/r,o=r+i*n,[(i*t+e)/o,(i*e-t)/o])}class L{constructor(t){if(!(t=N.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,r,i=t,o=i.rows,a=new b(o,o),s=!0;for(n=0;n<o;n++){let t=0;for(r=0;r<n;r++){let o=0;for(e=0;e<r;e++)o+=a.get(r,e)*a.get(n,e);o=(i.get(n,r)-o)/a.get(r,r),a.set(n,r,o),t+=o*o}for(t=i.get(n,n)-t,s&&=t>0,a.set(n,n,Math.sqrt(Math.max(t,0))),r=n+1;r<o;r++)a.set(n,r,0)}this.L=a,this.positiveDefinite=s}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=N.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let r,i,o,a=t.columns,s=t.clone();for(o=0;o<n;o++)for(i=0;i<a;i++){for(r=0;r<o;r++)s.set(o,i,s.get(o,i)-s.get(r,i)*e.get(o,r));s.set(o,i,s.get(o,i)/e.get(o,o))}for(o=n-1;o>=0;o--)for(i=0;i<a;i++){for(r=o+1;r<n;r++)s.set(o,i,s.get(o,i)-s.get(r,i)*e.get(r,o));s.set(o,i,s.get(o,i)/e.get(o,o))}return s}get lowerTriangularMatrix(){return this.L}}class I{constructor(e,n={}){e=N.checkMatrix(e);let{Y:r}=n;const{scaleScores:i=!1,maxIterations:o=1e3,terminationCriteria:a=1e-10}=n;let s;if(r){if(r=t.isAnyArray(r)&&"number"==typeof r[0]?b.columnVector(r):N.checkMatrix(r),r.rows!==e.rows)throw new Error("Y should have the same number of rows as X");s=r.getColumnVector(0)}else s=e.getColumnVector(0);let l,c,u,h,d=1;for(let t=0;t<o&&d>a;t++)u=e.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),u=u.div(u.norm()),l=e.mmul(u).div(u.transpose().mmul(u).get(0,0)),t>0&&(d=l.clone().sub(h).pow(2).sum()),h=l.clone(),r?(c=r.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),c=c.div(c.norm()),s=r.mmul(c).div(c.transpose().mmul(c).get(0,0))):s=l;if(r){let t=e.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));t=t.div(t.norm());let n=e.clone().sub(l.clone().mmul(t.transpose())),i=s.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),o=r.clone().sub(l.clone().mulS(i.get(0,0)).mmul(c.transpose()));this.t=l,this.p=t.transpose(),this.w=u.transpose(),this.q=c,this.u=s,this.s=l.transpose().mmul(l),this.xResidual=n,this.yResidual=o,this.betas=i}else this.w=u.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=i?l.clone().div(this.s.get(0,0)):l,this.xResidual=e.sub(l.mmul(u.transpose()))}}return Xb.AbstractMatrix=m,Xb.CHO=L,Xb.CholeskyDecomposition=L,Xb.DistanceMatrix=E,Xb.EVD=D,Xb.EigenvalueDecomposition=D,Xb.LU=O,Xb.LuDecomposition=O,Xb.Matrix=b,Xb.MatrixColumnSelectionView=class extends w{constructor(t,e){d(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},Xb.MatrixColumnView=class extends w{constructor(t,e){l(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},Xb.MatrixFlipColumnView=class extends w{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},Xb.MatrixFlipRowView=class extends w{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},Xb.MatrixRowSelectionView=class extends w{constructor(t,e){h(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},Xb.MatrixRowView=class extends w{constructor(t,e){s(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},Xb.MatrixSelectionView=k,Xb.MatrixSubView=class extends w{constructor(t,e,n,r,i){f(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},Xb.MatrixTransposeView=class extends w{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},Xb.NIPALS=I,Xb.Nipals=I,Xb.QR=T,Xb.QrDecomposition=T,Xb.SVD=_,Xb.SingularValueDecomposition=_,Xb.SymmetricMatrix=x,Xb.WrapperMatrix1D=M,Xb.WrapperMatrix2D=N,Xb.correlation=function(e,n=e,r={}){e=new b(e);let i=!1;if("object"!=typeof n||b.isMatrix(n)||t.isAnyArray(n)?n=new b(n):(r=n,n=e,i=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:a=!0}=r;o&&(e.center("column"),i||n.center("column")),a&&(e.scale("column"),i||n.scale("column"));const s=e.standardDeviation("column",{unbiased:!0}),l=i?s:n.standardDeviation("column",{unbiased:!0}),c=e.transpose().mmul(n);for(let t=0;t<c.rows;t++)for(let n=0;n<c.columns;n++)c.set(t,n,c.get(t,n)*(1/(s[t]*l[n]))*(1/(e.rows-1)));return c},Xb.covariance=function(e,n=e,r={}){e=new b(e);let i=!1;if("object"!=typeof n||b.isMatrix(n)||t.isAnyArray(n)?n=new b(n):(r=n,n=e,i=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=r;o&&(e=e.center("column"),i||(n=n.center("column")));const a=e.transpose().mmul(n);for(let t=0;t<a.rows;t++)for(let n=0;n<a.columns;n++)a.set(t,n,a.get(t,n)*(1/(e.rows-1)));return a},Xb.default=b,Xb.determinant=function t(e){if((e=b.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,r,i,o;if(2===e.columns)return n=e.get(0,0),r=e.get(0,1),i=e.get(1,0),o=e.get(1,1),n*o-r*i;if(3===e.columns){let o,a,s;return o=new k(e,[1,2],[1,2]),a=new k(e,[1,2],[0,2]),s=new k(e,[1,2],[0,1]),n=e.get(0,0),r=e.get(0,1),i=e.get(0,2),n*t(o)-r*t(a)+i*t(s)}return new O(e).determinant}throw Error("determinant can only be calculated for a square matrix")},Xb.inverse=function(t,e=!1){return t=N.checkMatrix(t),e?new _(t).inverse():A(t,b.eye(t.rows))},Xb.linearDependencies=function(t,e={}){const{thresholdValue:n=1e-9,thresholdError:r=1e-9}=e;let i=(t=b.checkMatrix(t)).rows,o=new b(i,i);for(let e=0;e<i;e++){let a=b.columnVector(t.getRow(e)),s=t.subMatrixRow(C(i,e)).transpose(),l=new _(s).solve(a),c=b.sub(a,s.mmul(l)).abs().max();o.setRow(e,P(c,l,e,n,r))}return o},Xb.pseudoInverse=function(t,e=Number.EPSILON){if((t=b.checkMatrix(t)).isEmpty())return t.transpose();let n=new _(t,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,o=n.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return i.mmul(b.diag(o).mmul(r.transpose()))},Xb.solve=A,Xb.wrap=function(e,n){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new N(e):new M(e,n);throw new Error("the argument is not an array")},Xb}var rx=nx(),ix=E(rx);const ox=rx.Matrix,ax=rx.SingularValueDecomposition;ix.Matrix?ix.Matrix:rx.Matrix;const sx={center:[0,0],linkDistance:50};class lx{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},sx),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericMDSLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericMDSLayout(!0,t,e)}))}genericMDSLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i=[0,0],linkDistance:o=50}=r,a=e.getAllNodes(),s=e.getAllEdges();if(!(null==a?void 0:a.length)||1===a.length)return vb(e,t,i);const l=ob({nodes:a,edges:s}),c=ib(l);cx(c);const u=((t,e)=>{const n=[];return t.forEach((t=>{const r=[];t.forEach((t=>{r.push(t*e)})),n.push(r)})),n})(c,o),h=ux(u),d=[];h.forEach(((t,e)=>{const n=cb(a[e]);n.data.x=t[0]+i[0],n.data.y=t[1]+i[1],d.push(n)})),t&&d.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:d,edges:s}}))}}const cx=t=>{let e=-999999;t.forEach((t=>{t.forEach((t=>{t!==1/0&&e<t&&(e=t)}))})),t.forEach(((n,r)=>{n.forEach(((n,i)=>{n===1/0&&(t[r][i]=e)}))}))},ux=t=>{const e=ox.mul(ox.pow(t,2),-.5),n=e.mean("row"),r=e.mean("column"),i=e.mean();e.add(i).subRowVector(n).subColumnVector(r);const o=new ax(e),a=ox.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map((t=>ox.mul([t],[a]).toJSON()[0].splice(0,2)))};function hx(t){return!!t.tick&&!!t.stop}const dx={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},fx={center:[0,0],comboPadding:10,treeKey:"combo"};function px(t,e,n,r){var i;return Ve(this,void 0,void 0,(function*(){return hx(t)?(t.execute(e,n),t.stop(),t.tick(null!==(i=n.iterations)&&void 0!==i?i:300)):r?yield t.assign(e,n):yield t.execute(e,n)}))}function gx(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,l=0;for(i=0;i<a;++i)s+=(o=n[i]).x,l+=o.y;for(s=(s/a-t)*r,l=(l/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function vx(t){return function(){return t}}function mx(t){return 1e-6*(t()-.5)}function yx(t){return t.x+t.vx}function bx(t){return t.y+t.vy}function xx(t){var e,n,r,i=1,o=1;function a(){for(var t,a,l,c,u,h,d,f=e.length,p=0;p<o;++p)for(a=Ob(e,yx,bx).visitAfter(s),t=0;t<f;++t)l=e[t],h=n[l.index],d=h*h,c=l.x+l.vx,u=l.y+l.vy,a.visit(g);function g(t,e,n,o,a){var s=t.data,f=t.r,p=h+f;if(!s)return e>c+p||o<c-p||n>u+p||a<u-p;if(s.index>l.index){var g=c-s.x-s.vx,v=u-s.y-s.vy,m=g*g+v*v;m<p*p&&(0===g&&(m+=(g=mx(r))*g),0===v&&(m+=(v=mx(r))*v),m=(p-(m=Math.sqrt(m)))/m*i,l.vx+=(g*=m)*(p=(f*=f)/(d+f)),l.vy+=(v*=m)*p,s.vx-=g*(p=1-p),s.vy-=v*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=vx(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,l()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:vx(+e),l(),a):t},a}function Ex(t){return t.index}function wx(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function kx(t){var e,n,r,i,o,a,s=Ex,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=vx(30),u=1;function h(r){for(var i=0,s=t.length;i<u;++i)for(var l,c,h,d,f,p,g,v=0;v<s;++v)c=(l=t[v]).source,d=(h=l.target).x+h.vx-c.x-c.vx||mx(a),f=h.y+h.vy-c.y-c.vy||mx(a),d*=p=((p=Math.sqrt(d*d+f*f))-n[v])/p*r*e[v],f*=p,h.vx-=d*(g=o[v]),h.vy-=f*g,c.vx+=d*(g=1-g),c.vy+=f*g}function d(){if(r){var a,l,c=r.length,u=t.length,h=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(c);a<u;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=wx(h,l.source)),"object"!=typeof l.target&&(l.target=wx(h,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(u);a<u;++a)l=t[a],o[a]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(u),f(),n=new Array(u),p()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,a=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(u=+t,h):u},h.strength=function(t){return arguments.length?(l="function"==typeof t?t:vx(+t),f(),h):l},h.distance=function(t){return arguments.length?(c="function"==typeof t?t:vx(+t),p(),h):c},h}var Mx={value:()=>{}};function Nx(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ox(r)}function Ox(t){this._=t}function Sx(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Tx(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Mx,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ox.prototype=Nx.prototype={constructor:Ox,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=o[a]).type)i[n]=Tx(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Tx(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=o[a]).type)&&(n=Sx(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ox(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var _x,Ax,Cx=0,Px=0,Dx=0,Rx=0,Lx=0,Ix=0,jx="object"==typeof performance&&performance.now?performance:Date,Fx="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Bx(){return Lx||(Fx(zx),Lx=jx.now()+Ix)}function zx(){Lx=0}function Vx(){this._call=this._time=this._next=null}function Gx(t,e,n){var r=new Vx;return r.restart(t,e,n),r}function Wx(){Lx=(Rx=jx.now())+Ix,Cx=Px=0;try{!function(){Bx(),++Cx;for(var t,e=_x;e;)(t=Lx-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Cx}()}finally{Cx=0,function(){var t,e,n=_x,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:_x=e);Ax=t,Hx(r)}(),Lx=0}}function $x(){var t=jx.now(),e=t-Rx;e>1e3&&(Ix-=e,Rx=t)}function Hx(t){Cx||(Px&&(Px=clearTimeout(Px)),t-Lx>24?(t<1/0&&(Px=setTimeout(Wx,t-jx.now()-Ix)),Dx&&(Dx=clearInterval(Dx))):(Dx||(Rx=jx.now(),Dx=setInterval($x,1e3)),Cx=1,Fx(Wx)))}Vx.prototype=Gx.prototype={constructor:Vx,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Bx():+n)+(null==e?0:+e),this._next||Ax===this||(Ax?Ax._next=this:_x=this,Ax=this),this._call=t,this._time=n,Hx()},stop:function(){this._call&&(this._call=null,this._time=1/0,Hx())}};const Ux=4294967296;function Yx(t){return t.x}function qx(t){return t.y}var Xx=Math.PI*(3-Math.sqrt(5));function Kx(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=Gx(h),c=Nx("tick","end"),u=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Ux)/Ux}();function h(){d(),c.call("tick",e),n<r&&(l.stop(),c.call("end",e))}function d(r){var l,c,u=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),l=0;l<u;++l)null==(c=t[l]).fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*Xx;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,u),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(u=t,s.forEach(p),e):u},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,l,c=0,u=t.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(a=(i=e-(s=t[c]).x)*i+(o=n-s.y)*o)<r&&(l=s,r=a);return l},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function Zx(){var t,e,n,r,i,o=vx(-30),a=1,s=1/0,l=.81;function c(n){var i,o=t.length,a=Ob(t,Yx,qx).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function u(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function h(t){var e,n,r,o,a,s=0,l=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,c,u){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=u-o,p=h*h+d*d;if(f*f/l<p)return p<s&&(0===h&&(p+=(h=mx(n))*h),0===d&&(p+=(d=mx(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=h*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=mx(n))*h),0===d&&(p+=(d=mx(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(f=i[t.data.index]*r/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,u()},c.strength=function(t){return arguments.length?(o="function"==typeof t?t:vx(+t),u(),c):o},c.distanceMin=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(l=t*t,c):Math.sqrt(l)},c}function Jx(t,e,n){var r,i,o,a=vx(.1);function s(t){for(var a=0,s=r.length;a<s;++a){var l=r[a],c=l.x-e||1e-6,u=l.y-n||1e-6,h=Math.sqrt(c*c+u*u),d=(o[a]-h)*i[a]*t/h;l.vx+=c*d,l.vy+=u*d}}function l(){if(r){var e,n=r.length;for(i=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),i[e]=isNaN(o[e])?0:+a(r[e],e,r)}}return"function"!=typeof t&&(t=vx(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,l()},s.strength=function(t){return arguments.length?(a="function"==typeof t?t:vx(+t),l(),s):a},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:vx(+e),l(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function Qx(t){var e,n,r,i=vx(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=vx(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:vx(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:vx(+e),a(),o):t},o}function tE(t){var e,n,r,i=vx(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=vx(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:vx(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:vx(+e),a(),o):t},o}const eE=(t,e)=>e.reduce(((e,[n,r])=>e[n]&&void 0!==r?e[n].call(t,r):e),t);var nE,rE,iE,oE,aE,sE,lE,cE,uE,hE,dE,fE,pE,gE,vE,mE,yE,bE,xE,EE,wE,kE,ME,NE;function OE(){if(oE)return iE;return oE=1,iE=function(t,e){return t===e||t!=t&&e!=e}}function SE(){if(sE)return aE;sE=1;var t=OE();return aE=function(e,n){for(var r=e.length;r--;)if(t(e[r][0],n))return r;return-1},aE}function TE(){if(mE)return vE;mE=1;var t=rE?nE:(rE=1,nE=function(){this.__data__=[],this.size=0}),e=function(){if(cE)return lE;cE=1;var t=SE(),e=Array.prototype.splice;return lE=function(n){var r=this.__data__,i=t(r,n);return!(i<0||(i==r.length-1?r.pop():e.call(r,i,1),--this.size,0))},lE}(),n=function(){if(hE)return uE;hE=1;var t=SE();return uE=function(e){var n=this.__data__,r=t(n,e);return r<0?void 0:n[r][1]},uE}(),r=function(){if(fE)return dE;fE=1;var t=SE();return dE=function(e){return t(this.__data__,e)>-1}}(),i=function(){if(gE)return pE;gE=1;var t=SE();return pE=function(e,n){var r=this.__data__,i=t(r,e);return i<0?(++this.size,r.push([e,n])):r[i][1]=n,this},pE}();function o(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return o.prototype.clear=t,o.prototype.delete=e,o.prototype.get=n,o.prototype.has=r,o.prototype.set=i,vE=o}var _E="object"==typeof n&&n&&n.Object===Object&&n;module.exports=_E;var AE,CE,PE,DE,RE,LE,IE,jE,FE,BE,zE,VE,GE,WE,$E,HE,UE,YE,qE,XE,KE,ZE,JE,QE,tw,ew,nw,rw,iw,ow,aw,sw,lw,cw,uw,hw,dw,fw,pw,gw,vw,mw,yw,bw,xw,Ew,ww,kw,Mw,Nw,Ow,Sw,Tw,_w,Aw,Cw,Pw,Dw,Rw,Lw,Iw,jw,Fw,Bw,zw,Vw,Gw,Ww,$w,Hw,Uw,Yw,qw,Xw,Kw,Zw,Jw,Qw,tk,ek,nk,rk,ik=w(Object.freeze({__proto__:null}));function ok(){if(CE)return AE;CE=1;var t=ik,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")();return AE=n}function ak(){if(DE)return PE;DE=1;var t=ok().Symbol;return PE=t}function sk(){if(BE)return FE;BE=1;var t=ak(),e=function(){if(LE)return RE;LE=1;var t=ak(),e=Object.prototype,n=e.hasOwnProperty,r=e.toString,i=t?t.toStringTag:void 0;return RE=function(t){var e=n.call(t,i),o=t[i];try{t[i]=void 0;var a=!0}catch(t){}var s=r.call(t);return a&&(e?t[i]=o:delete t[i]),s}}(),n=function(){if(jE)return IE;jE=1;var t=Object.prototype.toString;return IE=function(e){return t.call(e)}}(),r=t?t.toStringTag:void 0;return FE=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?e(t):n(t)}}function lk(){if(VE)return zE;return VE=1,zE=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}function ck(){if(WE)return GE;WE=1;var t=sk(),e=lk();return GE=function(n){if(!e(n))return!1;var r=t(n);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}}function uk(){if(YE)return UE;YE=1;var t=function(){if(HE)return $E;HE=1;var t=ok()["__core-js_shared__"];return $E=t}(),e=function(){var e=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();return UE=function(t){return!!e&&e in t}}function hk(){if(XE)return qE;XE=1;var t=Function.prototype.toString;return qE=function(e){if(null!=e){try{return t.call(e)}catch(t){}try{return e+""}catch(t){}}return""}}function dk(){if(ew)return tw;ew=1;var t=function(){if(ZE)return KE;ZE=1;var t=ck(),e=uk(),n=lk(),r=hk(),i=/^\[object .+?Constructor\]$/,o=Function.prototype,a=Object.prototype,s=o.toString,l=a.hasOwnProperty,c=RegExp("^"+s.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return KE=function(o){return!(!n(o)||e(o))&&(t(o)?c:i).test(r(o))}}(),e=QE?JE:(QE=1,JE=function(t,e){return null==t?void 0:t[e]});return tw=function(n,r){var i=e(n,r);return t(i)?i:void 0}}function fk(){if(rw)return nw;rw=1;var t=dk()(ok(),"Map");return nw=t}function pk(){if(ow)return iw;ow=1;var t=dk()(Object,"create");return iw=t}function gk(){if(mw)return vw;mw=1;var t=function(){if(sw)return aw;sw=1;var t=pk();return aw=function(){this.__data__=t?t(null):{},this.size=0}}(),e=cw?lw:(cw=1,lw=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}),n=function(){if(hw)return uw;hw=1;var t=pk(),e=Object.prototype.hasOwnProperty;return uw=function(n){var r=this.__data__;if(t){var i=r[n];return"__lodash_hash_undefined__"===i?void 0:i}return e.call(r,n)?r[n]:void 0},uw}(),r=function(){if(fw)return dw;fw=1;var t=pk(),e=Object.prototype.hasOwnProperty;return dw=function(n){var r=this.__data__;return t?void 0!==r[n]:e.call(r,n)},dw}(),i=function(){if(gw)return pw;gw=1;var t=pk();return pw=function(e,n){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=t&&void 0===n?"__lodash_hash_undefined__":n,this},pw}();function o(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return o.prototype.clear=t,o.prototype.delete=e,o.prototype.get=n,o.prototype.has=r,o.prototype.set=i,vw=o}function vk(){if(kw)return ww;kw=1;var t=Ew?xw:(Ew=1,xw=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t});return ww=function(e,n){var r=e.__data__;return t(n)?r["string"==typeof n?"string":"hash"]:r.map},ww}function mk(){if(Dw)return Pw;Dw=1;var t=function(){if(bw)return yw;bw=1;var t=gk(),e=TE(),n=fk();return yw=function(){this.size=0,this.__data__={hash:new t,map:new(n||e),string:new t}}}(),e=function(){if(Nw)return Mw;Nw=1;var t=vk();return Mw=function(e){var n=t(this,e).delete(e);return this.size-=n?1:0,n}}(),n=function(){if(Sw)return Ow;Sw=1;var t=vk();return Ow=function(e){return t(this,e).get(e)}}(),r=function(){if(_w)return Tw;_w=1;var t=vk();return Tw=function(e){return t(this,e).has(e)}}(),i=function(){if(Cw)return Aw;Cw=1;var t=vk();return Aw=function(e,n){var r=t(this,e),i=r.size;return r.set(e,n),this.size+=r.size==i?0:1,this},Aw}();function o(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return o.prototype.clear=t,o.prototype.delete=e,o.prototype.get=n,o.prototype.has=r,o.prototype.set=i,Pw=o}function yk(){if(jw)return Iw;jw=1;var t=TE(),e=function(){if(bE)return yE;bE=1;var t=TE();return yE=function(){this.__data__=new t,this.size=0}}(),n=(EE||(EE=1,xE=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}),xE),r=kE?wE:(kE=1,wE=function(t){return this.__data__.get(t)}),i=NE?ME:(NE=1,ME=function(t){return this.__data__.has(t)}),o=function(){if(Lw)return Rw;Lw=1;var t=TE(),e=fk(),n=mk();return Rw=function(r,i){var o=this.__data__;if(o instanceof t){var a=o.__data__;if(!e||a.length<199)return a.push([r,i]),this.size=++o.size,this;o=this.__data__=new n(a)}return o.set(r,i),this.size=o.size,this},Rw}();function a(e){var n=this.__data__=new t(e);this.size=n.size}return a.prototype.clear=e,a.prototype.delete=n,a.prototype.get=r,a.prototype.has=i,a.prototype.set=o,Iw=a}function bk(){if(Bw)return Fw;return Bw=1,Fw=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t},Fw}function xk(){if(Vw)return zw;Vw=1;var t=dk(),e=function(){try{var e=t(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();return zw=e}function Ek(){if(Ww)return Gw;Ww=1;var t=xk();return Gw=function(e,n,r){"__proto__"==n&&t?t(e,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[n]=r}}function wk(){if(Hw)return $w;Hw=1;var t=Ek(),e=OE(),n=Object.prototype.hasOwnProperty;return $w=function(r,i,o){var a=r[i];n.call(r,i)&&e(a,o)&&(void 0!==o||i in r)||t(r,i,o)}}function kk(){if(Yw)return Uw;Yw=1;var t=wk(),e=Ek();return Uw=function(n,r,i,o){var a=!i;i||(i={});for(var s=-1,l=r.length;++s<l;){var c=r[s],u=o?o(i[c],n[c],c,i,n):void 0;void 0===u&&(u=n[c]),a?e(i,c,u):t(i,c,u)}return i},Uw}function Mk(){if(Zw)return Kw;return Zw=1,Kw=function(t){return null!=t&&"object"==typeof t}}function Nk(){if(ek)return tk;ek=1;var t=function(){if(Qw)return Jw;Qw=1;var t=sk(),e=Mk();return Jw=function(n){return e(n)&&"[object Arguments]"==t(n)}}(),e=Mk(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,o=t(function(){return arguments}())?t:function(t){return e(t)&&r.call(t,"callee")&&!i.call(t,"callee")};return tk=o}function Ok(){if(rk)return nk;rk=1;var t=Array.isArray;return nk=t}var Sk,Tk,_k,Ak,Ck,Pk,Dk,Rk,Lk,Ik,jk,Fk={exports:{}};function Bk(){return _k||(_k=1,function(t,e){var n=ok(),r=Tk?Sk:(Tk=1,Sk=function(){return!1}),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,a=o&&o.exports===i?n.Buffer:void 0,s=(a?a.isBuffer:void 0)||r;t.exports=s}(Fk,Fk.exports)),Fk.exports}function zk(){if(Ck)return Ak;Ck=1;var t=/^(?:0|[1-9]\d*)$/;return Ak=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n},Ak}function Vk(){if(Dk)return Pk;Dk=1;return Pk=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function Gk(){if(jk)return Ik;return jk=1,Ik=function(t){return function(e){return t(e)}}}var Wk,$k,Hk,Uk,Yk,qk,Xk,Kk,Zk,Jk,Qk,tM,eM,nM,rM,iM,oM,aM,sM,lM,cM,uM,hM,dM,fM,pM,gM,vM={exports:{}};function mM(){return Wk||(Wk=1,function(t,e){var n=ik,r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,o=i&&i.exports===r&&n.process,a=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a}(vM,vM.exports)),vM.exports}function yM(){if(Hk)return $k;Hk=1;var t=function(){if(Lk)return Rk;Lk=1;var t=sk(),e=Vk(),n=Mk(),r={};return r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,Rk=function(i){return n(i)&&e(i.length)&&!!r[t(i)]}}(),e=Gk(),n=mM(),r=n&&n.isTypedArray,i=r?e(r):t;return $k=i}function bM(){if(Yk)return Uk;Yk=1;var t=(Xw||(Xw=1,qw=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}),qw),e=Nk(),n=Ok(),r=Bk(),i=zk(),o=yM(),a=Object.prototype.hasOwnProperty;return Uk=function(s,l){var c=n(s),u=!c&&e(s),h=!c&&!u&&r(s),d=!c&&!u&&!h&&o(s),f=c||u||h||d,p=f?t(s.length,String):[],g=p.length;for(var v in s)!l&&!a.call(s,v)||f&&("length"==v||h&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||i(v,g))||p.push(v);return p},Uk}function xM(){if(Xk)return qk;Xk=1;var t=Object.prototype;return qk=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}}function EM(){if(Zk)return Kk;return Zk=1,Kk=function(t,e){return function(n){return t(e(n))}}}function wM(){if(eM)return tM;eM=1;var t=xM(),e=function(){if(Qk)return Jk;Qk=1;var t=EM()(Object.keys,Object);return Jk=t}(),n=Object.prototype.hasOwnProperty;return tM=function(r){if(!t(r))return e(r);var i=[];for(var o in Object(r))n.call(r,o)&&"constructor"!=o&&i.push(o);return i}}function kM(){if(rM)return nM;rM=1;var t=ck(),e=Vk();return nM=function(n){return null!=n&&e(n.length)&&!t(n)}}function MM(){if(oM)return iM;oM=1;var t=bM(),e=wM(),n=kM();return iM=function(r){return n(r)?t(r):e(r)}}function NM(){if(hM)return uM;hM=1;var t=lk(),e=xM(),n=cM?lM:(cM=1,lM=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}),r=Object.prototype.hasOwnProperty;return uM=function(i){if(!t(i))return n(i);var o=e(i),a=[];for(var s in i)("constructor"!=s||!o&&r.call(i,s))&&a.push(s);return a}}function OM(){if(fM)return dM;fM=1;var t=bM(),e=NM(),n=kM();return dM=function(r){return n(r)?t(r,!0):e(r)}}var SM,TM,_M,AM,CM,PM,DM,RM,LM,IM,jM,FM,BM,zM,VM,GM,WM,$M,HM,UM,YM,qM,XM,KM,ZM,JM,QM,tN,eN,nN,rN,iN,oN,aN,sN,lN,cN,uN,hN,dN,fN,pN,gN,vN,mN,yN,bN,xN,EN,wN,kN,MN,NN,ON,SN,TN,_N,AN,CN,PN,DN,RN,LN,IN,jN,FN,BN,zN,VN,GN,WN,$N,HN,UN,YN,qN,XN,KN,ZN,JN,QN,tO,eO,nO,rO,iO,oO,aO,sO,lO,cO,uO,hO,dO,fO,pO,gO,vO,mO,yO,bO,xO,EO,wO,kO,MO,NO,OO,SO,TO,_O,AO,CO,PO,DO,RO,LO,IO,jO,FO,BO,zO,VO,GO,WO,$O,HO,UO,YO,qO,XO,KO,ZO,JO,QO,tS,eS,nS,rS,iS,oS,aS,sS,lS,cS,uS,hS,dS,fS,pS,gS,vS,mS,yS,bS,xS,ES,wS,kS,MS,NS,OS,SS,TS,_S,AS,CS,PS,DS,RS,LS,IS,jS,FS,BS,zS,VS,GS,WS,$S,HS,US,YS,qS,XS,KS,ZS,JS,QS,tT,eT,nT,rT,iT,oT,aT,sT,lT,cT,uT,hT,dT,fT,pT,gT,vT,mT,yT,bT,xT,ET,wT,kT,MT,NT,OT,ST,TT,_T,AT,CT,PT,DT,RT,LT,IT,jT,FT,BT,zT,VT,GT,WT,$T,HT,UT,YT,qT,XT,KT,ZT,JT,QT,t_,e_,n_,r_,i_,o_,a_,s_,l_,c_,u_,h_,d_,f_,p_,g_,v_,m_,y_,b_,x_,E_,w_,k_,M_,N_,O_,S_,T_,__,A_,C_,P_,D_,R_,L_,I_,j_,F_,B_,z_,V_,G_,W_,$_,H_,U_,Y_,q_,X_,K_,Z_,J_,Q_,tA,eA,nA,rA,iA,oA,aA,sA,lA,cA,uA,hA,dA,fA,pA,gA,vA,mA,yA,bA,xA,EA,wA,kA,MA,NA,OA,SA,TA,_A,AA,CA,PA,DA,RA,LA,IA,jA,FA,BA,zA,VA,GA,WA,$A,HA,UA,YA,qA,XA,KA,ZA,JA,QA,tC,eC,nC,rC,iC,oC,aC,sC,lC,cC,uC,hC,dC,fC,pC,gC,vC,mC,yC,bC,xC,EC,wC,kC,MC,NC,OC,SC,TC,_C,AC,CC,PC,DC,RC,LC,IC,jC,FC,BC,zC,VC,GC,WC,$C,HC,UC,YC,qC,XC,KC,ZC,JC,QC,tP,eP,nP,rP,iP,oP,aP,sP,lP,cP,uP,hP,dP,fP,pP,gP,vP,mP,yP,bP,xP,EP,wP,kP,MP,NP,OP={exports:{}};function SP(){return SM||(SM=1,function(t,e){var n=ok(),r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,o=i&&i.exports===r?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=a?a(n):new t.constructor(n);return t.copy(r),r}}(OP,OP.exports)),OP.exports}function TP(){if(_M)return TM;return _M=1,TM=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e},TM}function _P(){if(CM)return AM;return CM=1,AM=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o},AM}function AP(){if(DM)return PM;return DM=1,PM=function(){return[]}}function CP(){if(LM)return RM;LM=1;var t=_P(),e=AP(),n=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols;return RM=r?function(e){return null==e?[]:(e=Object(e),t(r(e),(function(t){return n.call(e,t)})))}:e}function PP(){if(BM)return FM;return BM=1,FM=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},FM}function DP(){if(VM)return zM;VM=1;var t=EM()(Object.getPrototypeOf,Object);return zM=t}function RP(){if(WM)return GM;WM=1;var t=PP(),e=DP(),n=CP(),r=AP(),i=Object.getOwnPropertySymbols;return GM=i?function(r){for(var i=[];r;)t(i,n(r)),r=e(r);return i}:r}function LP(){if(YM)return UM;YM=1;var t=PP(),e=Ok();return UM=function(n,r,i){var o=r(n);return e(n)?o:t(o,i(n))}}function IP(){if(XM)return qM;XM=1;var t=LP(),e=CP(),n=MM();return qM=function(r){return t(r,n,e)}}function jP(){if(rN)return nN;rN=1;var t=dk()(ok(),"Set");return nN=t}function FP(){if(sN)return aN;sN=1;var t=function(){if(QM)return JM;QM=1;var t=dk()(ok(),"DataView");return JM=t}(),e=fk(),n=function(){if(eN)return tN;eN=1;var t=dk()(ok(),"Promise");return tN=t}(),r=jP(),i=function(){if(oN)return iN;oN=1;var t=dk()(ok(),"WeakMap");return iN=t}(),o=sk(),a=hk(),s="[object Map]",l="[object Promise]",c="[object Set]",u="[object WeakMap]",h="[object DataView]",d=a(t),f=a(e),p=a(n),g=a(r),v=a(i),m=o;return(t&&m(new t(new ArrayBuffer(1)))!=h||e&&m(new e)!=s||n&&m(n.resolve())!=l||r&&m(new r)!=c||i&&m(new i)!=u)&&(m=function(t){var e=o(t),n="[object Object]"==e?t.constructor:void 0,r=n?a(n):"";if(r)switch(r){case d:return h;case f:return s;case p:return l;case g:return c;case v:return u}return e}),aN=m}function BP(){if(hN)return uN;hN=1;var t=ok().Uint8Array;return uN=t}function zP(){if(fN)return dN;fN=1;var t=BP();return dN=function(e){var n=new e.constructor(e.byteLength);return new t(n).set(new t(e)),n}}function VP(){if(EN)return xN;EN=1;var t=zP();return xN=function(e,n){var r=n?t(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},xN}function GP(){if(kN)return wN;kN=1;var t=zP(),e=function(){if(gN)return pN;gN=1;var t=zP();return pN=function(e,n){var r=n?t(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},pN}(),n=function(){if(mN)return vN;mN=1;var t=/\w*$/;return vN=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}}(),r=function(){if(bN)return yN;bN=1;var t=ak(),e=t?t.prototype:void 0,n=e?e.valueOf:void 0;return yN=function(t){return n?Object(n.call(t)):{}}}(),i=VP();return wN=function(o,a,s){var l=o.constructor;switch(a){case"[object ArrayBuffer]":return t(o);case"[object Boolean]":case"[object Date]":return new l(+o);case"[object DataView]":return e(o,s);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return i(o,s);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(o);case"[object RegExp]":return n(o);case"[object Symbol]":return r(o)}}}function WP(){if(NN)return MN;NN=1;var t=lk(),e=Object.create,n=function(){function n(){}return function(r){if(!t(r))return{};if(e)return e(r);n.prototype=r;var i=new n;return n.prototype=void 0,i}}();return MN=n}function $P(){if(SN)return ON;SN=1;var t=WP(),e=DP(),n=xM();return ON=function(r){return"function"!=typeof r.constructor||n(r)?{}:t(e(r))}}function HP(){if(CN)return AN;CN=1;var t=function(){if(_N)return TN;_N=1;var t=FP(),e=Mk();return TN=function(n){return e(n)&&"[object Map]"==t(n)}}(),e=Gk(),n=mM(),r=n&&n.isMap,i=r?e(r):t;return AN=i}function UP(){if(LN)return RN;LN=1;var t=function(){if(DN)return PN;DN=1;var t=FP(),e=Mk();return PN=function(n){return e(n)&&"[object Set]"==t(n)}}(),e=Gk(),n=mM(),r=n&&n.isSet,i=r?e(r):t;return RN=i}function YP(){if(jN)return IN;jN=1;var t=yk(),e=bk(),n=wk(),r=function(){if(sM)return aM;sM=1;var t=kk(),e=MM();return aM=function(n,r){return n&&t(r,e(r),n)}}(),i=function(){if(gM)return pM;gM=1;var t=kk(),e=OM();return pM=function(n,r){return n&&t(r,e(r),n)}}(),o=SP(),a=TP(),s=function(){if(jM)return IM;jM=1;var t=kk(),e=CP();return IM=function(n,r){return t(n,e(n),r)}}(),l=function(){if(HM)return $M;HM=1;var t=kk(),e=RP();return $M=function(n,r){return t(n,e(n),r)}}(),c=IP(),u=function(){if(ZM)return KM;ZM=1;var t=LP(),e=RP(),n=OM();return KM=function(r){return t(r,n,e)}}(),h=FP(),d=function(){if(cN)return lN;cN=1;var t=Object.prototype.hasOwnProperty;return lN=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r},lN}(),f=GP(),p=$P(),g=Ok(),v=Bk(),m=HP(),y=lk(),b=UP(),x=MM(),E=OM(),w="[object Arguments]",k="[object Function]",M="[object Object]",N={};return N[w]=N["[object Array]"]=N["[object ArrayBuffer]"]=N["[object DataView]"]=N["[object Boolean]"]=N["[object Date]"]=N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Map]"]=N["[object Number]"]=N[M]=N["[object RegExp]"]=N["[object Set]"]=N["[object String]"]=N["[object Symbol]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N["[object Error]"]=N[k]=N["[object WeakMap]"]=!1,IN=function O(S,T,_,A,C,P){var D,R=1&T,L=2&T,I=4&T;if(_&&(D=C?_(S,A,C,P):_(S)),void 0!==D)return D;if(!y(S))return S;var j=g(S);if(j){if(D=d(S),!R)return a(S,D)}else{var F=h(S),B=F==k||"[object GeneratorFunction]"==F;if(v(S))return o(S,R);if(F==M||F==w||B&&!C){if(D=L||B?{}:p(S),!R)return L?l(S,i(D,S)):s(S,r(D,S))}else{if(!N[F])return C?S:{};D=f(S,F,R)}}P||(P=new t);var z=P.get(S);if(z)return z;P.set(S,D),b(S)?S.forEach((function(t){D.add(O(t,T,_,t,S,P))})):m(S)&&S.forEach((function(t,e){D.set(e,O(t,T,_,e,S,P))}));var V=j?void 0:(I?L?u:c:L?E:x)(S);return e(V||S,(function(t,e){V&&(t=S[e=t]),n(D,e,O(t,T,_,e,S,P))})),D},IN}function qP(){if(BN)return FN;BN=1;var t=YP();return FN=function(e){return t(e,4)}}function XP(){if(VN)return zN;return VN=1,zN=function(t){return function(){return t}}}function KP(){if(HN)return $N;HN=1;var t=(WN||(WN=1,GN=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var l=a[t?s:++i];if(!1===n(o[l],l,o))break}return e}}),GN),e=t();return $N=e}function ZP(){if(YN)return UN;YN=1;var t=KP(),e=MM();return UN=function(n,r){return n&&t(n,r,e)}}function JP(){if(ZN)return KN;ZN=1;var t=ZP(),e=function(){if(XN)return qN;XN=1;var t=kM();return qN=function(e,n){return function(r,i){if(null==r)return r;if(!t(r))return e(r,i);for(var o=r.length,a=n?o:-1,s=Object(r);(n?a--:++a<o)&&!1!==i(s[a],a,s););return r}},qN}(),n=e(t);return KN=n}function QP(){if(QN)return JN;return QN=1,JN=function(t){return t}}function tD(){if(eO)return tO;eO=1;var t=QP();return tO=function(e){return"function"==typeof e?e:t}}function eD(){if(rO)return nO;rO=1;var t=bk(),e=JP(),n=tD(),r=Ok();return nO=function(i,o){return(r(i)?t:e)(i,n(o))}}function nD(){return oO?iO:(oO=1,iO=eD())}function rD(){if(fO)return dO;fO=1;var t=mk(),e=cO?lO:(cO=1,lO=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),n=hO?uO:(hO=1,uO=function(t){return this.__data__.has(t)});function r(e){var n=-1,r=null==e?0:e.length;for(this.__data__=new t;++n<r;)this.add(e[n])}return r.prototype.add=r.prototype.push=e,r.prototype.has=n,dO=r}function iD(){if(mO)return vO;return mO=1,vO=function(t,e){return t.has(e)}}function oD(){if(bO)return yO;bO=1;var t=rD(),e=(gO||(gO=1,pO=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}),pO),n=iD();return yO=function(r,i,o,a,s,l){var c=1&o,u=r.length,h=i.length;if(u!=h&&!(c&&h>u))return!1;var d=l.get(r),f=l.get(i);if(d&&f)return d==i&&f==r;var p=-1,g=!0,v=2&o?new t:void 0;for(l.set(r,i),l.set(i,r);++p<u;){var m=r[p],y=i[p];if(a)var b=c?a(y,m,p,i,r,l):a(m,y,p,r,i,l);if(void 0!==b){if(b)continue;g=!1;break}if(v){if(!e(i,(function(t,e){if(!n(v,e)&&(m===t||s(m,t,o,a,l)))return v.push(e)}))){g=!1;break}}else if(m!==y&&!s(m,y,o,a,l)){g=!1;break}}return l.delete(r),l.delete(i),g},yO}function aD(){if(kO)return wO;return kO=1,wO=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},wO}function sD(){if(NO)return MO;NO=1;var t=ak(),e=BP(),n=OE(),r=oD(),i=(EO||(EO=1,xO=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}),xO),o=aD(),a=t?t.prototype:void 0,s=a?a.valueOf:void 0;return MO=function(t,a,l,c,u,h,d){switch(l){case"[object DataView]":if(t.byteLength!=a.byteLength||t.byteOffset!=a.byteOffset)return!1;t=t.buffer,a=a.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=a.byteLength||!h(new e(t),new e(a)));case"[object Boolean]":case"[object Date]":case"[object Number]":return n(+t,+a);case"[object Error]":return t.name==a.name&&t.message==a.message;case"[object RegExp]":case"[object String]":return t==a+"";case"[object Map]":var f=i;case"[object Set]":var p=1&c;if(f||(f=o),t.size!=a.size&&!p)return!1;var g=d.get(t);if(g)return g==a;c|=2,d.set(t,a);var v=r(f(t),f(a),c,u,h,d);return d.delete(t),v;case"[object Symbol]":if(s)return s.call(t)==s.call(a)}return!1},MO}function lD(){if(_O)return TO;_O=1;var t=yk(),e=oD(),n=sD(),r=function(){if(SO)return OO;SO=1;var t=IP(),e=Object.prototype.hasOwnProperty;return OO=function(n,r,i,o,a,s){var l=1&i,c=t(n),u=c.length;if(u!=t(r).length&&!l)return!1;for(var h=u;h--;){var d=c[h];if(!(l?d in r:e.call(r,d)))return!1}var f=s.get(n),p=s.get(r);if(f&&p)return f==r&&p==n;var g=!0;s.set(n,r),s.set(r,n);for(var v=l;++h<u;){var m=n[d=c[h]],y=r[d];if(o)var b=l?o(y,m,d,r,n,s):o(m,y,d,n,r,s);if(!(void 0===b?m===y||a(m,y,i,o,s):b)){g=!1;break}v||(v="constructor"==d)}if(g&&!v){var x=n.constructor,E=r.constructor;x==E||!("constructor"in n)||!("constructor"in r)||"function"==typeof x&&x instanceof x&&"function"==typeof E&&E instanceof E||(g=!1)}return s.delete(n),s.delete(r),g},OO}(),i=FP(),o=Ok(),a=Bk(),s=yM(),l="[object Arguments]",c="[object Array]",u="[object Object]",h=Object.prototype.hasOwnProperty;return TO=function(d,f,p,g,v,m){var y=o(d),b=o(f),x=y?c:i(d),E=b?c:i(f),w=(x=x==l?u:x)==u,k=(E=E==l?u:E)==u,M=x==E;if(M&&a(d)){if(!a(f))return!1;y=!0,w=!1}if(M&&!w)return m||(m=new t),y||s(d)?e(d,f,p,g,v,m):n(d,f,x,p,g,v,m);if(!(1&p)){var N=w&&h.call(d,"__wrapped__"),O=k&&h.call(f,"__wrapped__");if(N||O){var S=N?d.value():d,T=O?f.value():f;return m||(m=new t),v(S,T,p,g,m)}}return!!M&&(m||(m=new t),r(d,f,p,g,v,m))},TO}function cD(){if(CO)return AO;CO=1;var t=lD(),e=Mk();return AO=function n(r,i,o,a,s){return r===i||(null==r||null==i||!e(r)&&!e(i)?r!=r&&i!=i:t(r,i,o,a,n,s))},AO}function uD(){if(LO)return RO;LO=1;var t=lk();return RO=function(e){return e==e&&!t(e)}}function hD(){if(BO)return FO;return BO=1,FO=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}}function dD(){if(VO)return zO;VO=1;var t=function(){if(DO)return PO;DO=1;var t=yk(),e=cD();return PO=function(n,r,i,o){var a=i.length,s=a,l=!o;if(null==n)return!s;for(n=Object(n);a--;){var c=i[a];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++a<s;){var u=(c=i[a])[0],h=n[u],d=c[1];if(l&&c[2]){if(void 0===h&&!(u in n))return!1}else{var f=new t;if(o)var p=o(h,d,u,n,r,f);if(!(void 0===p?e(d,h,3,o,f):p))return!1}}return!0},PO}(),e=function(){if(jO)return IO;jO=1;var t=uD(),e=MM();return IO=function(n){for(var r=e(n),i=r.length;i--;){var o=r[i],a=n[o];r[i]=[o,a,t(a)]}return r},IO}(),n=hD();return zO=function(r){var i=e(r);return 1==i.length&&i[0][2]?n(i[0][0],i[0][1]):function(e){return e===r||t(e,r,i)}}}function fD(){if(WO)return GO;WO=1;var t=sk(),e=Mk();return GO=function(n){return"symbol"==typeof n||e(n)&&"[object Symbol]"==t(n)}}function pD(){if(HO)return $O;HO=1;var t=Ok(),e=fD(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;return $O=function(i,o){if(t(i))return!1;var a=typeof i;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=i&&!e(i))||(r.test(i)||!n.test(i)||null!=o&&i in Object(o))}}function gD(){if(XO)return qO;XO=1;var t=function(){if(YO)return UO;YO=1;var t=mk();function e(n,r){if("function"!=typeof n||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var i=function(){var t=arguments,e=r?r.apply(this,t):t[0],o=i.cache;if(o.has(e))return o.get(e);var a=n.apply(this,t);return i.cache=o.set(e,a)||o,a};return i.cache=new(e.Cache||t),i}return e.Cache=t,UO=e}();return qO=function(e){var n=t(e,(function(t){return 500===r.size&&r.clear(),t})),r=n.cache;return n}}function vD(){if(QO)return JO;return QO=1,JO=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},JO}function mD(){if(rS)return nS;rS=1;var t=function(){if(eS)return tS;eS=1;var t=ak(),e=vD(),n=Ok(),r=fD(),i=t?t.prototype:void 0,o=i?i.toString:void 0;return tS=function t(i){if("string"==typeof i)return i;if(n(i))return e(i,t)+"";if(r(i))return o?o.call(i):"";var a=i+"";return"0"==a&&1/i==-1/0?"-0":a},tS}();return nS=function(e){return null==e?"":t(e)}}function yD(){if(oS)return iS;oS=1;var t=Ok(),e=pD(),n=function(){if(ZO)return KO;ZO=1;var t=gD(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=t((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(e,(function(t,e,i,o){r.push(i?o.replace(n,"$1"):e||t)})),r}));return KO=r}(),r=mD();return iS=function(i,o){return t(i)?i:e(i,o)?[i]:n(r(i))}}function bD(){if(sS)return aS;sS=1;var t=fD();return aS=function(e){if("string"==typeof e||t(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}}function xD(){if(cS)return lS;cS=1;var t=yD(),e=bD();return lS=function(n,r){for(var i=0,o=(r=t(r,n)).length;null!=n&&i<o;)n=n[e(r[i++])];return i&&i==o?n:void 0},lS}function ED(){if(gS)return pS;gS=1;var t=yD(),e=Nk(),n=Ok(),r=zk(),i=Vk(),o=bD();return pS=function(a,s,l){for(var c=-1,u=(s=t(s,a)).length,h=!1;++c<u;){var d=o(s[c]);if(!(h=null!=a&&l(a,d)))break;a=a[d]}return h||++c!=u?h:!!(u=null==a?0:a.length)&&i(u)&&r(d,u)&&(n(a)||e(a))},pS}function wD(){if(mS)return vS;mS=1;var t=fS?dS:(fS=1,dS=function(t,e){return null!=t&&e in Object(t)}),e=ED();return vS=function(n,r){return null!=n&&e(n,r,t)}}function kD(){if(bS)return yS;bS=1;var t=cD(),e=function(){if(hS)return uS;hS=1;var t=xD();return uS=function(e,n,r){var i=null==e?void 0:t(e,n);return void 0===i?r:i}}(),n=wD(),r=pD(),i=uD(),o=hD(),a=bD();return yS=function(s,l){return r(s)&&i(l)?o(a(s),l):function(r){var i=e(r,s);return void 0===i&&i===l?n(r,s):t(l,i,3)}}}function MD(){if(ES)return xS;return ES=1,xS=function(t){return function(e){return null==e?void 0:e[t]}}}function ND(){if(NS)return MS;NS=1;var t=MD(),e=function(){if(kS)return wS;kS=1;var t=xD();return wS=function(e){return function(n){return t(n,e)}}}(),n=pD(),r=bD();return MS=function(i){return n(i)?t(r(i)):e(i)}}function OD(){if(SS)return OS;SS=1;var t=dD(),e=kD(),n=QP(),r=Ok(),i=ND();return OS=function(o){return"function"==typeof o?o:null==o?n:"object"==typeof o?r(o)?e(o[0],o[1]):t(o):i(o)}}function SD(){if(_S)return TS;_S=1;var t=_P(),e=function(){if(sO)return aO;sO=1;var t=JP();return aO=function(e,n){var r=[];return t(e,(function(t,e,i){n(t,e,i)&&r.push(t)})),r},aO}(),n=OD(),r=Ok();return TS=function(i,o){return(r(i)?t:e)(i,n(o,3))}}function TD(){if(DS)return PS;DS=1;var t=function(){if(CS)return AS;CS=1;var t=Object.prototype.hasOwnProperty;return AS=function(e,n){return null!=e&&t.call(e,n)}}(),e=ED();return PS=function(n,r){return null!=n&&e(n,r,t)}}function _D(){if(LS)return RS;LS=1;var t=wM(),e=FP(),n=Nk(),r=Ok(),i=kM(),o=Bk(),a=xM(),s=yM(),l=Object.prototype.hasOwnProperty;return RS=function(c){if(null==c)return!0;if(i(c)&&(r(c)||"string"==typeof c||"function"==typeof c.splice||o(c)||s(c)||n(c)))return!c.length;var u=e(c);if("[object Map]"==u||"[object Set]"==u)return!c.size;if(a(c))return!t(c).length;for(var h in c)if(l.call(c,h))return!1;return!0}}function AD(){if(jS)return IS;return jS=1,IS=function(t){return void 0===t}}function CD(){if(BS)return FS;BS=1;var t=JP(),e=kM();return FS=function(n,r){var i=-1,o=e(n)?Array(n.length):[];return t(n,(function(t,e,n){o[++i]=r(t,e,n)})),o},FS}function PD(){if(VS)return zS;VS=1;var t=vD(),e=OD(),n=CD(),r=Ok();return zS=function(i,o){return(r(i)?t:n)(i,e(o,3))}}function DD(){if(YS)return US;YS=1;var t=(WS||(WS=1,GS=function(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}),GS),e=JP(),n=OD(),r=(HS||(HS=1,$S=function(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}),$S),i=Ok();return US=function(o,a,s){var l=i(o)?t:r,c=arguments.length<3;return l(o,n(a,4),s,c,e)},US}function RD(){if(rT)return nT;rT=1;var t=function(){if(ZS)return KS;ZS=1;var t=MD()("length");return KS=t}(),e=function(){if(QS)return JS;QS=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return JS=function(e){return t.test(e)}}(),n=function(){if(eT)return tT;eT=1;var t="\\ud800-\\udfff",e="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:"+n+"|"+r+")?",l="[\\ufe0e\\ufe0f]?",c=l+s+"(?:\\u200d(?:"+[i,o,a].join("|")+")"+l+s+")*",u="(?:"+[i+n+"?",n,o,a,e].join("|")+")",h=RegExp(r+"(?="+r+")|"+u+c,"g");return tT=function(t){for(var e=h.lastIndex=0;h.test(t);)++e;return e}}();return nT=function(r){return e(r)?n(r):t(r)}}function LD(){if(oT)return iT;oT=1;var t=wM(),e=FP(),n=kM(),r=function(){if(XS)return qS;XS=1;var t=sk(),e=Ok(),n=Mk();return qS=function(r){return"string"==typeof r||!e(r)&&n(r)&&"[object String]"==t(r)}}(),i=RD();return iT=function(o){if(null==o)return 0;if(n(o))return r(o)?i(o):o.length;var a=e(o);return"[object Map]"==a||"[object Set]"==a?o.size:t(o).length}}function ID(){if(sT)return aT;sT=1;var t=bk(),e=WP(),n=ZP(),r=OD(),i=DP(),o=Ok(),a=Bk(),s=ck(),l=lk(),c=yM();return aT=function(u,h,d){var f=o(u),p=f||a(u)||c(u);if(h=r(h,4),null==d){var g=u&&u.constructor;d=p?f?new g:[]:l(u)&&s(g)?e(i(u)):{}}return(p?t:n)(u,(function(t,e,n){return h(d,t,e,n)})),d},aT}function jD(){if(hT)return uT;hT=1;var t=PP(),e=function(){if(cT)return lT;cT=1;var t=ak(),e=Nk(),n=Ok(),r=t?t.isConcatSpreadable:void 0;return lT=function(t){return n(t)||e(t)||!!(r&&t&&t[r])}}();return uT=function n(r,i,o,a,s){var l=-1,c=r.length;for(o||(o=e),s||(s=[]);++l<c;){var u=r[l];i>0&&o(u)?i>1?n(u,i-1,o,a,s):t(s,u):a||(s[s.length]=u)}return s},uT}function FD(){if(gT)return pT;gT=1;var t=fT?dT:(fT=1,dT=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}),e=Math.max;return pT=function(n,r,i){return r=e(void 0===r?n.length-1:r,0),function(){for(var o=arguments,a=-1,s=e(o.length-r,0),l=Array(s);++a<s;)l[a]=o[r+a];a=-1;for(var c=Array(r+1);++a<r;)c[a]=o[a];return c[r]=i(l),t(n,this,c)}},pT}function BD(){if(ET)return xT;ET=1;var t=function(){if(mT)return vT;mT=1;var t=XP(),e=xk(),n=QP();return vT=e?function(n,r){return e(n,"toString",{configurable:!0,enumerable:!1,value:t(r),writable:!0})}:n}(),e=function(){if(bT)return yT;bT=1;var t=Date.now;return yT=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}},yT}(),n=e(t);return xT=n}function zD(){if(kT)return wT;kT=1;var t=QP(),e=FD(),n=BD();return wT=function(r,i){return n(e(r,i,t),r+"")}}function VD(){if(NT)return MT;return NT=1,MT=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1},MT}function GD(){if(CT)return AT;CT=1;var t=VD(),e=ST?OT:(ST=1,OT=function(t){return t!=t}),n=(_T||(_T=1,TT=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}),TT);return AT=function(r,i,o){return i==i?n(r,i,o):t(r,e,o)}}function WD(){if(BT)return FT;BT=1;var t=jP(),e=jT?IT:(jT=1,IT=function(){}),n=aD(),r=t&&1/n(new t([,-0]))[1]==1/0?function(e){return new t(e)}:e;return FT=r}function $D(){if(VT)return zT;VT=1;var t=rD(),e=function(){if(DT)return PT;DT=1;var t=GD();return PT=function(e,n){return!(null==e||!e.length)&&t(e,n,0)>-1}}(),n=(LT||(LT=1,RT=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}),RT),r=iD(),i=WD(),o=aD();return zT=function(a,s,l){var c=-1,u=e,h=a.length,d=!0,f=[],p=f;if(l)d=!1,u=n;else if(h>=200){var g=s?null:i(a);if(g)return o(g);d=!1,u=r,p=new t}else p=s?[]:f;t:for(;++c<h;){var v=a[c],m=s?s(v):v;if(v=l||0!==v?v:0,d&&m==m){for(var y=p.length;y--;)if(p[y]===m)continue t;s&&p.push(m),f.push(v)}else u(p,m,l)||(p!==f&&p.push(m),f.push(v))}return f},zT}function HD(){if(WT)return GT;WT=1;var t=kM(),e=Mk();return GT=function(n){return e(n)&&t(n)}}function UD(){if(HT)return $T;HT=1;var t=jD(),e=zD(),n=$D(),r=HD(),i=e((function(e){return n(t(e,1,r,!0))}));return $T=i}function YD(){if(XT)return qT;XT=1;var t=function(){if(YT)return UT;YT=1;var t=vD();return UT=function(e,n){return t(n,(function(t){return e[t]}))}}(),e=MM();return qT=function(n){return null==n?[]:t(n,e(n))}}function qD(){if(ZT)return KT;var t;ZT=1;try{t={clone:qP(),constant:XP(),each:nD(),filter:SD(),has:TD(),isArray:Ok(),isEmpty:_D(),isFunction:ck(),isUndefined:AD(),keys:MM(),map:PD(),reduce:DD(),size:LD(),transform:ID(),union:UD(),values:YD()}}catch(t){}return t||(t=window._),KT=t}function XD(){if(QT)return JT;QT=1;var t=qD();JT=n;var e="\0";function n(n){this._isDirected=!t.has(n,"directed")||n.directed,this._isMultigraph=!!t.has(n,"multigraph")&&n.multigraph,this._isCompound=!!t.has(n,"compound")&&n.compound,this._label=void 0,this._defaultNodeLabelFn=t.constant(void 0),this._defaultEdgeLabelFn=t.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function r(t,e){t[e]?t[e]++:t[e]=1}function i(t,e){--t[e]||delete t[e]}function o(e,n,r,i){var o=""+n,a=""+r;if(!e&&o>a){var s=o;o=a,a=s}return o+""+a+""+(t.isUndefined(i)?"\0":i)}function a(t,e){return o(t,e.v,e.w,e.name)}return n.prototype._nodeCount=0,n.prototype._edgeCount=0,n.prototype.isDirected=function(){return this._isDirected},n.prototype.isMultigraph=function(){return this._isMultigraph},n.prototype.isCompound=function(){return this._isCompound},n.prototype.setGraph=function(t){return this._label=t,this},n.prototype.graph=function(){return this._label},n.prototype.setDefaultNodeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultNodeLabelFn=e,this},n.prototype.nodeCount=function(){return this._nodeCount},n.prototype.nodes=function(){return t.keys(this._nodes)},n.prototype.sources=function(){var e=this;return t.filter(this.nodes(),(function(n){return t.isEmpty(e._in[n])}))},n.prototype.sinks=function(){var e=this;return t.filter(this.nodes(),(function(n){return t.isEmpty(e._out[n])}))},n.prototype.setNodes=function(e,n){var r=arguments,i=this;return t.each(e,(function(t){r.length>1?i.setNode(t,n):i.setNode(t)})),this},n.prototype.setNode=function(n,r){return t.has(this._nodes,n)?(arguments.length>1&&(this._nodes[n]=r),this):(this._nodes[n]=arguments.length>1?r:this._defaultNodeLabelFn(n),this._isCompound&&(this._parent[n]=e,this._children[n]={},this._children[e][n]=!0),this._in[n]={},this._preds[n]={},this._out[n]={},this._sucs[n]={},++this._nodeCount,this)},n.prototype.node=function(t){return this._nodes[t]},n.prototype.hasNode=function(e){return t.has(this._nodes,e)},n.prototype.removeNode=function(e){var n=this;if(t.has(this._nodes,e)){var r=function(t){n.removeEdge(n._edgeObjs[t])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],t.each(this.children(e),(function(t){n.setParent(t)})),delete this._children[e]),t.each(t.keys(this._in[e]),r),delete this._in[e],delete this._preds[e],t.each(t.keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},n.prototype.setParent=function(n,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(t.isUndefined(r))r=e;else{for(var i=r+="";!t.isUndefined(i);i=this.parent(i))if(i===n)throw new Error("Setting "+r+" as parent of "+n+" would create a cycle");this.setNode(r)}return this.setNode(n),this._removeFromParentsChildList(n),this._parent[n]=r,this._children[r][n]=!0,this},n.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},n.prototype.parent=function(t){if(this._isCompound){var n=this._parent[t];if(n!==e)return n}},n.prototype.children=function(n){if(t.isUndefined(n)&&(n=e),this._isCompound){var r=this._children[n];if(r)return t.keys(r)}else{if(n===e)return this.nodes();if(this.hasNode(n))return[]}},n.prototype.predecessors=function(e){var n=this._preds[e];if(n)return t.keys(n)},n.prototype.successors=function(e){var n=this._sucs[e];if(n)return t.keys(n)},n.prototype.neighbors=function(e){var n=this.predecessors(e);if(n)return t.union(n,this.successors(e))},n.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},n.prototype.filterNodes=function(e){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;t.each(this._nodes,(function(t,r){e(r)&&n.setNode(r,t)})),t.each(this._edgeObjs,(function(t){n.hasNode(t.v)&&n.hasNode(t.w)&&n.setEdge(t,r.edge(t))}));var i={};function o(t){var e=r.parent(t);return void 0===e||n.hasNode(e)?(i[t]=e,e):e in i?i[e]:o(e)}return this._isCompound&&t.each(n.nodes(),(function(t){n.setParent(t,o(t))})),n},n.prototype.setDefaultEdgeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultEdgeLabelFn=e,this},n.prototype.edgeCount=function(){return this._edgeCount},n.prototype.edges=function(){return t.values(this._edgeObjs)},n.prototype.setPath=function(e,n){var r=this,i=arguments;return t.reduce(e,(function(t,e){return i.length>1?r.setEdge(t,e,n):r.setEdge(t,e),e})),this},n.prototype.setEdge=function(){var e,n,i,a,s=!1,l=arguments[0];"object"==typeof l&&null!==l&&"v"in l?(e=l.v,n=l.w,i=l.name,2===arguments.length&&(a=arguments[1],s=!0)):(e=l,n=arguments[1],i=arguments[3],arguments.length>2&&(a=arguments[2],s=!0)),e=""+e,n=""+n,t.isUndefined(i)||(i=""+i);var c=o(this._isDirected,e,n,i);if(t.has(this._edgeLabels,c))return s&&(this._edgeLabels[c]=a),this;if(!t.isUndefined(i)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),this._edgeLabels[c]=s?a:this._defaultEdgeLabelFn(e,n,i);var u=function(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};r&&(s.name=r);return s}(this._isDirected,e,n,i);return e=u.v,n=u.w,Object.freeze(u),this._edgeObjs[c]=u,r(this._preds[n],e),r(this._sucs[e],n),this._in[n][c]=u,this._out[e][c]=u,this._edgeCount++,this},n.prototype.edge=function(t,e,n){var r=1===arguments.length?a(this._isDirected,arguments[0]):o(this._isDirected,t,e,n);return this._edgeLabels[r]},n.prototype.hasEdge=function(e,n,r){var i=1===arguments.length?a(this._isDirected,arguments[0]):o(this._isDirected,e,n,r);return t.has(this._edgeLabels,i)},n.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?a(this._isDirected,arguments[0]):o(this._isDirected,t,e,n),s=this._edgeObjs[r];return s&&(t=s.v,e=s.w,delete this._edgeLabels[r],delete this._edgeObjs[r],i(this._preds[e],t),i(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},n.prototype.inEdges=function(e,n){var r=this._in[e];if(r){var i=t.values(r);return n?t.filter(i,(function(t){return t.v===n})):i}},n.prototype.outEdges=function(e,n){var r=this._out[e];if(r){var i=t.values(r);return n?t.filter(i,(function(t){return t.w===n})):i}},n.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))},JT}function KD(){return r_?n_:(r_=1,n_={Graph:XD(),version:e_?t_:(e_=1,t_="2.1.8")})}function ZD(){if(o_)return i_;o_=1;var t=qD(),e=XD();function n(e){return t.map(e.nodes(),(function(n){var r=e.node(n),i=e.parent(n),o={v:n};return t.isUndefined(r)||(o.value=r),t.isUndefined(i)||(o.parent=i),o}))}function r(e){return t.map(e.edges(),(function(n){var r=e.edge(n),i={v:n.v,w:n.w};return t.isUndefined(n.name)||(i.name=n.name),t.isUndefined(r)||(i.value=r),i}))}return i_={write:function(e){var i={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:n(e),edges:r(e)};t.isUndefined(e.graph())||(i.value=t.clone(e.graph()));return i},read:function(n){var r=new e(n.options).setGraph(n.value);return t.each(n.nodes,(function(t){r.setNode(t.v,t.value),t.parent&&r.setParent(t.v,t.parent)})),t.each(n.edges,(function(t){r.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),r}}}function JD(){if(s_)return a_;s_=1;var t=qD();return a_=function(e){var n,r={},i=[];function o(i){t.has(r,i)||(r[i]=!0,n.push(i),t.each(e.successors(i),o),t.each(e.predecessors(i),o))}return t.each(e.nodes(),(function(t){n=[],o(t),n.length&&i.push(n)})),i},a_}function QD(){if(c_)return l_;c_=1;var t=qD();function e(){this._arr=[],this._keyIndices={}}return l_=e,e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},e.prototype.has=function(e){return t.has(this._keyIndices,e)},e.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},e.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(e,n){var r=this._keyIndices;if(e=String(e),!t.has(r,e)){var i=this._arr,o=i.length;return r[e]=o,i.push({key:e,priority:n}),this._decrease(o),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},e.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},e.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},e.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e},l_}function tR(){if(h_)return u_;h_=1;var t=qD(),e=QD();u_=function(t,r,i,o){return function(t,n,r,i){var o,a,s={},l=new e,c=function(t){var e=t.v!==o?t.v:t.w,n=s[e],i=r(t),c=a.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);c<n.distance&&(n.distance=c,n.predecessor=o,l.decrease(e,c))};t.nodes().forEach((function(t){var e=t===n?0:Number.POSITIVE_INFINITY;s[t]={distance:e},l.add(t,e)}));for(;l.size()>0&&(o=l.removeMin(),(a=s[o]).distance!==Number.POSITIVE_INFINITY);)i(o).forEach(c);return s}(t,String(r),i||n,o||function(e){return t.outEdges(e)})};var n=t.constant(1);return u_}function eR(){if(f_)return d_;f_=1;var t=tR(),e=qD();return d_=function(n,r,i){return e.transform(n.nodes(),(function(e,o){e[o]=t(n,o,r,i)}),{})}}function nR(){if(g_)return p_;g_=1;var t=qD();return p_=function(e){var n=0,r=[],i={},o=[];function a(s){var l=i[s]={onStack:!0,lowlink:n,index:n++};if(r.push(s),e.successors(s).forEach((function(e){t.has(i,e)?i[e].onStack&&(l.lowlink=Math.min(l.lowlink,i[e].index)):(a(e),l.lowlink=Math.min(l.lowlink,i[e].lowlink))})),l.lowlink===l.index){var c,u=[];do{c=r.pop(),i[c].onStack=!1,u.push(c)}while(s!==c);o.push(u)}}return e.nodes().forEach((function(e){t.has(i,e)||a(e)})),o},p_}function rR(){if(m_)return v_;m_=1;var t=qD(),e=nR();return v_=function(n){return t.filter(e(n),(function(t){return t.length>1||1===t.length&&n.hasEdge(t[0],t[0])}))}}function iR(){if(b_)return y_;b_=1;var t=qD();y_=function(t,n,r){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,o=e(n);r[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[t],i=e[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)}))}))})),r}(t,n||e,r||function(e){return t.outEdges(e)})};var e=t.constant(1);return y_}function oR(){if(E_)return x_;E_=1;var t=qD();function e(e){var r={},i={},o=[];if(t.each(e.sinks(),(function a(s){if(t.has(i,s))throw new n;t.has(r,s)||(i[s]=!0,r[s]=!0,t.each(e.predecessors(s),a),delete i[s],o.push(s))})),t.size(r)!==e.nodeCount())throw new n;return o}function n(){}return x_=e,e.CycleException=n,n.prototype=new Error,x_}function aR(){if(k_)return w_;k_=1;var t=oR();return w_=function(e){try{t(e)}catch(e){if(e instanceof t.CycleException)return!1;throw e}return!0}}function sR(){if(N_)return M_;N_=1;var t=qD();function e(n,r,i,o,a,s){t.has(o,r)||(o[r]=!0,i||s.push(r),t.each(a(r),(function(t){e(n,t,i,o,a,s)})),i&&s.push(r))}return M_=function(n,r,i){t.isArray(r)||(r=[r]);var o=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],s={};return t.each(r,(function(t){if(!n.hasNode(t))throw new Error("Graph does not have node: "+t);e(n,t,"post"===i,s,o,a)})),a},M_}function lR(){if(S_)return O_;S_=1;var t=sR();return O_=function(e,n){return t(e,n,"post")}}function cR(){if(__)return T_;__=1;var t=sR();return T_=function(e,n){return t(e,n,"pre")}}function uR(){if(C_)return A_;C_=1;var t=qD(),e=XD(),n=QD();return A_=function(r,i){var o,a=new e,s={},l=new n;function c(t){var e=t.v===o?t.w:t.v,n=l.priority(e);if(void 0!==n){var r=i(t);r<n&&(s[e]=o,l.decrease(e,r))}}if(0===r.nodeCount())return a;t.each(r.nodes(),(function(t){l.add(t,Number.POSITIVE_INFINITY),a.setNode(t)})),l.decrease(r.nodes()[0],0);var u=!1;for(;l.size()>0;){if(o=l.removeMin(),t.has(s,o))a.setEdge(o,s[o]);else{if(u)throw new Error("Input graph is not connected: "+r);u=!0}r.nodeEdges(o).forEach(c)}return a}}function hR(){if(L_)return R_;L_=1;var t=KD();return R_={Graph:t.Graph,json:ZD(),alg:D_?P_:(D_=1,P_={components:JD(),dijkstra:tR(),dijkstraAll:eR(),findCycles:rR(),floydWarshall:iR(),isAcyclic:aR(),postorder:lR(),preorder:cR(),prim:uR(),tarjan:nR(),topsort:oR()}),version:t.version}}function dR(){if(j_)return I_;var t;j_=1;try{t=hR()}catch(t){}return t||(t=window.graphlib),I_=t}function fR(){if(B_)return F_;B_=1;var t=YP();return F_=function(e){return t(e,5)}}function pR(){if(V_)return z_;V_=1;var t=OE(),e=kM(),n=zk(),r=lk();return z_=function(i,o,a){if(!r(a))return!1;var s=typeof o;return!!("number"==s?e(a)&&n(o,a.length):"string"==s&&o in a)&&t(a[o],i)},z_}function gR(){if(W_)return G_;W_=1;var t=zD(),e=OE(),n=pR(),r=OM(),i=Object.prototype,o=i.hasOwnProperty,a=t((function(t,a){t=Object(t);var s=-1,l=a.length,c=l>2?a[2]:void 0;for(c&&n(a[0],a[1],c)&&(l=1);++s<l;)for(var u=a[s],h=r(u),d=-1,f=h.length;++d<f;){var p=h[d],g=t[p];(void 0===g||e(g,i[p])&&!o.call(t,p))&&(t[p]=u[p])}return t}));return G_=a}function vR(){if(X_)return q_;X_=1;var t=function(){if(Y_)return U_;Y_=1;var t=/\s/;return U_=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n},U_}(),e=/^\s+/;return q_=function(n){return n?n.slice(0,t(n)+1).replace(e,""):n}}function mR(){if(Q_)return J_;Q_=1;var t=function(){if(Z_)return K_;Z_=1;var t=vR(),e=lk(),n=fD(),r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;return K_=function(s){if("number"==typeof s)return s;if(n(s))return NaN;if(e(s)){var l="function"==typeof s.valueOf?s.valueOf():s;s=e(l)?l+"":l}if("string"!=typeof s)return 0===s?s:+s;s=t(s);var c=i.test(s);return c||o.test(s)?a(s.slice(2),c?2:8):r.test(s)?NaN:+s}}(),e=1/0;return J_=function(n){return n?(n=t(n))===e||n===-1/0?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}}function yR(){if(rA)return nA;rA=1;var t=VD(),e=OD(),n=function(){if(eA)return tA;eA=1;var t=mR();return tA=function(e){var n=t(e),r=n%1;return n==n?r?n-r:n:0}}(),r=Math.max;return nA=function(i,o,a){var s=null==i?0:i.length;if(!s)return-1;var l=null==a?0:n(a);return l<0&&(l=r(s+l,0)),t(i,e(o,3),l)},nA}function bR(){if(oA)return iA;oA=1;var t=function(){if(H_)return $_;H_=1;var t=OD(),e=kM(),n=MM();return $_=function(r){return function(i,o,a){var s=Object(i);if(!e(i)){var l=t(o,3);i=n(i),o=function(t){return l(s[t],t,s)}}var c=r(i,o,a);return c>-1?s[l?i[c]:c]:void 0}},$_}(),e=t(yR());return iA=e}function xR(){if(sA)return aA;sA=1;var t=jD();return aA=function(e){return(null==e?0:e.length)?t(e,1):[]}}function ER(){if(cA)return lA;cA=1;var t=KP(),e=tD(),n=OM();return lA=function(r,i){return null==r?r:t(r,e(i),n)}}function wR(){if(hA)return uA;return hA=1,uA=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0},uA}function kR(){if(fA)return dA;fA=1;var t=Ek(),e=ZP(),n=OD();return dA=function(r,i){var o={};return i=n(i,3),e(r,(function(e,n,r){t(o,n,i(e,n,r))})),o}}function MR(){if(gA)return pA;gA=1;var t=fD();return pA=function(e,n,r){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=n(a);if(null!=s&&(void 0===l?s==s&&!t(s):r(s,l)))var l=s,c=a}return c},pA}function NR(){if(bA)return yA;bA=1;var t=MR(),e=mA?vA:(mA=1,vA=function(t,e){return t>e}),n=QP();return yA=function(r){return r&&r.length?t(r,n,e):void 0}}function OR(){if(EA)return xA;EA=1;var t=Ek(),e=OE();return xA=function(n,r,i){(void 0!==i&&!e(n[r],i)||void 0===i&&!(r in n))&&t(n,r,i)}}function SR(){if(NA)return MA;return NA=1,MA=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}}function TR(){if(_A)return TA;_A=1;var t=OR(),e=SP(),n=VP(),r=TP(),i=$P(),o=Nk(),a=Ok(),s=HD(),l=Bk(),c=ck(),u=lk(),h=function(){if(kA)return wA;kA=1;var t=sk(),e=DP(),n=Mk(),r=Function.prototype,i=Object.prototype,o=r.toString,a=i.hasOwnProperty,s=o.call(Object);return wA=function(r){if(!n(r)||"[object Object]"!=t(r))return!1;var i=e(r);if(null===i)return!0;var l=a.call(i,"constructor")&&i.constructor;return"function"==typeof l&&l instanceof l&&o.call(l)==s}}(),d=yM(),f=SR(),p=function(){if(SA)return OA;SA=1;var t=kk(),e=OM();return OA=function(n){return t(n,e(n))}}();return TA=function(g,v,m,y,b,x,E){var w=f(g,m),k=f(v,m),M=E.get(k);if(M)t(g,m,M);else{var N=x?x(w,k,m+"",g,v,E):void 0,O=void 0===N;if(O){var S=a(k),T=!S&&l(k),_=!S&&!T&&d(k);N=k,S||T||_?a(w)?N=w:s(w)?N=r(w):T?(O=!1,N=e(k,!0)):_?(O=!1,N=n(k,!0)):N=[]:h(k)||o(k)?(N=w,o(w)?N=p(w):u(w)&&!c(w)||(N=i(k))):O=!1}O&&(E.set(k,N),b(N,k,y,x,E),E.delete(k)),t(g,m,N)}},TA}function _R(){if(LA)return RA;LA=1;var t=function(){if(CA)return AA;CA=1;var t=yk(),e=OR(),n=KP(),r=TR(),i=lk(),o=OM(),a=SR();return AA=function s(l,c,u,h,d){l!==c&&n(c,(function(n,o){if(d||(d=new t),i(n))r(l,c,o,u,s,h,d);else{var f=h?h(a(l,o),n,o+"",l,c,d):void 0;void 0===f&&(f=n),e(l,o,f)}}),o)},AA}(),e=function(){if(DA)return PA;DA=1;var t=zD(),e=pR();return PA=function(n){return t((function(t,r){var i=-1,o=r.length,a=o>1?r[o-1]:void 0,s=o>2?r[2]:void 0;for(a=n.length>3&&"function"==typeof a?(o--,a):void 0,s&&e(r[0],r[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++i<o;){var l=r[i];l&&n(t,l,i,a)}return t}))},PA}(),n=e((function(e,n,r){t(e,n,r)}));return RA=n}function AR(){if(jA)return IA;return jA=1,IA=function(t,e){return t<e}}function CR(){if(BA)return FA;BA=1;var t=MR(),e=AR(),n=QP();return FA=function(r){return r&&r.length?t(r,n,e):void 0}}function PR(){if(VA)return zA;VA=1;var t=MR(),e=OD(),n=AR();return zA=function(r,i){return r&&r.length?t(r,e(i,2),n):void 0}}function DR(){if(WA)return GA;WA=1;var t=ok();return GA=function(){return t.Date.now()}}function RR(){if(YA)return UA;YA=1;var t=xD(),e=function(){if(HA)return $A;HA=1;var t=wk(),e=yD(),n=zk(),r=lk(),i=bD();return $A=function(o,a,s,l){if(!r(o))return o;for(var c=-1,u=(a=e(a,o)).length,h=u-1,d=o;null!=d&&++c<u;){var f=i(a[c]),p=s;if("__proto__"===f||"constructor"===f||"prototype"===f)return o;if(c!=h){var g=d[f];void 0===(p=l?l(g,f,d):void 0)&&(p=r(g)?g:n(a[c+1])?[]:{})}t(d,f,p),d=d[f]}return o},$A}(),n=yD();return UA=function(r,i,o){for(var a=-1,s=i.length,l={};++a<s;){var c=i[a],u=t(r,c);o(u,c)&&e(l,n(c,r),u)}return l},UA}function LR(){if(QA)return JA;QA=1;var t=function(){if(XA)return qA;XA=1;var t=RR(),e=wD();return qA=function(n,r){return t(n,r,(function(t,r){return e(n,r)}))}}(),e=function(){if(ZA)return KA;ZA=1;var t=xR(),e=FD(),n=BD();return KA=function(r){return n(e(r,void 0,t),r+"")}}()((function(e,n){return null==e?{}:t(e,n)}));return JA=e}function IR(){if(rC)return nC;rC=1;var t=function(){if(eC)return tC;eC=1;var t=Math.ceil,e=Math.max;return tC=function(n,r,i,o){for(var a=-1,s=e(t((r-n)/(i||1)),0),l=Array(s);s--;)l[o?s:++a]=n,n+=i;return l},tC}(),e=pR(),n=mR();return nC=function(r){return function(i,o,a){return a&&"number"!=typeof a&&e(i,o,a)&&(o=a=void 0),i=n(i),void 0===o?(o=i,i=0):o=n(o),a=void 0===a?i<o?1:-1:n(a),t(i,o,a,r)}},nC}function jR(){if(oC)return iC;oC=1;var t=IR()();return iC=t}function FR(){if(hC)return uC;hC=1;var t=function(){if(cC)return lC;cC=1;var t=fD();return lC=function(e,n){if(e!==n){var r=void 0!==e,i=null===e,o=e==e,a=t(e),s=void 0!==n,l=null===n,c=n==n,u=t(n);if(!l&&!u&&!a&&e>n||a&&s&&c&&!l&&!u||i&&s&&c||!r&&c||!o)return 1;if(!i&&!a&&!u&&e<n||u&&r&&o&&!i&&!a||l&&r&&o||!s&&o||!c)return-1}return 0}}();return uC=function(e,n,r){for(var i=-1,o=e.criteria,a=n.criteria,s=o.length,l=r.length;++i<s;){var c=t(o[i],a[i]);if(c)return i>=l?c:c*("desc"==r[i]?-1:1)}return e.index-n.index},uC}function BR(){if(fC)return dC;fC=1;var t=vD(),e=xD(),n=OD(),r=CD(),i=(sC||(sC=1,aC=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}),aC),o=Gk(),a=FR(),s=QP(),l=Ok();return dC=function(c,u,h){u=u.length?t(u,(function(t){return l(t)?function(n){return e(n,1===t.length?t[0]:t)}:t})):[s];var d=-1;u=t(u,o(n));var f=r(c,(function(e,n,r){return{criteria:t(u,(function(t){return t(e)})),index:++d,value:e}}));return i(f,(function(t,e){return a(t,e,h)}))},dC}function zR(){if(gC)return pC;gC=1;var t=jD(),e=BR(),n=zD(),r=pR(),i=n((function(n,i){if(null==n)return[];var o=i.length;return o>1&&r(n,i[0],i[1])?i=[]:o>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),e(n,t(i,1),[])}));return pC=i}function VR(){if(mC)return vC;mC=1;var t=mD(),e=0;return vC=function(n){var r=++e;return t(n)+r},vC}function GR(){if(EC)return xC;EC=1;var t=wk(),e=(bC||(bC=1,yC=function(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:void 0;n(a,t[r],s)}return a}),yC);return xC=function(n,r){return e(n||[],r||[],t)},xC}function WR(){if(kC)return wC;var t;kC=1;try{t={cloneDeep:fR(),constant:XP(),defaults:gR(),each:nD(),filter:SD(),find:bR(),flatten:xR(),forEach:eD(),forIn:ER(),has:TD(),isUndefined:AD(),last:wR(),map:PD(),mapValues:kR(),max:NR(),merge:_R(),min:CR(),minBy:PR(),now:DR(),pick:LR(),range:jR(),reduce:DD(),sortBy:zR(),uniqueId:VR(),values:YD(),zipObject:GR()}}catch(t){}return t||(t=window._),wC=t}function $R(){if(SC)return OC;SC=1;var t=WR(),e=dR().Graph,n=function(){if(NC)return MC;function t(){var t={};t._next=t._prev=t,this._sentinel=t}function e(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function n(t,e){if("_next"!==t&&"_prev"!==t)return e}return NC=1,MC=t,t.prototype.dequeue=function(){var t=this._sentinel,n=t._prev;if(n!==t)return e(n),n},t.prototype.enqueue=function(t){var n=this._sentinel;t._prev&&t._next&&e(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n},t.prototype.toString=function(){for(var t=[],e=this._sentinel,r=e._prev;r!==e;)t.push(JSON.stringify(r,n)),r=r._prev;return"["+t.join(", ")+"]"},MC}();OC=function(a,s){if(a.nodeCount()<=1)return[];var l=function(r,i){var a=new e,s=0,l=0;t.forEach(r.nodes(),(function(t){a.setNode(t,{v:t,in:0,out:0})})),t.forEach(r.edges(),(function(t){var e=a.edge(t.v,t.w)||0,n=i(t),r=e+n;a.setEdge(t.v,t.w,r),l=Math.max(l,a.node(t.v).out+=n),s=Math.max(s,a.node(t.w).in+=n)}));var c=t.range(l+s+3).map((function(){return new n})),u=s+1;return t.forEach(a.nodes(),(function(t){o(c,u,a.node(t))})),{graph:a,buckets:c,zeroIdx:u}}(a,s||r),c=function(t,e,n){var r,o=[],a=e[e.length-1],s=e[0];for(;t.nodeCount();){for(;r=s.dequeue();)i(t,e,n,r);for(;r=a.dequeue();)i(t,e,n,r);if(t.nodeCount())for(var l=e.length-2;l>0;--l)if(r=e[l].dequeue()){o=o.concat(i(t,e,n,r,!0));break}}return o}(l.graph,l.buckets,l.zeroIdx);return t.flatten(t.map(c,(function(t){return a.outEdges(t.v,t.w)})),!0)};var r=t.constant(1);function i(e,n,r,i,a){var s=a?[]:void 0;return t.forEach(e.inEdges(i.v),(function(t){var i=e.edge(t),l=e.node(t.v);a&&s.push({v:t.v,w:t.w}),l.out-=i,o(n,r,l)})),t.forEach(e.outEdges(i.v),(function(t){var i=e.edge(t),a=t.w,s=e.node(a);s.in-=i,o(n,r,s)})),e.removeNode(i.v),s}function o(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}return OC}function HR(){if(_C)return TC;_C=1;var t=WR(),e=$R();return TC={run:function(n){var r="greedy"===n.graph().acyclicer?e(n,function(t){return function(e){return t.edge(e).weight}}(n)):function(e){var n=[],r={},i={};function o(a){t.has(i,a)||(i[a]=!0,r[a]=!0,t.forEach(e.outEdges(a),(function(e){t.has(r,e.w)?n.push(e):o(e.w)})),delete r[a])}return t.forEach(e.nodes(),o),n}(n);t.forEach(r,(function(e){var r=n.edge(e);n.removeEdge(e),r.forwardName=e.name,r.reversed=!0,n.setEdge(e.w,e.v,r,t.uniqueId("rev"))}))},undo:function(e){t.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}},TC}function UR(){if(CC)return AC;CC=1;var t=WR(),e=dR().Graph;function n(e,n,r,i){var o;do{o=t.uniqueId(i)}while(e.hasNode(o));return r.dummy=n,e.setNode(o,r),o}function r(e){return t.max(t.map(e.nodes(),(function(n){var r=e.node(n).rank;if(!t.isUndefined(r))return r})))}return AC={addDummyNode:n,simplify:function(n){var r=(new e).setGraph(n.graph());return t.forEach(n.nodes(),(function(t){r.setNode(t,n.node(t))})),t.forEach(n.edges(),(function(t){var e=r.edge(t.v,t.w)||{weight:0,minlen:1},i=n.edge(t);r.setEdge(t.v,t.w,{weight:e.weight+i.weight,minlen:Math.max(e.minlen,i.minlen)})})),r},asNonCompoundGraph:function(n){var r=new e({multigraph:n.isMultigraph()}).setGraph(n.graph());return t.forEach(n.nodes(),(function(t){n.children(t).length||r.setNode(t,n.node(t))})),t.forEach(n.edges(),(function(t){r.setEdge(t,n.edge(t))})),r},successorWeights:function(e){var n=t.map(e.nodes(),(function(n){var r={};return t.forEach(e.outEdges(n),(function(t){r[t.w]=(r[t.w]||0)+e.edge(t).weight})),r}));return t.zipObject(e.nodes(),n)},predecessorWeights:function(e){var n=t.map(e.nodes(),(function(n){var r={};return t.forEach(e.inEdges(n),(function(t){r[t.v]=(r[t.v]||0)+e.edge(t).weight})),r}));return t.zipObject(e.nodes(),n)},intersectRect:function(t,e){var n,r,i=t.x,o=t.y,a=e.x-i,s=e.y-o,l=t.width/2,c=t.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a);return{x:i+n,y:o+r}},buildLayerMatrix:function(e){var n=t.map(t.range(r(e)+1),(function(){return[]}));return t.forEach(e.nodes(),(function(r){var i=e.node(r),o=i.rank;t.isUndefined(o)||(n[o][i.order]=r)})),n},normalizeRanks:function(e){var n=t.min(t.map(e.nodes(),(function(t){return e.node(t).rank})));t.forEach(e.nodes(),(function(r){var i=e.node(r);t.has(i,"rank")&&(i.rank-=n)}))},removeEmptyRanks:function(e){var n=t.min(t.map(e.nodes(),(function(t){return e.node(t).rank}))),r=[];t.forEach(e.nodes(),(function(t){var i=e.node(t).rank-n;r[i]||(r[i]=[]),r[i].push(t)}));var i=0,o=e.graph().nodeRankFactor;t.forEach(r,(function(n,r){t.isUndefined(n)&&r%o!=0?--i:i&&t.forEach(n,(function(t){e.node(t).rank+=i}))}))},addBorderNode:function(t,e,r,i){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=i);return n(t,"border",o,e)},maxRank:r,partition:function(e,n){var r={lhs:[],rhs:[]};return t.forEach(e,(function(t){n(t)?r.lhs.push(t):r.rhs.push(t)})),r},time:function(e,n){var r=t.now();try{return n()}finally{console.log(e+" time: "+(t.now()-r)+"ms")}},notime:function(t,e){return e()}},AC}function YR(){if(DC)return PC;DC=1;var t=WR(),e=UR();return PC={run:function(n){n.graph().dummyChains=[],t.forEach(n.edges(),(function(t){!function(t,n){var r,i,o,a=n.v,s=t.node(a).rank,l=n.w,c=t.node(l).rank,u=n.name,h=t.edge(n),d=h.labelRank;if(c===s+1)return;for(t.removeEdge(n),o=0,++s;s<c;++o,++s)h.points=[],i={width:0,height:0,edgeLabel:h,edgeObj:n,rank:s},r=e.addDummyNode(t,"edge",i,"_d"),s===d&&(i.width=h.width,i.height=h.height,i.dummy="edge-label",i.labelpos=h.labelpos),t.setEdge(a,r,{weight:h.weight},u),0===o&&t.graph().dummyChains.push(r),a=r;t.setEdge(a,l,{weight:h.weight},u)}(n,t)}))},undo:function(e){t.forEach(e.graph().dummyChains,(function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)}))}}}function qR(){if(LC)return RC;LC=1;var t=WR();return RC={longestPath:function(e){var n={};t.forEach(e.sources(),(function r(i){var o=e.node(i);if(t.has(n,i))return o.rank;n[i]=!0;var a=t.min(t.map(e.outEdges(i),(function(t){return r(t.w)-e.edge(t).minlen})));return a!==Number.POSITIVE_INFINITY&&null!=a||(a=0),o.rank=a}))},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}},RC}function XR(){if(jC)return IC;jC=1;var t=WR(),e=dR().Graph,n=qR().slack;function r(e,r){return t.forEach(e.nodes(),(function i(o){t.forEach(r.nodeEdges(o),(function(t){var a=t.v,s=o===a?t.w:a;e.hasNode(s)||n(r,t)||(e.setNode(s,{}),e.setEdge(o,s,{}),i(s))}))})),e.nodeCount()}function i(e,r){return t.minBy(r.edges(),(function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return n(r,t)}))}function o(e,n,r){t.forEach(e.nodes(),(function(t){n.node(t).rank+=r}))}return IC=function(t){var a,s,l=new e({directed:!1}),c=t.nodes()[0],u=t.nodeCount();l.setNode(c,{});for(;r(l,t)<u;)a=i(l,t),s=l.hasNode(a.v)?n(t,a):-n(t,a),o(l,t,s);return l}}function KR(){if(BC)return FC;BC=1;var t=WR(),e=XR(),n=qR().slack,r=qR().longestPath,i=dR().alg.preorder,o=dR().alg.postorder,a=UR().simplify;function s(t){t=a(t),r(t);var n,i=e(t);for(u(i),l(i,t);n=d(i);)p(i,t,n,f(i,t,n))}function l(e,n){var r=o(e,e.nodes());r=r.slice(0,r.length-1),t.forEach(r,(function(t){!function(t,e,n){var r=t.node(n),i=r.parent;t.edge(n,i).cutvalue=c(t,e,n)}(e,n,t)}))}function c(e,n,r){var i=e.node(r).parent,o=!0,a=n.edge(r,i),s=0;return a||(o=!1,a=n.edge(i,r)),s=a.weight,t.forEach(n.nodeEdges(r),(function(t){var a,l,c=t.v===r,u=c?t.w:t.v;if(u!==i){var h=c===o,d=n.edge(t).weight;if(s+=h?d:-d,a=r,l=u,e.hasEdge(a,l)){var f=e.edge(r,u).cutvalue;s+=h?-f:f}}})),s}function u(t,e){arguments.length<2&&(e=t.nodes()[0]),h(t,{},1,e)}function h(e,n,r,i,o){var a=r,s=e.node(i);return n[i]=!0,t.forEach(e.neighbors(i),(function(o){t.has(n,o)||(r=h(e,n,r,o,i))})),s.low=a,s.lim=r++,o?s.parent=o:delete s.parent,r}function d(e){return t.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function f(e,r,i){var o=i.v,a=i.w;r.hasEdge(o,a)||(o=i.w,a=i.v);var s=e.node(o),l=e.node(a),c=s,u=!1;s.lim>l.lim&&(c=l,u=!0);var h=t.filter(r.edges(),(function(t){return u===g(e,e.node(t.v),c)&&u!==g(e,e.node(t.w),c)}));return t.minBy(h,(function(t){return n(r,t)}))}function p(e,n,r,o){var a=r.v,s=r.w;e.removeEdge(a,s),e.setEdge(o.v,o.w,{}),u(e),l(e,n),function(e,n){var r=t.find(e.nodes(),(function(t){return!n.node(t).parent})),o=i(e,r);o=o.slice(1),t.forEach(o,(function(t){var r=e.node(t).parent,i=n.edge(t,r),o=!1;i||(i=n.edge(r,t),o=!0),n.node(t).rank=n.node(r).rank+(o?i.minlen:-i.minlen)}))}(e,n)}function g(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}return FC=s,s.initLowLimValues=u,s.initCutValues=l,s.calcCutValue=c,s.leaveEdge=d,s.enterEdge=f,s.exchangeEdges=p,FC}function ZR(){if(VC)return zC;VC=1;var t=qR().longestPath,e=XR(),n=KR();zC=function(n){switch(n.graph().ranker){case"network-simplex":default:i(n);break;case"tight-tree":!function(n){t(n),e(n)}(n);break;case"longest-path":r(n)}};var r=t;function i(t){n(t)}return zC}function JR(){if(WC)return GC;WC=1;var t=WR();return GC=function(e){var n=function(e){var n={},r=0;function i(o){var a=r;t.forEach(e.children(o),i),n[o]={low:a,lim:r++}}return t.forEach(e.children(),i),n}(e);t.forEach(e.graph().dummyChains,(function(t){for(var r=e.node(t),i=r.edgeObj,o=function(t,e,n,r){var i,o,a=[],s=[],l=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),a.push(i)}while(i&&(e[i].low>l||c>e[i].lim));o=i,i=r;for(;(i=t.parent(i))!==o;)s.push(i);return{path:a.concat(s.reverse()),lca:o}}(e,n,i.v,i.w),a=o.path,s=o.lca,l=0,c=a[l],u=!0;t!==i.w;){if(r=e.node(t),u){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(u=!1)}if(!u){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(t,c),t=e.successors(t)[0]}}))},GC}function QR(){if(HC)return $C;HC=1;var t=WR(),e=UR();function n(r,i,o,a,s,l,c){var u=r.children(c);if(u.length){var h=e.addBorderNode(r,"_bt"),d=e.addBorderNode(r,"_bb"),f=r.node(c);r.setParent(h,c),f.borderTop=h,r.setParent(d,c),f.borderBottom=d,t.forEach(u,(function(t){n(r,i,o,a,s,l,t);var e=r.node(t),u=e.borderTop?e.borderTop:t,f=e.borderBottom?e.borderBottom:t,p=e.borderTop?a:2*a,g=u!==f?1:s-l[c]+1;r.setEdge(h,u,{weight:p,minlen:g,nestingEdge:!0}),r.setEdge(f,d,{weight:p,minlen:g,nestingEdge:!0})})),r.parent(c)||r.setEdge(i,h,{weight:0,minlen:s+l[c]})}else c!==i&&r.setEdge(i,c,{weight:0,minlen:o})}return $C={run:function(r){var i=e.addDummyNode(r,"root",{},"_root"),o=function(e){var n={};function r(i,o){var a=e.children(i);a&&a.length&&t.forEach(a,(function(t){r(t,o+1)})),n[i]=o}return t.forEach(e.children(),(function(t){r(t,1)})),n}(r),a=t.max(t.values(o))-1,s=2*a+1;r.graph().nestingRoot=i,t.forEach(r.edges(),(function(t){r.edge(t).minlen*=s}));var l=function(e){return t.reduce(e.edges(),(function(t,n){return t+e.edge(n).weight}),0)}(r)+1;t.forEach(r.children(),(function(t){n(r,i,s,l,a,o,t)})),r.graph().nodeRankFactor=s},cleanup:function(e){var n=e.graph();e.removeNode(n.nestingRoot),delete n.nestingRoot,t.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}},$C}function tL(){if(XC)return qC;XC=1;var t=WR();function e(e){t.forEach(e.nodes(),(function(t){n(e.node(t))})),t.forEach(e.edges(),(function(t){n(e.edge(t))}))}function n(t){var e=t.width;t.width=t.height,t.height=e}function r(t){t.y=-t.y}function i(t){var e=t.x;t.x=t.y,t.y=e}return qC={adjust:function(t){var n=t.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||e(t)},undo:function(n){var o=n.graph().rankdir.toLowerCase();"bt"!==o&&"rl"!==o||function(e){t.forEach(e.nodes(),(function(t){r(e.node(t))})),t.forEach(e.edges(),(function(n){var i=e.edge(n);t.forEach(i.points,r),t.has(i,"y")&&r(i)}))}(n);"lr"!==o&&"rl"!==o||(!function(e){t.forEach(e.nodes(),(function(t){i(e.node(t))})),t.forEach(e.edges(),(function(n){var r=e.edge(n);t.forEach(r.points,i),t.has(r,"x")&&i(r)}))}(n),e(n))}}}function eL(){if(rP)return nP;rP=1;var t=WR();return nP=function(e,n){var r={};return t.forEach(e,(function(e,n){var i=r[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:n};t.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)})),t.forEach(n.edges(),(function(e){var n=r[e.v],i=r[e.w];t.isUndefined(n)||t.isUndefined(i)||(i.indegree++,n.out.push(r[e.w]))})),function(e){var n=[];function r(e){return function(n){n.merged||(t.isUndefined(n.barycenter)||t.isUndefined(e.barycenter)||n.barycenter>=e.barycenter)&&function(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}(e,n)}}function i(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var o=e.pop();n.push(o),t.forEach(o.in.reverse(),r(o)),t.forEach(o.out,i(o))}return t.map(t.filter(n,(function(t){return!t.merged})),(function(e){return t.pick(e,["vs","i","barycenter","weight"])}))}(t.filter(r,(function(t){return!t.indegree})))},nP}function nL(){if(sP)return aP;sP=1;var t=WR(),e=function(){if(eP)return tP;eP=1;var t=WR();return tP=function(e,n){return t.map(n,(function(n){var r=e.inEdges(n);if(r.length){var i=t.reduce(r,(function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}return{v:n}}))}}(),n=eL(),r=function(){if(oP)return iP;oP=1;var t=WR(),e=UR();function n(e,n,r){for(var i;n.length&&(i=t.last(n)).i<=r;)n.pop(),e.push(i.vs),r++;return r}return iP=function(r,i){var o,a=e.partition(r,(function(e){return t.has(e,"barycenter")})),s=a.lhs,l=t.sortBy(a.rhs,(function(t){return-t.i})),c=[],u=0,h=0,d=0;s.sort((o=!!i,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:o?e.i-t.i:t.i-e.i})),d=n(c,l,d),t.forEach(s,(function(t){d+=t.vs.length,c.push(t.vs),u+=t.barycenter*t.weight,h+=t.weight,d=n(c,l,d)}));var f={vs:t.flatten(c,!0)};return h&&(f.barycenter=u/h,f.weight=h),f}}();return aP=function i(o,a,s,l){var c=o.children(a),u=o.node(a),h=u?u.borderLeft:void 0,d=u?u.borderRight:void 0,f={};h&&(c=t.filter(c,(function(t){return t!==h&&t!==d})));var p=e(o,c);t.forEach(p,(function(e){if(o.children(e.v).length){var n=i(o,e.v,s,l);f[e.v]=n,t.has(n,"barycenter")&&(r=e,a=n,t.isUndefined(r.barycenter)?(r.barycenter=a.barycenter,r.weight=a.weight):(r.barycenter=(r.barycenter*r.weight+a.barycenter*a.weight)/(r.weight+a.weight),r.weight+=a.weight))}var r,a}));var g=n(p,s);!function(e,n){t.forEach(e,(function(e){e.vs=t.flatten(e.vs.map((function(t){return n[t]?n[t].vs:t})),!0)}))}(g,f);var v=r(g,l);if(h&&(v.vs=t.flatten([h,v.vs,d],!0),o.predecessors(h).length)){var m=o.node(o.predecessors(h)[0]),y=o.node(o.predecessors(d)[0]);t.has(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+m.order+y.order)/(v.weight+2),v.weight+=2}return v},aP}function rL(){if(cP)return lP;cP=1;var t=WR(),e=dR().Graph;return lP=function(n,r,i){var o=function(e){var n;for(;e.hasNode(n=t.uniqueId("_root")););return n}(n),a=new e({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(t){return n.node(t)}));return t.forEach(n.nodes(),(function(e){var s=n.node(e),l=n.parent(e);(s.rank===r||s.minRank<=r&&r<=s.maxRank)&&(a.setNode(e),a.setParent(e,l||o),t.forEach(n[i](e),(function(r){var i=r.v===e?r.w:r.v,o=a.edge(i,e),s=t.isUndefined(o)?0:o.weight;a.setEdge(i,e,{weight:n.edge(r).weight+s})})),t.has(s,"minRank")&&a.setNode(e,{borderLeft:s.borderLeft[r],borderRight:s.borderRight[r]}))})),a},lP}function iL(){if(fP)return dP;fP=1;var t=WR(),e=function(){if(ZC)return KC;ZC=1;var t=WR();return KC=function(e){var n={},r=t.filter(e.nodes(),(function(t){return!e.children(t).length})),i=t.max(t.map(r,(function(t){return e.node(t).rank}))),o=t.map(t.range(i+1),(function(){return[]}));function a(r){if(!t.has(n,r)){n[r]=!0;var i=e.node(r);o[i.rank].push(r),t.forEach(e.successors(r),a)}}var s=t.sortBy(r,(function(t){return e.node(t).rank}));return t.forEach(s,a),o},KC}(),n=function(){if(QC)return JC;QC=1;var t=WR();function e(e,n,r){for(var i=t.zipObject(r,t.map(r,(function(t,e){return e}))),o=t.flatten(t.map(n,(function(n){return t.sortBy(t.map(e.outEdges(n),(function(t){return{pos:i[t.w],weight:e.edge(t).weight}})),"pos")})),!0),a=1;a<r.length;)a<<=1;var s=2*a-1;a-=1;var l=t.map(new Array(s),(function(){return 0})),c=0;return t.forEach(o.forEach((function(t){var e=t.pos+a;l[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=l[e+1]),l[e=e-1>>1]+=t.weight;c+=t.weight*n}))),c}return JC=function(t,n){for(var r=0,i=1;i<n.length;++i)r+=e(t,n[i-1],n[i]);return r}}(),r=nL(),i=rL(),o=function(){if(hP)return uP;hP=1;var t=WR();return uP=function(e,n,r){var i,o={};t.forEach(r,(function(t){for(var r,a,s=e.parent(t);s;){if((r=e.parent(s))?(a=o[r],o[r]=s):(a=i,i=s),a&&a!==s)return void n.setEdge(a,s);s=r}}))}}(),a=dR().Graph,s=UR();function l(e,n,r){return t.map(n,(function(t){return i(e,t,r)}))}function c(e,n){var i=new a;t.forEach(e,(function(e){var a=e.graph().root,s=r(e,a,i,n);t.forEach(s.vs,(function(t,n){e.node(t).order=n})),o(e,i,s.vs)}))}function u(e,n){t.forEach(n,(function(n){t.forEach(n,(function(t,n){e.node(t).order=n}))}))}return dP=function(r){var i=s.maxRank(r),o=l(r,t.range(1,i+1),"inEdges"),a=l(r,t.range(i-1,-1,-1),"outEdges"),h=e(r);u(r,h);for(var d,f=Number.POSITIVE_INFINITY,p=0,g=0;g<4;++p,++g){c(p%2?o:a,p%4>=2),h=s.buildLayerMatrix(r);var v=n(r,h);v<f&&(g=0,d=t.cloneDeep(h),f=v)}u(r,d)},dP}function oL(){if(gP)return pP;gP=1;var t=WR(),e=dR().Graph,n=UR();function r(e,n){var r={};return t.reduce(n,(function(n,i){var a=0,s=0,l=n.length,c=t.last(i);return t.forEach(i,(function(n,u){var h=function(e,n){if(e.node(n).dummy)return t.find(e.predecessors(n),(function(t){return e.node(t).dummy}))}(e,n),d=h?e.node(h).order:l;(h||n===c)&&(t.forEach(i.slice(s,u+1),(function(n){t.forEach(e.predecessors(n),(function(t){var i=e.node(t),s=i.order;!(s<a||d<s)||i.dummy&&e.node(n).dummy||o(r,t,n)}))})),s=u+1,a=d)})),i})),r}function i(e,n){var r={};function i(n,i,a,s,l){var c;t.forEach(t.range(i,a),(function(i){c=n[i],e.node(c).dummy&&t.forEach(e.predecessors(c),(function(t){var n=e.node(t);n.dummy&&(n.order<s||n.order>l)&&o(r,t,c)}))}))}return t.reduce(n,(function(n,r){var o,a=-1,s=0;return t.forEach(r,(function(t,l){if("border"===e.node(t).dummy){var c=e.predecessors(t);c.length&&(o=e.node(c[0]).order,i(r,s,l,a,o),s=l,a=o)}i(r,s,r.length,o,n.length)})),r})),r}function o(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function a(e,n,r){if(n>r){var i=n;n=r,r=i}return t.has(e[n],r)}function s(e,n,r,i){var o={},s={},l={};return t.forEach(n,(function(e){t.forEach(e,(function(t,e){o[t]=t,s[t]=t,l[t]=e}))})),t.forEach(n,(function(e){var n=-1;t.forEach(e,(function(e){var c=i(e);if(c.length){c=t.sortBy(c,(function(t){return l[t]}));for(var u=(c.length-1)/2,h=Math.floor(u),d=Math.ceil(u);h<=d;++h){var f=c[h];s[e]===e&&n<l[f]&&!a(r,e,f)&&(s[f]=e,s[e]=o[e]=o[f],n=l[f])}}}))})),{root:o,align:s}}function l(n,r,i,o,a){var s={},l=function(n,r,i,o){var a=new e,s=n.graph(),l=function(e,n,r){return function(i,o,a){var s,l=i.node(o),c=i.node(a),u=0;if(u+=l.width/2,t.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=-l.width/2;break;case"r":s=l.width/2}if(s&&(u+=r?s:-s),s=0,u+=(l.dummy?n:e)/2,u+=(c.dummy?n:e)/2,u+=c.width/2,t.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":s=c.width/2;break;case"r":s=-c.width/2}return s&&(u+=r?s:-s),s=0,u}}(s.nodesep,s.edgesep,o);return t.forEach(r,(function(e){var r;t.forEach(e,(function(t){var e=i[t];if(a.setNode(e),r){var o=i[r],s=a.edge(o,e);a.setEdge(o,e,Math.max(l(n,t,r),s||0))}r=t}))})),a}(n,r,i,a),c=a?"borderLeft":"borderRight";function u(t,e){for(var n=l.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}return u((function(t){s[t]=l.inEdges(t).reduce((function(t,e){return Math.max(t,s[e.v]+l.edge(e))}),0)}),l.predecessors.bind(l)),u((function(t){var e=l.outEdges(t).reduce((function(t,e){return Math.min(t,s[e.w]-l.edge(e))}),Number.POSITIVE_INFINITY),r=n.node(t);e!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(s[t]=Math.max(s[t],e))}),l.successors.bind(l)),t.forEach(o,(function(t){s[t]=s[i[t]]})),s}function c(e,n){return t.minBy(t.values(n),(function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return t.forIn(n,(function(t,n){var o=function(t,e){return t.node(e).width}(e,n)/2;r=Math.max(t+o,r),i=Math.min(t-o,i)})),r-i}))}function u(e,n){var r=t.values(n),i=t.min(r),o=t.max(r);t.forEach(["u","d"],(function(r){t.forEach(["l","r"],(function(a){var s,l=r+a,c=e[l];if(c!==n){var u=t.values(c);(s="l"===a?i-t.min(u):o-t.max(u))&&(e[l]=t.mapValues(c,(function(t){return t+s})))}}))}))}function h(e,n){return t.mapValues(e.ul,(function(r,i){if(n)return e[n.toLowerCase()][i];var o=t.sortBy(t.map(e,i));return(o[1]+o[2])/2}))}return pP={positionX:function(e){var o,a=n.buildLayerMatrix(e),d=t.merge(r(e,a),i(e,a)),f={};t.forEach(["u","d"],(function(n){o="u"===n?a:t.values(a).reverse(),t.forEach(["l","r"],(function(r){"r"===r&&(o=t.map(o,(function(e){return t.values(e).reverse()})));var i=("u"===n?e.predecessors:e.successors).bind(e),a=s(e,o,d,i),c=l(e,o,a.root,a.align,"r"===r);"r"===r&&(c=t.mapValues(c,(function(t){return-t}))),f[n+r]=c}))}));var p=c(e,f);return u(f,p),h(f,e.graph().align)},findType1Conflicts:r,findType2Conflicts:i,addConflict:o,hasConflict:a,verticalAlignment:s,horizontalCompaction:l,alignCoordinates:u,findSmallestWidthAlignment:c,balance:h},pP}function aL(){if(mP)return vP;mP=1;var t=WR(),e=UR(),n=oL().positionX;return vP=function(r){(function(n){var r=e.buildLayerMatrix(n),i=n.graph().ranksep,o=0;t.forEach(r,(function(e){var r=t.max(t.map(e,(function(t){return n.node(t).height})));t.forEach(e,(function(t){n.node(t).y=o+r/2})),o+=r+i}))})(r=e.asNonCompoundGraph(r)),t.forEach(n(r),(function(t,e){r.node(e).x=t}))},vP}function sL(){if(bP)return yP;bP=1;var t=WR(),e=HR(),n=YR(),r=ZR(),i=UR().normalizeRanks,o=JR(),a=UR().removeEmptyRanks,s=QR(),l=function(){if(YC)return UC;YC=1;var t=WR(),e=UR();function n(t,n,r,i,o,a){var s={width:0,height:0,rank:a,borderType:n},l=o[n][a-1],c=e.addDummyNode(t,"border",s,r);o[n][a]=c,t.setParent(c,i),l&&t.setEdge(l,c,{weight:1})}return UC=function(e){t.forEach(e.children(),(function r(i){var o=e.children(i),a=e.node(i);if(o.length&&t.forEach(o,r),t.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var s=a.minRank,l=a.maxRank+1;s<l;++s)n(e,"borderLeft","_bl",i,a,s),n(e,"borderRight","_br",i,a,s)}}))},UC}(),c=tL(),u=iL(),h=aL(),d=UR(),f=dR().Graph;yP=function(M,N){var O=N&&N.debugTiming?d.time:d.notime;O("layout",(function(){var N=O("  buildLayoutGraph",(function(){return function(e){var n=new f({multigraph:!0,compound:!0}),r=k(e.graph());return n.setGraph(t.merge({},g,w(r,p),t.pick(r,v))),t.forEach(e.nodes(),(function(r){var i=k(e.node(r));n.setNode(r,t.defaults(w(i,m),y)),n.setParent(r,e.parent(r))})),t.forEach(e.edges(),(function(r){var i=k(e.edge(r));n.setEdge(r,t.merge({},x,w(i,b),t.pick(i,E)))})),n}(M)}));O("  runLayout",(function(){!function(f,p){p("    makeSpaceForEdgeLabels",(function(){!function(e){var n=e.graph();n.ranksep/=2,t.forEach(e.edges(),(function(t){var r=e.edge(t);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(f)})),p("    removeSelfEdges",(function(){!function(e){t.forEach(e.edges(),(function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(f)})),p("    acyclic",(function(){e.run(f)})),p("    nestingGraph.run",(function(){s.run(f)})),p("    rank",(function(){r(d.asNonCompoundGraph(f))})),p("    injectEdgeLabelProxies",(function(){!function(e){t.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};d.addDummyNode(e,"edge-proxy",i,"_ep")}}))}(f)})),p("    removeEmptyRanks",(function(){a(f)})),p("    nestingGraph.cleanup",(function(){s.cleanup(f)})),p("    normalizeRanks",(function(){i(f)})),p("    assignRankMinMax",(function(){!function(e){var n=0;t.forEach(e.nodes(),(function(r){var i=e.node(r);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,n=t.max(n,i.maxRank))})),e.graph().maxRank=n}(f)})),p("    removeEdgeLabelProxies",(function(){!function(e){t.forEach(e.nodes(),(function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(f)})),p("    normalize.run",(function(){n.run(f)})),p("    parentDummyChains",(function(){o(f)})),p("    addBorderSegments",(function(){l(f)})),p("    order",(function(){u(f)})),p("    insertSelfEdges",(function(){!function(e){var n=d.buildLayerMatrix(e);t.forEach(n,(function(n){var r=0;t.forEach(n,(function(n,i){var o=e.node(n);o.order=i+r,t.forEach(o.selfEdges,(function(t){d.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:i+ ++r,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))}(f)})),p("    adjustCoordinateSystem",(function(){c.adjust(f)})),p("    position",(function(){h(f)})),p("    positionSelfEdges",(function(){!function(e){t.forEach(e.nodes(),(function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{x:i+a,y:o},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.label.x=n.x,n.label.y=n.y}}))}(f)})),p("    removeBorderNodes",(function(){!function(e){t.forEach(e.nodes(),(function(n){if(e.children(n).length){var r=e.node(n),i=e.node(r.borderTop),o=e.node(r.borderBottom),a=e.node(t.last(r.borderLeft)),s=e.node(t.last(r.borderRight));r.width=Math.abs(s.x-a.x),r.height=Math.abs(o.y-i.y),r.x=a.x+r.width/2,r.y=i.y+r.height/2}})),t.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(f)})),p("    normalize.undo",(function(){n.undo(f)})),p("    fixupEdgeLabelCoords",(function(){!function(e){t.forEach(e.edges(),(function(n){var r=e.edge(n);if(t.has(r,"x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}}))}(f)})),p("    undoCoordinateSystem",(function(){c.undo(f)})),p("    translateGraph",(function(){!function(e){var n=Number.POSITIVE_INFINITY,r=0,i=Number.POSITIVE_INFINITY,o=0,a=e.graph(),s=a.marginx||0,l=a.marginy||0;function c(t){var e=t.x,a=t.y,s=t.width,l=t.height;n=Math.min(n,e-s/2),r=Math.max(r,e+s/2),i=Math.min(i,a-l/2),o=Math.max(o,a+l/2)}t.forEach(e.nodes(),(function(t){c(e.node(t))})),t.forEach(e.edges(),(function(n){var r=e.edge(n);t.has(r,"x")&&c(r)})),n-=s,i-=l,t.forEach(e.nodes(),(function(t){var r=e.node(t);r.x-=n,r.y-=i})),t.forEach(e.edges(),(function(r){var o=e.edge(r);t.forEach(o.points,(function(t){t.x-=n,t.y-=i})),t.has(o,"x")&&(o.x-=n),t.has(o,"y")&&(o.y-=i)})),a.width=r-n+s,a.height=o-i+l}(f)})),p("    assignNodeIntersects",(function(){!function(e){t.forEach(e.edges(),(function(t){var n,r,i=e.edge(t),o=e.node(t.v),a=e.node(t.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=a,r=o),i.points.unshift(d.intersectRect(o,n)),i.points.push(d.intersectRect(a,r))}))}(f)})),p("    reversePoints",(function(){!function(e){t.forEach(e.edges(),(function(t){var n=e.edge(t);n.reversed&&n.points.reverse()}))}(f)})),p("    acyclic.undo",(function(){e.undo(f)}))}(N,O)})),O("  updateInputGraph",(function(){!function(e,n){t.forEach(e.nodes(),(function(t){var r=e.node(t),i=n.node(t);r&&(r.x=i.x,r.y=i.y,n.children(t).length&&(r.width=i.width,r.height=i.height))})),t.forEach(e.edges(),(function(r){var i=e.edge(r),o=n.edge(r);i.points=o.points,t.has(o,"x")&&(i.x=o.x,i.y=o.y)})),e.graph().width=n.graph().width,e.graph().height=n.graph().height}(M,N)}))}))};var p=["nodesep","edgesep","ranksep","marginx","marginy"],g={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},v=["acyclicer","ranker","rankdir","align"],m=["width","height"],y={width:0,height:0},b=["minlen","weight","width","height","labeloffset"],x={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},E=["labelpos"];function w(e,n){return t.mapValues(t.pick(e,n),Number)}function k(e){var n={};return t.forEach(e,(function(t,e){n[e.toLowerCase()]=t})),n}return yP}function lL(){if(EP)return xP;EP=1;var t=WR(),e=UR(),n=dR().Graph;return xP={debugOrdering:function(r){var i=e.buildLayerMatrix(r),o=new n({compound:!0,multigraph:!0}).setGraph({});return t.forEach(r.nodes(),(function(t){o.setNode(t,{label:t}),o.setParent(t,"layer"+r.node(t).rank)})),t.forEach(r.edges(),(function(t){o.setEdge(t.v,t.w,{},t.name)})),t.forEach(i,(function(e,n){var r="layer"+n;o.setNode(r,{rank:"same"}),t.reduce(e,(function(t,e){return o.setEdge(t,e,{style:"invis"}),e}))})),o}}}var cL=NP?MP:(NP=1,MP={graphlib:dR(),layout:sL(),debug:lL(),util:{time:UR().time,notime:UR().notime},version:kP?wP:(kP=1,wP="0.8.5")}),uL=E(cL);class hL{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,hL.defaultOptions,t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))}))}genericDagreLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const{nodeSize:r}=n,i=new cL.graphlib.Graph;i.setGraph(n),i.setDefaultEdgeLabel((()=>({})));[...e.getAllNodes(),...e.getAllEdges()].some((({id:t})=>le(t)))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach((t=>{const{id:e}=t,n=Object.assign({},t.data);if(void 0!==r){const[e,i]=ub(Yt(r)?r(t):r);Object.assign(n,{width:e,height:i})}i.setNode(e.toString(),n)})),e.getAllEdges().forEach((({id:t,source:e,target:n})=>{i.setEdge(e.toString(),n.toString(),{id:t})})),uL.layout(i);const o={nodes:[],edges:[]};return i.nodes().forEach((n=>{const r=i.node(n);o.nodes.push({id:n,data:r}),t&&e.mergeNodeData(n,r)})),i.edges().forEach((n=>{const r=i.edge(n),{id:a}=r,s=ze(r,["id"]),{v:l,w:c}=n;o.edges.push({id:a,source:l,target:c,data:s}),t&&e.mergeEdgeData(a,s)})),o}))}}hL.defaultOptions={};class dL{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(e,n)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,n=t.ry-this.ry;let r=Math.hypot(e,n);r=r<1e-4?1e-4:r;const i=this.g*(this.degree+1)*(t.degree+1)/r;this.fx+=i*e/r,this.fy+=i*n/r}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,n=(this.rx*this.mass+t.rx*t.mass)/e,r=(this.ry*this.mass+t.ry*t.mass)/e,i=this.degree+t.degree;return new dL({rx:n,ry:r,mass:e,degree:i})}}class fL{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new fL({xmid:t,ymid:e,length:n})}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new fL({xmid:t,ymid:e,length:n})}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new fL({xmid:t,ymid:e,length:n})}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new fL({xmid:t,ymid:e,length:n})}}class pL{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}insert(t){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new pL(this.quad.NW()),this.NE=new pL(this.quad.NE()),this.SW=new pL(this.quad.SW()),this.SE=new pL(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t)):this.body=t}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(t){if(null!=this.body&&t!==this.body)if(this._isExternal())t.addForce(this.body);else{(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}const gL={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};const vL={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"};const mL={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};const yL=(t,e)=>{let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.min(r,i);else{Math.min(r,i)===t.rows?t.rows=e:t.cols=e}return n},bL=(t,e)=>{let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.max(r,i);else{Math.max(r,i)===t.rows?t.rows=e:t.cols=e}return n},xL=(t,e)=>t[`c-${e.row}-${e.col}`]||!1,EL=(t,e)=>t[`c-${e.row}-${e.col}`]=!0,wL=(t,e)=>{const n=t.cols||5;e.col++,e.col>=n&&(e.col=0,e.row++)},kL=(t,e,n,r,i,o,a,s)=>{let l,c;const u=i[t.id];if(u)l=u.col*n+n/2+e[0],c=u.row*r+r/2+e[1];else{for(;xL(s,a);)wL(o,a);l=a.col*n+n/2+e[0],c=a.row*r+r/2+e[1],EL(s,a),wL(o,a)}t.data.x=l,t.data.y=c},ML={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},NL=(t,e,n,r,i,o)=>{e.forEach(((a,s)=>{n[s]={x:0,y:0},e.forEach(((e,l)=>{if(s===l)return;if(i[s]!==i[l])return;let c=a.x-e.x,u=a.y-e.y,h=Math.sqrt(c*c+u*u);if(0===h){h=1;const t=s>l?1:-1;c=.01*t,u=.01*t}if(h<o(t[s])/2+o(t[l])/2){const t=r*r/h;n[s].x+=c/h*t,n[s].y+=u/h*t}}))}))},OL=(t,e,n,r,i,o,a,s)=>{const l=o||a/10;return r&&e.forEach(((e,n)=>{const r=t[n].x-t[i].x,o=t[n].y-t[i].y,a=Math.sqrt(r*r+o*o);let s=o/a,l=-r/a;const c=Math.sqrt(e.x*e.x+e.y*e.y);let u=Math.acos((s*e.x+l*e.y)/c);u>Math.PI/2&&(u-=Math.PI/2,s*=-1,l*=-1);const h=Math.cos(u)*c;e.x=s*h,e.y=l*h})),t.forEach(((o,a)=>{if(a===i)return;const c=Math.sqrt(e[a].x*e[a].x+e[a].y*e[a].y);if(c>0&&a!==i){const u=Math.min(l*(n/800),c);if(o.x+=e[a].x/c*u,o.y+=e[a].y/c*u,r){let e=o.x-t[i].x,n=o.y-t[i].y;const r=Math.sqrt(e*e+n*n);e=e/r*s[a],n=n/r*s[a],o.x=t[i].x+e,o.y=t[i].y+n}}})),t},SL={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};const TL=(t,e,n,r,i,o,a)=>{if(!t)return[];const s=[];if(e){const l={};e.forEach(((e,c)=>{const u=[];e.forEach(((e,s)=>{var h,d;if(c===s)u.push(0);else if(r[c]===r[s])if("data"===o)u.push(e*(Math.abs(c-s)*a)/(r[c]/i));else if(o){let n,f;if(l[t[c].id])n=l[t[c].id];else{const e=("id"===o?t[c].id:null===(h=t[c].data)||void 0===h?void 0:h[o])||0;n=ie(e)?e.charCodeAt(0):e,l[t[c].id]=n}if(l[t[s].id])f=l[t[s].id];else{const e=("id"===o?t[s].id:null===(d=t[s].data)||void 0===d?void 0:d[o])||0;f=ie(e)?e.charCodeAt(0):e,l[t[s].id]=f}u.push(e*(Math.abs(n-f)*a)/(r[c]/i))}else u.push(e*n/(r[c]/i));else{const t=(n+i)/2;u.push(e*t)}})),s.push(u)}))}return s},_L=t=>{const e=t.length,n=t[0].length,r=[];for(let i=0;i<e;i++){const e=[];for(let r=0;r<n;r++)0!==t[i][r]?e.push(1/(t[i][r]*t[i][r])):e.push(0);r.push(e)}return r},AL=(t,e)=>{let n=-1;return t.forEach(((t,r)=>{t.id===e&&(n=r)})),Math.max(n,0)},CL=(t,e,n)=>{const r=t.length;for(let i=0;i<r;i++)if(t[e][i]===1/0){t[e][i]=n,t[i][e]=n;for(let o=0;o<r;o++)t[i][o]!==1/0&&t[e][o]===1/0&&(t[e][o]=n+t[i][o],t[o][e]=n+t[i][o])}for(let n=0;n<r;n++)if(n!==e)for(let i=0;i<r;i++)if(t[n][i]===1/0){let r=Math.abs(t[e][n]-t[e][i]);r=0===r?1:r,t[n][i]=r}},PL=(t,e)=>{let n=0;for(let r=0;r<t[e].length;r++)t[e][r]!==1/0&&(n=t[e][r]>n?t[e][r]:n);return n},DL={center:[0,0],width:300,height:300};
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */
const RL=Symbol("Comlink.proxy"),LL=Symbol("Comlink.endpoint"),IL=Symbol("Comlink.releaseProxy"),jL=Symbol("Comlink.finalizer"),FL=Symbol("Comlink.thrown"),BL=t=>"object"==typeof t&&null!==t||"function"==typeof t,zL=new Map([["proxy",{canHandle:t=>BL(t)&&t[RL],serialize(t){const{port1:e,port2:n}=new MessageChannel;return VL(t,e),[n,[n]]},deserialize:t=>(t.start(),WL(t))}],["throw",{canHandle:t=>BL(t)&&FL in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function VL(t,e=globalThis,n=["*"]){e.addEventListener("message",(function r(i){if(!i||!i.data)return;if(!function(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}(n,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:o,type:a,path:s}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(JL);let c;try{const e=s.slice(0,-1).reduce(((t,e)=>t[e]),t),n=s.reduce(((t,e)=>t[e]),t);switch(a){case"GET":c=n;break;case"SET":e[s.slice(-1)[0]]=JL(i.data.value),c=!0;break;case"APPLY":c=n.apply(e,l);break;case"CONSTRUCT":c=function(t){return Object.assign(t,{[RL]:!0})}(new n(...l));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;VL(t,n),c=function(t,e){return KL.set(t,e),t}(e,[e])}break;case"RELEASE":c=void 0;break;default:return}}catch(t){c={value:t,[FL]:0}}Promise.resolve(c).catch((t=>({value:t,[FL]:0}))).then((n=>{const[i,s]=ZL(n);e.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===a&&(e.removeEventListener("message",r),GL(e),jL in t&&"function"==typeof t[jL]&&t[jL]())})).catch((t=>{const[n,r]=ZL({value:new TypeError("Unserializable return value"),[FL]:0});e.postMessage(Object.assign(Object.assign({},n),{id:o}),r)}))})),e.start&&e.start()}function GL(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function WL(t,e){return qL(t,[],e)}function $L(t){if(t)throw new Error("Proxy has been released and is not useable")}function HL(t){return QL(t,{type:"RELEASE"}).then((()=>{GL(t)}))}const UL=new WeakMap,YL="FinalizationRegistry"in globalThis&&new FinalizationRegistry((t=>{const e=(UL.get(t)||0)-1;UL.set(t,e),0===e&&HL(t)}));function qL(t,e=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(n,o){if($L(r),o===IL)return()=>{!function(t){YL&&YL.unregister(t)}(i),HL(t),r=!0};if("then"===o){if(0===e.length)return{then:()=>i};const n=QL(t,{type:"GET",path:e.map((t=>t.toString()))}).then(JL);return n.then.bind(n)}return qL(t,[...e,o])},set(n,i,o){$L(r);const[a,s]=ZL(o);return QL(t,{type:"SET",path:[...e,i].map((t=>t.toString())),value:a},s).then(JL)},apply(n,i,o){$L(r);const a=e[e.length-1];if(a===LL)return QL(t,{type:"ENDPOINT"}).then(JL);if("bind"===a)return qL(t,e.slice(0,-1));const[s,l]=XL(o);return QL(t,{type:"APPLY",path:e.map((t=>t.toString())),argumentList:s},l).then(JL)},construct(n,i){$L(r);const[o,a]=XL(i);return QL(t,{type:"CONSTRUCT",path:e.map((t=>t.toString())),argumentList:o},a).then(JL)}});return function(t,e){const n=(UL.get(e)||0)+1;UL.set(e,n),YL&&YL.register(t,e,t)}(i,t),i}function XL(t){const e=t.map(ZL);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const KL=new WeakMap;function ZL(t){for(const[e,n]of zL)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},KL.get(t)||[]]}function JL(t){switch(t.type){case"HANDLER":return zL.get(t.name).deserialize(t.value);case"RAW":return t.value}}function QL(t,e,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===i&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:i},e),n)}))}class tI extends tv{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=WL(new Worker(new URL("./worker.js","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("g6-extension-vue.min.js",document.baseURI).href),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var t;return Ve(this,void 0,void 0,(function*(){if(this.running)return this;this.running=!0;const e=ze(this.layout.options,["onTick"]),n={};Object.keys(e).forEach((t=>{Yt(e[t])||(n[t]=e[t])}));const r={layout:{id:this.layout.id,options:n,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},i=new Float32Array([0]),[o]=yield this.proxy.calculateLayout(r,[i]);return o}))}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[IL]()}isRunning(){return this.running}}const eI=t=>t?parseInt(t):0;function nI(t){if(!t)return[0,0];let e=640,n=480;const[r,i]=function(t){const e=getComputedStyle(t),n=t.clientWidth||eI(e.width),r=t.clientHeight||eI(e.height);return[n-(eI(e.paddingLeft)+eI(e.paddingRight)),r-(eI(e.paddingTop)+eI(e.paddingBottom))]}(t);e=r||e,n=i||n;return[Math.max(le(e)?e:1,1),Math.max(le(n)?n:1,1)]}function rI(t,e=!0,n){const r=document.createElement("div");return r.setAttribute("class",`g6-${t}`),Object.assign(r.style,{position:"absolute",display:"block"}),e&&Object.assign(r.style,{inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),n&&Object.assign(r.style,n),r}function iI(t,e="div",n={},r="",i=document.body){const o=document.getElementById(t);o&&o.remove();const a=document.createElement(e);return a.innerHTML=r,a.id=t,Object.assign(a.style,n),i.appendChild(a),a}class oI extends Lh{}var aI=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class sI extends oI{constructor(t,e){super(t,Object.assign({},sI.defaultOptions,e)),this.$element=rI("background");this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return aI(this,void 0,void 0,(function*(){e.update.call(this,t),Object.assign(this.$element.style,Pe(this.options,["key","type"]))}))}destroy(){super.destroy(),this.$element.remove()}}function lI(t,e,n,r,i,o){const a=n-t,s=r-e;let l=i-t,c=o-e,u=l*a+c*s,h=0;u<=0?h=0:(l=a-l,c=s-c,u=l*a+c*s,h=u<=0?0:u*u/(a*a+s*s));const d=l*l+c*c-h;return d<0?0:d}function cI(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)}function uI(t,e,n,r,i){return cI(t,e,n,r)<i*i}function hI(t){const e=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),r=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return{x:e,y:r,x2:n,y2:i,width:n-e,height:i-r}}sI.defaultOptions={transition:"background 0.5s",backgroundSize:"cover"};let dI=class t{constructor(t,e,n,r){this.x1=t,this.y1=e,this.x2=n,this.y2=r}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new t(e.x1,e.y1,e.x2,e.y2)}cuts(t,e){if(this.y1===this.y2)return!1;if(e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2)return!1;if(t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;return t<=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1)}distSquare(t,e){return lI(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}};var fI,pI;!function(t){t[t.POINT=1]="POINT",t[t.PARALLEL=2]="PARALLEL",t[t.COINCIDENT=3]="COINCIDENT",t[t.NONE=4]="NONE"}(fI||(fI={}));class gI{constructor(t,e=0,n=0){this.state=t,this.x=e,this.y=n}}function vI(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){const e=n/i,o=r/i;return 0<=e&&e<=1&&0<=o&&o<=1?new gI(fI.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new gI(fI.NONE)}return new gI(0===n||0===r?fI.COINCIDENT:fI.PARALLEL)}function mI(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){const t=n/i,e=r/i;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function yI(t,e,n){const r=new Set;return t.width<=0?(r.add(pI.LEFT),r.add(pI.RIGHT)):e<t.x?r.add(pI.LEFT):e>t.x+t.width&&r.add(pI.RIGHT),t.height<=0?(r.add(pI.TOP),r.add(pI.BOTTOM)):n<t.y?r.add(pI.TOP):n>t.y+t.height&&r.add(pI.BOTTOM),r}function bI(t,e){let n=e.x1,r=e.y1;const i=e.x2,o=e.y2,a=Array.from(yI(t,i,o));if(0===a.length)return!0;let s=yI(t,n,r);for(;0!==s.size;){for(const t of a)if(s.has(t))return!1;if(s.has(pI.RIGHT)||s.has(pI.LEFT)){let e=t.x;s.has(pI.RIGHT)&&(e+=t.width),r+=(e-n)*(o-r)/(i-n),n=e}else{let e=t.y;s.has(pI.BOTTOM)&&(e+=t.height),n+=(e-r)*(i-n)/(o-r),r=e}s=yI(t,n,r)}return!0}function xI(t,e){let n=Number.POSITIVE_INFINITY,r=0;function i(t,i,o,a){let s=mI(e,new dI(t,i,o,a));s=Math.abs(s-.5),s>=0&&s<=1&&(r++,s<n&&(n=s))}return i(t.x,t.y,t.x2,t.y),i(t.x,t.y,t.x,t.y2),r>1?n:(i(t.x,t.y2,t.x2,t.y2),r>1?n:(i(t.x2,t.y,t.x2,t.y2),0===r?-1:n))}function EI(t,e){let n=0;const r=vI(t,new dI(e.x,e.y,e.x2,e.y));n+=r.state===fI.POINT?1:0;const i=vI(t,new dI(e.x,e.y,e.x,e.y2));n+=i.state===fI.POINT?1:0;const o=vI(t,new dI(e.x,e.y2,e.x2,e.y2));n+=o.state===fI.POINT?1:0;const a=vI(t,new dI(e.x2,e.y,e.x2,e.y2));return n+=a.state===fI.POINT?1:0,{top:r,left:i,bottom:o,right:a,count:n}}!function(t){t[t.LEFT=0]="LEFT",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(pI||(pI={}));class wI{constructor(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new wI(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new wI(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x+t.width),i=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=r-e,this.height=i-n}addPoint(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x),i=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=r-e,this.height=i-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0||t.width<=0||t.height<=0)&&(t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2)}distSquare(t,e){if(this.containsPt(t,e))return 0;const n=yI(this,t,e);return n.has(pI.TOP)?n.has(pI.LEFT)?cI(t,e,this.x,this.y):n.has(pI.RIGHT)?cI(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(pI.BOTTOM)?n.has(pI.LEFT)?cI(t,e,this.x,this.y2):n.has(pI.RIGHT)?cI(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(pI.LEFT)?(this.x-t)*(this.x-t):n.has(pI.RIGHT)?(t-this.x2)*(t-this.x2):0}}let kI=class t{constructor(t,e,n){this.cx=t,this.cy=e,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(e){return new t(e.cx,e.cy,e.radius)}containsPt(t,e){return cI(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const n=cI(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;const r=Math.sqrt(n)-this.radius;return r*r}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}};class MI{constructor(t,e=0,n=0,r=0,i=0,o=10,a=10,s=new Float32Array(Math.max(0,o*a)).fill(0)){this.pixelGroup=t,this.i=e,this.j=n,this.pixelX=r,this.pixelY=i,this.width=o,this.height=a,this.area=s}createSub(t,e){return new MI(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new MI(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new MI(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),n=this.scaleY(t.y),r=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),i=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup));return new wI(e,n,r-e,i-n)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const n=Math.ceil(e/this.pixelGroup),r=this.boundX(t.x-n),i=this.boundY(t.y-n),o=this.boundX(t.x2+n),a=this.boundY(t.y2+n);return new wI(r,i,o-r,a-i)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}set(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;const n=this.width,r=t.width,i=Math.max(0,t.i),o=Math.max(0,t.j),a=Math.min(t.i+t.width,n),s=Math.min(t.j+t.height,this.height);if(!(s<=0||a<=0||i>=n||s>=this.height))for(let l=o;l<s;l++){const o=(l-t.j)*r,s=l*n;for(let n=i;n<a;n++){const r=t.area[n-t.i+o];0!==r&&(this.area[n+s]+=e*r)}}}fill(t){this.area.fill(t)}fillArea(t,e){const n=t.x+t.y*this.width;for(let r=0;r<t.height;r++){const i=n+r*this.width;this.area.fill(e,i,i+t.width)}}fillHorizontalLine(t,e,n,r){const i=t+e*this.width;this.area.fill(r,i,i+n)}fillVerticalLine(t,e,n,r){const i=t+e*this.width;for(let t=0;t<n;t++)this.area[i+t*this.width]=r}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const n=e*this.width;for(let e=0;e<this.width;e++){t+=this.area[n+e].toFixed(1).padStart(6),t+=" "}t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const n=this.area.reduce(((t,e)=>Math.min(t,e)),Number.POSITIVE_INFINITY),r=this.area.reduce(((t,e)=>Math.max(t,e)),Number.NEGATIVE_INFINITY),i=t=>(t-n)/(r-n);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){const r=this.area[e+n*this.width];t.fillStyle=`rgba(0, 0, 0, ${i(r)})`,t.fillRect(e,n,1,1)}t.restore()}drawThreshold(t,e,n=!0){if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++){const i=this.area[n+r*this.width];t.fillStyle=i>e?"black":"white",t.fillRect(n,r,1,1)}t.restore()}}}function NI(t,e){const n=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(n):n(t)}function OI(t,e,n){return SI(Object.assign(hI(t),{distSquare:(e,n)=>lI(t.x1,t.y1,t.x2,t.y2,e,n)}),e,n)}function SI(t,e,n){const r=NI(t,n),i=e.scale(r),o=e.createSub(i,r);return function(t,e,n,r){const i=n*n;for(let o=0;o<t.height;o++)for(let a=0;a<t.width;a++){const s=r(e.invertScaleX(t.i+a),e.invertScaleY(t.j+o));if(0!==s){if(s<i){const e=n-Math.sqrt(s);t.set(a,o,e*e)}}else t.set(a,o,i)}}(o,e,n,((e,n)=>t.distSquare(e,n))),o}function TI(t,e){return{x:t,y:e}}function _I(t,e,n,r){if(0===t.length)return[];const i=function(t){if(t.length<2)return t;let e=0,n=0;return t.forEach((t=>{e+=t.cx,n+=t.cy})),e/=t.length,n/=t.length,t.map((t=>{const r=e-t.cx,i=n-t.cy;return[t,r*r+i*i]})).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}(t);return i.map(((t,o)=>{const a=i.slice(0,o);return function(t,e,n,r,i){const o=TI(e.cx,e.cy),a=function(t,e,n){let r=Number.POSITIVE_INFINITY;return e.reduce(((e,i)=>{const o=cI(t.x,t.y,i.cx,i.cy);if(o>r)return e;const a=new dI(t.x,t.y,i.cx,i.cy),s=function(t,e){return t.reduce(((t,n)=>bI(n,e)&&function(t,e){function n(t,n,r,i){let o=mI(e,new dI(t,n,r,i));return o=Math.abs(o-.5),o>=0&&o<=1?1:0}let r=n(t.x,t.y,t.x2,t.y);return r+=n(t.x,t.y,t.x,t.y2),r>1||(r+=n(t.x,t.y2,t.x2,t.y2),r>1||(r+=n(t.x2,t.y,t.x2,t.y2),r>0))}(n,e)?t+1:t),0)}(n,a);return o*(s+1)*(s+1)<r&&(e=i,r=o*(s+1)*(s+1)),e}),null)}(o,n,t);if(null==a)return[];const s=function(t,e,n,r){const i=[],o=[];o.push(t);let a=!0;for(let t=0;t<n&&a;t++)for(a=!1;!a&&o.length>0;){const t=o.pop(),n=PI(e,t),s=n?EI(t,n):null;if(!n||!s||2!==s.count){a||i.push(t);continue}let l=r,c=DI(n,l,s,!0),u=CI(c,o)||CI(c,i),h=AI(c,e);for(;!u&&h&&l>=1;)l/=1.5,c=DI(n,l,s,!0),u=CI(c,o)||CI(c,i),h=AI(c,e);if(!c||u||h||(o.push(new dI(t.x1,t.y1,c.x,c.y)),o.push(new dI(c.x,c.y,t.x2,t.y2)),a=!0),a)continue;l=r,c=DI(n,l,s,!1);let d=CI(c,o)||CI(c,i);for(h=AI(c,e);!d&&h&&l>=1;)l/=1.5,c=DI(n,l,s,!1),d=CI(c,o)||CI(c,i),h=AI(c,e);c&&!d&&(o.push(new dI(t.x1,t.y1,c.x,c.y)),o.push(new dI(c.x,c.y,t.x2,t.y2)),a=!0),a||i.push(t)}for(;o.length>0;)i.push(o.pop());return i}(new dI(o.x,o.y,a.cx,a.cy),t,r,i);return function(t,e){const n=[];for(;t.length>0;){const r=t.pop();if(0===t.length){n.push(r);break}const i=t.pop(),o=new dI(r.x1,r.y1,i.x2,i.y2);PI(e,o)?(n.push(r),t.push(i)):t.push(o)}return n}(s,t)}(e,t,a,n,r)})).flat()}function AI(t,e){return e.some((e=>e.containsPt(t.x,t.y)))}function CI(t,e){return e.some((e=>!!uI(e.x1,e.y1,t.x,t.y,.001)||!!uI(e.x2,e.y2,t.x,t.y,.001)))}function PI(t,e){let n=Number.POSITIVE_INFINITY,r=null;for(const i of t){if(!bI(i,e))continue;const t=xI(i,e);t>=0&&t<n&&(r=i,n=t)}return r}function DI(t,e,n,r){const i=n.top,o=n.left,a=n.bottom,s=n.right;if(r){if(o.state===fI.POINT){if(i.state===fI.POINT)return TI(t.x-e,t.y-e);if(a.state===fI.POINT)return TI(t.x-e,t.y2+e);const n=t.width*t.height;return t.width*(.5*(o.y-t.y+(s.y-t.y)))<.5*n?o.y>s.y?TI(t.x-e,t.y-e):TI(t.x2+e,t.y-e):o.y<s.y?TI(t.x-e,t.y2+e):TI(t.x2+e,t.y2+e)}if(s.state===fI.POINT){if(i.state===fI.POINT)return TI(t.x2+e,t.y-e);if(a.state===fI.POINT)return TI(t.x2+e,t.y2+e)}const n=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*n?i.x>a.x?TI(t.x-e,t.y-e):TI(t.x-e,t.y2+e):i.x<a.x?TI(t.x2+e,t.y-e):TI(t.x2+e,t.y2+e)}if(o.state===fI.POINT){if(i.state===fI.POINT)return TI(t.x2+e,t.y2+e);if(a.state===fI.POINT)return TI(t.x2+e,t.y-e);const n=t.height*t.width;return t.width*(.5*(o.y-t.y+(s.y-t.y)))<.5*n?o.y>s.y?TI(t.x2+e,t.y2+e):TI(t.x-e,t.y2+e):o.y<s.y?TI(t.x2+e,t.y-e):TI(t.x-e,t.y-e)}if(s.state===fI.POINT){if(i.state===fI.POINT)return TI(t.x-e,t.y2+e);if(a.state===fI.POINT)return TI(t.x-e,t.y-e)}const l=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*l?i.x>a.x?TI(t.x2+e,t.y2+e):TI(t.x2+e,t.y-e):i.x<a.x?TI(t.x-e,t.y2+e):TI(t.x-e,t.y-e)}function RI(t,e,n,r){if(!(t.closed?n<t.length:n<t.length-1))return!1;const i=t.get(e),o=t.get(n+1);for(let a=e+1;a<=n;a++){const e=t.get(a);if(lI(i.x,i.y,o.x,o.y,e.x,e.y)>r)return!1}return!0}function LI(t,e){switch(t){case-2:return(((3-e)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}class II{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(0===e.length)return"";const n="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;const e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t);let r="M";for(const t of e)r+=`${n(t.x)},${n(t.y)} L`;return r=r.slice(0,-1),this.closed&&(r+=" Z"),r}draw(t){const e=this.points;if(0!==e.length){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const n of e)t.lineTo(n.x,n.y);this.closed&&t.closePath()}}sample(t){return function(t=8){return e=>{let n=t,r=e.length;if(n>1)for(r=Math.floor(e.length/n);r<3&&n>1;)n-=1,r=Math.floor(e.length/n);const i=[];for(let t=0,o=0;o<r;o++,t+=n)i.push(e.get(t));return new II(i)}}(t)(this)}simplify(t){return function(t=0){return e=>{if(t<0||e.length<3)return e;const n=[];let r=0;const i=t*t;for(;r<e.length;){let t=r+1;for(;RI(e,r,t,i);)t++;n.push(e.get(r)),r=t}return new II(n)}}(t)(this)}bSplines(t){return function(t=6){function e(t,e,n){let r=0,i=0;for(let o=-2;o<=1;o++){const a=t.get(e+o),s=LI(o,n);r+=s*a.x,i+=s*a.y}return{x:r,y:i}}return n=>{if(n.length<3)return n;const r=[],i=n.closed,o=n.length+3-1+(i?0:2);r.push(e(n,2-(i?0:2),0));for(let a=2-(i?0:2);a<o;a++)for(let i=1;i<=t;i++)r.push(e(n,a,i/t));return new II(r)}}(t)(this)}apply(t){return t(this)}containsElements(t){const e=function(t){if(0===t.length)return null;const e=t[0],n=new wI(e.x,e.y,0,0);for(const e of t)n.addPoint(e);return n}(this.points);return!!e&&t.every((t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy)))}withinArea(t,e){if(0===this.length)return!1;let n=0;const r=this.points[0],i=new dI(r.x,r.y,r.x,r.y);for(let r=1;r<this.points.length;r++){const o=this.points[r];i.x1=i.x2,i.y1=i.y2,i.x2=o.x,i.y2=o.y,i.cuts(t,e)&&n++}return i.x1=i.x2,i.y1=i.y2,i.x2=r.x,i.y2=r.y,i.cuts(t,e)&&n++,n%2==1}}class jI{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;const e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new II(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}function FI(t,e){const n=2*(Math.floor(t.width)+Math.floor(t.height)),r=new jI(n);function i(n,r,i,o){const a=t.get(n,r);return Number.isNaN(a)?Number.NaN:a>e?i+o:i}function o(t,e){let n=0;return n=i(t,e,n,1),n=i(t+1,e,n,2),n=i(t,e+1,n,4),n=i(t+1,e+1,n,8),Number.isNaN(n)?-1:n}let a=1;function s(e,n){let i=e,s=n,l=t.invertScaleX(i),c=t.invertScaleY(s);for(let e=0;e<t.width*t.height;e++){const e={x:l,y:c};if(r.contains(e)){if(r.isFirst(e))return!0}else r.add(e);const n=o(i,s);switch(n){case-1:return!0;case 0:case 3:case 2:case 7:a=2;break;case 12:case 14:case 4:a=3;break;case 6:a=0===a?3:2;break;case 1:case 13:case 5:a=0;break;case 9:a=2===a?0:1;break;case 10:case 8:case 11:a=1;break;default:return console.warn("Marching squares invalid state: "+n),!0}switch(a){case 0:s--,c-=t.pixelGroup;break;case 1:s++,c+=t.pixelGroup;break;case 3:i--,l-=t.pixelGroup;break;case 2:i++,l+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+n),!0}}return!0}for(let n=0;n<t.width;n++)for(let i=0;i<t.height;i++){if(t.get(n,i)<=e)continue;const a=o(n,i);if(!(a<0||15===a)&&s(n,i))return r.path()}return null}const BI={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function zI(t){return null!=t&&"number"==typeof t.radius}function VI(t,e){if(zI(t)!==zI(e))return!1;if(zI(t)){const n=e;return t.cx===n.cx&&t.cy===n.cy&&t.radius===n.radius}const n=e;return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}var GI;!function(t){t[t.MEMBERS=0]="MEMBERS",t[t.NON_MEMBERS=1]="NON_MEMBERS",t[t.EDGES=2]="EDGES"}(GI||(GI={}));let WI=class{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new wI(0,0,0,0),this.potentialArea=new MI(1,0,0,0,0,0,0),this.o=Object.assign({},BI,t)}pushMember(...t){if(0!==t.length){this.dirty.add(GI.MEMBERS);for(const e of t)this.members.push({raw:e,obj:zI(e)?kI.from(e):wI.from(e),area:null})}}removeMember(t){const e=this.members.findIndex((e=>VI(e.raw,t)));return!(e<0)&&(this.members.splice(e,1),this.dirty.add(GI.MEMBERS),!0)}removeNonMember(t){const e=this.nonMembers.findIndex((e=>VI(e.raw,t)));return!(e<0)&&(this.nonMembers.splice(e,1),this.dirty.add(GI.NON_MEMBERS),!0)}removeEdge(t){const e=this.edges.findIndex((e=>e.obj.equals(t)));return!(e<0)&&(this.edges.splice(e,1),this.dirty.add(GI.NON_MEMBERS),!0)}pushNonMember(...t){if(0!==t.length){this.dirty.add(GI.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:zI(e)?kI.from(e):wI.from(e),area:null})}}pushEdge(...t){if(0!==t.length){this.dirty.add(GI.EDGES);for(const e of t)this.edges.push({raw:e,obj:dI.from(e),area:null})}}update(){const t=this.dirty.has(GI.MEMBERS),e=this.dirty.has(GI.NON_MEMBERS);let n=this.dirty.has(GI.EDGES);this.dirty.clear();const r=this.members.map((t=>t.obj));if(this.o.virtualEdges&&(t||e)){const t=_I(r,this.nonMembers.map((t=>t.obj)),this.o.maxRoutingIterations,this.o.morphBuffer),e=new Map(this.virtualEdges.map((t=>[t.obj.toString(),t.area])));this.virtualEdges=t.map((t=>{var n;return{raw:t,obj:t,area:null!==(n=e.get(t.toString()))&&void 0!==n?n:null}})),n=!0}let i=!1;if(t||n){const t=function(t,e){if(0===t.length)return new wI(0,0,0,0);const n=wI.from(t[0]);for(const e of t)n.add(e);for(const t of e)n.add(hI(t));return n}(r,this.virtualEdges.concat(this.edges).map((t=>t.obj))),e=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,n=wI.from(NI(t,e));n.equals(this.activeRegion)||(i=!0,this.activeRegion=n)}if(i){const t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=MI.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach((t=>t.area=null)),this.nonMembers.forEach((t=>t.area=null)),this.edges.forEach((t=>t.area=null)),this.virtualEdges.forEach((t=>t.area=null))):t===this.potentialArea.width&&e===this.potentialArea.height||(this.potentialArea=MI.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const o=new Map,a=t=>{if(t.area){const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof wI?"R":"C"}`;o.set(e,t.area)}},s=t=>{if(t.area)return;const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof wI?"R":"C"}`;if(o.has(e)){const n=o.get(e);return void(t.area=this.potentialArea.copy(n,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1}))}const n=t.obj instanceof wI?function(t,e,n){const r=e.scale(t),i=e.addPadding(r,n),o=e.createSub(i,{x:t.x-n,y:t.y-n}),a=r.x-i.x,s=r.y-i.y,l=i.x2-r.x2,c=i.y2-r.y2,u=i.width-a-l,h=i.height-s-c,d=n*n;o.fillArea({x:a,y:s,width:u+1,height:h+1},d);const f=[0],p=Math.max(s,a,l,c);{const i=e.invertScaleX(r.x+r.width/2);for(let o=1;o<p;o++){const a=e.invertScaleY(r.y-o),s=t.distSquare(i,a);if(!(s<d))break;{const t=n-Math.sqrt(s);f.push(t*t)}}}const g=[],v=Math.max(a,l),m=Math.max(s,l);for(let i=1;i<v;i++){const o=e.invertScaleX(r.x-i),a=[];for(let i=1;i<m;i++){const s=e.invertScaleY(r.y-i),l=t.distSquare(o,s);if(l<d){const t=n-Math.sqrt(l);a.push(t*t)}else a.push(0)}g.push(a)}for(let t=1;t<Math.min(s,f.length);t++){const e=f[t];o.fillHorizontalLine(a,s-t,u+1,e)}for(let t=1;t<Math.min(c,f.length);t++){const e=f[t];o.fillHorizontalLine(a,s+h+t,u+1,e)}for(let t=1;t<Math.min(a,f.length);t++){const e=f[t];o.fillVerticalLine(a-t,s,h+1,e)}for(let t=1;t<Math.min(c,f.length);t++){const e=f[t];o.fillVerticalLine(a+u+t,s,h+1,e)}for(let t=1;t<a;t++){const e=g[t-1],n=a-t;for(let t=1;t<s;t++)o.set(n,s-t,e[t-1]);for(let t=1;t<c;t++)o.set(n,s+h+t,e[t-1])}for(let t=1;t<l;t++){const e=g[t-1],n=a+u+t;for(let t=1;t<s;t++)o.set(n,s-t,e[t-1]);for(let t=1;t<c;t++)o.set(n,s+h+t,e[t-1])}return o}(t.obj,this.potentialArea,this.o.nodeR1):SI(t.obj,this.potentialArea,this.o.nodeR1);t.area=n,o.set(e,n)};this.members.forEach(a),this.nonMembers.forEach(a),this.members.forEach(s),this.nonMembers.forEach((t=>{this.activeRegion.intersects(t.obj)?s(t):t.area=null})),this.edges.forEach((t=>{t.area||(t.area=OI(t.obj,this.potentialArea,this.o.edgeR1))})),this.virtualEdges.forEach((t=>{t.area||(t.area=OI(t.obj,this.potentialArea,this.o.edgeR1))}))}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new II([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,n=this.members.map((t=>t.area)),r=this.virtualEdges.concat(this.edges).map((t=>t.area)),i=this.nonMembers.filter((t=>null!=t.area)).map((t=>t.area)),o=this.members.map((t=>t.obj));return function(t,e,n,r,i,o={}){const a=Object.assign({},BI,o);let s=a.threshold,l=a.memberInfluenceFactor,c=a.edgeInfluenceFactor,u=a.nonMemberInfluenceFactor;const h=(a.nodeR0-a.nodeR1)*(a.nodeR0-a.nodeR1),d=(a.edgeR0-a.edgeR1)*(a.edgeR0-a.edgeR1);for(let o=0;o<a.maxMarchingIterations;o++){if(t.clear(),0!==l){const n=l/h;for(const r of e)t.incArea(r,n)}if(0!==c){const e=c/d;for(const r of n)t.incArea(r,e)}if(0!==u){const e=u/h;for(const n of r)t.incArea(n,e)}const f=FI(t,s);if(f&&i(f))return f;if(s*=.95,o<=.5*a.maxMarchingIterations)l*=1.2,c*=1.2;else{if(!(0!==u&&r.length>0))break;u*=.8}}return new II([])}(e,n,r,i,(t=>t.containsElements(o)),t)}};var $I=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class HI extends oI{constructor(t,e){super(t,Me({},HI.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:t,bubbleSetOptions:e}=this.parseOptions();Se(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);const n=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(n):(this.shape=new tf({style:n}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;const e=xh(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{const{graph:e}=this.context,n=this.options.members,r=[...this.members.keys()],i=this.options.avoidMembers,o=[...this.avoidMembers.keys()];if(!t&&Se(n,r)&&Se(i,o))return this.path;const{enter:a=[],exit:s=[]}=Ch(r,n,(t=>t)),{enter:l=[],exit:c=[]}=Ch(o,i,(t=>t));t&&(s.push(t),a.push(t));const u=(t,n,r)=>{t.forEach((t=>{const i=r?this.members:this.avoidMembers,o=r?"pushMember":"pushNonMember",a=r?"removeMember":"removeNonMember";if(n){let n;"edge"===e.getElementType(t)?([n]=YI(e,t),this.bubbleSets.pushEdge(n)):([n]=UI(e,t),this.bubbleSets[o](n)),i.set(t,n)}else{const n=i.get(t);n&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(n):this.bubbleSets[a](n),i.delete(t))}}))};u(s,!1,!0),u(a,!0,!0),u(c,!1,!1),u(l,!0,!1);const h=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=Jd(h.points.map(id)),this.path},this.bindEvents(),this.bubbleSets=new WI(this.options)}bindEvents(){this.context.graph.on(xu.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(xu.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new WI(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const t=this.options,{type:e,key:n,members:r,avoidMembers:i}=t,o=$I(t,["type","key","members","avoidMembers"]),a=Object.keys(o).reduce(((t,e)=>(e in BI?t.bubbleSetOptions[e]=o[e]:t.style[e]=o[e],t)),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:r,avoidMembers:i},a)}addMember(t){const e=Array.isArray(t)?t:[t];e.some((t=>this.options.avoidMembers.includes(t)))&&(this.options.avoidMembers=this.options.avoidMembers.filter((t=>!e.includes(t)))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((t=>!e.includes(t))),this.drawBubbleSets()}updateMember(t){this.options.members=Yt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some((t=>this.options.members.includes(t)))&&(this.options.members=this.options.members.filter((t=>!e.includes(t)))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some((t=>e.includes(t)))&&(this.options.avoidMembers=this.options.avoidMembers.filter((t=>!e.includes(t))),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(xu.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(xu.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}HI.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},BI);const UI=(t,e)=>(Array.isArray(e)?e:[e]).map((e=>{const n=t.getElementRenderBounds(e);return new wI(n.min[0],n.min[1],Xu(n),Ku(n))})),YI=(t,e)=>(Array.isArray(e)?e:[e]).map((e=>{const n=t.getEdgeData(e),r=t.getElementPosition(n.source),i=t.getElementPosition(n.target);return dI.from({x1:r[0],y1:r[1],x2:i[0],y2:i[1]})}));var qI=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class XI extends oI{constructor(t,e){super(t,Object.assign({},XI.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{const{onClick:e,trigger:n}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const n=t.target.getAttribute("value");null==e||e(n,t.target,this.targetElement),this.hide()}"click"!==n&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=rI("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t);this.context.canvas.getContainer().appendChild(this.$element),iI("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}show(t){return qI(this,void 0,void 0,(function*(){const{enable:e,offset:n}=this.options;if("function"==typeof e&&!e(t)||!e)return void this.hide();const r=yield this.getDOMContent(t);r instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(r)):this.$element.innerHTML=r;const i=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-i.left+n[0]}px`,this.$element.style.top=`${t.client.y-i.top+n[1]}px`,this.$element.style.display="block",this.targetElement=t.target}))}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return qI(this,void 0,void 0,(function*(){const{getContent:e,getItems:n}=this.options;return n?`\n    <ul class="g6-contextmenu-ul">\n      ${(yield n(t)).map((t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`)).join("")}\n    </ul>\n  `:yield e(t)}))}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}XI.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class KI extends oI{constructor(t,e){super(t,Object.assign({},KI.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:t,element:e}=this.context,n=t.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:r,iterRate:i,divRate:o}=this.options;let{lambda:a,divisions:s,iterations:l}=this.options;for(let t=0;t<r;t++){for(let t=0;t<l;t++){const t={};n.forEach((e=>{var n;if(e.source===e.target)return;const r=xh(e);t[r]=this.getEdgeForces(e,s,a);for(let e=0;e<s+1;e++)(n=this.edgePoints)[r]||(n[r]=[]),this.edgePoints[r][e]=Bh(this.edgePoints[r][e],t[r][e])}))}a/=2,s*=o,l*=i,this.divideEdges(s)}n.forEach((t=>{const n=xh(t),r=e.getElement(n);null==r||r.update({d:rg(this.edgePoints[n])})}))},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map((t=>[xh(t),Xh(ed(t))])))}divideEdges(t){this.context.model.getEdgeData().forEach((e=>{var n;const r=xh(e);(n=this.edgePoints)[r]||(n[r]=[]);const i=this.nodeMap[e.source],o=this.nodeMap[e.target];if(1===t)this.edgePoints[r].push(i),this.edgePoints[r].push(Gh(Bh(i,o),2)),this.edgePoints[r].push(o);else{const e=(0===this.edgePoints[r].length?$h(i,o):rj(this.edgePoints[r]))/(t+1);let n=e;const a=[i];for(let t=1;t<this.edgePoints[r].length;t++){const i=this.edgePoints[r][t-1],o=this.edgePoints[r][t];let s=$h(o,i);for(;s>n;){const t=n/s,r=Bh(i,Vh(zh(o,i),t));a.push(r),s-=n,n=e}n-=s}a.push(o),this.edgePoints[r]=a}}))}getVectorPosition(t){const e=this.nodeMap[t.source],n=this.nodeMap[t.target],[r,i]=zh(n,e);return{source:e,target:n,vx:r,vy:i,length:$h(e,n)}}measureEdgeCompatibility(t,e){const n=this.getVectorPosition(t),r=this.getVectorPosition(e);return ZI(n,r)*JI(n,r)*QI(n,r)*nj(n,r)}getEdgeBundles(){const t={},e=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach(((r,i)=>{n.forEach(((n,o)=>{var a,s;if(o<=i)return;this.measureEdgeCompatibility(r,n)>=e&&(t[a=xh(r)]||(t[a]=[]),t[xh(r)].push(n),t[s=xh(n)]||(t[s]=[]),t[xh(n)].push(r))}))})),t}getSpringForce(t,e){const{pre:n,cur:r,next:i}=t;return Vh(zh(Bh(n,i),Vh(r,2)),e)}getElectrostaticForce(t,e){Oe(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[xh(e)];let r=[0,0];return null==n||n.forEach((n=>{const i=this.edgePoints[xh(n)][t],o=this.edgePoints[xh(e)][t],a=zh(i,o),s=$h(i,o);r=Bh(r,Vh(a,1/s))})),r}getEdgeForces(t,e,n){const r=this.nodeMap[t.source],i=this.nodeMap[t.target],o=this.options.K/($h(r,i)*(e+1)),a=[[0,0]],s=xh(t);for(let r=1;r<e;r++){const e=this.getSpringForce({pre:this.edgePoints[s][r-1],cur:this.edgePoints[s][r],next:this.edgePoints[s][r+1]||[0,0]},o),i=this.getElectrostaticForce(r,t);a.push(Vh(Bh(e,i),n))}return a.push([0,0]),a}bindEvents(){const{graph:t}=this.context;t.on(xu.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:t}=this.context;t.off(xu.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}KI.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const ZI=(t,e)=>Math.abs(function(t,e){return t.reduce(((t,n,r)=>t+n*e[r]),0)}([t.vx,t.vy],[e.vx,e.vy])/(t.length*e.length)),JI=(t,e)=>{const n=(t.length+e.length)/2;return 2/(n/Math.min(t.length,e.length)+Math.max(t.length,e.length)/n)},QI=(t,e)=>{const n=(t.length+e.length)/2;return n/(n+$h(Gh(Bh(t.source,t.target),2),Gh(Bh(e.source,e.target),2)))},tj=(t,e)=>{if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];const n=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),r=(n*n*e.source[0]+n*(t[1]-e.source[1])+t[0])/(n*n+1);return[r,n*(r-e.source[0])+e.source[1]]},ej=(t,e)=>{const n=tj(e.source,t),r=tj(e.target,t),i=Gh(Bh(n,r),2),o=Gh(Bh(t.source,t.target),2);return 0===$h(n,r)?0:Math.max(0,1-2*$h(o,i)/$h(n,r))},nj=(t,e)=>Math.min(ej(t,e),ej(e,t)),rj=t=>{let e=0;for(let n=1;n<t.length;n++)e+=$h(t[n],t[n-1]);return e},ij={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8};class oj extends oI{constructor(t,e){super(t,Object.assign({},oj.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=id(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{const e=Object.assign({},ij,this.options.style);this.isLensOn||(this.lens=new hf({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,od(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{const{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;const{nodes:r,edges:i,combos:o}=n;return{nodes:r.filter((e=>t(xh(e),"node"))),edges:i.filter((e=>t(xh(e),"edge"))),combos:o.filter((e=>t(xh(e),"combo")))}},this.getFocusElements=t=>{const{nodes:e,edges:n}=this.getFilterData(),r=e.filter((e=>$h(ed(e),t)<this.r)),i=r.map((t=>xh(t)));return{nodes:r,edges:n.filter((t=>{const{source:e,target:n}=t,r=i.includes(e),o=i.includes(n);switch(this.options.nodeType){case"both":return r&&o;case"either":return r!==o;case"source":return r&&!o;case"target":return!r&&o;default:return!1}}))}},this.renderFocusElements=()=>{const{element:t,graph:e}=this.context;if(!this.isLensOn)return;const n=this.lens.getCenter(),{nodes:r,edges:i}=this.getFocusElements(n),o=new Set,a=n=>{const r=xh(n);o.add(r);const i=t.getElement(r);if(!i)return;const a=this.shapes.get(r)||i.cloneNode();a.setPosition(i.getPosition()),a.id=i.id,this.shapes.has(r)?Object.entries(i.attributes).forEach((([t,e])=>{a.style[t]!==e&&(a.style[t]=e)})):(this.canvas.appendChild(a),this.shapes.set(r,a));const s=e.getElementType(r),l=this.getElementStyle(s,n);a.update(l)};r.forEach(a),i.forEach(a),this.shapes.forEach(((t,e)=>{o.has(e)||(t.destroy(),this.shapes.delete(e))}))},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();const{clientX:n,clientY:r,deltaX:i,deltaY:o}=t,{graph:a,canvas:s}=this.context,l=a.getCanvasByClient([n,r]),c=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||$h(l,c)>this.r)return;const{maxR:u,minR:h}=this.options,d=i+o>0?1/.95:.95,f=Math.min(...s.getSize())/2;this.r=Math.max(h||0,Math.min(u||f,this.r*d)),this.renderLens(c),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;const n=id(t.canvas),r=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||$h(n,r)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=id(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const n="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof n?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:r}=this.options,i=e.getCanvas().getLayer();["click","drag"].includes(n)&&i.addEventListener(mu.CLICK,this.onEdgeFilter),"pointermove"===n?i.addEventListener(mu.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(i.addEventListener(mu.DRAG_START,this.onDragStart),i.addEventListener(mu.DRAG,this.onDrag),i.addEventListener(mu.DRAG_END,this.onDragEnd)),"wheel"===r&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(mu.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:r}=this.options,i=e.getCanvas().getLayer();["click","drag"].includes(n)&&i.removeEventListener(mu.CLICK,this.onEdgeFilter),"pointermove"===n?i.removeEventListener(mu.POINTER_MOVE,this.onEdgeFilter):"drag"===n&&(i.removeEventListener(mu.DRAG_START,this.onDragStart),i.removeEventListener(mu.DRAG,this.onDrag),i.removeEventListener(mu.DRAG_END,this.onDragEnd)),"wheel"===r&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(mu.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach(((t,e)=>{t.destroy(),this.shapes.delete(e)})),super.destroy()}}oj.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const aj={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class sj extends oI{constructor(t,e){super(t,Object.assign({},sj.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=id(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{const e=Object.assign({},aj,this.options.style);this.isLensOn||(this.lens=new hf({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,od(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{const{minD:t,maxD:e}=this.options;return`${Math.round((this.d-t)/(e-t)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:t}=this.context,e=this.lens.getCenter(),n=(this.d+1)*this.r,r=new Map,i=new Map;t.getNodeData().forEach((o=>{const a=ed(o),s=$h(a,e);if(s>this.r)return;const l=n*s/(this.d*s+this.r),[c,u]=a,[h,d]=e,f=[h+l*((c-h)/s),d+l*((u-d)/s)],p=xh(o),g=this.getNodeStyle(o),v=Ce(t.getElementRenderStyle(p),Object.keys(g));r.set(p,Object.assign(Object.assign({},od(f)),g)),i.set(p,Object.assign(Object.assign({},od(a)),v))})),this.updateStyle(r,i)},this.getNodeStyle=t=>{const{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{const{graph:n,element:r}=this.context,{enter:i,exit:o,keep:a}=Ch(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),(t=>t)),s=new Set,l=(t,e)=>{const i=r.getElement(t);null==i||i.update(e),n.getRelatedEdgesData(t).forEach((t=>{s.add(xh(t))}))};[...i,...a].forEach((e=>{l(e,t.get(e))})),o.forEach((t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)})),s.forEach((t=>{const e=r.getElement(t);null==e||e.update({})})),this.prevMagnifiedStyleMap=t,e.forEach(((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)}))},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;const{clientX:e,clientY:n}=t;return!($h(this.context.graph.getCanvasByClient([e,n]),this.lens.getCenter())>this.r)},this.scaleR=t=>{const{maxR:e,minR:n}=this.options,r=t?1/.95:.95,i=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(n||0,Math.min(e||i,this.r*r))},this.scaleD=t=>{const{maxD:e,minD:n}=this.options,r=t?this.d+.1:this.d-.1;this.d=Math.max(n,Math.min(e,r))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleR(e+n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleD(e+n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.isDragValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;return!($h(id(t.canvas),this.lens.getCenter())>this.r)},this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=id(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleR(e-n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleD(e-n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:r,scaleDBy:i}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.addEventListener(mu.CLICK,this.onCreateFisheye),"pointermove"===n&&o.addEventListener(mu.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===r||"drag"===i){o.addEventListener(mu.DRAG_START,this.onDragStart),o.addEventListener(mu.DRAG_END,this.onDragEnd);const t="drag"===n?this.onDrag:"drag"===r?this.scaleRByDrag:this.scaleDByDrag;o.addEventListener(mu.DRAG,t)}if("wheel"===r||"wheel"===i){const e="wheel"===r?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(mu.WHEEL,e,{passive:!1})}}unbindEvents(){var t;const{graph:e}=this.context,{trigger:n,scaleRBy:r,scaleDBy:i}=this.options,o=e.getCanvas().getLayer();if(["click","drag"].includes(n)&&o.removeEventListener(mu.CLICK,this.onCreateFisheye),"pointermove"===n&&o.removeEventListener(mu.POINTER_MOVE,this.onCreateFisheye),"drag"===n||"drag"===r||"drag"===i){o.removeEventListener(mu.DRAG_START,this.onDragStart),o.removeEventListener(mu.DRAG_END,this.onDragEnd);const t="drag"===n?this.onDrag:"drag"===r?this.scaleRByDrag:this.scaleDByDrag;o.removeEventListener(mu.DRAG,t)}if("wheel"===r||"wheel"===i){const e="wheel"===r?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(mu.WHEEL,e)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}sj.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class lj extends oI{constructor(t,e){super(t,Object.assign({},lj.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,n,r;const i=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(i),i?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(r=(n=this.options).onExit)||void 0===r||r.call(n)},this.shortcut=new md(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    "}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit);["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((t=>{document.addEventListener(t,this.onFullscreenChange,!1)}))}unbindEvents(){this.shortcut.unbindAll();["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach((t=>{document.removeEventListener(t,this.onFullscreenChange,!1)}))}setGraphSize(t=!0){var e,n;let r,i;t?(r=(null===(e=globalThis.screen)||void 0===e?void 0:e.width)||0,i=(null===(n=globalThis.screen)||void 0===n?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[r,i]=this.graphSize,this.context.graph.setSize(r,i),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch((t=>{_u(`Error attempting to enable full-screen: ${t.message} (${t.name})`)}))}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}lj.defaultOptions={trigger:{},autoFit:!0};class cj extends oI{constructor(t,e){super(t,Object.assign({},cj.defaultOptions,e)),this.$element=rI("grid-line"),this.offset=[0,0],this.onTransform=t=>{if(!this.options.follow)return;const{data:{translate:e}}=t;e&&this.updateOffset(e)};!function(t,e){const n=t.firstChild;n?t.insertBefore(e,n):t.appendChild(e)}(this.context.canvas.getContainer(),this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(xu.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:t,stroke:e,lineWidth:n,border:r,borderLineWidth:i,borderStroke:o,borderStyle:a}=this.options;Object.assign(this.$element.style,{border:r?`${i}px ${a} ${o}`:"none",backgroundImage:`linear-gradient(${e} ${n}px, transparent ${n}px), linear-gradient(90deg, ${e} ${n}px, transparent ${n}px)`,backgroundSize:`${t}px ${t}px`})}updateOffset(t){this.offset=function(t,e){return t.map((t=>t%e))}(Bh(this.offset,t),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(xu.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}function uj(t){const e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach((t=>{const{type:n,value:r}=t,i=xh(r);if("NodeAdded"===n||"EdgeAdded"===n||"ComboAdded"===n)e.Added.set(i,t);else if("NodeUpdated"===n||"EdgeUpdated"===n||"ComboUpdated"===n)if(e.Added.has(i))e.Added.set(i,{type:n.replace("Updated","Added"),value:r});else if(e.Updated.has(i)){const{original:t}=e.Updated.get(i);e.Updated.set(i,{type:n,value:r,original:t})}else e.Removed.has(i)||e.Updated.set(i,t);else"NodeRemoved"!==n&&"EdgeRemoved"!==n&&"ComboRemoved"!==n||(e.Added.has(i)?e.Added.delete(i):e.Updated.has(i)?(e.Updated.delete(i),e.Removed.set(i,t)):e.Removed.set(i,t))})),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function hj(t){const{NodeAdded:e=[],NodeUpdated:n=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:o=[],EdgeRemoved:a=[],ComboAdded:s=[],ComboUpdated:l=[],ComboRemoved:c=[]}=ae(t,(t=>t.type));return{add:{nodes:e,edges:i,combos:s},update:{nodes:n,edges:o,combos:l},remove:{nodes:r,edges:a,combos:c}}}function dj(t,e){for(const n in t)Kt(t[n])&&!Array.isArray(t[n])&&null!==t[n]?(e[n]||(e[n]={}),dj(t[n],e[n])):void 0===e[n]&&(e[n]=Du(n))}function fj(t,e=!1,n){const r={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:o,remove:a}=hj(uj(t));return["nodes","edges","combos"].forEach((t=>{o[t]&&o[t].forEach((e=>{var i,o;const a=Object.assign({},e.value);let s=Object.assign({},e.original);if(n){const t=n.graph.getElementType(xh(e.original)),r="edge"===t?"stroke":"fill",i=n.element.getElementComputedStyle(t,e.original);s=Object.assign(Object.assign({},e.original),{style:Object.assign({[r]:i[r]},e.original.style)})}dj(a,s),(i=r.current.update)[t]||(i[t]=[]),r.current.update[t].push(a),(o=r.original.update)[t]||(o[t]=[]),r.original.update[t].push(s)})),i[t]&&i[t].forEach((e=>{var n,i;const o=Object.assign({},e.value);(n=r.current.add)[t]||(n[t]=[]),r.current.add[t].push(o),(i=r.original.remove)[t]||(i[t]=[]),r.original.remove[t].push(o)})),a[t]&&a[t].forEach((e=>{var n,i;const o=Object.assign({},e.value);(n=r.current.remove)[t]||(n[t]=[]),r.current.remove[t].push(o),(i=r.original.add)[t]||(i[t]=[]),r.original.add[t].push(o)}))})),r}cj.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};class pj extends oI{constructor(t,e){super(t,Object.assign({},pj.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(t,e=!0)=>{var n,r,i;this.freezed=!0,null===(r=(n=this.options).executeCommand)||void 0===r||r.call(n,t);const o=e?t.original:t.current;this.context.graph.addData(o.add),this.context.graph.updateData(o.update),this.context.graph.removeData(wh(o.remove,!1)),null===(i=this.context.element)||void 0===i||i.draw({silence:!0,animation:t.animation}),this.freezed=!1},this.addCommand=t=>{var e;if(!this.freezed){if(t.type===xu.AFTER_DRAW){const{dataChanges:n=[],animation:r=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;return this.batchChanges.push(n),void(this.batchAnimation&&(this.batchAnimation=r))}this.batchChanges=[n],this.batchAnimation=r}this.undoStackPush(fj(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Eu.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{const{initiate:e}=t.data;if(this.batchAnimation=!1,e)this.batchChanges=[];else{this.undoStack.pop()||(this.batchChanges=null)}},this.emitter=new tv;const{graph:n}=this.context;n.on(xu.AFTER_DRAW,this.addCommand),n.on(xu.BATCH_START,this.initBatchCommand),n.on(xu.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,n,r;const i=this.undoStack.pop();if(i){this.executeCommand(i);if(!1===(null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,i,!1)))return;this.redoStack.push(i),null===(r=(n=this.options).afterAddCommand)||void 0===r||r.call(n,i,!1),this.notify(Eu.UNDO,i)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(Eu.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(Eu.CANCEL,t)),this}undoStackPush(t){var e,n,r,i;const{stackSize:o}=this.options;0!==o&&this.undoStack.length>=o&&this.undoStack.shift();!1!==(null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,t,!0))&&(this.undoStack.push(t),null===(i=(r=this.options).afterAddCommand)||void 0===i||i.call(r,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Eu.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(Eu.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:t}=this.context;t.off(xu.AFTER_DRAW,this.addCommand),t.off(xu.BATCH_START,this.initBatchCommand),t.off(xu.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}var gj,vj,mj,yj,bj,xj,Ej,wj,kj,Mj;function Nj(){if(wj)return Ej;function t(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}return wj=1,Ej=function(e){const n=function(e){const n=[];for(let r=0;r<e.length;r++){for(;n.length>=2&&t(n[n.length-2],n[n.length-1],e[r])<=0;)n.pop();n.push(e[r])}return n.pop(),n}(e),r=function(e){const n=e.reverse(),r=[];for(let e=0;e<n.length;e++){for(;r.length>=2&&t(r[r.length-2],r[r.length-1],n[e])<=0;)r.pop();r.push(n[e])}return r.pop(),r}(e),i=r.concat(n);return i.push(e[0]),i},Ej}pj.defaultOptions={stackSize:0};var Oj=function(){if(Mj)return kj;Mj=1;const t=function(){if(vj)return gj;function t(t,e,n,r,i,o){const a=(o-e)*(n-t)-(r-e)*(i-t);return a>0||!(a<0)}return vj=1,gj=function(e,n){const r=e[0][0],i=e[0][1],o=e[1][0],a=e[1][1],s=n[0][0],l=n[0][1],c=n[1][0],u=n[1][1];return t(r,i,s,l,c,u)!==t(o,a,s,l,c,u)&&t(r,i,o,a,s,l)!==t(r,i,o,a,c,u)}}(),e=function(){if(yj)return mj;function t(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(let e=0;e<t.length;e++){const n=t[e],r=this.coordToCellNum(n[0]),i=this.coordToCellNum(n[1]);if(this._cells[r])this._cells[r][i]?this._cells[r][i].push(n):this._cells[r][i]=[n];else{const t=[];t[i]=[n],this._cells[r]=t}}}return yj=1,t.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this.coordToCellNum(t[2]),i=this.coordToCellNum(t[3]),o=[];for(let t=e;t<=r;t++)for(let e=n;e<=i;e++)for(let n=0;n<this.cellPoints(t,e).length;n++)o.push(this.cellPoints(t,e)[n]);return o},removePoint:function(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this._cells[e][n];let i;for(let e=0;e<r.length;e++)if(r[e][0]===t[0]&&r[e][1]===t[1]){i=e;break}return r.splice(i,1),r},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},mj=function(e,n){return new t(e,n)}}(),n=xj?bj:(xj=1,bj={toXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)}))},fromXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)}))}}),r=Nj();function i(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function o(t,e,n){const r=[e[0]-t[0],e[1]-t[1]],o=[n[0]-t[0],n[1]-t[1]],a=i(t,e),s=i(t,n);return(r[0]*o[0]+r[1]*o[1])/Math.sqrt(a*s)}function a(e,n){for(let r=0;r<n.length-1;r++){const i=[n[r],n[r+1]];if(!(e[0][0]===i[0][0]&&e[0][1]===i[0][1]||e[0][0]===i[1][0]&&e[0][1]===i[1][1])&&t(e,i))return!0}return!1}function s(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function l(t,e,n){let r,i,s=null,l=u,c=u;for(let u=0;u<e.length;u++)r=o(t[0],t[1],e[u]),i=o(t[1],t[0],e[u]),r>l&&i>c&&!a([t[0],e[u]],n)&&!a([t[1],e[u]],n)&&(l=r,c=i,s=e[u]);return s}function c(t,e,n,r,o){let a=!1;for(let c=0;c<t.length-1;c++){const u=[t[c],t[c+1]],h=u[0][0]+","+u[0][1]+","+u[1][0]+","+u[1][1];if(i(u[0],u[1])<e||o.has(h))continue;let d,f,p,g=0,v=s(u);do{v=r.extendBbox(v,g),d=v[2]-v[0],f=v[3]-v[1],p=l(u,r.rangePoints(v),t),g++}while(null===p&&(n[0]>d||n[1]>f));d>=n[0]&&f>=n[1]&&o.add(h),null!==p&&(t.splice(c+1,0,p),r.removePoint(p),a=!0)}return a?c(t,e,n,r,o):t}const u=Math.cos(90/(180/Math.PI)),h=.6;return kj=function(t,i,o){let a=i||20;const s=function(t){const e=[t[0]];let n=t[0];for(let r=1;r<t.length;r++){const i=t[r];n[0]===i[0]&&n[1]===i[1]||e.push(i),n=i}return e}(function(t){return t.sort((function(t,e){return t[0]-e[0]||t[1]-e[1]}))}(n.toXy(t,o)));if(s.length<4){const t=s.concat([s[0]]);return o?n.fromXy(t,o):t}const l=function(t){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(let o=t.length-1;o>=0;o--)t[o][0]<e&&(e=t[o][0]),t[o][1]<n&&(n=t[o][1]),t[o][0]>r&&(r=t[o][0]),t[o][1]>i&&(i=t[o][1]);return[r-e,i-n]}(s),u=[l[0]*h,l[1]*h],d=r(s),f=s.filter((function(t){return d.indexOf(t)<0})),p=Math.ceil(1/(s.length/(l[0]*l[1]))),g=c(d,Math.pow(a,2),u,e(f,p),new Set);return o?n.fromXy(g,o):g},kj}(),Sj=E(Oj);const Tj=(t,e,n)=>{if("sharp"===n)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...r,t[0],t[1]+e],["A",...r,t[0],t[1]-e]]},_j=(t,e,n)=>{const r=[e,e,0,0,0],i="sharp"===n?Bh(t[0],Wh(Uh(zh(t[0],t[1])),e)):t[0],o="sharp"===n?Bh(t[1],Wh(Uh(zh(t[1],t[0])),e)):t[1],a=Wh(Uh(qh(zh(i,o),!1)),e),s=Wh(a,-1),l=Bh(i,a),c=Bh(o,a),u=Bh(o,s),h=Bh(i,s);return"sharp"===n?[["M",l[0],l[1]],["L",c[0],c[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",c[0],c[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,l[0],l[1]]]},Aj=(t,e)=>{const n=pd(t).map(((n,r)=>{const i=(r-2+t.length)%t.length,o=(r-1+t.length)%t.length,a=(r+1)%t.length,s=t[i],l=t[o],c=t[a],u=zh(s,l),h=zh(l,n),d=zh(n,c),f=(t,e)=>Yh(t,e,!0)<Math.PI,p=f(u,h),g=f(h,d),v=t=>Wh(Uh(qh(t,!1)),e),m=v(h);return[{p:Xh(Bh(l,p?v(u):m)),concave:p&&l},{p:Xh(Bh(n,g?v(d):m)),concave:g&&n}]})),r=[e,e,0,0,0],i=n.findIndex(((t,e)=>!(n[(e-1+n.length)%n.length][0].concave||n[(e-1+n.length)%n.length][1].concave||t[0].concave||t[0].concave||t[1].concave))),o=n.slice(i).concat(n.slice(0,i));let a=[];return o.flatMap(((t,e)=>{const i=[],s=o[n.length-1];return 0===e&&i.push(["M",...s[1].p]),t[0].concave?a.push(t[0].p,t[1].p):i.push(["A",...r,...t[0].p]),t[1].concave?a.unshift(t[1].p):i.push(["L",...t[1].p]),3===a.length&&(i.pop(),i.push(["C",...a.flat()]),a=[]),i}))},Cj=(t,e)=>{const n=pd(t).map(((e,n)=>({p:e,v:Uh(zh(t[(n+1)%t.length],e))})));return n.forEach(((r,i)=>{const o=i>0?i-1:t.length-1,a=n[o].v,s=Uh(Bh(a,Wh(r.v,Yh(a,r.v,!0)<Math.PI?1:-1)));r.p=Bh(r.p,Wh(s,e))})),Jd(n.map((t=>t.p)))},Pj=(t,e)=>{const n=t.map(((n,r)=>{const i=t[0===r?t.length-1:r-1],o=Kh(Wh(Uh(qh(zh(i,n),!1)),e));return[Bh(i,o),Bh(n,o)]})),r=n.flat();return r.map(((t,e)=>{if(e%2==0)return null;return Qh([r[(e-1)%r.length],r[e%r.length]],[r[(e+1)%r.length],r[(e+2)%r.length]],!0)})).filter(Boolean).map(((t,e)=>[0===e?"M":"L",t[0],t[1]])).concat([["Z"]])};var Dj=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Rj extends oI{constructor(t,e){super(t,Object.assign({},Rj.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){const t=!Se(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new tf({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(xh(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(t=!1)=>{const{graph:e}=this.context,n=this.getMember();if(0===n.length)return"";const r=n.map((t=>e.getNodeData(t))),i=Sj(r.map(ed),this.options.concavity).slice(1).reverse(),o=i.flatMap((t=>r.filter((e=>Se(ed(e),t))).map(xh)));return Se(o,this.hullMemberIds)&&!t||(this.hullMemberIds=o,this.path=function(t,e,n){if(1===t.length)return Tj(t[0],e,n);if(2===t.length)return _j(t,e,n);switch(n){case"smooth":return Cj(t,e);case"sharp":return Pj(t,e);default:return Aj(t,e)}}(i,this.getPadding(),this.options.corner)),this.path},this.bindEvents()}bindEvents(){this.context.graph.on(xu.AFTER_RENDER,this.drawHull),this.context.graph.on(xu.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,n=Dj(e,["members","padding","corner"]);return Object.assign(Object.assign({},n),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context,e=this.hullMemberIds.reduce(((e,n)=>{const{halfExtents:r}=t.getElementRenderBounds(n),i=Math.max(r[0],r[1]);return Math.max(e,i)}),0);return e+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter((t=>!e.includes(t))),e.some((t=>this.hullMemberIds.includes(t)))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=Yt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(xu.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}function Lj(t,e){e(t),t.children&&t.children.forEach((function(t){t&&Lj(t,e)}))}function Ij(t){Fj(t,!0)}function jj(t){Fj(t,!1)}function Fj(t,e){var n=e?"visible":"hidden";Lj(t,(function(t){t.attr("visibility",n)}))}Rj.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var Bj=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,$e([],We(e),!1))||this;return r.isMutationObserved=!0,r.addEventListener(Ws.INSERTED,(function(){jj(r)})),r}return Fe(e,t),e}(Fl);function zj(t){var e=t.appendChild(new Bj({class:"offscreen"}));return jj(e),e}var Vj=function(t){function e(e){void 0===e&&(e={});var n=e.style,r=ze(e,["style"]);return t.call(this,Be({style:Be({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},r))||this}return Fe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=zj(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e}(Jl);function Gj(t){return t*Math.PI/180}function Wj(t){return Number((180*t/Math.PI).toPrecision(5))}var $j=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=r}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},t}();function Hj(t,e){return Yt(t)?t.apply(void 0,$e([],We(e),!1)):t}var Uj,Yj,qj,Xj,Kj=function(t,e){var n=function(t){return"".concat(e,"-").concat(t)},r=Object.fromEntries(Object.entries(t).map((function(t){var e=We(t,2),r=e[0],i=e[1],o=n(i);return[r,{name:o,class:".".concat(o),id:"#".concat(o),toString:function(){return o}}]})));return Object.assign(r,{prefix:n}),r},Zj=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=5),Object.entries(e).forEach((function(i){var o=We(i,2),a=o[0],s=o[1],l=t;Object.prototype.hasOwnProperty.call(e,a)&&(s?ee(s)?(ee(t[a])||(l[a]={}),n<r?Zj(t[a],s,n+1,r):l[a]=e[a]):Xt(s)?(l[a]=[],l[a]=l[a].concat(s)):l[a]=s:l[a]=s)}))},Jj=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Zj(t,e[r]);return t},Qj=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)},tF=(Yj=function(t,e){var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return Uj||(Uj=xl.offscreenCanvasCreator.getOrCreateContext(void 0)),Uj.font=[o,a,i,"".concat(n,"px"),r].join(" "),Uj.measureText(t).width},qj=function(t,e){return[t,Object.values(e||eF(t)).join()].join("")},Xj=4096,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=qj?qj.apply(this,t):t[0];Ee.has(Yj)||Ee.set(Yj,function(t){var e,n,r,i=t;function o(t,o){++e>i&&(r=n,a(1),++e),n[t]=o}function a(t){e=0,n=Object.create(null),t||(r=Object.create(null))}return a(),{clear:a,has:function(t){return void 0!==n[t]||void 0!==r[t]},get:function(t){var e=n[t];return void 0!==e?e:void 0!==(e=r[t])?(o(t,e),e):void 0},set:function(t,e){void 0!==n[t]?n[t]=e:o(t,e)}}}(Xj));var r=Ee.get(Yj);if(r.has(n))return r.get(n);var i=Yj.apply(this,t);return r.set(n,i),i}),eF=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",i=t.style.fontVariant,o=t.style.fontSize;return{fontSize:o="object"==typeof o?o.value:o,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:i}};function nF(t){return"text"===t.nodeName?t:"g"===t.nodeName&&1===t.children.length&&"text"===t.children[0].nodeName?t.children[0]:null}function rF(t,e){var n=nF(t);n&&n.attr(e)}function iF(t,e,n){void 0===n&&(n="..."),rF(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function oF(t){var e=t.canvas,n=t.touches,r=t.offsetX,i=t.offsetY;if(e)return[e.x,e.y];if(n){var o=n[0];return[o.clientX,o.clientY]}return r&&i?[r,i]:[0,0]}function aF(t){return"function"==typeof t?t():ie(t)||le(t)?new Vj({style:{text:String(t)}}):t}function sF(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=function(t){t.node().removeChildren()}),t?n(e):(r&&i(e),null)}function lF(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!1),!!(r&&t===e||i&&t===n)||t>e&&t<n}function cF(t,e){return"number"==typeof t&&"number"==typeof e?function(t,e){return function(n){return t*(1-n)+e*n}}(t,e):Array.isArray(t)&&Array.isArray(e)?function(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(i){var o=new Array(r),a=new Array(n),s=0;for(s=0;s<r;++s)o[s]=cF(t[s],e[s]);for(;s<n;++s)a[s]=e[s];for(s=0;s<r;++s)a[s]=o[s](i);return a}}(t,e):"object"==typeof t&&"object"==typeof e?function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n={},r={};return Object.entries(e).forEach((function(e){var i=We(e,2),o=i[0],a=i[1];o in t?n[o]=cF(t[o],a):r[o]=a})),function(t){return Object.entries(n).forEach((function(e){var n=We(e,2),i=n[0],o=n[1];return r[i]=o(t)})),r}}(t,e):function(e){return t}}function uF(t){for(var e=1/0,n=1/0,r=-1/0,i=-1/0,o=0;o<t.length;o++){var a=t[o],s=a.x,l=a.y,c=We([s+a.width,l+a.height],2),u=c[0],h=c[1];s<e&&(e=s),l<n&&(n=l),u>r&&(r=u),h>i&&(i=h)}return new $j(e,n,r-e,i-n)}var hF=function(t,e,n){var r=t.width,i=t.height,o=n.flexDirection,a=void 0===o?"row":o;n.flexWrap;var s=n.justifyContent,l=void 0===s?"flex-start":s;n.alignContent;var c=n.alignItems,u=void 0===c?"flex-start":c,h="row"===a,d="row"===a||"column"===a,f=h?d?[1,0]:[-1,0]:d?[0,1]:[0,-1],p=We([0,0],2),g=p[0],v=p[1],m=e.map((function(t){var e,n=t.width,r=t.height,i=We([g,v],2),o=i[0],a=i[1];return e=We([g+n*f[0],v+r*f[1]],2),g=e[0],v=e[1],new $j(o,a,n,r)})),y=uF(m),b={"flex-start":0,"flex-end":h?r-y.width:i-y.height,center:h?(r-y.width)/2:(i-y.height)/2},x=m.map((function(t){var e=t.x,n=t.y,r=$j.fromRect(t);return r.x=h?e+b[l]:e,r.y=h?n:n+b[l],r}));uF(x);var E=function(t){var e=We(h?["height",i]:["width",r],2),n=e[0],o=e[1];switch(u){case"flex-start":default:return 0;case"flex-end":return o-t[n];case"center":return o/2-t[n]/2}},w=x.map((function(t){var e=t.x,n=t.y,r=$j.fromRect(t);return r.x=h?e:e+E(r),r.y=h?n+E(r):n,r})),k=w.map((function(e){var n,r,i=$j.fromRect(e);return i.x+=null!==(n=t.x)&&void 0!==n?n:0,i.y+=null!==(r=t.y)&&void 0!==r?r:0,i}));return k},dF=function(t,e,n){return[]};function fF(t,e){return[t[0]*e,t[1]*e]}function pF(t,e){return[t[0]+e[0],t[1]+e[1]]}function gF(t,e){return[t[0]-e[0],t[1]-e[1]]}function vF(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function mF(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function yF(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function bF(t){if(0===t[0]&&0===t[1])return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function xF(t,e){return+t.toPrecision(e)}function EF(t,e){var n={},r=Array.isArray(e)?e:[e];for(var i in t)r.includes(i)||(n[i]=t[i]);return n}function wF(t,e,n){void 0===n&&(n=[[0,0],[1,1]]);for(var r=!!e,i=[],o=0,a=t.length;o<a;o+=2)i.push([t[o],t[o+1]]);var s,l,c,u=function(t,e,n,r){var i,o,a,s,l,c,u=[],h=!!r,d=[1/0,1/0],f=[-1/0,-1/0];if(h){d=(i=We(r,2))[0],f=i[1];for(var p=0,g=t.length;p<g;p+=1)d=vF(d,m=t[p]),f=mF(f,m)}p=0;for(var v=t.length;p<v;p+=1){var m=t[p];if(0!==p||n)if(p!==v-1||n){o=t[p-1];var y=[0,0];y=fF(y=gF(a=t[p+1],o),e);var b=yF(m,o),x=yF(m,a),E=b+x;0!==E&&(b/=E,x/=E);var w=fF(y,-b),k=fF(y,x);l=pF(m,w),s=vF(s=pF(m,k),mF(a,m)),s=mF(s,vF(a,m)),l=vF(l=pF(m,w=fF(w=gF(s,m),-b/x)),mF(o,m)),s=pF(m,k=fF(k=gF(m,l=mF(l,vF(o,m))),x/b)),h&&(l=vF(l=mF(l,d),f),s=vF(s=mF(s,d),f)),u.push(c),u.push(l),c=s}else l=m,u.push(c),u.push(l);else c=m}return u}(i,.4,r,n),h=i.length,d=[];for(o=0;o<h-1;o+=1)s=u[2*o],l=u[2*o+1],c=i[o+1],d.push(["C",s[0],s[1],l[0],l[1],c[0],c[1]]);return d}var kF=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function MF(t){return kF.includes(t)}function NF(t){var e={};for(var n in t)MF(n)&&(e[n]=t[n]);return e}function OF(t,e,n){var r=t.getBBox(),i=r.width,o=r.height,a=e/Math.max(i,o);return t.style.transform="scale(".concat(a,")"),a}var SF=function(){function t(t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=[null,null,null,null,null]),void 0===a&&(a=[]),void 0===s&&(s=[]),e.add(this),this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=o[0],this._update=o[1],this._exit=o[2],this._merge=o[3],this._split=o[4],this._transitions=a,this._facetElements=s}var e,n,r;return t.prototype.selectAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(e,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(this._elements,null,this._parent,this._document,void 0,void 0,e)},t.prototype.select=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new n([e],null,e,this._document)},t.prototype.append=function(t){var e=this,r="function"==typeof t?t:function(){return e.createElement(t)},i=[];if(null!==this._data){for(var o=0;o<this._data.length;o++){var a=this._data[o],s=We(Array.isArray(a)?a:[a,null],2),l=s[0],c=s[1];(h=r(l,o)).__data__=l,null!==c&&(h.__fromElements__=c),this._parent.appendChild(h),i.push(h)}return new n(i,null,this._parent,this._document)}for(o=0;o<this._elements.length;o++){var u=this._elements[o],h=r(l=u.__data__,o);u.appendChild(h),i.push(h)}return new n(i,null,i[0],this._document)},t.prototype.maybeAppend=function(t,n){var i=He(this,e,"m",r).call(this,"#"===t[0]?t:"#".concat(t),n);return i.attr("id",t),i},t.prototype.maybeAppendByClassName=function(t,n){var i=t.toString(),o=He(this,e,"m",r).call(this,"."===i[0]?i:".".concat(i),n);return o.attr("className",i),o},t.prototype.maybeAppendByName=function(t,n){var i=He(this,e,"m",r).call(this,'[name="'.concat(t,'"]'),n);return i.attr("name",t),i},t.prototype.data=function(t,e,r){var i,o;void 0===e&&(e=function(t){return t}),void 0===r&&(r=function(){return null});for(var a,s,l,c=[],u=[],h=new Set(this._elements),d=[],f=new Set,p=new Map(this._elements.map((function(t,n){return[e(t.__data__,n),t]}))),g=new Map(this._facetElements.map((function(t,n){return[e(t.__data__,n),t]}))),v=(a=this._elements,s=function(t){return r(t.__data__)},l=new Map,a.forEach((function(t){var e=s(t);l.has(e)||l.set(e,[]),l.get(e).push(t)})),l),m=0;m<t.length;m++){var y=t[m],b=e(y,m),x=r(y,m);if(p.has(b))(M=p.get(b)).__data__=y,M.__facet__=!1,u.push(M),h.delete(M),p.delete(b);else if(g.has(b)){(M=g.get(b)).__data__=y,M.__facet__=!0,u.push(M),g.delete(b)}else if(v.has(b)){var E=v.get(b);d.push([y,E]);try{for(var w=(i=void 0,Ge(E)),k=w.next();!k.done;k=w.next()){var M=k.value;h.delete(M)}}catch(t){i={error:t}}finally{try{k&&!k.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}v.delete(b)}else if(p.has(x)){(M=p.get(x)).__toData__?M.__toData__.push(y):M.__toData__=[y],f.add(M),h.delete(M)}else c.push(y)}var N=[new n([],c,this._parent,this._document),new n(u,null,this._parent,this._document),new n(h,null,this._parent,this._document),new n([],d,this._parent,this._document),new n(f,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,N)},t.prototype.merge=function(t){var e=$e($e([],We(this._elements),!1),We(t._elements),!1),r=$e($e([],We(this._transitions),!1),We(t._transitions),!1);return new n(e,null,this._parent,this._document,void 0,r)},t.prototype.createElement=function(t){if(this._document)return this._document.createElement(t,{});var e=n.registry[t];return e?new e:function(t){throw new Error(t)}("Unknown node type: ".concat(t))},t.prototype.join=function(t,e,n,r,i){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()}),void 0===r&&(r=function(t){return t}),void 0===i&&(i=function(t){return t.remove()});var o=t(this._enter),a=e(this._update),s=n(this._exit),l=r(this._merge),c=i(this._split);return a.merge(o).merge(s).merge(l).merge(c)},t.prototype.remove=function(){for(var t=function(t){var n=e._elements[t],r=e._transitions[t];r?r.then((function(){return n.remove()})):n.remove()},e=this,r=0;r<this._elements.length;r++)t(r);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n=this._elements[e],r=n.__data__;t.call(n,r,e)}return this},t.prototype.attr=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each((function(r,i){void 0!==e&&(this[t]=n.call(this,r,i))}))},t.prototype.style=function(t,e,n){void 0===n&&(n=!0);var r="function"==typeof e&&n?e:function(){return e};return this.each((function(n,i){void 0!==e&&(this.style[t]=r.call(this,n,i))}))},t.prototype.styles=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),this.each((function(n,r){var i=this;Object.entries(t).forEach((function(t){var o=We(t,2),a=o[0],s=o[1],l="function"==typeof s&&e?s:function(){return s};void 0!==s&&i.attr(a,l.call(i,n,r))}))}))},t.prototype.update=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,r){t&&this.update&&this.update(n.call(this,e,r))}))},t.prototype.maybeUpdate=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each((function(e,r){t&&this.update&&this.update(n.call(this,e,r))}))},t.prototype.transition=function(t){var e=this._transitions;return this.each((function(n,r){e[r]=t.call(this,n,r)}))},t.prototype.on=function(t,e){return this.each((function(){this.addEventListener(t,e)})),this},t.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,$e([this._parent,this],We(e),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter((function(t){return!!t}))},t.prototype.parent=function(){return this._parent},n=t,e=new WeakSet,r=function(t,e){var r=this._elements[0],i=r.querySelector(t);if(i)return new n([i],null,this._parent,this._document);var o="string"==typeof e?this.createElement(e):e();return r.appendChild(o),new n([o],null,this._parent,this._document)},t.registry={g:Fl,rect:Kl,circle:Rl,path:Hl,text:Vj,ellipse:jl,image:Vl,line:Wl,polygon:Yl,polyline:Xl,html:zl},t}();function TF(t){return new SF([t],null,t,t.ownerDocument)}function _F(t){if(le(t))return[t,t,t,t];if(Xt(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}function AF(t){var e=t.getLocalBounds(),n=We([e.min,e.max],2),r=We(n[0],2),i=r[0],o=r[1],a=We(n[1],2),s=a[0],l=a[1];return{x:i,y:o,width:s-i,height:l-o,left:i,bottom:l,top:o,right:s}}function CF(t,e){var n=We(t,2),r=n[0],i=n[1],o=We(e,2),a=o[0],s=o[1];return r!==a&&i===s}function PF(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function DF(t,e,n){var r;void 0===n&&(n=!0);var i=e||(null===(r=t.match(/^([a-z][a-z0-9]+)/))||void 0===r?void 0:r[0])||"",o=t.replace(new RegExp("^(".concat(i,")")),"");return n?function(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}(o):o}var RF=function(t,e){if(!(null==t?void 0:t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function LF(t,e,n){void 0===n&&(n=!1);var r={};return Object.entries(t).forEach((function(t){var i=We(t,2),o=i[0],a=i[1];if("className"===o||"class"===o);else if(RF(o,"show")&&RF(DF(o,"show"),e)!==n)o===function(t,e){return"".concat(e).concat(PF(t))}(e,"show")?r[o]=a:r[o.replace(new RegExp(PF(e)),"")]=a;else if(!RF(o,"show")&&RF(o,e)!==n){var s=DF(o,e);"filter"===s&&"function"==typeof a||(r[s]=a)}})),r}function IF(t,e){return Object.entries(t).reduce((function(t,n){var r=We(n,2),i=r[0],o=r[1];return i.startsWith("show")?t["show".concat(e).concat(i.slice(4))]=o:t["".concat(e).concat(PF(i))]=o,t}),{})}function jF(t,e){void 0===e&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(t).forEach((function(t){var o=We(t,2),a=o[0],s=o[1];e.includes(a)||(-1!==n.indexOf(a)?i[a]=s:r[a]=s)})),[r,i]}function FF(t,e){var n={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},r=e;return Object.keys(n).forEach((function(t){var e=n[t];r=r.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))})),r}function BF(t,e){if(e)try{var n=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,(function(e,n,r){return"translate(".concat(function(t,e,n){var r=t.getBBox(),i=r.width,o=r.height,a=We([e,n].map((function(t,e){var n;return t.includes("%")?parseFloat((null===(n=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===n?void 0:n[0])||"0")/100*(0===e?i:o):t})),2);return[a[0],a[1]]}(t,n,r),")")}));t.attr("transform",n)}catch(t){}}var zF=function(t,e){null!=e?t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,$e([],We(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach((function(e){return t.appendChild(e)})):t.appendChild(e)):t.innerHTML=""};function VF(){Fj(this,"hidden"!==this.attributes.visibility)}var GF=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,Jj({},{style:n},e))||this;return r.initialized=!1,r._defaultOptions=n,r}return Fe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=zj(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e.prototype.attributeChangedCallback=function(t){"visibility"===t&&VF.call(this)},e.prototype.update=function(t,e){var n;return this.attr(Jj({},this.attributes,t||{})),null===(n=this.render)||void 0===n?void 0:n.call(this,this.attributes,this,e)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,e){},e.prototype.getSubShapeStyle=function(t){return t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex,ze(t,["x","y","transform","transformOrigin","class","className","zIndex"])},e}(Il),WF=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},$F=WF,HF=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},UF=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},YF=UF;var qF=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]};function XF(t){var e=function(t){var e="default";if(Kt(t)&&t instanceof Image)e="image";else if(Yt(t))e="symbol";else if(ie(t)){var n=new RegExp("data:(image|text)");e=t.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(t);return["base64","url","image"].includes(e)?"image":t&&"symbol"===e?"path":null}var KF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.prototype.render=function(t,n){var r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=this.getSubShapeStyle(t),l=s.symbol,c=s.size,u=void 0===c?16:c,h=ze(s,["symbol","size"]),d=XF(l);sF(!!d,TF(n),(function(t){t.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call((function(t){if("image"===d){var n=2*u;t.styles({img:l,width:n,height:n,x:i-u,y:a-u})}else{n=u/2;var r=Yt(l)?l:e.getSymbol(l);t.styles(Be({d:null==r?void 0:r(i,a,n)},h))}}))}))},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(GF);function ZF(t,...e){return e.reduce(((t,e)=>n=>t(e(n))),t)}function JF(t,e){return e-t?n=>(n-t)/(e-t):t=>.5}KF.registerSymbol("cross",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]})),KF.registerSymbol("hyphen",(function(t,e,n){return[["M",t-n,e],["L",t+n,e]]})),KF.registerSymbol("line",HF),KF.registerSymbol("plus",(function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]})),KF.registerSymbol("tick",(function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]})),KF.registerSymbol("circle",WF),KF.registerSymbol("point",$F),KF.registerSymbol("bowtie",(function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]})),KF.registerSymbol("hexagon",(function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]})),KF.registerSymbol("square",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]})),KF.registerSymbol("diamond",(function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]})),KF.registerSymbol("triangle",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]})),KF.registerSymbol("triangle-down",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]})),KF.registerSymbol("line",HF),KF.registerSymbol("dot",UF),KF.registerSymbol("dash",YF),KF.registerSymbol("smooth",(function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]})),KF.registerSymbol("hv",(function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]})),KF.registerSymbol("vh",(function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]})),KF.registerSymbol("hvh",(function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]})),KF.registerSymbol("vhv",(function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}));const QF=Math.sqrt(50),tB=Math.sqrt(10),eB=Math.sqrt(2);function nB(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/10**i;return i>=0?(o>=QF?10:o>=tB?5:o>=eB?2:1)*10**i:-(10**-i)/(o>=QF?10:o>=tB?5:o>=eB?2:1)}const rB=(t,e,n=5)=>{const r=[t,e];let i,o=0,a=r.length-1,s=r[o],l=r[a];return l<s&&([s,l]=[l,s],[o,a]=[a,o]),i=nB(s,l,n),i>0?(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,i=nB(s,l,n)):i<0&&(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,i=nB(s,l,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(l/i)*i):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(l*i)/i),r};function iB(t){return!(ye(t)||(e=t,null===e)||Number.isNaN(t));var e}var oB,aB,sB={exports:{}};var lB,cB,uB,hB,dB={exports:{}};function fB(){return cB?lB:(cB=1,lB=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))})}var pB=function(){if(hB)return sB.exports;hB=1;var t=aB?oB:(aB=1,oB={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),e=function(){if(uB)return dB.exports;uB=1;var t=fB(),e=Array.prototype.concat,n=Array.prototype.slice,r=dB.exports=function(r){for(var i=[],o=0,a=r.length;o<a;o++){var s=r[o];t(s)?i=e.call(i,n.call(s)):i.push(s)}return i};return r.wrap=function(t){return function(){return t(r(arguments))}},dB.exports}(),n=Object.hasOwnProperty,r=Object.create(null);for(var i in t)n.call(t,i)&&(r[t[i]]=i);var o=sB.exports={to:{},get:{}};function a(t,e,n){return Math.min(Math.max(e,t),n)}function s(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}return o.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=o.get.hsl(t),n="hsl";break;case"hwb":e=o.get.hwb(t),n="hwb";break;default:e=o.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},o.get.rgb=function(e){if(!e)return null;var r,i,o,s=[0,0,0,1];if(r=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=r[2],r=r[1],i=0;i<3;i++){var l=2*i;s[i]=parseInt(r.slice(l,l+2),16)}o&&(s[3]=parseInt(o,16)/255)}else if(r=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(r=r[1])[3],i=0;i<3;i++)s[i]=parseInt(r[i]+r[i],16);o&&(s[3]=parseInt(o+o,16)/255)}else if(r=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(i=0;i<3;i++)s[i]=parseInt(r[i+1],0);r[4]&&(r[5]?s[3]=.01*parseFloat(r[4]):s[3]=parseFloat(r[4]))}else{if(!(r=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(r=e.match(/^(\w+)$/))?"transparent"===r[1]?[0,0,0,0]:n.call(t,r[1])?((s=t[r[1]])[3]=1,s):null:null;for(i=0;i<3;i++)s[i]=Math.round(2.55*parseFloat(r[i+1]));r[4]&&(r[5]?s[3]=.01*parseFloat(r[4]):s[3]=parseFloat(r[4]))}for(i=0;i<3;i++)s[i]=a(s[i],0,255);return s[3]=a(s[3],0,1),s},o.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(n)?1:n,0,1)]}return null},o.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,a(parseFloat(e[2]),0,100),a(parseFloat(e[3]),0,100),a(isNaN(n)?1:n,0,1)]}return null},o.to.hex=function(){var t=e(arguments);return"#"+s(t[0])+s(t[1])+s(t[2])+(t[3]<1?s(Math.round(255*t[3])):"")},o.to.rgb=function(){var t=e(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},o.to.rgb.percent=function(){var t=e(arguments),n=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),i=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+n+"%, "+r+"%, "+i+"%)":"rgba("+n+"%, "+r+"%, "+i+"%, "+t[3]+")"},o.to.hsl=function(){var t=e(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},o.to.hwb=function(){var t=e(arguments),n="";return t.length>=4&&1!==t[3]&&(n=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+n+")"},o.to.keyword=function(t){return r[t.slice(0,3)]},sB.exports}(),gB=E(pB);function vB(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function mB(t){const e=gB.get(t);if(!e)return null;const{model:n,value:r}=e;return"rgb"===n?r:"hsl"===n?function(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,i=t[3];if(0===n)return[255*r,255*r,255*r,i];const o=r<.5?r*(1+n):r+n-r*n,a=2*r-o;return[255*vB(a,o,e+1/3),255*vB(a,o,e),255*vB(a,o,e-1/3),i]}(r):null}const yB=(t,e)=>n=>t*(1-n)+e*n,bB=(t,e)=>"number"==typeof t&&"number"==typeof e?yB(t,e):"string"==typeof t&&"string"==typeof e?((t,e)=>{const n=mB(t),r=mB(e);return null===n||null===r?n?()=>t:()=>e:t=>{const e=new Array(4);for(let i=0;i<4;i+=1){const o=n[i],a=r[i];e[i]=o*(1-t)+a*t}const[i,o,a,s]=e;return`rgba(${Math.round(i)}, ${Math.round(o)}, ${Math.round(a)}, ${s})`}})(t,e):()=>t,xB=(t,e)=>{const n=yB(t,e);return t=>Math.round(n(t))};function EB({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function wB(t){return"object"==typeof t?t.valueOf():t}class kB extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=wB,null!==t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(EB({map:this.map,initKey:this.initKey},t))}has(t){return super.has(EB({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(function({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(function({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}({map:this.map,initKey:this.initKey},t))}}class MB{constructor(t){this.options=Me({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=Me({},this.options,t),this.rescale(t)}rescale(t){}}const NB=Symbol("defaultUnknown");function OB(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function SB(t){const{value:e,from:n,to:r,mapper:i,notFoundReturn:o}=t;let a=i.get(e);if(void 0===a){if(o!==NB)return o;a=n.push(e)-1,i.set(e,a)}return r[a%r.length]}function TB(t){return t instanceof Date?t=>`${t}`:"object"==typeof t?t=>JSON.stringify(t):t=>t}class _B extends MB{getDefaultOptions(){return{domain:[],range:[],unknown:NB}}constructor(t){super(t)}map(t){return 0===this.domainIndexMap.size&&OB(this.domainIndexMap,this.getDomain(),this.domainKey),SB({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&OB(this.rangeIndexMap,this.getRange(),this.rangeKey),SB({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=TB(e),this.rangeKey=TB(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new _B(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function AB(t){return Math.round(1e12*t)/1e12}function CB(t){const{domain:e,range:n,paddingOuter:r,paddingInner:i,flex:o,round:a,align:s}=t,l=e.length,c=function(t,e){const n=e-t.length;return n>0?[...t,...new Array(n).fill(1)]:n<0?t.slice(0,e):t}(o,l),[u,h]=n,d=h-u,f=d/(2/l*r+1-1/l*i),p=f*i/l,g=f-l*p,v=function(t){const e=Math.min(...t);return t.map((t=>t/e))}(c),m=g/v.reduce(((t,e)=>t+e)),y=new kB(e.map(((t,e)=>{const n=v[e]*m;return[t,a?Math.floor(n):n]}))),b=new kB(e.map(((t,e)=>{const n=v[e]*m+p;return[t,a?Math.floor(n):n]}))),x=Array.from(b.values()).reduce(((t,e)=>t+e)),E=u+(d-(x-x/l*i))*s;let w=a?Math.round(E):E;const k=new Array(l);for(let t=0;t<l;t+=1){k[t]=AB(w);const n=e[t];w+=b.get(n)}return{valueBandWidth:y,valueStep:b,adjustedRange:k}}class PB extends _B{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:NB,flex:[]}}constructor(t){super(t)}clone(){return new PB(this.options)}getStep(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:n,round:r,flex:i}=this.options,{adjustedRange:o,valueBandWidth:a,valueStep:s}=function(t){var e;const{domain:n}=t,r=n.length;if(0===r)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return CB(t);const{range:i,paddingOuter:o,paddingInner:a,round:s,align:l}=t;let c,u,h=i[0];const d=i[1]-h,f=2*o,p=r-a;c=d/Math.max(1,f+p),s&&(c=Math.floor(c)),h+=(d-c*(r-a))*l,u=c*(1-a),s&&(h=Math.round(h),u=Math.round(u));const g=new Array(r).fill(0).map(((t,e)=>h+e*c));return{valueStep:c,valueBandWidth:u,adjustedRange:g}}({align:t,range:n,round:r,flex:i,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=s,this.valueBandWidth=a,this.adjustedRange=o}}const DB=(t,e,n)=>{let r,i,o=t,a=e;if(o===a&&n>0)return[o];let s=nB(o,a,n);if(0===s||!Number.isFinite(s))return[];if(s>0){o=Math.ceil(o/s),a=Math.floor(a/s),i=new Array(r=Math.ceil(a-o+1));for(let t=0;t<r;t+=1)i[t]=(o+t)*s}else{s=-s,o=Math.ceil(o*s),a=Math.floor(a*s),i=new Array(r=Math.ceil(a-o+1));for(let t=0;t<r;t+=1)i[t]=(o+t)/s}return i},RB=(t,e,n)=>{const[r,i]=t,[o,a]=e;let s,l;return r<i?(s=JF(r,i),l=n(o,a)):(s=JF(i,r),l=n(a,o)),ZF(l,s)},LB=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=t[0]>t[r],s=a?[...t].reverse():t,l=a?[...e].reverse():e;for(let t=0;t<r;t+=1)i[t]=JF(s[t],s[t+1]),o[t]=n(l[t],l[t+1]);return e=>{const n=function(t,e,n,r){let i=n||0,o=r||t.length;for(;i<o;){const n=Math.floor((i+o)/2);t[n]>e?o=n:i=n+1}return i}(t,e,1,r)-1,a=i[n];return ZF(o[n],a)(e)}},IB=(t,e,n,r)=>(Math.min(t.length,e.length)>2?LB:RB)(t,e,r?xB:n);class jB extends MB{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:yB,tickCount:5}}map(t){return iB(t)?this.output(t):this.options.unknown}invert(t){return iB(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,n,...r]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,n,...r)}getTicks(){const{tickMethod:t}=this.options,[e,n,r,...i]=this.getTickMethodOptions();return t(e,n,r,...i)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return rB}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:n}=this.options,r=this.options.domain.map(t),i=Math.min(r.length,n.length);return e?function(t,e){const n=e<t?e:t,r=t>e?t:e;return t=>Math.min(Math.max(n,t),r)}(r[0],r[i-1]):Ie}composeOutput(t,e){const{domain:n,range:r,round:i,interpolate:o}=this.options,a=IB(n.map(t),r,o,i);this.output=ZF(a,e,t)}composeInput(t,e,n){const{domain:r,range:i}=this.options,o=IB(i,r.map(t),yB);this.input=ZF(e,n,o)}}class FB extends jB{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:bB,tickMethod:DB,tickCount:5}}chooseTransforms(){return[Ie,Ie]}clone(){return new FB(this.options)}}var BB=function(t){function e(e){var n=this,r=e.style,i=ze(e,["style"]);return(n=t.call(this,Me({},{type:"column"},Be({style:r},i)))||this).columnsGroup=new Fl({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return Fe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.columns,n=t.x,r=t.y;this.columnsGroup.style.transform="translate(".concat(n,", ").concat(r,")"),TF(this.columnsGroup).selectAll(".column").data(e.flat()).join((function(t){return t.append("rect").attr("className","column").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.update=function(t){this.attr(Jj({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(Dl),zB=function(t){function e(e){var n=this,r=e.style,i=ze(e,["style"]);return(n=t.call(this,Me({},{type:"lines"},Be({style:r},i)))||this).linesGroup=n.appendChild(new Fl),n.areasGroup=n.appendChild(new Fl),n.render(),n}return Fe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,n=t.areas,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")"),e&&this.renderLines(e),n&&this.renderAreas(n)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(Jj({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){TF(this.linesGroup).selectAll(".line").data(t).join((function(t){return t.append("path").attr("className","line").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.attr(t)}))}),(function(t){return t.remove()}))},e.prototype.renderAreas=function(t){TF(this.linesGroup).selectAll(".area").data(t).join((function(t){return t.append("path").attr("className","area").each((function(t){this.attr(t)}))}),(function(t){return t.each((function(t){this.style(t)}))}),(function(t){return t.remove()}))},e}(Dl);function VB(t,e){void 0===e&&(e=!1);var n=e?t.length-1:0,r=t.map((function(t,e){return $e([e===n?"M":"L"],We(t),!1)}));return e?r.reverse():r}function GB(t,e){if(void 0===e&&(e=!1),t.length<=2)return VB(t);for(var n=[],r=t.length,i=0;i<r;i+=1){var o=e?t[r-i-1]:t[i];Se(o,n.slice(-2))||n.push.apply(n,$e([],We(o),!1))}var a=wF(n,!1);return e?a.unshift($e(["M"],We(t[r-1]),!1)):a.unshift($e(["M"],We(t[0]),!1)),a}function WB(t,e,n){var r=be(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}function $B(t){return 0===t.length?[0,0]:[re(he(t,(function(t){return re(t)||0}))),ne(ue(t,(function(t){return ne(t)||0})))]}function HB(t){for(var e=be(t),n=e[0].length,r=We([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],o=r[1],a=0;a<e.length;a+=1)for(var s=e[a],l=0;l<n;l+=1)s[l]>=0?(s[l]+=i[l],i[l]=s[l]):(s[l]+=o[l],o[l]=s[l]);return e}var UB=function(t){function e(e){return t.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Fe(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];var e=be(t);return le(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?HB(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=We(t.getOptions().domain||[0,0],2),n=e[0],r=e[1];return r<0?t.map(r):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,e=this.attributes,n=e.type,r=e.isStack,i=e.smooth;if("line"!==n)throw new Error("linesStyle can only be used in line type");var o=LF(this.attributes,"area"),a=LF(this.attributes,"line"),s=this.containerShape.width,l=this.data;if(0===l[0].length)return{lines:[],areas:[]};var c=this.scales,u=function(t,e){var n,r=e.x,i=e.y,o=We(i.getOptions().range||[0,0],2),a=o[0],s=o[1];return s>a&&(n=We([a,s],2),s=n[0],a=n[1]),t.map((function(t){return t.map((function(t,e){return[r.map(e),se(i.map(t),s,a)]}))}))}(l,{type:"line",x:c.x,y:c.y}),h=[];if(o){var d=this.baseline;h=r?i?function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var o=t[i],a=GB(o),s=void 0;if(0===i)s=WB(a,e,n);else{var l=GB(t[i-1],!0),c=o[0];l[0][0]="L",s=$e($e($e([],We(a),!1),We(l),!1),[$e(["M"],We(c),!1),["Z"]],!1)}r.push(s)}return r}(u,s,d):function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var o=VB(t[i]),a=void 0;if(0===i)a=WB(o,e,n);else{var s=VB(t[i-1],!0);s[0][0]="L",a=$e($e($e([],We(o),!1),We(s),!1),[["Z"]],!1)}r.push(a)}return r}(u,s,d):function(t,e,n,r){return t.map((function(t){return WB(e?GB(t):VB(t),n,r)}))}(u,i,s,d)}return{lines:u.map((function(e,n){return Be({stroke:t.getColor(n),d:i?GB(e):VB(e)},a)})),areas:h.map((function(e,n){return Be({d:e,fill:t.getColor(n)},o)}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,e=LF(this.attributes,"column"),n=this.attributes,r=n.isStack,i=n.type,o=n.scale;if("column"!==i)throw new Error("columnsStyle can only be used in column type");var a=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};r&&(s=HB(s));var l=this.createScales(s),c=l.x,u=l.y,h=We($B(s),2),d=h[0],f=h[1],p=new FB({domain:[0,f-(d>0?0:d)],range:[0,a*o]}),g=c.getBandWidth(),v=this.rawData;return{columns:s.map((function(n,i){return n.map((function(n,o){var a=g/s.length;return Be(Be({fill:t.getColor(i)},e),r?{x:c.map(o),y:u.map(n),width:g,height:p.map(v[i][o])}:{x:c.map(o)+a*i,y:n>=0?u.map(n):u.map(0),width:a,height:p.map(Math.abs(n))})}))}))}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n,r,i;(n=e,r=".container",i="rect",n.querySelector(r)?TF(n).select(r):TF(n).append(i)).attr("className","container").node();var o=t.type,a=t.x,s=t.y,l="spark".concat(o),c=Be({x:a,y:s},"line"===o?this.linesStyle:this.columnsStyle);TF(e).selectAll(".spark").data([o]).join((function(t){return t.append((function(t){return"line"===t?new zB({className:l,style:c}):new BB({className:l,style:c})})).attr("className","spark ".concat(l))}),(function(t){return t.update(c)}),(function(t){return t.remove()}))},e.prototype.getColor=function(t){var e=this.attributes.color;return Xt(e)?e[t%e.length]:Yt(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,n,r=this.attributes,i=r.type,o=r.scale,a=r.range,s=void 0===a?[]:a,l=r.spacing,c=this.containerShape,u=c.width,h=c.height,d=We($B(t),2),f=d[0],p=d[1],g=new FB({domain:[null!==(e=s[0])&&void 0!==e?e:f,null!==(n=s[1])&&void 0!==n?n:p],range:[h,h*(1-o)]});return"line"===i?{type:i,x:new FB({domain:[0,t[0].length-1],range:[0,u]}),y:g}:{type:i,x:new PB({domain:t[0].map((function(t,e){return e})),range:[0,u],paddingInner:l,paddingOuter:l/2,align:.5}),y:g}},e.tag="sparkline",e}(GF);function YB(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter((function(t){var n=We(t,1)[0];return!e.includes(n)})));return Object.fromEntries(e.map((function(e){return function(t){return"boolean"!=typeof t&&"enter"in t&&"update"in t&&"exit"in t}(t)?!1===t[e]?[e,!1]:[e,Be(Be({},t[e]),n)]:[e,n]})))}function qB(t,e){t?t.finished.then(e):e()}function XB(t,e){"update"in t?t.update(e):t.attr(e)}function KB(t,e,n){return 0===e.length?null:n?t.animate(e,n):(XB(t,{style:e.slice(-1)[0]}),null)}function ZB(t,e,n){var r={},i={};return Object.entries(e).forEach((function(e){var n=We(e,2),o=n[0],a=n[1];if(!qt(a)){var s=t.style[o]||t.parsedStyle[o]||0;s!==a&&(r[o]=s,i[o]=a)}})),n?KB(t,[r,i],Be({fill:"both"},n)):(XB(t,i),null)}function JB(t,e){return t.style.opacity||(t.style.opacity=1),ZB(t,{opacity:0},e)}var QB={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},tz={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},ez={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},nz=Kj({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),rz=Kj({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),iz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.prototype.render=function(t,e){var n=t.x,r=t.y,i=t.size,o=void 0===i?10:i,a=t.radius,s=void 0===a?o/4:a,l=t.orientation,c=ze(t,["x","y","size","radius","orientation"]),u=o,h=2.4*u,d=TF(e).maybeAppendByClassName(rz.iconRect,"rect").styles(Be(Be({},c),{width:u,height:h,radius:s,x:n-u/2,y:r-h/2,transformOrigin:"center"})),f=n+1/3*u-u/2,p=n+2/3*u-u/2,g=r+1/4*h-h/2,v=r+3/4*h-h/2;d.maybeAppendByClassName("".concat(rz.iconLine,"-1"),"line").styles(Be({x1:f,x2:f,y1:g,y2:v},c)),d.maybeAppendByClassName("".concat(rz.iconLine,"-2"),"line").styles(Be({x1:p,x2:p,y1:g,y2:v},c)),"vertical"===l&&(d.node().style.transform="rotate(90)")},e}(GF),oz=function(t){function e(e){return t.call(this,e,ez)||this}return Fe(e,t),e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.x,i=n.y,o=n.showLabel,a=LF(this.attributes,"label"),s=a.x,l=void 0===s?0:s,c=a.y,u=void 0===c?0:c,h=a.transform,d=a.transformOrigin,f=We(jF(ze(a,["x","y","transform","transformOrigin"]),[]),2),p=f[0],g=f[1],v=TF(t).maybeAppendByClassName(rz.labelGroup,"g").styles(g),m=Be(Be({},tz),p),y=m.text,b=ze(m,["text"]);sF(!!o,v,(function(t){e.label=t.maybeAppendByClassName(rz.label,"text").styles(Be(Be({},b),{x:r+l,y:i+u,transform:h,transformOrigin:d,text:"".concat(y)})),e.label.on("mousedown",(function(t){t.stopPropagation()})),e.label.on("touchstart",(function(t){t.stopPropagation()}))}))},e.prototype.renderIcon=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.orientation,o=e.type,a=Be(Be({x:n,y:r,orientation:i},QB),LF(this.attributes,"icon")),s=this.attributes.iconShape,l=void 0===s?function(){return new iz({style:a})}:s;TF(t).maybeAppendByClassName(rz.iconGroup,"g").selectAll(rz.icon.class).data([l]).join((function(t){return t.append("string"==typeof l?l:function(){return l(o)}).attr("className",rz.icon.name)}),(function(t){return t.update(a)}),(function(t){return t.remove()}))},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(GF),az=function(t){function e(e){var n=t.call(this,e,Be(Be(Be({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(t){return t.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},IF(ez,"handle")),IF(QB,"handleIcon")),IF(tz,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(t){return function(e){e.stopPropagation(),n.target=t,n.prevPos=n.getOrientVal(oF(e));var r=n.availableSpace,i=r.x,o=r.y,a=n.getBBox(),s=a.x,l=a.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([i,o])-n.getOrientVal([+s,+l])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(t){var e=n.attributes,r=e.slidable,i=e.brushable,o=e.type;t.stopPropagation();var a=n.getOrientVal(oF(t)),s=a-n.prevPos;if(s){var l=n.getRatio(s);switch(n.target){case"start":r&&n.setValuesOffset(l);break;case"end":r&&n.setValuesOffset(0,l);break;case"selection":r&&n.setValuesOffset(l,l);break;case"track":if(!i)return;n.selectionWidth+=l,"range"===o?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0)}n.prevPos=a}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(t){var e=n.attributes,r=e.onChange,i=e.type,o="range"===i?t:t[1],a="range"===i?n.getValues():n.getValues()[1],s=new Ds("valuechange",{detail:{oldValue:o,value:a}});n.dispatchEvent(s),null==r||r(a)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Fe(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){if("horizontal"!==this.attributes.orientation)return null;var t=LF(this.attributes,"sparkline");return Be(Be({zIndex:0},this.availableSpace),t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,n=t.trackSize,r=We(this.getOrientVal([[e,n],[n,e]]),2);return{width:r[0],height:r[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var e=We(_F(t.padding),4),n=e[0],r=e[1],i=e[2],o=e[3],a=this.shape;return{x:o,y:n,width:a.width-(o+r),height:a.height-(n+i)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attributes.values=t;var n=!1!==e&&this.attributes.animate;this.updateSelectionArea(n),this.updateHandlesPosition(n)},e.prototype.updateSelectionArea=function(t){var e=this.calcSelectionArea();this.foregroundGroup.selectAll(nz.selection.class).each((function(n,r){ZB(this,e[r],t)}))},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&ZB(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&ZB(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var n=this.values,r=this.clampValues(t);this.attributes.values=r,this.setValues(r),e&&this.onValueChange(n)},e.prototype.renderTrack=function(t){var e=this.attributes,n=e.x,r=e.y,i=LF(this.attributes,"track");this.trackShape=TF(t).maybeAppendByClassName(nz.track,"rect").styles(Be(Be({x:n,y:r},this.shape),i))},e.prototype.renderBrushArea=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.brushable;this.brushArea=TF(t).maybeAppendByClassName(nz.brushArea,"rect").styles(Be({x:n,y:r,fill:"transparent",cursor:i?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var e=this,n=this.attributes,r=n.x,i=n.y;sF("horizontal"===n.orientation,TF(t).maybeAppendByClassName(nz.sparklineGroup,"g"),(function(t){var n=Be(Be({},e.sparklineStyle),{x:r,y:i});t.maybeAppendByClassName(nz.sparkline,(function(){return new UB({style:n})})).update(n)}))},e.prototype.renderHandles=function(){var t,e=this,n=this.attributes,r=n.showHandle,i=n.type,o=r?"range"===i?["start","end"]:["end"]:[],a=this;null===(t=this.foregroundGroup)||void 0===t||t.selectAll(nz.handle.class).data(o.map((function(t){return{type:t}})),(function(t){return t.type})).join((function(t){return t.append((function(t){var n=t.type;return new oz({style:e.getHandleStyle(n)})})).each((function(t){var e=t.type;this.attr("class","".concat(nz.handle.name," ").concat(e,"-handle"));var n="".concat(e,"Handle");a[n]=this,this.addEventListener("pointerdown",a.onDragStart(e))}))}),(function(t){return t.each((function(t){var e=t.type;this.update(a.getHandleStyle(e))}))}),(function(t){return t.each((function(t){var e=t.type,n="".concat(e,"Handle");a[n]=void 0})).remove()}))},e.prototype.renderSelection=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.type,o=e.selectionType;this.foregroundGroup=TF(t).maybeAppendByClassName(nz.foreground,"g");var a=LF(this.attributes,"selection"),s=function(t){return t.style("visibility",(function(t){return t.show?"visible":"hidden"})).style("cursor",(function(t){return"select"===o?"grab":"invert"===o?"crosshair":"default"})).styles(Be(Be({},a),{transform:"translate(".concat(n,", ").concat(r,")")}))},l=this;this.foregroundGroup.selectAll(nz.selection.class).data("value"===i?[]:this.calcSelectionArea().map((function(t,e){return{style:Be({},t),index:e,show:"select"===o?1===e:1!==e}})),(function(t){return t.index})).join((function(t){return t.append("rect").attr("className",nz.selection.name).call(s).each((function(t,e){var n=this;1===e?(l.selectionShape=TF(this),this.on("pointerdown",(function(t){n.attr("cursor","grabbing"),l.onDragStart("selection")(t)})),l.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),l.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),l.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",(function(){n.attr("cursor","grabbing")})),this.addEventListener("pointerup",(function(){n.attr("cursor","pointer")})),this.addEventListener("pointerover",(function(){n.attr("cursor","pointer")}))):this.on("pointerdown",l.onDragStart("track"))}))}),(function(t){return t.call(s)}),(function(t){return t.remove()})),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderBrushArea(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){var n;void 0===e&&(e=4);var r=We(this.range,2),i=r[0],o=r[1],a=We(this.getValues().map((function(t){return xF(t,e)})),2),s=a[0],l=a[1],c=We(((Array.isArray(t)?t:[s,null!=t?t:l])||[s,l]).map((function(t){return xF(t,e)})),2),u=c[0],h=c[1];if("value"===this.attributes.type)return[0,se(h,i,o)];u>h&&(u=(n=We([h,u],2))[0],h=n[1]);var d=h-u;return d>o-i?[i,o]:u<i?s===i&&l===h?[i,h]:[i,d+i]:h>o?l===o&&s===u?[u,o]:[o-d,o]:[u,h]},e.prototype.calcSelectionArea=function(t){var e=We(this.clampValues(t),2),n=e[0],r=e[1],i=this.availableSpace,o=i.x,a=i.y,s=i.width,l=i.height;return this.getOrientVal([[{y:a,height:l,x:o,width:n*s},{y:a,height:l,x:n*s+o,width:(r-n)*s},{y:a,height:l,x:r*s,width:(1-r)*s}],[{x:o,width:s,y:a,height:n*l},{x:o,width:s,y:n*l+a,height:(r-n)*l},{x:o,width:s,y:r*l,height:(1-r)*l}]])},e.prototype.calcHandlePosition=function(t){var e=this.attributes.handleIconOffset,n=this.availableSpace,r=n.x,i=n.y,o=n.width,a=n.height,s=We(this.clampValues(),2),l=s[0],c=s[1],u="start"===t?-e:e,h=("start"===t?l:c)*this.getOrientVal([o,a])+u;return{x:r+this.getOrientVal([h,o/2]),y:i+this.getOrientVal([a/2,h])}},e.prototype.inferTextStyle=function(t){return"horizontal"===this.attributes.orientation?{}:"start"===t?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:"end"===t?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var e,n=this.attributes,r=n.type,i=n.orientation,o=n.formatter,a=n.autoFitLabel,s=LF(this.attributes,"handle"),l=LF(s,"label"),c=s.spacing,u=this.getHandleSize(),h=this.clampValues(),d=o("start"===t?h[0]:h[1]),f=new Vj({style:Be(Be(Be({},l),this.inferTextStyle(t)),{text:d})}),p=f.getBBox(),g=p.width,v=p.height;if(f.destroy(),!a){if("value"===r)return{text:d,x:0,y:-v-c};var m=c+u+("horizontal"===i?g/2:0);return(e={text:d})["horizontal"===i?"x":"y"]="start"===t?-m:m,e}var y=0,b=0,x=this.availableSpace,E=x.width,w=x.height,k=this.calcSelectionArea()[1],M=k.x,N=k.y,O=k.width,S=k.height,T=c+u;if("horizontal"===i){var _=T+g/2;if("start"===t)y=M-T-g>0?-_:_;else y=E-M-O-T>g?_:-_}else{var A=v+T;b="start"===t?N-u>v?-A:T:w-(N+S)-u>v?A:-T}return{x:y,y:b,text:d}},e.prototype.getHandleLabelStyle=function(t){var e=LF(this.attributes,"handleLabel");return Be(Be(Be({},e),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,e=LF(this.attributes,"handleIcon"),n=this.getOrientVal(["ew-resize","ns-resize"]),r=this.getHandleSize();return Be({cursor:n,shape:t,size:r},e)},e.prototype.getHandleStyle=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.showLabel,o=e.showLabelOnInteraction,a=e.orientation,s=this.calcHandlePosition(t),l=s.x,c=s.y,u=this.calcHandleText(t),h=i;return!i&&o&&(h=!!this.target),Be(Be(Be({},IF(this.getHandleIconStyle(),"icon")),IF(Be(Be({},this.getHandleLabelStyle(t)),u),"label")),{transform:"translate(".concat(l+n,", ").concat(c+r,")"),orientation:a,showLabel:h,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,e=t.handleIconSize,n=t.width,r=t.height;return e||Math.floor((this.getOrientVal([+r,+n])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=We(t,2),n=e[0],r=e[1];return"horizontal"===this.attributes.orientation?n:r},e.prototype.setValuesOffset=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var r=this.attributes.type,i=We(this.getValues(),2),o=[i[0]+("range"===r?t:0),i[1]+e].sort();n?this.setValues(o):this.innerSetValues(o,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,r=e.height;return t/this.getOrientVal([n,r])},e.prototype.dispatchCustomEvent=function(t,e,n){var r=this;t.on(e,(function(t){t.stopPropagation(),r.dispatchEvent(new Ds(n,{detail:t}))}))},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,n=t.deltaY||e,r=this.getRatio(n);this.setValuesOffset(r,r,!0)}},e.tag="slider",e}(GF),sz={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Hl({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};Me({},sz,{style:{type:"arc"}}),Me({},sz,{style:{}});var lz=Kj({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),cz=Kj({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function uz(t){return t.reduce((function(t,e,n){return t.push($e([0===n?"M":"L"],We(e),!1)),t}),[])}function hz(t,e,n){return"surround"===e.type?function(t,e,n){var r=e.connect,i=void 0===r?"line":r,o=e.center;if("line"===i)return uz(t);if(!o)return[];var a=yF(t[0],o),s=n?0:1;return t.reduce((function(t,e,n){return 0===n?t.push($e(["M"],We(e),!1)):t.push($e(["A",a,a,0,0,s],We(e),!1)),t}),[])}(t,e,n):uz(t)}function dz(t,e,n){var r=n.type,i=n.connect,o=n.center,a=n.closed?[["Z"]]:[],s=We([hz(t,n),hz(e.slice().reverse(),n,!0)],2),l=s[0],c=s[1],u=We([t[0],e.slice(-1)[0]],2),h=u[0],d=u[1],f=function(t,e){return[l,t,c,e,a].flat()};if("line"===i||"surround"===r)return f([$e(["L"],We(d),!1)],[$e(["L"],We(h),!1)]);if(!o)throw new Error("Arc grid need to specified center");var p=We([yF(d,o),yF(h,o)],2),g=p[0],v=p[1];return f([$e(["A",g,g,0,0,1],We(d),!1),$e(["L"],We(d),!1)],[$e(["A",v,v,0,0,0],We(h),!1),$e(["L"],We(h),!1)])}var fz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.prototype.render=function(t,e){t.type,t.center,t.areaFill,t.closed;var n=ze(t,["type","center","areaFill","closed"]),r=function(t){var e=t.data,n=void 0===e?[]:e;return t.closed?n.map((function(t){var e=t.points,n=We(e,1)[0];return Be(Be({},t),{points:$e($e([],We(e),!1),[n],!1)})})):n}(t),i=TF(e).maybeAppendByClassName(cz.lineGroup,"g"),o=TF(e).maybeAppendByClassName(cz.regionGroup,"g"),a=function(t,e,n,r){var i=n.animate,o=n.isBillboard,a=e.map((function(t,e){return{id:t.id||"grid-line-".concat(e),d:hz(t.points,n)}}));return t.selectAll(cz.line.class).data(a,(function(t){return t.id})).join((function(t){return t.append("path").each((function(t,e){var n=Hj(NF(Be({d:t.d},r)),[t,e,a]);this.attr(Be({class:cz.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:o},n))}))}),(function(t){return t.transition((function(t,e){return ZB(this,Hj(NF(Be({d:t.d},r)),[t,e,a]),i.update)}))}),(function(t){return t.transition((function(){var t=this,e=JB(this,i.exit);return qB(e,(function(){return t.remove()})),e}))})).transitions()}(i,r,t,n),s=function(t,e,n){var r=n.animate,i=n.connect,o=n.areaFill;if(e.length<2||!o||!i)return[];for(var a=Array.isArray(o)?o:[o,"transparent"],s=function(t){return a[t%a.length]},l=[],c=0;c<e.length-1;c++){var u=We([e[c].points,e[c+1].points],2),h=dz(u[0],u[1],n);l.push({d:h,fill:s(c)})}return t.selectAll(cz.region.class).data(l,(function(t,e){return e})).join((function(t){return t.append("path").each((function(t,e){var n=Hj(t,[t,e,l]);this.attr(n)})).attr("className",cz.region.name)}),(function(t){return t.transition((function(t,e){return ZB(this,Hj(t,[t,e,l]),r.update)}))}),(function(t){return t.transition((function(){var t=this,e=JB(this,r.exit);return qB(e,(function(){return t.remove()})),e}))})).transitions()}(o,r,t);return $e($e([],We(a),!1),We(s),!1)},e}(GF);function pz(t,e){return Object.fromEntries(Object.entries(t).map((function(t){var n=We(t,2);return[n[0],Hj(n[1],e)]})))}function gz(t,e){return e&&Yt(e)?t.filter(e):t}function vz(t,e){var n=e.startAngle;return(e.endAngle-n)*t+n}function mz(t,e){if("linear"===e.type){var n=We(e.startPos,2),r=n[0],i=n[1],o=We(e.endPos,2),a=We([o[0]-r,o[1]-i],2);return bF([a[0],a[1]])}var s=Gj(vz(t,e));return[-Math.sin(s),Math.cos(s)]}function yz(t,e,n){return function(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}(mz(t,n),"positive"!==e)}function bz(t,e){return yz(t,e.labelDirection,e)}function xz(t,e){return"linear"===e.type?function(t,e){var n=We(e.startPos,2),r=n[0],i=n[1],o=We(e.endPos,2),a=We([o[0]-r,o[1]-i],2);return[r+a[0]*t,i+a[1]*t]}(t,e):function(t,e){var n=e.radius,r=We(e.center,2),i=r[0],o=r[1],a=Gj(vz(t,e));return[i+n*Math.cos(a),o+n*Math.sin(a)]}(t,e)}function Ez(t){return 0===mz(0,t)[1]}function wz(t){return 0===mz(0,t)[0]}function kz(t,e){return e-t==360}function Mz(t,e,n,r,i){var o=e-t,a=We([i,i],2),s=a[0],l=a[1],c=We([Gj(t),Gj(e)],2),u=c[0],h=c[1],d=function(t){return[n+i*Math.cos(t),r+i*Math.sin(t)]},f=We(d(u),2),p=f[0],g=f[1],v=We(d(h),2),m=v[0],y=v[1];if(kz(t,e)){var b=We(d((h+u)/2),2);return[["M",p,g],["A",s,l,0,1,0,b[0],b[1]],["A",s,l,0,1,0,m,y]]}var x=o>180?1:0,E=t>e?0:1;return"M".concat(p,",").concat(g,",A").concat(s,",").concat(l,",0,").concat(x,",").concat(E,",").concat(m,",").concat(y)}function Nz(t,e,n,r){var i=e.startAngle,o=e.endAngle,a=e.center,s=e.radius;return t.selectAll(lz.line.class).data([{d:Mz.apply(void 0,$e($e([i,o],We(a),!1),[s],!1))}],(function(t,e){return e})).join((function(t){return t.append("path").attr("className",lz.line.name).styles(e).styles({d:function(t){return t.d}})}),(function(t){return t.transition((function(){var t=this,e=function(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var i=r.duration,o=void 0===i?0:i,a=cF(e,n),s=Math.ceil(+o/16),l=new Array(s).fill(0).map((function(t,e,n){return{__keyframe_data__:a(e/(n.length-1))}}));return t.animate(l,Be({fill:"both"},r))}(this,function(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,i=e.center,o=e.radius;return $e($e([n,r],We(i),!1),[o],!1)}(this),$e($e([i,o],We(a),!1),[s],!1),r.update);if(e){var n=function(){var e=Te(t.attributes,"__keyframe_data__");t.style.d=Mz.apply(void 0,$e([],We(e),!1))};e.onframe=n,e.onfinish=n}return e})).styles(e)}),(function(t){return t.remove()})).styles(n).transitions()}function Oz(t){var e=We(t,2),n=We(e[0],2),r=n[0],i=n[1],o=We(e[1],2);return{x1:r,y1:i,x2:o[0],y2:o[1]}}function Sz(t,e,n,r){var i=e.showTrunc,o=e.startPos,a=e.endPos,s=e.truncRange,l=e.lineExtension,c=We([o,a],2),u=We(c[0],2),h=u[0],d=u[1],f=We(c[1],2),p=f[0],g=f[1],v=We(l?function(t,e,n){void 0===n&&(n=[0,0]);var r=We([t,e,n],3),i=We(r[0],2),o=i[0],a=i[1],s=We(r[1],2),l=s[0],c=s[1],u=We(r[2],2),h=u[0],d=u[1],f=We([l-o,c-a],2),p=f[0],g=f[1],v=Math.sqrt(Math.pow(p,2)+Math.pow(g,2)),m=We([-h/v,d/v],2),y=m[0],b=m[1];return[y*p,y*g,b*p,b*g]}(o,a,l):new Array(4).fill(0),4),m=v[0],y=v[1],b=v[2],x=v[3],E=function(e){return t.selectAll(lz.line.class).data(e,(function(t,e){return e})).join((function(t){return t.append("line").attr("className",(function(t){return"".concat(lz.line.name," ").concat(t.className)})).styles(n).transition((function(t){return ZB(this,Oz(t.line),!1)}))}),(function(t){return t.styles(n).transition((function(t){return ZB(this,Oz(t.line),r.update)}))}),(function(t){return t.remove()})).transitions()};if(!i||!s)return E([{line:[[h+m,d+y],[p+b,g+x]],className:lz.line.name}]);var w=We(s,2),k=w[0],M=w[1],N=p-h,O=g-d,S=We([h+N*k,d+O*k],2),T=S[0],_=S[1],A=We([h+N*M,d+O*M],2),C=A[0],P=A[1],D=E([{line:[[h+m,d+y],[T,_]],className:lz.lineFirst.name},{line:[[C,P],[p+b,g+x]],className:lz.lineSecond.name}]);return function(t,e){e.truncRange,e.truncShape,e.lineExtension}(0,e),D}function Tz(t,e,n){var r,i=e.type,o=LF(e,"line");return r="linear"===i?Sz(t,e,EF(o,"arrow"),n):Nz(t,e,EF(o,"arrow"),n),function(t,e,n,r){var i,o=n.showArrow,a=n.showTrunc,s=n.lineArrow,l=n.lineArrowOffset,c=n.lineArrowSize;if(i="arc"===e?t.select(lz.line.class):a?t.select(lz.lineSecond.class):t.select(lz.line.class),!o||!s||"arc"===n.type&&kz(n.startAngle,n.endAngle)){var u=i.node();u&&(u.style.markerEnd=void 0)}else{var h=aF(s);h.attr(r),OF(h,c),i.style("markerEnd",h).style("markerEndOffset",-l)}}(t,i,e,o),r}function _z(t){var e=t.type,n=t.gridCenter;return"linear"===e?n:n||t.center}function Az(t,e){var n=e.gridLength;return t.map((function(t,r){var i=t.value,o=We(xz(i,e),2),a=o[0],s=o[1],l=We(fF(function(t,e){return yz(t,e.gridDirection,e)}(i,e),n),2);return{id:r,points:[[a,s],[a+l[0],s+l[1]]]}}))}function Cz(t,e,n,r){var i=LF(n,"grid"),o=i.type,a=i.areaFill,s=_z(n),l=gz(e,n.gridFilter),c="segment"===o?Az(l,n):function(t,e){var n=e.gridControlAngles,r=_z(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||0===n.length)throw new Error("Invalid gridControlAngles");var i=We(r,2),o=i[0],a=i[1];return t.map((function(t,r){var i=We(xz(t.value,e),2),s=i[0],l=i[1],c=We([s-o,l-a],2),u=c[0],h=c[1],d=[];return n.forEach((function(t){var e=Gj(t),n=We([Math.cos(e),Math.sin(e)],2),r=n[0],i=n[1],s=u*r-h*i+o,l=u*i+h*r+a;d.push([s,l])})),{points:d,id:r}}))}(l,n),u=Be(Be({},i),{center:s,areaFill:Yt(a)?l.map((function(t,e){return Hj(a,[t,e,l])})):a,animate:r,data:c});return t.selectAll(lz.grid.class).data([1]).join((function(t){return t.append((function(){return new fz({style:u})})).attr("className",lz.grid.name)}),(function(t){return t.transition((function(){return this.update(u)}))}),(function(t){return t.remove()})).transitions()}var Pz=function(){function t(t,e,n,r){this.set(t,e,n,r)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(t,e,n){var r=this,i=r.x1,o=r.y1,a=r.x2,s=r.y2,l=Math.cos(t),c=Math.sin(t),u=e-e*l+n*c,h=n-e*c-n*l;return[[l*i-c*s+u,c*i+l*s+h],[l*a-c*s+u,c*a+l*s+h],[l*i-c*o+u,c*i+l*o+h],[l*a-c*o+u,c*a+l*o+h]]},t.prototype.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function Dz(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),i=We(r.min,2),o=i[0],a=i[1],s=We(r.max,2),l=s[0],c=s[1],u=t.getBBox(),h=u.width,d=u.height,f=0,p=0,g=o,v=a,m=nF(t);if(m){d-=1.5;var y=m.style.textAlign,b=m.style.textBaseline;"center"===y?g=(o+l)/2:"right"!==y&&"end"!==y||(g=l),"middle"===b?v=(a+c)/2:"bottom"===b&&(v=c)}var x=We(_F(e),4),E=x[0],w=void 0===E?0:E,k=x[1],M=void 0===k?0:k,N=x[2],O=void 0===N?w:N,S=x[3],T=new Pz((f+=o)-(void 0===S?M:S),(p+=a)-w,f+h+M,p+d+O);return t.setEulerAngles(n),T.rotatedPoints(Gj(n),g,v)}function Rz(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function Lz(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===r?0:r<0?2:1}function Iz(t,e){return e.every((function(e){return function(t,e){var n=t.length;if(n<3)return!1;var r,i,o,a,s,l,c=[e,[9999,e[1]]],u=0,h=0;do{var d=[t[h],t[(h+1)%n]];if(i=c,o=void 0,a=void 0,s=void 0,l=void 0,o=Lz((r=d)[0],r[1],i[0]),a=Lz(r[0],r[1],i[1]),s=Lz(i[0],i[1],r[0]),l=Lz(i[0],i[1],r[1]),o!==a&&s!==l||0===o&&Rz(r,i[0])||0===a&&Rz(r,i[1])||0===s&&Rz(i,r[0])||0===l&&Rz(i,r[1])){if(0===Lz(d[0],e,d[1]))return Rz(d,e);u++}h=(h+1)%n}while(0!==h);return!!(1&u)}(t,e)}))}function jz(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some((function(t){return function(t,e){var n=We(t,4),r=n[0],i=n[1],o=n[2],a=n[3],s=We(e,4),l=s[0],c=s[1],u=o-r,h=a-i,d=s[2]-l,f=s[3]-c,p=u*f-d*h;if(0===p)return!1;var g=p>0,v=r-l,m=i-c,y=u*m-h*v;if(y<0===g)return!1;var b=d*m-f*v;return b<0!==g&&y>p!==g&&b>p!==g}(e,t)}))}function Fz(t,e,n){var r,i,o=e.crossPadding,a=new Set,s=null,l=function(t,e){var n=t.type,r=t.labelDirection,i=t.crossSize;if(!i)return!1;if("arc"===n){var o=t.center,a=t.radius,s=We(o,2),l=s[0],c=s[1],u="negative"===r?0:i,h=-a-u,d=a+u,f=We(_F(e),4),p=f[0],g=f[1],v=f[2],m=f[3];return new Pz(l+h-m,c+h-p,l+d+g,c+d+v)}var y=We(t.startPos,2),b=y[0],x=y[1],E=We(t.endPos,2),w=E[0],k=E[1],M=We(wz(t)?[-e,0,e,0]:[0,e,0,-e],4),N=M[0],O=M[1],S=M[2],T=M[3],_=fF(bz(0,t),i),A=new Pz(b,x,w,k);return A.x1+=T,A.y1+=N,A.x2+=O+_[0],A.y2+=S+_[1],A}(e,o),c=function(t){return!l||function(t,e,n){var r=t.x1,i=t.x2,o=t.y1,a=t.y2;return Iz([[r,o],[i,o],[i,a],[r,a]],Dz(e,n))}(l,t)},u=function(t,e){return!t||!t.firstChild||!function(t,e,n){var r,i,o=Dz(t,n).flat(1),a=Dz(e,n).flat(1),s=[[o[0],o[1],o[2],o[3]],[o[0],o[1],o[4],o[5]],[o[4],o[5],o[6],o[7]],[o[2],o[3],o[6],o[7]]];try{for(var l=Ge(s),c=l.next();!c.done;c=l.next())if(jz(a,c.value))return!0}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return!1}(t.firstChild,e.firstChild,_F(n))};try{for(var h=Ge(t),d=h.next();!d.done;d=h.next()){var f=d.value;c(f)?!s||u(s,f)?s=f:(a.add(s),a.add(f)):a.add(f)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return Array.from(a)}function Bz(t,e){return void 0===e&&(e={}),qt(t)?0:"number"==typeof t?t:Math.floor(tF(t,e))}var zz=function(t,e){var n=e.seq,r=void 0===n?2:n;return t.filter((function(t,e){return!(e%r)||(jj(t),!1)}))};var Vz=new Map([["hide",function(t,e,n,r){var i=t.length,o=e.keepHeader,a=e.keepTail;if(!(i<=1||2===i&&o&&a)){var s,l,c,u=zz,h=function(t){return t.forEach(r.show),t},d=2,f=t.slice(),p=t.slice(),g=Math.min.apply(Math,$e([1],We(t.map((function(t){return t.getBBox().width}))),!1));if("linear"===n.type&&(Ez(n)||wz(n))){var v=AF(t[0]).left,m=AF(t[i-1]).right,y=Math.abs(m-v)||1;d=Math.max(Math.floor(i*g/y),d)}for(o&&(s=f.splice(0,1)[0]),a&&(l=f.splice(-1,1)[0],f.reverse()),h(f);d<t.length&&Fz((c=l?$e($e([l],We(p),!1),[s],!1):$e([s],We(p),!1),c.filter(Qj)),n,null==e?void 0:e.margin).length;){if(l&&!s&&d%2==0)f.splice(0,1).forEach(r.hide);else if(l&&s){f.splice(0,1).forEach(r.hide)}p=u(h(f),{seq:d}),d++}}}],["rotate",function(t,e,n,r){var i,o,a=e.optionalAngles,s=void 0===a?[0,45,90]:a,l=e.margin,c=e.recoverWhenFailed,u=void 0===c||c,h=t.map((function(t){return t.getLocalEulerAngles()})),d=function(e){return t.forEach((function(t,n){var i=Array.isArray(e)?e[n]:e;r.rotate(t,+i)}))};try{for(var f=Ge(s),p=f.next();!p.done;p=f.next()){if(d(p.value),Fz(t,n,l).length<1)return}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}u&&d(h)}],["ellipsis",function(t,e,n,r){if(!(t.length<=1)){var i=e.suffix,o=void 0===i?"...":i,a=e.minLength,s=e.maxLength,l=void 0===s?1/0:s,c=e.step,u=void 0===c?" ":c,h=e.margin,d=void 0===h?[0,0,0,0]:h,f=eF(r.getTextShape(t[0])),p=Bz(u,f),g=a?Bz(a,f):p,v=Bz(l,f);(qt(v)||v===1/0)&&(v=Math.max.apply(null,t.map((function(t){return t.getBBox().width}))));var m=t.slice(),y=We(d,4);y[0],y[1],y[2],y[3];for(var b=function(e){if(m.forEach((function(t){r.ellipsis(r.getTextShape(t),e,o)})),(m=Fz(t,n,d)).length<1)return{value:void 0}},x=v;x>g+p;x-=p){var E=b(x);if("object"==typeof E)return E.value}}}],["wrap",function(t,e,n,r){var i=e.wordWrapWidth,o=void 0===i?50:i,a=e.maxLines,s=void 0===a?3:a,l=e.recoverWhenFailed,c=void 0===l||l,u=e.margin,h=void 0===u?[0,0,0,0]:u,d=t.map((function(t){return t.attr("maxLines")||1})),f=Math.min.apply(Math,$e([],We(d),!1)),p=function(t){var e=t.type,n=t.labelDirection;return"linear"===e&&Ez(t)?"negative"===n?"bottom":"top":"middle"}(n),g=function(e){return t.forEach((function(t,n){var i=Array.isArray(e)?e[n]:e;r.wrap(t,o,i,p)}))};if(!(f>s)){for(var v=f;v<=s;v++)if(g(v),Fz(t,n,h).length<1)return;c&&g(d)}}]]);function Gz(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce((function(t,e){return t*function(t){return"positive"===t?-1:1}(e)}),1)}function Wz(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function $z(t,e){var n=We(t,2),r=n[0],i=n[1],o=We(e,2),a=o[0],s=o[1],l=We([r*a+i*s,r*s-i*a],2),c=l[0],u=l[1];return Math.atan2(u,c)}function Hz(t,e,n){var r,i=n.labelAlign;if(null===(r=e.style.transform)||void 0===r?void 0:r.includes("rotate"))return e.getLocalEulerAngles();var o=bz(t.value,n),a=mz(t.value,n);return"horizontal"===i?0:function(t){var e=(t+360)%180;return lF(e,-90,90)||(e+=180),e}(Wj("perpendicular"===i?$z([1,0],o):$z([a[0]<0?-1:1,0],a)))}function Uz(t,e,n){var r=n.type,i=n.labelAlign,o=bz(t,n),a=Wz(e),s=Wz(Wj($z([1,0],o))),l="center",c="middle";return"linear"===r?[90,270].includes(s)&&0===a?(l="center",c=1===o[1]?"top":"bottom"):s%180||![90,270].includes(a)?0===s?(lF(a,0,90,!1,!0)||lF(a,0,90)||lF(a,270,360))&&(l="start"):90===s?lF(a,0,90,!1,!0)?l="start":(lF(a,90,180)||lF(a,270,360))&&(l="end"):270===s?lF(a,0,90,!1,!0)?l="end":(lF(a,90,180)||lF(a,270,360))&&(l="start"):180===s&&(90===a?l="start":(lF(a,0,90)||lF(a,270,360))&&(l="end")):l="center":"parallel"===i?c=lF(s,0,180,!0)?"top":"bottom":"horizontal"===i?lF(s,90,270,!1)?l="end":(lF(s,270,360,!1)||lF(s,0,90))&&(l="start"):"perpendicular"===i&&(l=lF(s,90,270)?"end":"start"),{textAlign:l,textBaseline:c}}function Yz(t,e,n){var r=n.showTick,i=n.tickLength,o=n.tickDirection,a=n.labelDirection,s=n.labelSpacing,l=e.indexOf(t),c=Hj(s,[t,l,e]),u=We([bz(t.value,n),Gz(a,o)],2),h=We(pF(fF(u[0],c+(1===u[1]?Hj(r?i:0,[t,l,e]):0)),xz(t.value,n)),2);return{x:h[0],y:h[1]}}function qz(t,e){"text"===t.nodeName&&t.attr(e)}function Xz(t){!function(t,e,n){var r=e.labelOverlap,i=void 0===r?[]:r;i.length&&i.forEach((function(r){var i=r.type,o=Vz.get(i);(function(t,e,n){return!(e.labelOverlap.length<1)&&("hide"===n?!function(t){for(var e=t;e;){if("offscreen"===e.className)return!0;e=e.parent}return!1}(t[0]):"rotate"===n?!t.some((function(t){var e;return!!(null===(e=t.attr("transform"))||void 0===e?void 0:e.includes("rotate"))})):"ellipsis"!==n&&"wrap"!==n||t.filter((function(t){return t.querySelector("text")})).length>1)})(t,e,i)&&(null==o||o(t,r,e,n))}))}(this.node().childNodes,t,{hide:jj,show:Ij,rotate:function(e,n){!function(t,e,n){e.setLocalEulerAngles(t);var r=Uz(e.__data__.value,t,n),i=e.querySelector(lz.labelItem.class);i&&qz(i,r)}(+n,e,t)},ellipsis:function(t,e,n){t&&iF(t,e||1/0,n)},wrap:function(t,e,n){var r,i;t&&(void 0===(r=n)&&(r=2),void 0===i&&(i="top"),rF(t,{wordWrap:!0,wordWrapWidth:e,maxLines:r,textBaseline:i}))},getTextShape:function(t){return t.querySelector("text")}})}function Kz(t,e,n,r,i){var o=n.indexOf(e),a=TF(t).append(function(t,e,n,r){var i=r.labelFormatter;return Yt(i)?function(){return aF(Hj(i,[t,e,n,bz(t.value,r)]))}:function(){return aF(t.label||"")}}(e,o,n,i)).attr("className",lz.labelItem.name).node(),s=We(jF(pz(r,[e,o,n])),2),l=s[0],c=s[1],u=c.transform,h=ze(c,["transform"]);BF(a,u);var d=Hz(e,a,i);return a.getLocalEulerAngles()||a.setLocalEulerAngles(d),qz(a,Be(Be({},Uz(e.value,d,i)),l)),t.attr(h),a}function Zz(t,e,n,r){var i=gz(e,n.labelFilter),o=LF(n,"label");return t.selectAll(lz.label.class).data(i,(function(t,e){return e})).join((function(r){return r.append("g").attr("className",lz.label.name).transition((function(t){Kz(this,t,e,o,n);var r=Yz(t,e,n),i=r.x,a=r.y;return this.style.transform="translate(".concat(i,", ").concat(a,")"),null})).call((function(){Xz.call(t,n)}))}),(function(i){return i.transition((function(t){var i=function(t,e,n,r){if(void 0===r&&(r="destroy"),function(t,e){return"text"===t.nodeName&&"text"===e.nodeName&&t.attributes.text===e.attributes.text}(t,e))return t.remove(),[null];var i=function(){"destroy"===r?t.destroy():"hide"===r&&jj(t),e.isVisible()&&Ij(e)};if(!n)return i(),[null];var o=n.duration,a=void 0===o?0:o,s=n.delay,l=void 0===s?0:s,c=Math.ceil(+a/2),u=+a/4,h=We(t.getGeometryBounds().center,2),d=h[0],f=h[1],p=We(e.getGeometryBounds().center,2),g=We([(d+p[0])/2-d,(f+p[1])/2-f],2),v=g[0],m=g[1],y=t.style.opacity,b=void 0===y?1:y,x=e.style.opacity,E=void 0===x?1:x,w=t.style.transform||"",k=e.style.transform||"",M=t.animate([{opacity:b,transform:"translate(0, 0) ".concat(w)},{opacity:0,transform:"translate(".concat(v,", ").concat(m,") ").concat(w)}],Be(Be({fill:"both"},n),{duration:l+c+u})),N=e.animate([{opacity:0,transform:"translate(".concat(-v,", ").concat(-m,") ").concat(k),offset:.01},{opacity:E,transform:"translate(0, 0) ".concat(k)}],Be(Be({fill:"both"},n),{duration:c+u,delay:l+c-u}));return qB(N,i),[M,N]}(this.querySelector(lz.labelItem.class),Kz(this,t,e,o,n),r.update),a=Yz(t,e,n),s=a.x,l=a.y,c=ZB(this,{transform:"translate(".concat(s,", ").concat(l,")")},r.update);return $e($e([],We(i),!1),[c],!1)})).call((function(e){var r,i,o=Te(e,"_transitions").flat().filter(Qj);i=function(){Xz.call(t,n)},0===(r=o).length?i():Promise.all(r.map((function(t){return null==t?void 0:t.finished}))).then(i)}))}),(function(t){return t.transition((function(){var t=this,e=JB(this.childNodes[0],r.exit);return qB(e,(function(){return TF(t).remove()})),e}))})).transitions()}function Jz(t,e){return yz(t,e.tickDirection,e)}function Qz(t,e,n,r,i){var o=We(function(t,e){var n=We(t,2);return[[0,0],[n[0]*e,n[1]*e]]}(r,Hj(i.tickLength,[t,e,n])),2),a=We(o[0],2),s=a[0],l=a[1],c=We(o[1],2);return{x1:s,x2:c[0],y1:l,y2:c[1]}}function tV(t,e,n,r,i,o){var a=function(t,e,n,r,i){var o=i.tickFormatter,a=Jz(e.value,i),s="line";return Yt(o)&&(s=function(){return Hj(o,[e,n,r,a])}),t.append(s).attr("className",lz.tickItem.name)}(TF(this),t,e,n,r);!function(t,e,n,r,i,o,a){var s=Jz(t.value,o),l=Qz(t,e,n,s,o),c=l.x1,u=l.x2,h=l.y1,d=l.y2,f=We(jF(pz(a,[t,e,n,s])),2),p=f[0],g=f[1];"line"===r.node().nodeName&&r.styles(Be({x1:c,x2:u,y1:h,y2:d},p)),i.attr(g),r.styles(p)}(t,e,n,a,this,r,i);var s=We(xz(t.value,r),2),l=s[0],c=s[1];return ZB(this,{transform:"translate(".concat(l,", ").concat(c,")")},o)}var eV=Kj({text:"text"},"title");function nV(t){return/\S+-\S+/g.test(t)?t.split("-").map((function(t){return t[0]})):t.length>2?[t[0]]:t.split("")}function rV(t,e){var n=Object.entries(e).reduce((function(e,n){var r=We(n,2),i=r[0],o=r[1];return t.node().attr(i)||(e[i]=o),e}),{});t.styles(n)}var iV=function(t){function e(e){return t.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return Fe(e,t),e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,n=t.height,r=t.position,i=t.spacing,o=t.inset,a=this.querySelector(eV.text.class);if(!a)return new $j(0,0,+e,+n);var s=a.getBBox(),l=s.width,c=s.height,u=We(_F(i),4),h=u[0],d=u[1],f=u[2],p=u[3],g=We([0,0,+e,+n],4),v=g[0],m=g[1],y=g[2],b=g[3],x=nV(r);if(x.includes("i"))return new $j(v,m,y,b);x.forEach((function(t,r){var i,o,a,s;"t"===t&&(i=We(0===r?[c+f,+n-c-f]:[0,+n],2),m=i[0],b=i[1]),"r"===t&&(o=We([+e-l-p],1),y=o[0]),"b"===t&&(a=We([+n-c-h],1),b=a[0]),"l"===t&&(s=We(0===r?[l+d,+e-l-d]:[0,+e],2),v=s[0],y=s[1])}));var E=We(_F(o),4),w=E[0],k=E[1],M=E[2],N=E[3],O=We([N+k,w+M],2),S=O[0],T=O[1];return new $j(v+N,m+w,y-S,b-T)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new $j(0,0,0,0)},e.prototype.render=function(t,e){var n=this;t.width,t.height,t.position,t.spacing;var r=ze(t,["width","height","position","spacing"]),i=We(jF(r),1)[0],o=function(t){var e,n,r,i,o=t,a=o.width,s=o.height,l=o.position,c=We([+a/2,+s/2],2),u=We([+c[0],+c[1],"center","middle"],4),h=u[0],d=u[1],f=u[2],p=u[3],g=nV(l);return g.includes("l")&&(h=(e=We([0,"start"],2))[0],f=e[1]),g.includes("r")&&(h=(n=We([+a,"end"],2))[0],f=n[1]),g.includes("t")&&(d=(r=We([0,"top"],2))[0],p=r[1]),g.includes("b")&&(d=(i=We([+s,"bottom"],2))[0],p=i[1]),{x:h,y:d,textAlign:f,textBaseline:p}}(t),a=o.x,s=o.y,l=o.textAlign,c=o.textBaseline;sF(!!r.text,TF(e),(function(t){n.title=t.maybeAppendByClassName(eV.text,"text").styles(i).call(rV,{x:a,y:s,textAlign:l,textBaseline:c}).node()}))},e}(GF);function oV(t,e,n,r,i){var o=We(jF(LF(r,"title")),2),a=o[0],s=o[1],l=s.transform,c=s.transformOrigin,u=ze(s,["transform","transformOrigin"]);e.styles(u);var h=l||function(t,e,n){var r=2*t.getGeometryBounds().halfExtents[1];if("vertical"===e){if("left"===n)return"rotate(-90) translate(0, ".concat(r/2,")");if("right"===n)return"rotate(-90) translate(0, -".concat(r/2,")")}return""}(t.node(),a.direction,a.position);t.styles(Be(Be({},a),{transformOrigin:c})),BF(t.node(),h);var d=function(t,e,n){var r=n.titlePosition,i=void 0===r?"lb":r,o=n.titleSpacing,a=nV(i),s=t.node().getLocalBounds(),l=We(s.min,2),c=l[0],u=l[1],h=We(s.halfExtents,2),d=h[0],f=h[1],p=We(e.node().getLocalBounds().halfExtents,2),g=p[0],v=p[1],m=We([c+d,u+f],2),y=m[0],b=m[1],x=We(_F(o),4),E=x[0],w=x[1],k=x[2],M=x[3];if(["start","end"].includes(i)&&"linear"===n.type){var N=n.startPos,O=n.endPos,S=We("start"===i?[N,O]:[O,N],2),T=S[0],_=S[1],A=We(fF(bF([-_[0]+T[0],-_[1]+T[1]]),E),2),C=A[0],P=A[1];return{x:T[0]+C,y:T[1]+P}}return a.includes("t")&&(b-=f+v+E),a.includes("r")&&(y+=d+g+w),a.includes("l")&&(y-=d+g+M),a.includes("b")&&(b+=f+v+k),{x:y,y:b}}(TF(n._offscreen||n.querySelector(lz.mainGroup.class)),e,r),f=d.x,p=d.y;return ZB(e.node(),{transform:"translate(".concat(f,", ").concat(p,")")},i)}function aV(t,e,n,r){var i=t.showLine,o=t.showTick,a=t.showLabel,s=sF(i,e.maybeAppendByClassName(lz.lineGroup,"g"),(function(e){return Tz(e,t,r)}))||[],l=sF(o,e.maybeAppendByClassName(lz.tickGroup,"g"),(function(e){return function(t,e,n,r){var i=gz(e,n.tickFilter),o=LF(n,"tick");return t.selectAll(lz.tick.class).data(i,(function(t){return t.id||t.label})).join((function(t){return t.append("g").attr("className",lz.tick.name).transition((function(t,e){return tV.call(this,t,e,i,n,o,!1)}))}),(function(t){return t.transition((function(t,e){return this.removeChildren(),tV.call(this,t,e,i,n,o,r.update)}))}),(function(t){return t.transition((function(){var t=this,e=JB(this.childNodes[0],r.exit);return qB(e,(function(){return t.remove()})),e}))})).transitions()}(e,n,t,r)}))||[],c=sF(a,e.maybeAppendByClassName(lz.labelGroup,"g"),(function(e){return Zz(e,n,t,r)}))||[];return $e($e($e([],We(s),!1),We(l),!1),We(c),!1).filter((function(t){return!!t}))}var sV=function(t){function e(e){return t.call(this,e,sz)||this}return Fe(e,t),e.prototype.render=function(t,e,n){var r=this,i=t.titleText,o=t.data,a=t.animate,s=t.showTitle,l=t.showGrid,c=t.dataThreshold,u=t.truncRange,h=function(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],i=0;i<t.length;i+=n)r.push(t[i]);return r}(o,c).filter((function(t){var e=t.value;return!(u&&e>u[0]&&e<u[1])})),d=YB(void 0===n?a:n),f=sF(l,TF(e).maybeAppendByClassName(lz.gridGroup,"g"),(function(e){return Cz(e,h,t,d)}))||[],p=TF(e).maybeAppendByClassName(lz.mainGroup,"g");i&&(!this.initialized&&d.enter||this.initialized&&d.update)&&aV(t,TF(this.offscreenGroup),h,YB(!1));var g=aV(t,TF(p.node()),h,d),v=sF(s,TF(e).maybeAppendByClassName(lz.titleGroup,"g"),(function(e){return function(t,e,n,r){var i=n.titleText;return t.selectAll(lz.title.class).data([{title:i}].filter((function(t){return!!t.title})),(function(t,e){return t.title})).join((function(o){return o.append((function(){return aF(i)})).attr("className",lz.title.name).transition((function(){return oV(TF(this),t,e,n,r.enter)}))}),(function(i){return i.transition((function(){return oV(TF(this),t,e,n,r.update)}))}),(function(t){return t.remove()})).transitions()}(e,r,t,d)}))||[];return $e($e($e([],We(f),!1),We(g),!1),We(v),!1).flat().filter((function(t){return!!t}))},e}(GF),lV=Kj({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),cV=function(t){function e(e){var n=t.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:qF(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(t,e){return"".concat(t,"/").concat(e)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new Fl({class:lV.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new Fl({class:lV.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Fe(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return se(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=We(function(t){var e;return(null===(e=t[0])||void 0===e?void 0:e.map((function(e,n){return t.map((function(t){return t[n]}))})))||[]}(this.pageViews.map((function(t){var e=t.getBBox();return[e.width,e.height]}))).map((function(t){return Math.max.apply(Math,$e([],We(t),!1))})),2),e=t[0],n=t[1],r=this.attributes,i=r.pageWidth,o=void 0===i?e:i,a=r.pageHeight;return{pageWidth:o,pageHeight:void 0===a?n:a}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e=t.prototype.getBBox.call(this),n=e.x,r=e.y,i=this.controllerShape,o=this.pageShape,a=o.pageWidth,s=o.pageHeight;return new $j(n,r,a+i.width,s)},e.prototype.goTo=function(t){var e=this,n=this.attributes.animate,r=this,i=r.currPage,o=r.playState,a=r.playWindow,s=r.pageViews;if("idle"!==o||t<0||s.length<=0||t>=s.length)return null;s[i].setLocalPosition(0,0),this.prepareFollowingPage(t);var l=We(this.getFollowingPageDiff(t),2),c=l[0],u=l[1];this.playState="running";var h=KB(a,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-c,", ").concat(-u,")")}],n);return qB(h,(function(){e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo()})),h},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n<=0)return null;var r=t?(n-1+e)%e:se(n-1,0,e);return this.goTo(r)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n>=e-1)return null;var r=t?(n+1)%e:se(n+1,0,e);return this.goTo(r)},e.prototype.renderClipPath=function(t){var e=this.pageShape,n=e.pageWidth,r=e.pageHeight;n&&r?(this.clipPath=t.maybeAppendByClassName(lV.clipPath,"rect").styles({width:n,height:r}),this.contentGroup.attr("clipPath",this.clipPath.node())):this.contentGroup.style.clipPath=void 0},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach((function(e,n){t.includes(n)?Ij(e):jj(e)}))},e.prototype.adjustControllerLayout=function(){var t=this,e=t.prevBtnGroup,n=t.nextBtnGroup,r=t.pageInfoGroup,i=this.attributes,o=i.orientation,a=i.controllerPadding,s=r.getBBox(),l=s.width;s.height;var c=We("horizontal"===o?[-180,0]:[-90,90],2),u=c[0],h=c[1];e.setLocalEulerAngles(u),n.setLocalEulerAngles(h);var d=e.getBBox(),f=d.width,p=d.height,g=n.getBBox(),v=g.width,m=g.height,y=Math.max(f,l,v),b="horizontal"===o?{offset:[[0,0],[f/2+a,0],[f+l+2*a,0]],textAlign:"start"}:{offset:[[y/2,-p-a],[y/2,0],[y/2,m+a]],textAlign:"center"},x=We(b.offset,3),E=We(x[0],2),w=E[0],k=E[1],M=We(x[1],2),N=M[0],O=M[1],S=We(x[2],2),T=S[0],_=S[1],A=b.textAlign,C=r.querySelector("text");C&&(C.style.textAlign=A),e.setLocalPosition(w,k),r.setLocalPosition(N,O),n.setLocalPosition(T,_)},e.prototype.updatePageInfo=function(){var t,e=this,n=e.currPage,r=e.pageViews,i=e.attributes.formatter;r.length<2||(null===(t=this.pageInfoGroup.querySelector(lV.pageInfo.class))||void 0===t||t.attr("text",i(n+1,r.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var n=this.attributes.orientation,r=this.pageShape,i=r.pageWidth,o=r.pageHeight,a=t<e?-1:1;return"horizontal"===n?[a*i,0]:[0,a*o]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,n=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var r=We(this.getFollowingPageDiff(t),2),i=r[0],o=r[1];n[t].setLocalPosition(i,o)}},e.prototype.renderController=function(t){var e=this,n=this.attributes.controllerSpacing,r=this.pageShape,i=r.pageWidth,o=r.pageHeight,a=this.pageViews.length>=2,s=t.maybeAppendByClassName(lV.controller,"g");if(Fj(s.node(),a),a){var l=LF(this.attributes,"button"),c=LF(this.attributes,"pageNum"),u=We(jF(l),2),h=u[0],d=u[1],f=h.size,p=ze(h,["size"]),g=!s.select(lV.prevBtnGroup.class).node(),v=s.maybeAppendByClassName(lV.prevBtnGroup,"g").styles(d);this.prevBtnGroup=v.node();var m=v.maybeAppendByClassName(lV.prevBtn,"path"),y=s.maybeAppendByClassName(lV.nextBtnGroup,"g").styles(d);this.nextBtnGroup=y.node(),[m,y.maybeAppendByClassName(lV.nextBtn,"path")].forEach((function(t){t.styles(Be(Be({},p),{transformOrigin:"center"})),OF(t.node(),f)}));var b=s.maybeAppendByClassName(lV.pageInfoGroup,"g");this.pageInfoGroup=b.node(),b.maybeAppendByClassName(lV.pageInfo,"text").styles(c),this.updatePageInfo(),s.node().setLocalPosition(i+n,o/2),g&&(this.prevBtnGroup.addEventListener("click",(function(){e.prev()})),this.nextBtnGroup.addEventListener("click",(function(){e.next()})))}},e.prototype.render=function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i;this.attr("transform","translate(".concat(r,", ").concat(o,")"));var a=TF(e);this.renderClipPath(a),this.renderController(a),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=xe((function(){return t.render(t.attributes,t)}),50);this.playWindow.addEventListener(Ws.INSERTED,e),this.playWindow.addEventListener(Ws.REMOVED,e)},e}(GF);function uV(t,e,n){return void 0===t&&(t="horizontal"),"horizontal"===t?e:n}KF.registerSymbol("hiddenHandle",(function(t,e,n){var r=1.4*n;return[["M",t-n,e-r],["L",t+n,e-r],["L",t+n,e+r],["L",t-n,e+r],["Z"]]})),KF.registerSymbol("verticalHandle",(function(t,e,n){var r=1.4*n,i=n/2,o=n/6,a=t+.4*r;return[["M",t,e],["L",a,e+i],["L",t+r,e+i],["L",t+r,e-i],["L",a,e-i],["Z"],["M",a,e+o],["L",t+r-2,e+o],["M",a,e-o],["L",t+r-2,e-o]]})),KF.registerSymbol("horizontalHandle",(function(t,e,n){var r=1.4*n,i=n/2,o=n/6,a=e+.4*r;return[["M",t,e],["L",t-i,a],["L",t-i,e+r],["L",t+i,e+r],["L",t+i,a],["Z"],["M",t-o,a],["L",t-o,e+r-2],["M",t+o,a],["L",t+o,e+r-2]]}));var hV=Kj({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");var dV=function(t){function e(e){return t.call(this,e,{span:[1,1],marker:function(){return new Rl({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Fe(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return!!t&&("string"==typeof t||"number"==typeof t?""!==t:"function"==typeof t||""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,e=this.valueGroup,n=this.attributes.markerSize,r=t.node().getBBox(),i=r.width,o=r.height,a=e.node().getBBox(),s=a.width,l=a.height;return{markerWidth:n,labelWidth:i,valueWidth:s,height:Math.max(n,o,l)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var e=We(_F(t),2),n=e[0],r=e[1],i=this.showValue?r:0,o=n+i;return[n/o,i/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,n=e.markerSize,r=e.width,i=this.actualSpace,o=i.markerWidth,a=i.height,s=this.actualSpace,l=s.labelWidth,c=s.valueWidth,u=We(this.spacing,2),h=u[0],d=u[1];if(r){var f=r-n-h-d,p=We(this.span,2);l=(t=We([p[0]*f,p[1]*f],2))[0],c=t[1]}return{width:o+l+c+h+d,height:a,markerWidth:o,labelWidth:l,valueWidth:c}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var e=We(_F(t),2),n=e[0],r=e[1];return this.showValue?[n,r]:[n,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,n=t.labelWidth,r=t.valueWidth,i=t.width,o=t.height,a=We(this.spacing,2),s=a[0];return{height:o,width:i,markerWidth:e,labelWidth:n,valueWidth:r,position:[e/2,e+s,e+n+s+a[1]]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=function(t){var e=t.querySelector(hV.marker.class);return e?e.style:{}}(this.markerGroup.node()),e=this.attributes,n=e.markerSize,r=e.markerStrokeWidth,i=void 0===r?t.strokeWidth:r,o=e.markerLineWidth,a=void 0===o?t.lineWidth:o,s=e.markerStroke,l=void 0===s?t.stroke:s,c=+(i||a||(l?1:0))*Math.sqrt(2),u=this.markerGroup.node().getBBox(),h=u.width,d=u.height;return(1-c/Math.max(h,d))*n},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,n=this.attributes.marker,r=LF(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(hV.markerGroup,"g").style("zIndex",0),sF(!!n,this.markerGroup,(function(){var t,i=e.markerGroup.node(),o=null===(t=i.childNodes)||void 0===t?void 0:t[0],a="string"==typeof n?new KF({style:{symbol:n},className:hV.marker.name}):n();o?a.nodeName===o.nodeName?o instanceof KF?o.update(Be(Be({},r),{symbol:n})):(!function(t,e){var n,r,i=e.attributes;try{for(var o=Ge(Object.entries(i)),a=o.next();!a.done;a=o.next()){var s=We(a.value,2),l=s[0],c=s[1];"id"!==l&&"className"!==l&&t.attr(l,c)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(o,a),TF(o).styles(r)):(o.remove(),TF(a).attr("className",hV.marker.name).styles(r),i.appendChild(a)):(a instanceof KF||TF(a).attr("className",hV.marker.name).styles(r),i.appendChild(a)),e.markerGroup.node().scale(1/e.markerGroup.node().getScale()[0]);var s=OF(e.markerGroup.node(),e.scaleSize);e.markerGroup.node().style._transform="scale(".concat(s,")")}))},e.prototype.renderLabel=function(t){var e=LF(this.attributes,"label"),n=e.text,r=ze(e,["text"]);this.labelGroup=t.maybeAppendByClassName(hV.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(hV.label,(function(){return aF(n)})).styles(r)},e.prototype.renderValue=function(t){var e=this,n=LF(this.attributes,"value"),r=n.text,i=ze(n,["text"]);this.valueGroup=t.maybeAppendByClassName(hV.valueGroup,"g").style("zIndex",0),sF(this.showValue,this.valueGroup,(function(){e.valueGroup.maybeAppendByClassName(hV.value,(function(){return aF(r)})).styles(i)}))},e.prototype.renderBackground=function(t){var e=this.shape,n=e.width,r=e.height,i=LF(this.attributes,"background");this.background=t.maybeAppendByClassName(hV.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(hV.background,"rect").styles(Be({width:n,height:r},i))},e.prototype.adjustLayout=function(){var t=this.layout,e=t.labelWidth,n=t.valueWidth,r=t.height,i=We(t.position,3),o=i[0],a=i[1],s=i[2],l=r/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(l,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(a,", ").concat(l,")")}),iF(this.labelGroup.select(hV.label.class).node(),Math.ceil(e)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(s,", ").concat(l,")")}),iF(this.valueGroup.select(hV.value.class).node(),Math.ceil(n)))},e.prototype.render=function(t,e){var n=TF(e),r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o;n.styles({transform:"translate(".concat(i,", ").concat(a,")")}),this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.adjustLayout()},e}(GF),fV=Kj({page:"item-page",navigator:"navigator",item:"item"},"items"),pV=function(t,e,n){return void 0===n&&(n=!0),t?e(t):n},gV=function(t){function e(e){var n=t.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Le,mouseenter:Le,mouseleave:Le})||this;return n.navigatorShape=[0,0],n}return Fe(e,t),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,e=t.gridRow,n=t.gridCol,r=t.data;if(!e&&!n)throw new Error("gridRow and gridCol can not be set null at the same time");return e&&n?[e,n]:e?[e,r.length]:[r.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,e=t.data,n=t.layout,r=LF(this.attributes,"item"),i=e.map((function(t,i){var o=t.id,a=void 0===o?i:o,s=t.label,l=t.value;return{id:"".concat(a),index:i,style:Be({layout:n,labelText:s,valueText:l},Object.fromEntries(Object.entries(r).map((function(n){var r=We(n,2);return[r[0],Hj(r[1],[t,i,e])]}))))}}));return i},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attributes,n=e.orientation,r=e.width,i=e.rowPadding,o=e.colPadding,a=We(this.navigatorShape,1)[0],s=We(this.grid,2),l=s[0],c=s[1],u=c*l,h=0;return this.pageViews.children.map((function(e,s){var d,f,p=Math.floor(s/u),g=s%u,v=t.ifHorizontal(c,l),m=[Math.floor(g/v),g%v];"vertical"===n&&m.reverse();var y=We(m,2),b=y[0],x=y[1],E=(r-a-(c-1)*o)/c,w=e.getBBox().height,k=We([0,0],2),M=k[0],N=k[1];return"horizontal"===n?(M=(d=We([h,b*(w+i)],2))[0],N=d[1],h=x===c-1?0:h+E+o):(M=(f=We([x*(E+o),h],2))[0],N=f[1],h=b===l-1?0:h+w+i),{page:p,index:s,row:b,col:x,pageIndex:g,width:E,height:w,x:M,y:N}}))},e.prototype.getFlexLayout=function(){var t=this.attributes,e=t.width,n=t.height,r=t.rowPadding,i=t.colPadding,o=We(this.navigatorShape,1)[0],a=We(this.grid,2),s=a[0],l=a[1],c=We([e-o,n],2),u=c[0],h=c[1],d=We([0,0,0,0,0,0,0,0],8),f=d[0],p=d[1],g=d[2],v=d[3],m=d[4],y=d[5],b=d[6],x=d[7];return this.pageViews.children.map((function(t,e){var n,o,a,c,d=t.getBBox(),E=d.width,w=d.height,k=0===b?0:i,M=b+k+E;return M<=u&&pV(m,(function(t){return t<l}))?(n=We([b+k,x,M],3),f=n[0],p=n[1],b=n[2],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:y,col:m++}):(o=We([y+1,0,0,x+w+r],4),y=o[0],m=o[1],b=o[2],(x=o[3])+w<=h&&pV(y,(function(t){return t<s}))?(a=We([b,x,E],3),f=a[0],p=a[1],b=a[2],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:y,col:m++}):(c=We([0,0,E,0,g+1,0,0,0],8),f=c[0],p=c[1],b=c[2],x=c[3],g=c[4],v=c[5],y=c[6],m=c[7],{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:v++,row:y,col:m++}))}))},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return uV(this.attributes.orientation,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(fV.item.class).forEach((function(e){t.appendChild(e)})),t.querySelectorAll(fV.page.class).forEach((function(e){t.removeChild(e).destroy()}))},e.prototype.renderItems=function(t){var e=this.attributes,n=e.click,r=e.mouseenter,i=e.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);TF(t).selectAll(fV.item.class).data(this.renderData,(function(t){return t.id})).join((function(t){return t.append((function(t){var e=t.style;return new dV({style:e})})).attr("className",fV.item.name).on("click",(function(){null==n||n(this),o("itemClick",{item:this})})).on("pointerenter",(function(){null==r||r(this),o("itemMouseenter",{item:this})})).on("pointerleave",(function(){null==i||i(this),o("itemMouseleave",{item:this})}))}),(function(t){return t.each((function(t){var e=t.style;this.update(e)}))}),(function(t){return t.remove()}))},e.prototype.relayoutNavigator=function(){var t,e=this.attributes,n=e.layout,r=e.width,i=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,o=We(this.navigatorShape,2),a=o[0],s=o[1];this.navigator.update("grid"===n?{pageWidth:r-a,pageHeight:i-s}:{})},e.prototype.adjustLayout=function(){var t,e,n=this,r=Object.entries((t=this.itemsLayout,e="page",t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{}))).map((function(t){var e=We(t,2);return{page:e[0],layouts:e[1]}})),i=$e([],We(this.navigator.getContainer().children),!1);r.forEach((function(t){var e=t.layouts,r=n.pageViews.appendChild(new Fl({className:fV.page.name}));e.forEach((function(t){var e=t.x,n=t.y,o=t.index,a=t.width,s=t.height,l=i[o];r.appendChild(l),_e(l,"__layout__",t),l.update({x:e,y:n,width:a,height:s})}))})),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=this.attributes.orientation,n=LF(this.attributes,"nav"),r=Jj({orientation:e},n),i=this;return t.selectAll(fV.navigator.class).data(["nav"]).join((function(t){return t.append((function(){return new cV({style:r})})).attr("className",fV.navigator.name).each((function(){i.navigator=this}))}),(function(t){return t.each((function(){this.update(r)}))}),(function(t){return t.remove()})),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,e){var n=this.attributes.data;if(n&&0!==n.length){var r=this.renderNavigator(TF(e));this.renderItems(r.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var n=new Ds(t,{detail:e});this.dispatchEvent(n)},e}(GF),vV=Kj({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),mV={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};!function(t){function e(e){return t.call(this,e,mV)||this}Fe(e,t),e.prototype.render=function(t,e){var n=TF(e).maybeAppendByClassName(vV.markerGroup,"g");this.renderMarker(n);var r=TF(e).maybeAppendByClassName(vV.labelGroup,"g");this.renderLabel(r)},e.prototype.renderMarker=function(t){var e=this,n=this.attributes,r=n.orientation,i=n.markerSymbol,o=void 0===i?uV(r,"horizontalHandle","verticalHandle"):i;sF(!!o,t,(function(t){var n=LF(e.attributes,"marker"),r=Be({symbol:o},n);e.marker=t.maybeAppendByClassName(vV.marker,(function(){return new KF({style:r})})).update(r)}))},e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.showLabel,i=n.orientation,o=n.spacing,a=void 0===o?0:o,s=n.formatter;sF(r,t,(function(t){var n,r=LF(e.attributes,"label"),o=r.text,l=ze(r,["text"]),c=(null===(n=t.select(vV.marker.class))||void 0===n?void 0:n.node().getBBox())||{},u=c.width,h=void 0===u?0:u,d=c.height,f=We(uV(i,[0,(void 0===d?0:d)+a,"center","top"],[h+a,0,"start","middle"]),4),p=f[0],g=f[1],v=f[2],m=f[3];t.maybeAppendByClassName(vV.label,"text").styles(Be(Be({},l),{x:p,y:g,text:s(o).toString(),textAlign:v,textBaseline:m}))}))}}(GF);var yV={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},bV=Jj({},yV,{});Jj({},yV,IF(mV,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var xV=Kj({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),EV=function(t){function e(e){return t.call(this,e,bV)||this}return Fe(e,t),e.prototype.renderTitle=function(t,e,n){var r=this.attributes,i=r.showTitle,o=r.titleText,a=We(jF(LF(this.attributes,"title")),2),s=a[0],l=a[1];this.titleGroup=t.maybeAppendByClassName(xV.titleGroup,"g").styles(l);var c=Be(Be({width:e,height:n},s),{text:i?o:""});this.title=this.titleGroup.maybeAppendByClassName(xV.title,(function(){return new iV({style:c})})).update(c)},e.prototype.renderItems=function(t,e){var n=e.x,r=e.y,i=e.width,o=e.height,a=We(jF(LF(this.attributes,"title",!0)),2),s=a[0],l=a[1],c=Be(Be({},s),{width:i,height:o,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(xV.itemsGroup,"g").styles(Be(Be({},l),{transform:"translate(".concat(n,", ").concat(r,")")}));var u=this;this.itemsGroup.selectAll(xV.items.class).data(["items"]).join((function(t){return t.append((function(){return new gV({style:c})})).attr("className",xV.items.name).each((function(){u.items=TF(this)}))}),(function(t){return t.update(c)}),(function(t){return t.remove()}))},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.title.node().getAvailableSpace(),e=t.x,n=t.y;this.itemsGroup.node().style.transform="translate(".concat(e,", ").concat(n,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,n=t.width,r=t.height;return e?this.title.node().getAvailableSpace():new $j(0,0,n,r)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e,n,r=null===(e=this.title)||void 0===e?void 0:e.node(),i=null===(n=this.items)||void 0===n?void 0:n.node();return r&&i?function(t,e){var n=t.attributes,r=n.position,i=n.spacing,o=n.inset,a=n.text,s=t.getBBox(),l=e.getBBox(),c=nV(r),u=We(_F(a?i:0),4),h=u[0],d=u[1],f=u[2],p=u[3],g=We(_F(o),4),v=g[0],m=g[1],y=g[2],b=g[3],x=We([p+d,h+f],2),E=x[0],w=x[1],k=We([b+m,v+y],2),M=k[0],N=k[1];if("l"===c[0])return new $j(s.x,s.y,l.width+s.width+E+M,Math.max(l.height+N,s.height));if("t"===c[0])return new $j(s.x,s.y,Math.max(l.width+M,s.width),l.height+s.height+w+N);var O=We([e.attributes.width||l.width,e.attributes.height||l.height],2),S=O[0],T=O[1];return new $j(l.x,l.y,S+s.width+E+M,T+s.height+w+N)}(r,i):t.prototype.getBBox.call(this)},e.prototype.render=function(t,e){var n=this.attributes,r=n.width,i=n.height,o=n.x,a=void 0===o?0:o,s=n.y,l=void 0===s?0:s,c=TF(e);e.style.transform="translate(".concat(a,", ").concat(l,")"),this.renderTitle(c,r,i),this.renderItems(c,this.availableSpace),this.adjustLayout()},e}(GF),wV={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},kV=Kj({background:"background",labelGroup:"label-group",label:"label"},"indicator"),MV=function(t){function e(e){var n=t.call(this,e,wV)||this;return n.point=[0,0],n.group=n.appendChild(new Fl({})),n.isMutationObserved=!0,n}return Fe(e,t),e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,e=t.position,n=We(_F(t.padding),4),r=n[0],i=n[1],o=n[2],a=n[3],s=this.label.node().getLocalBounds(),l=s.min,c=s.max,u=new $j(l[0]-a,l[1]-r,c[0]+i-l[0]+a,c[1]+o-l[1]+r),h=this.getPath(e,u),d=LF(this.attributes,"background");this.background=TF(this.group).maybeAppendByClassName(kV.background,"path").styles(Be(Be({},d),{d:h})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,e=t.formatter,n=t.labelText,r=We(jF(LF(this.attributes,"label")),2),i=r[0],o=r[1];i.text;var a=ze(i,["text"]);(this.label=TF(this.group).maybeAppendByClassName(kV.labelGroup,"g").styles(o),n)&&this.label.maybeAppendByClassName(kV.label,(function(){return aF(e(n))})).style("text",e(n).toString()).selectAll("text").styles(a)},e.prototype.adjustLayout=function(){var t=We(this.point,2),e=t[0],n=t[1],r=this.attributes,i=r.x,o=r.y;this.group.attr("transform","translate(".concat(i-e,", ").concat(o-n,")"))},e.prototype.getPath=function(t,e){var n=this.attributes.radius,r=e.x,i=e.y,o=e.width,a=e.height,s=[["M",r+n,i],["L",r+o-n,i],["A",n,n,0,0,1,r+o,i+n],["L",r+o,i+a-n],["A",n,n,0,0,1,r+o-n,i+a],["L",r+n,i+a],["A",n,n,0,0,1,r,i+a-n],["L",r,i+n],["A",n,n,0,0,1,r+n,i],["Z"]],l={top:4,right:6,bottom:0,left:2}[t],c=this.createCorner([s[l].slice(-2),s[l+1].slice(-2)]);return s.splice.apply(s,$e([l+1,1],We(c),!1)),s[0][0]="M",s},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var n=CF.apply(void 0,$e([],We(t),!1)),r=We(t,2),i=We(r[0],2),o=i[0],a=i[1],s=We(r[1],2),l=s[0],c=s[1],u=We(n?[l-o,[o,l]]:[c-a,[a,c]],2),h=u[0],d=We(u[1],2),f=d[0],p=d[1],g=h/2,v=e*(h/Math.abs(h)),m=v/2,y=v*Math.sqrt(3)/2*.8,b=We([f,f+g-m,f+g,f+g+m,p],5),x=b[0],E=b[1],w=b[2],k=b[3],M=b[4];return n?(this.point=[w,a-y],[["L",x,a],["L",E,a],["L",w,a-y],["L",k,a],["L",M,a]]):(this.point=[o+y,w],[["L",o,x],["L",o,E],["L",o+y,w],["L",o,k],["L",o,M]])},e.prototype.applyVisibility=function(){"hidden"===this.attributes.visibility?jj(this):Ij(this)},e.prototype.bindEvents=function(){this.label.on(Ws.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(GF);function NV(t){return void 0===t&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var OV={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function SV(t){var e;void 0===t&&(t="");var n=NV(t);return(e={})[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=Be({flex:1},OV),e[".".concat(n.VALUE)]=Be({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},OV),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var TV=function(t){function e(e){var n,r,i=this,o=null===(r=null===(n=e.style)||void 0===n?void 0:n.template)||void 0===r?void 0:r.prefixCls,a=NV(o);return(i=t.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(a.CONTAINER,'"></div>'),title:'<div class="'.concat(a.TITLE,'"></div>'),item:'<li class="'.concat(a.LIST_ITEM,'" data-index={index}>\n        <span class="').concat(a.NAME,'">\n          <span class="').concat(a.MARKER,'" style="background:{color}"></span>\n          <span class="').concat(a.NAME_LABEL,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(a.VALUE,'" title="{value}">{value}</span>\n      </li>')},style:SV(o)})||this).timestamp=-1,i.prevCustomContentKey=i.attributes.contentKey,i.initShape(),i.render(i.attributes,i),i}return Fe(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,e=t.data,n=t.template;return e.map((function(t,e){var r=t.name,i=void 0===r?"":r,o=t.color,a=void 0===o?"black":o,s=t.index,l=ze(t,["name","color","index"]),c=Be({name:i,color:a,index:null!=s?s:e},l);return An(function(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,(function(t,n){return"\\"===t.charAt(0)?t.slice(1):void 0===e[n]?"":e[n]})):t}(n.item,c))}))},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var e;null===(e=this.element)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(t,e){var n=this;if(void 0!==t&&void 0!==e){var r=function(){n.attributes.x=null!=t?t:n.attributes.x,n.attributes.y=null!=e?e:n.attributes.y,n.updatePosition()};"hidden"===this.element.style.visibility?this.closeTransition(r):r()}this.element.style.visibility="visible"},e.prototype.hide=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.attributes.enterable&&this.isCursorEntered(t,e)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=An(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(void 0===this.prevCustomContentKey||this.prevCustomContentKey!==this.attributes.contentKey){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&("string"==typeof t?this.element.innerHTML=t:zF(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,e,n=this.attributes,r=n.template,i=n.title,o=n.enterable,a=n.style,s=n.content,l=NV(r.prefixCls),c=this.element;if(this.element.style.pointerEvents=o?"auto":"none",s)this.renderCustomContent();else{i?(c.innerHTML=r.title,c.getElementsByClassName(l.TITLE)[0].innerHTML=i):null===(e=null===(t=c.getElementsByClassName(l.TITLE))||void 0===t?void 0:t[0])||void 0===e||e.remove();var u=this.HTMLTooltipItemsElements,h=document.createElement("ul");h.className=l.LIST,zF(h,u);var d=this.element.querySelector(".".concat(l.LIST));d?d.replaceWith(h):c.appendChild(h)}!function(t,e){Object.entries(e).forEach((function(e){var n=We(e,2),r=n[0],i=n[1];$e([t],We(t.querySelectorAll(r)),!1).filter((function(t){return t.matches(r)})).forEach((function(t){t&&(t.style.cssText+=Object.entries(i).reduce((function(t,e){return"".concat(t).concat(e.join(":"),";")}),""))}))}))}(c,a)},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,r=e.offset,i=(t||n).split("-"),o={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},a=this.elementSize,s=a.width,l=a.height,c=[-s/2,-l/2];return i.forEach((function(t){var e=We(c,2),n=e[0],i=e[1],a=We(o[t],2),u=a[0],h=a[1];c=[n+(s/2+r[0])*u,i+(l/2+r[1])*h]})),c},e.prototype.setOffsetPosition=function(t){var e=We(t,2),n=e[0],r=e[1],i=this.attributes,o=i.x,a=void 0===o?0:o,s=i.y,l=void 0===s?0:s,c=i.container,u=c.x,h=c.y;this.element.style.left="".concat(+a+u+n,"px"),this.element.style.top="".concat(+l+h+r,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,e=void 0===t?60:t,n=Date.now();this.timestamp>0&&n-this.timestamp<e||(this.timestamp=n,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var e=We(t,2),n=e[0],r=e[1],i=this.attributes,o=i.x,a=i.y,s=i.bounding,l=i.position;if(!s)return[n,r];var c=this.element,u=c.offsetWidth,h=c.offsetHeight,d=We([+o+n,+a+r],2),f=d[0],p=d[1],g={left:"right",right:"left",top:"bottom",bottom:"top"},v=s.x,m=s.y,y={left:f<v,right:f+u>v+s.width,top:p<m,bottom:p+h>m+s.height},b=[];l.split("-").forEach((function(t){y[t]?b.push(g[t]):b.push(t)}));var x=b.join("-");return this.getRelativeOffsetFromCursor(x)},e.prototype.isCursorEntered=function(t,e){if(this.element){var n=this.element.getBoundingClientRect(),r=n.x,i=n.y,o=n.width,a=n.height;return new $j(r,i,o,a).isPointIn(t,e)}return!1},e.prototype.closeTransition=function(t){var e=this,n=this.element.style.transition;this.element.style.transition="none",t(),setTimeout((function(){e.element.style.transition=n}),10)},e.tag="tooltip",e}(GF),_V=function(t){function e(e){var n=t.call(this,e)||this;n.layoutEvents=[Ws.BOUNDS_CHANGED,Ws.INSERTED,Ws.REMOVED],n.$margin=_F(0),n.$padding=_F(0);var r=e.style||{},i=r.margin,o=void 0===i?0:i,a=r.padding,s=void 0===a?0:a;return n.margin=o,n.padding=s,n.isMutationObserved=!0,n.bindEvents(),n}return Fe(e,t),Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(t){this.$margin=_F(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding=_F(t)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=this.attributes,e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,a=t.height,s=We(this.$margin,4),l=s[0],c=s[1],u=s[2],h=s[3];return new $j(n-h,i-l,o+h+c,a+l+u)},e.prototype.appendChild=function(e,n){return e.isMutationObserved=!0,t.prototype.appendChild.call(this,e,n),e},e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,n=t.height,r=We(this.$padding,4),i=r[0],o=r[1],a=r[2],s=r[3],l=We(this.$margin,4),c=l[0],u=l[3];return new $j(s+u,i+c,e-s-o,n-i-a)},e.prototype.layout=function(){if(this.attributes.display&&this.isConnected&&!this.children.some((function(t){return!t.isConnected})))try{var t=this.attributes,e=t.x,n=t.y;this.style.transform="translate(".concat(e,", ").concat(n,")");var r=function(t,e,n){if(0===e.length)return[];var r={flex:hF,grid:dF},i=n.display in r?r[n.display]:null;return(null==i?void 0:i.call(null,t,e,n))||[]}(this.getAvailableSpace(),this.children.map((function(t){return t.getBBox()})),this.attributes);this.children.forEach((function(t,e){var n=r[e],i=n.x,o=n.y;t.style.transform="translate(".concat(i,", ").concat(o,")")}))}catch(t){}},e.prototype.bindEvents=function(){var t=this;this.layoutEvents.forEach((function(e){t.addEventListener(e,(function(e){e.target.isMutationObserved=!0,t.layout()}))}))},e.prototype.attributeChangedCallback=function(t,e,n){"margin"===t?this.margin=n:"padding"===t&&(this.padding=n),this.layout()},e}(Fl),AV=function(t){function e(n){var r=t.call(this,Jj({},e.defaultOptions,n))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new Kl({})),r.label=r.background.appendChild(new Fl({})),r}return Fe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return _F(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,n=t.value,r=LF(this.attributes,"label");TF(this.label).maybeAppend(".label",(function(){return aF(e)})).attr("className","label").styles(r),this.label.attr("__data__",n)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=We(this.padding,4),n=e[0],r=e[1],i=e[2],o=e[3],a=t.width,s=t.height,l=a+o+r,c=s+n+i,u=LF(this.attributes,"background"),h=this.style,d=h.width,f=void 0===d?0:d,p=h.height,g=void 0===p?0:p,v=h.selected;this.background.attr(Be(Be({},u),{width:Math.max(l,f),height:Math.max(c,g),fill:v?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((c-s)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",(function(){t.style.selected||t.background.attr("fill",t.hoverColor)})),this.addEventListener("pointerleave",(function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)}));var e=this;this.addEventListener("click",(function(){var n=t.style,r=n.label,i=n.value,o=n.onClick;null==o||o(i,{label:r,value:i},e)}))},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(GF),CV=function(t){function e(n){var r,i,o=t.call(this,Jj({},e.defaultOptions,n))||this;o.currentValue=null===(r=e.defaultOptions.style)||void 0===r?void 0:r.defaultValue,o.isPointerInSelect=!1,o.select=o.appendChild(new Kl({className:"select",style:{cursor:"pointer",width:0,height:0}})),o.dropdown=o.appendChild(new Kl({className:"dropdown"}));var a=o.style.defaultValue;return a&&(null===(i=o.style.options)||void 0===i?void 0:i.some((function(t){return t.value===a})))&&(o.currentValue=a),o}return Fe(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return _F(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,n=this.style,r=n.x,i=n.y,o=n.width,a=n.height,s=n.bordered,l=n.showDropdownIcon,c=LF(this.attributes,"select"),u=LF(this.attributes,"placeholder");this.select.attr(Be(Be({x:r,y:i,width:o,height:a},c),{fill:"#fff",strokeWidth:s?1:0}));var h=this.dropdownPadding;l&&TF(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(r+o-10-h[1]-h[3],", ").concat(i+a/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var d=null===(t=this.style.options)||void 0===t?void 0:t.find((function(t){return t.value===e.currentValue})),f=Be({x:r+h[3]},u);TF(this.select).selectAll(".placeholder").data(d?[]:[1]).join((function(t){return t.append("text").attr("className","placeholder").styles(f).style("y",(function(){var t=this.getBBox();return i+(a-t.height)/2}))}),(function(t){return t.styles(f)}),(function(t){return t.remove()}));var p=LF(this.attributes,"optionLabel"),g=Be({x:r+h[3]},p);TF(this.select).selectAll(".value").data(d?[d]:[]).join((function(t){return t.append((function(t){return aF(t.label)})).attr("className","value").styles(g).style("y",(function(){var t=this.getBBox();return i+(a-t.height)/2}))}),(function(t){return t.styles(g)}),(function(t){return t.remove()}))},e.prototype.renderDropdown=function(){var t,e,n=this,r=this.style,i=r.x,o=r.y,a=r.width,s=r.height,l=r.options,c=r.onSelect,u=r.open,h=LF(this.attributes,"dropdown"),d=LF(this.attributes,"option"),f=this.dropdownPadding;TF(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(l,(function(t){return t.value})).join((function(t){return t.append((function(t){return new AV({className:"dropdown-item",style:Be(Be(Be({},t),d),{width:a-f[1]-f[3],selected:t.value===n.currentValue,onClick:function(t,e,r){n.setValue(t),null==c||c(t,e,r),n.dispatchEvent(new Ds("change",{detail:{value:t,option:e,item:r}})),jj(n.dropdown)}})})})).each((function(t,e){var n,r=(null===(n=this.parentNode)||void 0===n?void 0:n.children).reduce((function(t,n,r){return r<e&&(t+=n.getBBox().height),t}),0);this.attr("transform","translate(".concat(f[3],", ").concat(f[0]+r,")"))}))}),(function(t){return t.update((function(t){return{selected:t.value===n.currentValue}}))}),(function(t){return t.remove()}));var p=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),g=h.spacing;this.dropdown.attr(Be({transform:"translate(".concat(i,", ").concat(o+s+g,")"),width:p.width+f[1]+f[3],height:p.height+f[0]+f[2]},h)),!u&&jj(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",(function(t){t.stopPropagation()})),this.select.addEventListener("click",(function(){"visible"===t.dropdown.style.visibility?jj(t.dropdown):Ij(t.dropdown)})),this.addEventListener("pointerenter",(function(){t.isPointerInSelect=!0})),this.addEventListener("pointerleave",(function(){t.isPointerInSelect=!1})),null===document||void 0===document||document.addEventListener("click",(function(){t.isPointerInSelect||jj(t.dropdown)}))},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"请选择",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(GF),PV=function(t){function e(n){var r=t.call(this,Jj({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,n))||this;return r.showBackground=!0,r.background=r.appendChild(new Kl({})),r.icon=r.appendChild(new Fl({})),r}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return _F(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=We(this.padding,4),n=e[0],r=e[1],i=e[2],o=e[3];return Math.max(t-Math.max(o+r,n+i),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.size,i=r/2,o=LF(this.attributes,"background");this.background.attr(Be({x:e-i,y:n-i,width:r,height:r},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),n=e.x,r=e.y;this.indicator.update({x:n+t/2,y:r-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var e;t.prototype.connectedCallback.call(this);var n=this.attributes.size,r=this.background.getBBox(),i=r.x,o=r.y,a=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;a&&(this.indicator=a.appendChild(new MV({style:{x:i+n/2,y:o-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",(function(){null==n||n(t)})),this.showBackground){var r=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",(function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()})),this.addEventListener("pointerleave",(function(){r(),t.hideIndicator()})),this.addEventListener("pointerdown",(function(){t.background.attr({opacity:e.backgroundOpacities.active})})),this.addEventListener("pointerup",(function(){r()}))}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(GF),DV=function(t,e){return void 0===e&&(e="#565758"),new Hl({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},RV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.prototype.arcPath=function(t,e,n){var r=We([n,n],2),i=r[0],o=r[1],a=function(r){return[t+n*Math.cos(r),e+n*Math.sin(r)]},s=We(a(-5/4*Math.PI),2),l=s[0],c=s[1],u=We(a(1/4*Math.PI),2),h=u[0],d=u[1];return"M".concat(l,",").concat(c,",A").concat(i,",").concat(o,",0,1,1,").concat(h,",").concat(d)},Object.defineProperty(e.prototype,"label",{get:function(){return"重置"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=this.lineWidth,a=o+.5;TF(this.icon).maybeAppend(".reset","path").styles({stroke:r,lineWidth:o,d:this.arcPath(e,n,i/2-o),markerStart:DV(a,r)})},e}(PV),LV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快退"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=i/2,a=i/2/Math.pow(3,.5),s=[[e,n],[e,n-a],[e-o,n],[e,n+a],[e,n],[e+o,n-a],[e+o,n+a],[e,n]];TF(this.icon).maybeAppend(".backward","polygon").styles({points:s,fill:r})},e}(PV),IV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"快进"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=i/2,a=i/2/Math.pow(3,.5),s=[[e,n],[e,n-a],[e+o,n],[e,n+a],[e,n],[e-o,n-a],[e-o,n+a],[e,n]];TF(this.icon).maybeAppend(".forward","polygon").styles({points:s,fill:r})},e}(PV),jV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"播放"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=i/3*Math.pow(3,.5)*.8,a=[[e+o,n],[e-o/2,n-i/2*.8],[e-o/2,n+i/2*.8],[e+o,n]];TF(this.icon).maybeAppend(".play","polygon").styles({points:a,fill:r})},e}(PV),FV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"暂停"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=i/3,a=[[e-o,n-i/2],[e-o,n+i/2],[e-o/2,n+i/2],[e-o/2,n-i/2],[e-o,n-i/2],[e+o/2,n-i/2],[e+o/2,n+i/2],[e+o,n+i/2],[e+o,n-i/2]];TF(this.icon).maybeAppend(".pause","polygon").styles({points:a,fill:r})},e}(PV),BV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"范围时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=this.lineWidth,a=o;TF(this.icon).maybeAppend(".left-line","line").styles({x1:e-i/2,y1:n-i/2,x2:e-i/2,y2:n+i/2,stroke:r,lineWidth:o}),TF(this.icon).maybeAppend(".right-line","line").styles({x1:e+i/2,y1:n-i/2,x2:e+i/2,y2:n+i/2,stroke:r,lineWidth:o}),TF(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:n,x2:e-i/2+2*a,y2:n,stroke:r,lineWidth:o,markerEnd:DV(2*o,r)}),TF(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:n,x2:e+i/2-2*a,y2:n,stroke:r,lineWidth:o,markerEnd:DV(2*o,r)})},e}(PV),zV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"单一时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=this.lineWidth;TF(this.icon).maybeAppend(".line","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:o});var a=o;TF(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-i/2-2*a,y1:n,x2:e-2*a,y2:n,stroke:r,lineWidth:o,markerEnd:DV(2*o,r)}),TF(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+i/2+2*a,y1:n,x2:e+2*a,y2:n,stroke:r,lineWidth:o,markerEnd:DV(2*o,r)})},e}(PV),VV=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},GV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"折线图"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=this.lineWidth,a=(i-2*o-o)/4,s=(i-2*o-o)/2,l=We([e-i/2+o,n+i/2-2*o],2),c=l[0],u=l[1];TF(this.icon).maybeAppend(".coordinate","polyline").styles({points:VV(i).map((function(t){var r=We(t,2),i=r[0],o=r[1];return[i+e,o+n]})),stroke:r,lineWidth:o}),TF(this.icon).maybeAppend(".line","polyline").styles({points:[[c,u],[c+a,u-s],[c+2*a,u],[c+4*a,u-2*s]],stroke:r,lineWidth:o})},e}(PV),WV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"条形图"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,n=e.x,r=e.y,i=e.color,o=this.iconSize,a=this.lineWidth,s=a,l=(o-s)/t.length,c=(o-2*s)/4,u=We([n-o/2+2*s,r+o/2-s],2),h=u[0],d=u[1];TF(this.icon).maybeAppend(".coordinate","polyline").styles({points:VV(o).map((function(t){var e=We(t,2),i=e[0],o=e[1];return[i+n,o+r]})),stroke:i,lineWidth:a}),TF(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map((function(t,e){return{value:t,index:e}}))).join((function(t){return t.append("line").attr("className","column").style("x1",(function(t){var e=t.index;return h+l*e})).style("y1",d).style("x2",(function(t){var e=t.index;return h+l*e})).style("y2",(function(t){var e=t.value;return d-c*e})).styles({y1:d,stroke:i,lineWidth:a})}))},e}(PV),$V=function(t){function e(e){var n=t.call(this,Jj({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return Fe(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,o=this.lineWidth;TF(this.icon).maybeAppend(".split","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:o})},e}(PV),HV=function(t){function e(){var e=t.apply(this,$e([],We(arguments),!1))||this;return e.showBackground=!1,e}return Fe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return _F(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,n=e.x,r=e.y,i=e.speed,o=void 0===i?1:i,a=Pe(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),s=se(t,20,1/0),l=Be(Be({},a),{x:n-s/2,y:r-10,width:s,height:20,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});TF(this.icon).maybeAppend(".speed",(function(){return new CV({style:l})})).attr("className","speed").each((function(){this.update(l)}))},e.tag="SpeedSelect",e}(PV),UV=function(t){function e(e){var n=t.call(this,e)||this;return n.icon=n.appendChild(new Fl({})),n.currentType=n.attributes.type,n}return Fe(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes;e.onChange;var n=ze(e,["onChange"]);TF(this.icon).selectAll(".icon").data([this.currentType]).join((function(e){return e.append((function(e){var n,r=null===(n=t.toggles.find((function(t){return We(t,1)[0]===e})))||void 0===n?void 0:n[1];if(!r)throw new Error("Invalid type: ".concat(e));return new r({})})).attr("className","icon").styles(n,!1).update({})}),(function(t){return t.styles({restStyles:n}).update({})}),(function(t){return t.remove()}))},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var r=(t.toggles.findIndex((function(e){return We(e,1)[0]===t.currentType}))+1)%t.toggles.length,i=t.toggles[r][0];null==e||e(t.currentType),t.currentType=i,t.render()}))},e.tag="ToggleIcon",e}(GF),YV=function(t){function e(e){var n=t.call(this,Jj({},{style:{type:"play"}},e))||this;return n.toggles=[["play",jV],["pause",FV]],n}return Fe(e,t),e}(UV),qV=function(t){function e(e){var n=t.call(this,Jj({},{style:{type:"range"}},e))||this;return n.toggles=[["range",BV],["value",zV]],n}return Fe(e,t),e}(UV),XV=function(t){function e(e){var n=t.call(this,Jj({},{style:{type:"column"}},e))||this;return n.toggles=[["line",GV],["column",WV]],n}return Fe(e,t),e}(UV),KV={reset:RV,speed:HV,backward:LV,playPause:YV,forward:IV,selectionType:qV,chartType:XV,split:$V},ZV=function(t){function e(n){var r=t.call(this,Jj({},e.defaultOptions,n))||this;return r.background=r.appendChild(new Kl({})),r.functions=r.appendChild(new Fl({})),r}return Fe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return _F(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,n=t.y,r=t.width,i=t.height,o=LF(this.attributes,"background");this.background.attr(Be({x:e,y:n,width:r,height:i},o))},e.prototype.renderFunctions=function(){var t,e=this,n=this.attributes,r=n.functions,i=n.iconSize,o=n.iconSpacing,a=n.x,s=n.y,l=n.width,c=n.height,u=n.align,h=We(this.padding,4),d=h[1],f=h[3],p=r.reduce((function(t,e){return t.length&&e.length?t.concat.apply(t,$e(["split"],We(e),!1)):t.concat.apply(t,$e([],We(e),!1))}),[]),g=p.length*(i+o)-o,v={left:f+i/2,center:(l-g)/2+i/2,right:l-g-f-d+i/2}[u]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),p.forEach((function(t,n){var r,l=KV[t],u={x:a+n*(i+o)+v,y:s+c/2,size:i};if(l===HV?(u.speed=e.attributes.speed,u.onSelect=function(n){return e.handleFunctionChange(t,{value:n})}):[YV,qV,XV].includes(l)?(u.onChange=function(n){return e.handleFunctionChange(t,{value:n})},l===YV&&(u.type="play"===e.attributes.state?"pause":"play"),l===qV&&(u.type="range"===e.attributes.selectionType?"value":"range"),l===XV&&(u.type="line"===e.attributes.chartType?"column":"line")):u.onClick=function(){return e.handleFunctionChange(t,{value:t})},l===HV){var h=null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView;h&&(e.speedSelect=new l({style:Be(Be({},u),{zIndex:100})}),h.appendChild(e.speedSelect))}else e.functions.appendChild(new l({style:u}))}))},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var n=this.attributes.onChange;null==n||n(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(GF),JV=function(t){function e(n){var r=t.call(this,Jj({},e.defaultOptions,n))||this;return r.bindEvents(),r}return Fe(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",(function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))})),this.addEventListener("mouseleave",(function(){t.attr("lineWidth",0)}))},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Rl),QV=function(t){function e(n){return t.call(this,Jj({},e.defaultOptions,n))||this}return Fe(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,o=LF(this.attributes,"background");TF(this).maybeAppend("background","rect").attr("className","background").styles(Be({x:e-r/2,y:n-i/2,width:r,height:i},o))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.iconSize,i=LF(this.attributes,"icon"),o=r/2;TF(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(Be({x1:e-1,y1:n-o,x2:e-1,y2:n+o},i)),TF(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(Be({x1:e+1,y1:n-o,x2:e+1,y2:n+o},i))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,o=t.type,a=LF(this.attributes,"border"),s="start"===o?+r/2:-r/2;TF(this).maybeAppend("border","line").attr("className","border").styles(Be({x1:s+e,y1:n-i/2,x2:s+e,y2:n+i/2},a))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(GF);function tG(t,e){return"number"==typeof t?eG(t):function(t,e){var n=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(n.getHours())&&0===n.getMinutes()?FF(n,"HH:mm\nYYYY-MM-DD"):FF(n,"HH:mm");case"half-day":return n.getHours()<12?"AM\n".concat(FF(n,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(n.getDate())?FF(n,"DD\nYYYY-MM"):FF(n,"DD");case"week":return n.getDate()<=7?FF(n,"DD\nYYYY-MM"):FF(n,"DD");case"month":return[0,6].includes(n.getMonth())?FF(n,"MM月\nYYYY"):FF(n,"MM月");case"season":return[0].includes(n.getMonth())?FF(n,"MM月\nYYYY"):FF(n,"MM月");case"year":return FF(n,"YYYY");default:return FF(n,"YYYY-MM-DD HH:mm")}}(t,e)}function eG(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),n=String(Math.floor(t%3600/60)).padStart(2,"0"),r=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(n,":").concat(r):"".concat(e,":").concat(n,":").concat(r)}var nG=function(t){function e(n){var r=t.call(this,Jj({},e.defaultOptions,n))||this;r.axis=r.appendChild(new sV({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new az({style:{onChange:function(t){r.handleSliderChange(t)}}})),r.controller=r.appendChild(new ZV({})),r.states={},r.handleSliderChange=function(t){var e,n=(e=r.states.values,Array.isArray(e)?$e([],We(e),!1):e);r.setBySliderValues(t),r.dispatchOnChange(n)};var i=r.attributes,o=i.selectionType,a=i.chartType,s=i.speed,l=i.state,c=i.playMode,u=i.values;return r.states={chartType:a,playMode:c,selectionType:o,speed:s,state:l},r.setByTimebarValues(u),r}return Fe(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort((function(t,e){return t.time<e.time?-1:t.time>e.time?1:0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,o=t.type,a=t.controllerHeight,s=se(+i-a,0,+i),l=new $j(e,n+ +i-a,+r,a),c=0,u="time"===o?10:s;return{axisBBox:"chart"===o?new $j(e,n+s-(c=35),+r,c):new $j,controllerBBox:l,timelineBBox:new $j(e,n+("time"===o?s:s-u),+r,u-c)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,n,r=this.data,i=We(Array.isArray(t)?t:[0,t],2),o=i[0],a=i[1],s=r.length,l=r[Math.floor(o*s)],c=r[Math.ceil(a*s)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:r[0].time,null!==(n=null==c?void 0:c.time)&&void 0!==n?n:1/0]},e.prototype.setByTimebarValues=function(t){var e,n,r,i=this.data,o=We(Array.isArray(t)?t:[void 0,t],2),a=o[0],s=o[1],l=i.find((function(t){return t.time===a})),c=i.find((function(t){return t.time===s}));this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:null===(n=i[0])||void 0===n?void 0:n.time,null!==(r=null==c?void 0:c.time)&&void 0!==r?r:1/0]},e.prototype.setByIndex=function(t){var e,n,r,i,o=this.data,a=We(t,2),s=a[0],l=a[1];this.states.values=[null!==(n=null===(e=o[s])||void 0===e?void 0:e.time)&&void 0!==n?n:o[0].time,null!==(i=null===(r=this.data[l])||void 0===r?void 0:r.time)&&void 0!==i?i:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,n=e.values,r=e.selectionType,i=We(Array.isArray(n)?n:[void 0,n],2),o=i[0],a=i[1],s=this.data,l=s.length,c="value"===r;return[(t=s.findIndex((function(t){return t.time===o})),c?0:t>-1?t/l:0),function(){if(a===1/0)return 1;var t=s.findIndex((function(t){return t.time===a}));return t>-1?t/l:c?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,n=t.selectionType,r=We(Array.isArray(e)?e:[this.data[0].time,e],2),i=r[0],o=r[1];return"value"===n?o:[i,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,n=e.length;return e[Math.floor(t*(n-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new QV({style:{type:t,height:e,iconSize:e/6}})}:function(){return new Wl({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,n=t.x,r=t.y,i=t.width,o=t.height,a=this.states,s=a.selectionType,l=a.chartType,c=this.data,u=this.attributes,h=u.type,d=u.labelFormatter,f=LF(this.attributes,"chart");f.type;var p=ze(f,["type"]),g="range"===s;if("time"===h)return Be({handleIconShape:function(){return new JV({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:g?-15:0,autoFitLabel:g,handleSpacing:g?-15:0,trackFill:"#edeeef",trackLength:i,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:s,values:this.sliderValues,formatter:function(t){if(d)return d(t);var n=e.getDatumByRatio(t).time;return"number"==typeof n?eG(n):FF(n,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},p);var v="range"===s?5:0,m=c.map((function(t){return t.value}));return Be({handleIconOffset:v,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:m,sparklineType:l,sparklineScale:.8,trackLength:i,trackSize:o,type:s,values:this.sliderValues,transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},p)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,n=this.attributes,r=n.interval,i=n.labelFormatter,o=LF(this.attributes,"axis"),a=t.x,s=t.y,l=t.width,c=$e($e([],We(e),!1),[{time:0}],!1).map((function(t,e,n){var r=t.time;return{label:"".concat(r),value:e/(n.length-1),time:r}})),u=Be({startPos:[a,s],endPos:[a+l,s],data:c,labelFilter:function(t,e){return e<c.length-1},labelFormatter:function(t){var e=t.time;return i?i(e):tG(e,r)}},o);return u},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,n=this.states,r=n.state,i=n.speed,o=n.selectionType,a=n.chartType,s=LF(this.attributes,"controller"),l=this,c=Be(Be(Be({},t),{iconSize:20,speed:i,state:r,selectionType:o,chartType:a,onChange:function(t,e){var n=e.value;switch(t){case"reset":l.internalReset();break;case"speed":l.handleSpeedChange(n);break;case"backward":l.internalBackward();break;case"playPause":"play"===n?l.internalPlay():l.internalPause();break;case"forward":l.internalForward();break;case"selectionType":l.handleSelectionTypeChange(n);break;case"chartType":l.handleChartTypeChange(n)}}}),s);"time"===e&&(c.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(c)},e.prototype.dispatchOnChange=function(t){var e=this.data,n=this.attributes.onChange,r=this.states,i=r.values,o=r.selectionType,a=We(i,2),s=a[0],l=a[1],c=l===1/0?e.at(-1).time:l;t&&function(t,e){if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t[0]===e[0]){if(t[1]===e[1])return!0;if(t[1]===1/0||e[1]===1/0)return!0}return!1}return!Array.isArray(e)&&t===e}(t,"range"===o?[s,c]:c)||null==n||n("range"===o?[s,c]:c)},e.prototype.internalReset=function(t){var e,n,r=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===r?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===n||n.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var n=this.data,r=n.length,i=this.states,o=i.values,a=i.selectionType,s=i.playMode,l=We(o,2),c=l[0],u=l[1],h=n.findIndex((function(t){return t.time===c})),d=n.findIndex((function(t){return t.time===u}));-1===d&&(d=r);var f,p="backward"===t?-1:1;"range"===a?"acc"===s?(f=[h,d+p],-1===p&&h===d&&(f=[h,r])):f=[h+p,d+p]:f=[h,d+p];var g=function(t){var e=We(t.sort((function(t,e){return t-e})),2),n=e[0],i=e[1],o=function(t){return se(t,0,r)};return i>r?"value"===a?[0,0]:"acc"===s?[o(n),o(n)]:[0,o(i-n)]:n<0?"acc"===s?[0,o(i)]:[o(n+r-i),r]:[o(n),o(i)]}(f);return this.setByIndex(g),this.updateSelection(),g},e.prototype.internalBackward=function(t){var e,n,r=this.moveSelection("backward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,n,r=this,i=this.data,o=this.attributes.loop,a=this.states.speed,s=void 0===a?1:a;this.playInterval=window.setInterval((function(){r.internalForward()[1]!==i.length||o||(r.internalPause(),r.renderController())}),1e3/s),this.states.state="play",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===n||n.call(e))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,n;clearInterval(this.playInterval),this.states.state="pause",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===n||n.call(e))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,n,r=this.moveSelection("forward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,n;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===n||n.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,n;this.states.selectionType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===n||n.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,n;this.states.chartType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===n||n.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,n=t.controllerBBox,r=t.timelineBBox;this.renderController(n),this.renderAxis(e),this.renderChart(r),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(GF),rG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class iG extends oI{constructor(t,e){super(t,Object.assign({},iG.defaultOptions,e)),this.typePrefix="__data__",this.element=null,this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:t}=this.context;t.on(xu.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{const{graph:n}=this.context,{typePrefix:r}=this,i=Te(t,[r,"id"]),o=Te(t,[r,"style","labelText"]),[a]=i.split("__"),s=this.fieldMap[a].get(o)||[];n.setElementState(Object.fromEntries(null==s?void 0:s.map((t=>[t,e]))))},this.click=t=>{if("hover"===this.options.trigger)return;const e=Te(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter((t=>t!==e)),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;const e=Te(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter((t=>t!==e)):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,n)=>{if(!t)return;const r=this.fieldMap[n];if(r)if(r.has(t)){const n=r.get(t);n&&(n.push(e),r.set(t,n))}else r.set(t,[e])},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];const{model:n,element:r,graph:i}=this.context,{nodes:o,edges:a,combos:s}=n.getData(),l={},c=e=>Yt(t)?t(e):t,u={node:"circle",edge:"line",combo:"rect"},h={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},d=(t,e)=>{t.forEach((t=>{const{id:n}=t,i=Te(t,["data",c(t)]),o=(null==r?void 0:r.getElementType(e,t))||"circle",a=((t,e)=>null==r?void 0:r.getElementComputedStyle(t,e))(e,t),s=("edge"===e?null==a?void 0:a.stroke:null==a?void 0:a.fill)||"#1783ff";n&&i&&i.replace(/\s+/g,"")&&(this.setFieldMap(i,n,e),l[i]||(l[i]={id:`${e}__${n}`,label:i,marker:h[o]||u[e],elementType:e,lineWidth:1,stroke:s,fill:s}))}))};switch(e){case"node":d(o,"node");break;case"edge":d(a,"edge");break;case"combo":d(s,"combo");break;default:return[]}return Object.values(l)},this.layout=t=>{let{flexDirection:e,alignItems:n,justifyContent:r}={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"};const i={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in i&&([e,n,r]=i[t]),{display:"flex",flexDirection:e,justifyContent:r,alignItems:n}},this.createElement=()=>{if(this.draw)return void this.updateElement();const{canvas:t}=this.context,[e,n]=t.getSize(),r=this.options,{width:i=e,height:o=n,nodeField:a,edgeField:s,comboField:l,trigger:c,position:u}=r,h=rG(r,["width","height","nodeField","edgeField","comboField","trigger","position"]),d=this.getMarkerData(a,"node"),f=this.getMarkerData(s,"edge"),p=this.getMarkerData(l,"combo"),g=[...d,...p,...f],v=this.layout(u),m=new _V({style:Object.assign({width:i,height:o},v)}),y=Object.assign({width:i,height:o,data:g,itemMarkerLineWidth:({lineWidth:t})=>t,itemMarker:({marker:t})=>t,itemMarkerStroke:({stroke:t})=>t,itemMarkerFill:({fill:t})=>t,gridCol:d.length},h,this.getEvents()),b=new EV({className:"legend",style:y});m.appendChild(b),t.appendChild(m),this.element=m,this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;null===(t=this.element)||void 0===t||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;this.element.getChildByIndex(0).update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}destroy(){this.clear(),this.context.graph.off(xu.AFTER_DRAW,this.createElement),super.destroy()}}iG.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16};class oG extends oI{constructor(t,e){super(t,Object.assign({},oG.defaultOptions,e)),this.onDraw=t=>{var e;(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.render)||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;const{size:[e,n]}=this.options,{movementX:r,movementY:i}=t,{left:o,top:a,width:s,height:l}=this.mask.style,[,,c,u]=this.maskBBox;let h=parseInt(o)+r,d=parseInt(a)+i,f=parseInt(s),p=parseInt(l);h<0&&(h=0),d<0&&(d=0),h+f>e&&(h=sG(e-f,0)),d+p>n&&(d=sG(n-p,0)),f<c&&(r>0?(h=sG(h-r,0),f=aG(f+r,e)):r<0&&(f=aG(f-r,e))),p<u&&(i>0?(d=sG(d-i,0),p=aG(p+i,n)):i<0&&(p=aG(p-i,n))),Object.assign(this.mask.style,{left:h+"px",top:d+"px",width:f+"px",height:p+"px"});const g=parseInt(o)-h,v=parseInt(a)-d;if(0===g&&0===v)return;const m=this.context.canvas.getCamera().getZoom()/this.canvas.getCamera().getZoom();this.context.graph.translateBy([g*m,v*m],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=De((()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())}),32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=xe((()=>{this.renderMinimap(),this.renderMask()}),this.options.delay,!0)}bindEvents(){const{graph:t}=this.context;t.on(xu.AFTER_DRAW,this.onDraw),t.on(xu.AFTER_RENDER,this.onRender),t.on(xu.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(xu.AFTER_DRAW,this.onDraw),t.off(xu.AFTER_RENDER,this.onRender),t.off(xu.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;const{nodes:r,edges:i,combos:o}=n;return{nodes:r.filter((e=>t(xh(e),"node"))),edges:i.filter((e=>t(xh(e),"edge"))),combos:o.filter((e=>t(xh(e),"combo")))}}setShapes(t,e){const{nodes:n,edges:r,combos:i}=e,{shape:o}=this.options,{element:a}=this.context;if("key"===o){const e=new Set,o=n=>{const r=xh(n);e.add(r);const i=a.getElement(r);if(!i)return;const o=i.getShape("key"),s=this.shapes.get(r)||o.cloneNode();s.setPosition(o.getPosition()),i.style.zIndex&&(s.style.zIndex=i.style.zIndex),s.id=i.id,this.shapes.has(r)?Object.entries(o.attributes).forEach((([t,e])=>{s.style[t]!==e&&(s.style[t]=e)})):(t.appendChild(s),this.shapes.set(r,s))};return r.forEach(o),i.forEach(o),n.forEach(o),void this.shapes.forEach(((n,r)=>{e.has(r)||(t.removeChild(n),this.shapes.delete(r))}))}const s=(t,e)=>{const n=a.getElement(t).getPosition();return e.setPosition(n),e};t.removeChildren(),r.forEach((e=>t.appendChild(o(xh(e),"edge")))),i.forEach((e=>{t.appendChild(s(xh(e),o(xh(e),"combo")))})),n.forEach((e=>{t.appendChild(s(xh(e),o(xh(e),"node")))}))}calculatePosition(){const{position:t,size:[e,n]}=this.options,{canvas:r}=this.context,[i,o]=r.getSize(),[a,s]=td(t);return[a*(i-e),s*(o-n)]}createContainer(){const{container:t,className:e,size:[n,r],containerStyle:i}=this.options;if(t)return"string"==typeof t?document.querySelector(t):t;const o=document.createElement("div");o.classList.add("g6-minimap"),e&&o.classList.add(e);const[a,s]=this.calculatePosition();return Object.assign(o.style,Object.assign({position:"absolute",left:a+"px",top:s+"px",width:n+"px",height:r+"px"},i)),this.context.canvas.getContainer().appendChild(o)}initCanvas(){const{renderer:t,size:[e,n]}=this.options;if(this.canvas){const{width:r,height:i}=this.canvas.getConfig();e===r&&n===i||this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{const r=document.createElement("div"),i=this.createContainer();this.container=i,i.appendChild(r),this.canvas=new dc({width:e,height:n,container:r,renderer:t||new Pp})}return this.setCamera(),this.canvas}createLandmark(t,e,n){const r=`${t.join(",")}-${e.join(",")}-${n}`;if(this.landmarkMap.has(r))return this.landmarkMap.get(r);const i=this.canvas.getCamera().createLandmark(r,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(r,i),i}setCamera(){var t;const{canvas:e}=this.context,n=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!n)return;const{size:[r,i],padding:o}=this.options,[a,s,l,c]=Yu(o),{min:u,max:h,center:d}=e.getBounds("elements"),f=(r-c-s)/(h[0]-u[0]),p=(i-a-l)/(h[1]-u[1]),g=Math.min(f,p),v=this.createLandmark(d,d,g);n.gotoLandmark(v,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),r=t.getCanvasByViewport(e),i=this.canvas.canvas2Viewport(od(n)),o=this.canvas.canvas2Viewport(od(r)),a=o.x-i.x,s=o.y-i.y;return[i.x,i.y,a,s]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[n,r,i,o]=this.maskBBox;return n<0&&(i=aG(i+n,t),n=0),r<0&&(o=aG(o+r,e),r=0),n+i>t&&(i=sG(t-n,0)),r+o>e&&(o=sG(e-r,0)),[aG(n,t),aG(r,e),sG(i,0),sG(o,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,n,r]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:r+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),null===(t=this.mask)||void 0===t||t.remove(),super.destroy()}}oG.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const aG=(t,e)=>Math.min(t,e),sG=(t,e)=>Math.max(t,e);var lG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};const cG={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class uG extends oI{constructor(t,e){super(t,Object.assign({},uG.defaultOptions,e)),this.initSnapline=()=>{const t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new Wl({style:Object.assign(Object.assign({},cG),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new Wl({style:Object.assign(Object.assign({},cG),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,n)=>lG(this,void 0,void 0,(function*(){const{verticalX:r,horizontalY:i}=n,{tolerance:o}=this.options,{min:[a,s],max:[l,c],center:[u,h]}=e;let d=0,f=0;null!==r&&(hG(l,r)<o&&(d=r-l),hG(a,r)<o&&(d=r-a),hG(u,r)<o&&(d=r-u),0!==d&&(this.isVerticalSticking=!0)),null!==i&&(hG(c,i)<o&&(f=i-c),hG(s,i)<o&&(f=i-s),hG(h,i)<o&&(f=i-h),0!==f&&(this.isHorizontalSticking=!0)),0===d&&0===f||(yield this.context.graph.translateElementBy({[t]:[d,f]},!1))})),this.enableSnap=t=>{const{target:e}=t,n=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[r,i]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(r)<=n&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[e.id]:[-r,-i]},!1),!1;if(this.isHorizontalSticking&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[e.id]:[0,-i]},!1),!1;if(this.isVerticalSticking&&Math.abs(r)<=n)return this.context.graph.translateElementBy({[e.id]:[-r,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout((()=>{this.enableStick=!0}),200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{const{tolerance:n,shape:r}=this.options,{min:[i,o],max:[a,s],center:[l,c]}=e;let u=null,h=null,d=null,f=null,p=null,g=null;return this.getNodes().some((e=>{if(Se(t.id,e.id))return!1;const v=dG(e,r).getRenderBounds(),{min:[m,y],max:[b,x],center:[E,w]}=v;return null===u&&(hG(E,l)<n?u=E:hG(m,i)<n||hG(m,a)<n?u=m:(hG(b,a)<n||hG(b,i)<n)&&(u=b),null!==u&&(h=Math.min(y,o),d=Math.max(x,s))),null===f&&(hG(w,c)<n?f=w:hG(y,o)<n||hG(y,s)<n?f=y:(hG(x,s)<n||hG(x,o)<n)&&(f=x),null!==f&&(p=Math.min(m,i),g=Math.max(b,a))),null!==u&&null!==f})),{verticalX:u,verticalMinY:h,verticalMaxY:d,horizontalY:f,horizontalMinX:p,horizontalMaxX:g}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>lG(this,void 0,void 0,(function*(){const{target:e}=t;if(this.options.autoSnap){if(!this.enableSnap(t))return}const n=dG(e,this.options.shape).getRenderBounds(),r=this.calcSnaplineMetadata(e,n);this.hideSnapline(),null===r.verticalX&&null===r.horizontalY||this.updateSnapline(r),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,n,r))})),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,n=((null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[]).filter((t=>{var e;return"hidden"!==Te(t,["style","visibility"])&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))}));return e?n.filter((t=>e(t))):n}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||cG.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:n,verticalMaxY:r,horizontalY:i,horizontalMinX:o,horizontalMaxX:a}=t,[s,l]=this.context.canvas.getSize(),{offset:c}=this.options;null!==i?Object.assign(this.horizontalLine.style,{x1:c===1/0?0:o-c,y1:i,x2:c===1/0?s:a+c,y2:i,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:c===1/0?0:n-c,x2:e,y2:c===1/0?l:r+c,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return Gh([t.dx,t.dy],e)}bindEvents(){return lG(this,void 0,void 0,(function*(){const{graph:t}=this.context;t.on(wu.DRAG_START,this.onDragStart),t.on(wu.DRAG,this.onDrag),t.on(wu.DRAG_END,this.onDragEnd)}))}unbindEvents(){const{graph:t}=this.context;t.off(wu.DRAG_START,this.onDragStart),t.off(wu.DRAG,this.onDrag),t.off(wu.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}uG.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const hG=(t,e)=>Math.abs(t-e),dG=(t,e)=>"function"==typeof e?e(t):t.getShape(e);var fG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},pG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const gG=["timestamp","time","date","datetime"];class vG extends oI{get padding(){return Yu(this.options.padding)}constructor(t,e){super(t,Object.assign({},vG.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach((t=>{if("position"===t)this.upsertWrapper();else this.upsertTimebar()}))}backup(){this.originalData=mG(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:r,data:i,x:o,y:a,width:s,height:l,mode:c}=e,u=pG(e,["onChange","timebarType","data","x","y","width","height","mode"]),h=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then((()=>{var t;const e=Object.assign(Object.assign({x:h[0]/2-s/2,y:d,onChange:t=>{const e=(Xt(t)?t:[t,t]).map((t=>function(t){return t instanceof Date}(t)?t.getTime():t));"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==n||n(e)}},u),{data:i.map((t=>le(t)?{time:t,value:0}:t)),width:s,height:l,type:r});this.timebar?this.timebar.update(e):(this.timebar=new nG({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))}))}upsertWrapper(){var t;if(!this.wrapper){const t=document.createElement("div");t.style.position="absolute",this.wrapper=t}const{x:e,y:n,className:r,position:i}=this.options;return r&&(this.wrapper.className=r),le(e)||le(n)?Object.assign(this.wrapper.style,{left:`${null!=e?e:0}px`,top:`${null!=n?n:0}px`}):Object.assign(this.wrapper.style,{["top"===i?"bottom":"top"]:"unset",["top"===i?"top":"bottom"]:"0px"}),null===(t=this.context.canvas.getContainer())||void 0===t||t.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var t,e;const n=this.upsertWrapper();if(this.canvas)return this.canvas;const{height:r}=this.options,[i]=this.context.canvas.getSize(),[o,,a]=this.padding;return this.canvas=new dc({container:n,width:i,height:r+o+a,renderer:(null===(e=(t=this.context.options).renderer)||void 0===e?void 0:e.call(t,"main"))||new Pp,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}filterElements(t){return fG(this,void 0,void 0,(function*(){var e;if(!this.originalData)return;const{elementTypes:n,getTime:r}=this.options,{graph:i,element:o}=this.context,a=mG(this.originalData);n.forEach((e=>{const n=`${e}s`;a[n]=(this.originalData[n]||[]).filter((e=>{const n=r(e);return!!yG(n,t)}))}));const s=[...a.nodes,...a.combos].map((t=>xh(t)));a.edges=a.edges.filter((t=>{const e=t.source,n=t.target;return s.includes(e)&&s.includes(n)})),i.setData(a),yield null===(e=o.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished}))}hiddenElements(t){const{graph:e}=this.context,{elementTypes:n,getTime:r}=this.options,i=[],o=[];n.forEach((e=>{var n;const a=`${e}s`;((null===(n=this.originalData)||void 0===n?void 0:n[a])||[]).forEach((e=>{const n=xh(e),a=r(e);yG(a,t)?o.push(n):i.push(n)}))})),e.hideElement(i,!1),e.showElement(o,!1)}destroy(){var t,e,n;const{graph:r}=this.context;this.originalData&&r.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(n=this.wrapper)||void 0===n||n.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}vG.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>bG(t,gG,void 0),loop:!1};const mG=t=>{const{nodes:e=[],edges:n=[],combos:r=[]}=t;return{nodes:[...e],edges:[...n],combos:[...r]}},yG=(t,e)=>{if(le(e))return t===e;const[n,r]=e;return t>=n&&t<=r},bG=(t,e,n)=>{var r;for(let n=0;n<e.length;n++){const i=e[n],o=null===(r=t.data)||void 0===r?void 0:r[i];if(o)return o}return n};var xG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class EG extends oI{constructor(t,e){super(t,Object.assign({},EG.defaultOptions,e)),this.$element=rI("toolbar",!1),this.onToolbarItemClick=t=>{const{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const n=t.target.getAttribute("value");null==e||e(n,t.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),iI("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),iI("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return xG(this,void 0,void 0,(function*(){e.update.call(this,t);const{className:n,position:r,style:i}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,i,function(t){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return t.split("-").forEach((t=>{e[t]="8px"})),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(r)),this.$element.innerHTML=yield this.getDOMContent()}))}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return xG(this,void 0,void 0,(function*(){return(yield this.options.getItems()).map((t=>`\n          <div class="g6-toolbar-item" value="${t.value}">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#${t.id}"></use>\n            </svg>\n          </div>`)).join("")}))}}EG.defaultOptions={position:"top-left"};class wG extends oI{constructor(t,e){super(t,Object.assign({},wG.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=t=>{const{enable:e}=this.options;return"function"==typeof e?e(t):e},this.onClick=t=>{const{target:{id:e}}=t;this.currentTarget===e?(this.hide(t),this.currentTarget=null):(this.currentTarget=e,this.show(t))},this.onPointerMove=t=>{const{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t),this.currentTarget=null},this.onCanvasMove=t=>{this.hide(t),this.currentTarget=null},this.onPointerEnter=t=>{this.show(t)},this.showById=t=>{const e={target:{id:t}};this.show(e)},this.getElementData=(t,e)=>{const{model:n}=this.context;switch(e){case"node":return n.getNodeData([t]);case"edge":return n.getEdgeData([t]);case"combo":return n.getComboData([t]);default:return[]}},this.show=t=>{const{client:e,target:{id:n}}=t;if($g(t.target))return;if(!this.tooltipElement||!this.isEnable(t))return;const r=this.context.graph.getElementType(n),{getContent:i,title:o}=this.options;this.currentTarget=n;const a=this.getElementData(n,r);let s,l;if(e)s=e.x,l=e.y;else{const t=Te(a,"0.style",{x:0,y:0});s=t.x,l=t.y}let c={};if(i)c.content=i(t,a);else{const t=this.context.graph.getElementRenderStyle(n),e="node"===r?t.fill:t.stroke;c={title:o||r,data:a.map((t=>({name:"ID",value:t.id||`${t.source} -> ${t.target}`,color:e})))}}this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:s,y:l,style:{".tooltip":{visibility:"visible"}}}),c))},this.hide=t=>{var e;if(!t)return void(null===(e=this.tooltipElement)||void 0===e||e.hide());if(!this.tooltipElement)return;if(!this.currentTarget)return;const{client:{x:n,y:r}}=t;this.tooltipElement.hide(n,r)},this.initTooltip=()=>{var t;const e=new TV({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach((n=>{t.off(n,e[n])}))}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach((n=>{t.on(n,e[n])}))}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:r,left:i}=n.getBoundingClientRect(),{style:o,position:a,enterable:s,container:l={x:-i,y:-r},title:c,offset:u}=this.options,[h,d]=e,[f,p]=t.getSize();return{x:h,y:d,container:l,title:c,bounding:{x:0,y:0,width:f,height:p},position:a,enterable:s,offset:u,style:o}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}wG.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var kG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};let MG;function NG(t,e){MG||(MG=document.createElement("canvas")),MG.width=t,MG.height=e;return MG.getContext("2d").clearRect(0,0,t,e),MG}var OG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},SG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class TG extends oI{constructor(t,e){super(t,Object.assign({},TG.defaultOptions,e)),this.$element=rI("watermark");this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return OG(this,void 0,void 0,(function*(){e.update.call(this,t);const n=this.options,{width:r,height:i,text:o,imageURL:a}=n,s=SG(n,["width","height","text","imageURL"]);Object.keys(s).forEach((e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])}));const l=a?yield function(t,e,n,r){return kG(this,void 0,void 0,(function*(){const i=NG(t,e),o=i.getContext("2d"),{rotate:a,opacity:s}=r;a&&o.rotate(a),s&&(o.globalAlpha=s);const l=new Image;return l.crossOrigin="anonymous",l.src=n,new Promise((n=>{l.onload=function(){const r=t>l.width?(t-l.width)/2:0,a=e>l.height?(e-l.height)/2:0;o.drawImage(l,0,0,l.width,l.height,r,a,t-2*r,e-2*a),n(i.toDataURL())}}))}))}(r,i,a,s):yield function(t,e,n,r){return kG(this,void 0,void 0,(function*(){const i=NG(t,e),o=i.getContext("2d"),{rotate:a,opacity:s,textFill:l,textFontSize:c,textFontFamily:u,textFontVariant:h,textFontWeight:d,textAlign:f,textBaseline:p}=r;return o.textAlign=f,o.textBaseline=p,o.translate(t/2,e/2),o.font=`${c}px ${u} ${h} ${d}`,a&&o.rotate(a),s&&(o.globalAlpha=s),l&&(o.fillStyle=l,o.fillText(`${n}`,0,0)),i.toDataURL()}))}(r,i,o,s);this.$element.style.backgroundImage=`url(${l})`}))}destroy(){super.destroy(),this.$element.remove()}}TG.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const _G=["#7E92B5","#F4664A","#FFBE3A"],AG={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},CG={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function PG(t){const{bgColor:e,textColor:n,nodeColor:r,nodeColorDisabled:i,nodeStroke:o,nodeHaloStrokeOpacityActive:a=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=_G,nodePaletteOptions:d=AG,edgeColor:f,edgeColorDisabled:p,edgePaletteOptions:g=CG,comboColor:v,comboColorDisabled:m,comboStroke:y,comboStrokeDisabled:b,edgeColorInactive:x}=t;return{background:e,node:{palette:d,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:o,portStrokeOpacity:.65,size:32,stroke:o,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:o},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:a},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:o,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:c,labelFill:n,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:x,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:v,halo:!1,haloLineWidth:12,haloStroke:y,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:y},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const DG=PG({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),RG=PG({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class LG extends Lh{beforeDraw(t,e){return t}afterLayout(){}}function IG(t,e,n,r,i){const o=xh(r),a=`${n}s`,s=i?r:t.add[a].get(o)||t.update[a].get(o)||t.remove[a].get(o)||r;Object.entries(t).forEach((([t,n])=>{e===t?n[a].set(o,s):n[a].delete(o)}))}function jG(t,e){return Object.keys(t).every((n=>t[n]===e[n]))}const FG=(t,e,n,r)=>{const i=`${n}s`,o=xh(r);t.add[i].has(o)||t.update[i].has(o)||t[e][i].set(xh(r),r)};
/*!
   * @antv/g-plugin-dragndrop
   * @description A G plugin for Drag n Drop implemented with PointerEvents
   * @version 2.0.17
   * @date 11/5/2024, 10:47:16 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */
var BG=function(){function t(e){l(this,t),this.dragndropPluginOptions=e}return u(t,[{key:"apply",value:function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,o=i.defaultView,a=function(t){var e=t.target,r=e===i,a=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(a){var s=!1,l=t.timeStamp,c=[t.clientX,t.clientY],u=null,h=[t.clientX,t.clientY],d=function(){var t=Pr(Ar().mark((function t(o){var d,f,p,g,v,m;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=8;break}if(d=o.timeStamp-l,f=vn([o.clientX,o.clientY],c),!(d<=n.dragndropPluginOptions.dragstartTimeThreshold||f<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:o.type="dragstart",a.dispatchEvent(o),s=!0;case 8:if(o.type="drag",o.dx=o.clientX-h[0],o.dy=o.clientY-h[1],a.dispatchEvent(o),h=[o.clientX,o.clientY],r){t.next=21;break}return p="pointer"===n.dragndropPluginOptions.overlap?[o.canvasX,o.canvasY]:e.getBounds().center,t.next=17,i.elementsFromPoint(p[0],p[1]);case 17:g=t.sent,v=g[g.indexOf(e)+1],m=(null==v?void 0:v.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?i:null),u!==m&&(u&&(o.type="dragleave",o.target=u,u.dispatchEvent(o)),m&&(o.type="dragenter",o.target=m,m.dispatchEvent(o)),(u=m)&&(o.type="dragover",o.target=u,u.dispatchEvent(o)));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();o.addEventListener("pointermove",d);var f=function(t){if(s){t.detail={preventClick:!0};var e=t.clone();u&&(e.type="drop",e.target=u,u.dispatchEvent(e)),e.type="dragend",a.dispatchEvent(e),s=!1}o.removeEventListener("pointermove",d)};e.addEventListener("pointerup",f,{once:!0}),e.addEventListener("pointerupoutside",f,{once:!0})}};r.hooks.init.tap(t.tag,(function(){o.addEventListener("pointerdown",a)})),r.hooks.destroy.tap(t.tag,(function(){o.removeEventListener("pointerdown",a)}))}}])}();BG.tag="Dragndrop";var zG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,e),(t=m(this,e)).name="dragndrop",t.options=n,t}return b(e,t),u(e,[{key:"init",value:function(){this.addRenderingPlugin(new BG(s({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}(Br),VG=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},GG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const WG=["main"],$G=["background","main","label","transient"];class HG{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||this.getLayers().main}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:n,background:r,cursor:i,enableMultiLayer:o}=e,a=GG(e,["renderer","background","cursor","enableMultiLayer"]),s=o?$G:WG,l=UG(n,s),c=Object.fromEntries(s.map((t=>[t,new dc(Object.assign(Object.assign({},a),{supportsMutipleCanvasesInOneContainer:o,renderer:l[t],background:o?"background"===t?r:void 0:r}))])));YG(c),this.extends={config:this.config,renderer:n,renderers:l,layers:c}}get ready(){return Promise.all(Object.entries(this.getLayers()).map((([,t])=>t.ready)))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach((n=>{const r=n.getCamera(),i=r.getPosition(),o=r.getFocalPoint();n.resize(t,e),r.setPosition(i),r.setFocalPoint(o)}))}getBounds(t){return eh(Object.values(this.getLayers()).map((e=>t?e.getRoot().childNodes.find((e=>e.classList.includes(t))):e.getRoot())).filter((t=>(null==t?void 0:t.childNodes.length)>0)).map((t=>t.getBounds())))}getContainer(){const t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;const r=(null===(n=t.style)||void 0===n?void 0:n.$layer)||"main";return this.getLayer(r).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=UG(t,this.config.enableMultiLayer?$G:WG);this.extends.renderers=e,Object.entries(e).forEach((([t,e])=>this.getLayer(t).setRenderer(e))),YG(this.getLayers())}getCanvasByViewport(t){return id(this.getLayer().viewport2Canvas(od(t)))}getViewportByCanvas(t){return id(this.getLayer().canvas2Viewport(od(t)))}getViewportByClient(t){return id(this.getLayer().client2Viewport(od(t)))}getClientByViewport(t){return id(this.getLayer().viewport2Client(od(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),n=e.client2Viewport(od(t));return id(e.viewport2Canvas(n))}toDataURL(){return VG(this,arguments,void 0,(function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:n="viewport"}=t,r=GG(t,["mode"]);let[i,o,a,s]=[0,0,0,0];if("viewport"===n)[a,s]=this.getSize();else if("overall"===n){const t=this.getBounds(),e=Zu(t);[i,o]=t.min,[a,s]=e}const l=An('<div id="virtual-image"></div>'),c=new dc({width:a,height:s,renderer:new Pp,devicePixelRatio:e,container:l,background:this.extends.config.background});yield c.ready,c.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),c.appendChild(this.getRoot().cloneNode(!0));const u=this.getLayer("label").getRoot().cloneNode(!0),h=c.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);u.translate([d[0]-h.x,d[1]-h.y]),u.scale(1/this.getCamera().getZoom()),c.appendChild(u),c.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const f=this.getCamera(),p=c.getCamera();if("viewport"===n)p.setZoom(f.getZoom()),p.setPosition(f.getPosition()),p.setFocalPoint(f.getFocalPoint());else if("overall"===n){const[t,e,n]=p.getPosition(),[r,a,s]=p.getFocalPoint();p.setPosition([t+i,e+o,n]),p.setFocalPoint([r+i,a+o,s])}const g=c.getContextService();return new Promise((t=>{c.addEventListener(ac.RERENDER,(()=>VG(this,void 0,void 0,(function*(){yield new Promise((t=>setTimeout(t,300)));const e=yield g.toDataURL(r);t(e)}))))}))}))}destroy(){Object.values(this.getLayers()).forEach((t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()}))}}function UG(t,e){return Object.fromEntries(e.map((e=>{const n=(null==t?void 0:t(e))||new Pp;return"main"===e?n.registerPlugin(new zG({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]})))}function YG(t){Object.entries(t).forEach((([t,e])=>{const n=e.getContextService().getDomElement();(null==n?void 0:n.style)&&(n.style.position="absolute",n.style.outline="none",n.tabIndex=1,"main"!==t&&(n.style.pointerEvents="none"))}))}class qG{constructor(t){this.type=t}}class XG extends qG{constructor(t,e){super(t),this.data=e}}class KG extends qG{constructor(t,e,n,r){super(t),this.animationType=e,this.animation=n,this.data=r}}class ZG extends qG{constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class JG extends qG{constructor(t,e){super(t),this.data=e}}function QG(t,e){t.emit(e.type,e)}const tW="cachedStyle",eW=t=>`__${t}__`;function nW(t,e){return Te(t,[tW,eW(e)])}class rW{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var r,i,o;null===(r=null==e?void 0:e.before)||void 0===r||r.call(e);const a=this.getTasks().map((([e,r])=>{var i,o,a;const{element:s,elementType:l,stage:c}=e,u=Lu(this.context.options,l,c,t);null===(i=null==r?void 0:r.before)||void 0===i||i.call(r);const h=Fu(s,this.inferStyle(e,n),u);return h?(null===(o=null==r?void 0:r.beforeAnimate)||void 0===o||o.call(r,h),h.finished.then((()=>{var t,e;null===(t=null==r?void 0:r.afterAnimate)||void 0===t||t.call(r,h),null===(e=null==r?void 0:r.after)||void 0===e||e.call(r),this.animations.delete(h)}))):null===(a=null==r?void 0:r.after)||void 0===a||a.call(r),h})).filter(Boolean);a.forEach((t=>this.animations.add(t)));const s=Cu(a);return s?(null===(i=null==e?void 0:e.beforeAnimate)||void 0===i||i.call(e,s),s.finished.then((()=>{var t,n;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,s),null===(n=null==e?void 0:e.after)||void 0===n||n.call(e),this.release()}))):null===(o=null==e?void 0:e.after)||void 0===o||o.call(e),s}inferStyle(t,e){var n,r;const{element:i,elementType:o,stage:a,originalStyle:s,modifiedStyle:l}=t,c={},u={};if("enter"===a)Object.assign(c,{opacity:0});else if("exit"===a)Object.assign(u,{opacity:0});else if("show"===a)Object.assign(c,{opacity:0}),Object.assign(u,{opacity:null!==(n=nW(i,"opacity"))&&void 0!==n?n:Du("opacity")});else if("hide"===a)Object.assign(c,{opacity:null!==(r=nW(i,"opacity"))&&void 0!==r?r:Du("opacity")}),Object.assign(u,{opacity:0});else if("collapse"===a){const{collapse:t}=e||{},{target:n,descendants:r,position:a}=t;if("node"===o){if(r.includes(i.id)){const[t,e,n]=a;Object.assign(u,{x:t,y:e,z:n})}}else if("combo"===o){if(i.id===n||r.includes(i.id)){const[t,e]=a;Object.assign(u,{x:t,y:e,childrenNode:s.childrenNode})}}else"edge"===o&&Object.assign(u,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if("expand"===a){const{expand:t}=e||{},{target:n,descendants:r,position:a}=t;if("node"===o){if(i.id===n||r.includes(i.id)){const[t,e,n]=a;Object.assign(c,{x:t,y:e,z:n})}}else if("combo"===o){if(i.id===n||r.includes(i.id)){const[t,e,n]=a;Object.assign(c,{x:t,y:e,z:n,childrenNode:l.childrenNode})}}else"edge"===o&&Object.assign(c,{sourceNode:l.sourceNode,targetNode:l.targetNode})}return[Object.keys(c).length>0?Object.assign({},s,c):s,Object.keys(u).length>0?Object.assign({},l,u):l]}stop(){this.animations.forEach((t=>t.cancel()))}clear(){this.tasks=[]}release(){var t,e;const{canvas:n}=this.context,r=null===(e=null===(t=n.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;r&&(n.document.timeline.animationsWithPromises=r.filter((t=>"finished"!==t.playState)))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class iW{constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,1===this.batchCount&&this.emit(new XG(xu.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new XG(xu.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class oW extends Rh{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{const{target:e}=t,n=function(t){if(!t)return null;if(t instanceof tc)return{type:"canvas",element:t};let e=t;for(;e;){if(Ag(e))return{type:"node",element:e};if(Cg(e))return{type:"edge",element:e};if(Pg(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!n)return;const{graph:r,canvas:i}=this.context,{type:o,element:a}=n;if("destroyed"in a&&($g(a)||a.destroyed))return;const{type:s,detail:l,button:c}=t,u=Object.assign(Object.assign({},t),{target:a,targetType:o,originalTarget:e});s===mu.POINTER_MOVE&&(this.currentTarget!==a&&(this.currentTarget&&r.emit(`${this.currentTargetType}:${mu.POINTER_LEAVE}`,Object.assign(Object.assign({},u),{type:mu.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),a&&(Object.assign(u,{type:mu.POINTER_ENTER}),r.emit(`${o}:${mu.POINTER_ENTER}`,u))),this.currentTarget=a,this.currentTargetType=o),s===mu.CLICK&&2===c||(r.emit(`${o}:${s}`,u),r.emit(s,u)),s===mu.CLICK&&2===l&&(Object.assign(u,{type:mu.DBLCLICK}),r.emit(`${o}:${mu.DBLCLICK}`,u),r.emit(mu.DBLCLICK,u)),s===mu.POINTER_DOWN&&2===c&&(Object.assign(u,{type:mu.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=i.getContainer())||void 0===t||t.addEventListener(mu.CONTEXT_MENU,(t=>t.preventDefault()),{once:!0})}}),r.emit(`${o}:${mu.CONTEXT_MENU}`,u),r.emit(mu.CONTEXT_MENU,u))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[yu.KEY_DOWN,yu.KEY_UP].forEach((e=>{t.addEventListener(e,this.forwardContainerEvents)}));const e=this.context.canvas.document;e&&[mu.CLICK,mu.DBLCLICK,mu.POINTER_OVER,mu.POINTER_LEAVE,mu.POINTER_ENTER,mu.POINTER_MOVE,mu.POINTER_OUT,mu.POINTER_DOWN,mu.POINTER_UP,mu.CONTEXT_MENU,mu.DRAG_START,mu.DRAG,mu.DRAG_END,mu.DRAG_ENTER,mu.DRAG_OVER,mu.DRAG_LEAVE,mu.DROP,mu.WHEEL].forEach((t=>{e.addEventListener(t,this.forwardCanvasEvents)}))}destroy(){const t=this.context.canvas.getContainer();t&&[yu.KEY_DOWN,yu.KEY_UP].forEach((e=>{t.removeEventListener(e,this.forwardContainerEvents)})),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var aW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function sW(t,e){const{data:n,style:r}=t,i=aW(t,["data","style"]),{data:o,style:a}=e,s=aW(e,["data","style"]),l=Object.assign(Object.assign({},i),s);return(n||o)&&Object.assign(l,{data:Object.assign(Object.assign({},n),o)}),(r||a)&&Object.assign(l,{style:Object.assign(Object.assign({},r),a)}),l}function lW(t){const{data:e,style:n}=t,r=aW(t,["data","style"]);return e&&(r.data=Object.assign({},e)),n&&(r.style=Object.assign({},n)),r}function cW(t={},e={}){const{states:n=[],data:r={},style:i={},children:o=[]}=t,a=aW(t,["states","data","style","children"]),{states:s=[],data:l={},style:c={},children:u=[]}=e,h=(t,e)=>t.length===e.length&&t.every(((t,n)=>t===e[n])),d=(t,e)=>{const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((n=>t[n]===e[n]))};return!!d(a,aW(e,["states","data","style","children"]))&&(!!h(o,u)&&(!!h(n,s)&&(!!d(r,l)&&!!d(i,c))))}var uW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function hW(t){const{id:e=xh(t),style:n,data:r}=t,i=uW(t,["id","style","data"]),o=Object.assign(Object.assign({},t),{style:Object.assign({},n),data:Object.assign({},r)});return function(t){return"source"in t&&"target"in t}(t)?Object.assign({id:e,data:o},i):{id:e,data:o}}function dW(t){return t.data}class fW{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new ov}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===fu.NodeUpdated||e===fu.EdgeUpdated||e===fu.ComboUpdated){const{value:n,original:r}=t;this.changes.push({value:lW(n),original:lW(r),type:e})}else this.changes.push({value:lW(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce(((e,n)=>{const r=dW(n);return this.isCombo(xh(r))||(void 0===t||t.includes(xh(r)))&&e.push(r),e}),[])}getEdgeDatum(t){return dW(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce(((e,n)=>{const r=dW(n);return(void 0===t||t.includes(xh(r)))&&e.push(r),e}),[])}getComboData(t){return this.model.getAllNodes().reduce(((e,n)=>{const r=dW(n);return this.isCombo(xh(r))?((void 0===t||t.includes(xh(r)))&&e.push(r),e):e}),[])}getRootsData(t=Mu){return this.model.getRoots(t).map(dW)}getAncestorsData(t,e){const{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getAncestors(t,e).map(dW):[]}getDescendantsData(t){const e=this.getElementDataById(t),n=[];return wd(e,(t=>{t!==e&&n.push(t)}),(t=>this.getChildrenData(xh(t))),"TB"),n}getParentData(t,e){const{model:n}=this;if(!e)return void _u("The hierarchy structure key is not specified");if(!n.hasNode(t)||!n.hasTreeStructure(e))return;const r=n.getParent(t,e);return r?dW(r):void 0}getChildrenData(t){const e="node"===this.getElementType(t)?Mu:ku,{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getChildren(t,e).map(dW):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){return"edge"===this.getElementType(t)?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){return dW(this.model.getNode(t))}getNodeLikeData(t){return this.model.getAllNodes().reduce(((e,n)=>{const r=dW(n);return t?t.includes(xh(r))&&e.push(r):e.push(r),e}),[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter((t=>{var n;return null===(n=t.states)||void 0===n?void 0:n.includes(e)}))}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(dW)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(dW)}setData(t){const{nodes:e=[],edges:n=[],combos:r=[]}=t,{nodes:i,edges:o,combos:a}=this.getData(),s=Ch(i,e,(t=>xh(t)),cW),l=Ch(o,n,(t=>xh(t)),cW),c=Ch(a,r,(t=>xh(t)),cW);this.batch((()=>{this.addData({nodes:s.enter,edges:l.enter,combos:c.enter}),this.updateData({nodes:s.update,edges:l.update,combos:c.update}),this.removeData({nodes:s.exit.map(xh),edges:l.exit.map(xh),combos:c.exit.map(xh)})}))}addData(t){const{nodes:e,edges:n,combos:r}=t;this.batch((()=>{this.addComboData(r),this.addNodeData(e),this.addEdgeData(n)}))}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map((t=>(this.pushChange({value:t,type:fu.NodeAdded}),hW(t))))),this.updateNodeLikeHierarchy(t))}addEdgeData(t=[]){t.length&&this.model.addEdges(t.map((t=>(this.pushChange({value:t,type:fu.EdgeAdded}),hW(t)))))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(ku)||e.attachTreeStructure(ku),e.addNodes(t.map((t=>(this.comboIds.add(xh(t)),this.pushChange({value:t,type:fu.ComboAdded}),hW(t))))),this.updateNodeLikeHierarchy(t)}addChildrenData(t,e){const n=this.getNodeLikeDatum(t),r=e.map(xh);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...r]}]),this.addEdgeData(r.map((e=>({source:t,target:e}))))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach((t=>{const n=xh(t);Eh(t)&&(e.hasTreeStructure(ku)||e.attachTreeStructure(ku),this.setParent(n,Eh(t),ku));const r=t.children||[];if(r.length){e.hasTreeStructure(Mu)||e.attachTreeStructure(Mu);const t=r.filter((t=>e.hasNode(t)));t.forEach((t=>this.setParent(t,n,Mu))),t.length!==r.length&&this.updateNodeData([{id:n,children:t}])}}))}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:n,combos:r}=t;this.batch((()=>{this.updateNodeData(e),this.updateComboData(r),this.updateEdgeData(n)}))}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch((()=>{const n=[];t.forEach((t=>{const r=xh(t),i=dW(e.getNode(r));if(cW(i,t))return;const o=sW(i,t);this.pushChange({value:o,original:i,type:fu.NodeUpdated}),e.mergeNodeData(r,o),n.push(o)})),this.updateNodeLikeHierarchy(n)}))}refreshData(){const{nodes:t,edges:e,combos:n}=this.getData();t.forEach((t=>{this.pushChange({value:t,original:t,type:fu.NodeUpdated})})),e.forEach((t=>{this.pushChange({value:t,original:t,type:fu.EdgeUpdated})})),n.forEach((t=>{this.pushChange({value:t,original:t,type:fu.ComboUpdated})}))}syncNodeDatum(t){const{model:e}=this,n=xh(t),r=sW(dW(e.getNode(n)),t);e.mergeNodeData(n,r)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch((()=>{t.forEach((t=>{const n=xh(t),r=dW(e.getEdge(n));if(cW(r,t))return;t.source&&r.source!==t.source&&e.updateEdgeSource(n,t.source),t.target&&r.target!==t.target&&e.updateEdgeTarget(n,t.target);const i=sW(r,t);this.pushChange({value:i,original:r,type:fu.EdgeUpdated}),e.mergeEdgeData(n,i)}))}))}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch((()=>{const n=[];t.forEach((t=>{const r=xh(t),i=dW(e.getNode(r));if(cW(i,t))return;const o=sW(i,t);this.pushChange({value:o,original:i,type:fu.ComboUpdated}),e.mergeNodeData(r,o),n.push(o)})),this.updateNodeLikeHierarchy(n)}))}setParent(t,e,n,r=!0){var i;if(t===e)return;const o=this.getNodeLikeDatum(t),a=Eh(o);if(e){const t=this.getNodeLikeDatum(e);if(void 0!==(null===(i=t.style)||void 0===i?void 0:i.zIndex)){const n=Te(t,["style","zIndex"],0)+(this.isCombo(e)?1:0);_e(o,["style","zIndex"],n)}}if(a!==e&&n===ku){const n={id:t,combo:e};this.isCombo(t)?this.syncComboDatum(n):this.syncNodeDatum(n)}this.model.setParent(t,e,n),r&&n===ku&&function(t,e){void 0===e&&(e=new Map);var n=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];e.has(o)||(n.push(o),e.set(o,!0))}return n}([a,e]).forEach((t=>{void 0!==t&&this.refreshComboData(t)}))}refreshComboData(t){const e=this.getComboData([t])[0],n=this.getAncestorsData(t,ku);e&&this.pushChange({value:e,original:e,type:fu.ComboUpdated}),n.forEach((t=>{this.pushChange({value:t,original:t,type:fu.ComboUpdated})}))}syncComboDatum(t){const{model:e}=this,n=xh(t);if(!e.hasNode(n))return;const r=sW(dW(e.getNode(n)),t);e.mergeNodeData(n,r)}getElementPosition(t){return ed(this.getElementDataById(t))}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const n=Bh(this.getElementPosition(t),[...e,0].slice(0,3));this.translateNodeTo(t,n)}translateNodeTo(t,e){const[n=0,r=0,i=0]=e;this.preventUpdateNodeLikeHierarchy((()=>{this.updateNodeData([{id:t,style:{x:n,y:r,z:i}}])}))}translateComboBy(t,e){const[n=0,r=0,i=0]=e;if([n,r,i].some(isNaN)||[n,r,i].every((t=>0===t)))return;const o=this.getComboData([t])[0];if(!o)return;const a=new Set;wd(o,(t=>{const e=xh(t);if(a.has(e))return;a.add(e);const[o,s,l]=ed(t),c=sW(t,{style:{x:o+n,y:s+r,z:l+i}});this.pushChange({value:c,original:t,type:this.isCombo(e)?fu.ComboUpdated:fu.NodeUpdated}),this.model.mergeNodeData(e,c)}),(t=>this.getChildrenData(xh(t))),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;const[r=0,i=0,o=0]=e,a=null===(n=this.getComboData([t]))||void 0===n?void 0:n[0];if(!a)return;const[s,l,c]=ed(a),u=r-s,h=i-l,d=o-c;wd(a,(t=>{const e=xh(t),[n,r,i]=ed(t),o=sW(t,{style:{x:n+u,y:r+h,z:i+d}});this.pushChange({value:o,original:t,type:this.isCombo(e)?fu.ComboUpdated:fu.NodeUpdated}),this.model.mergeNodeData(e,o)}),(t=>this.getChildrenData(xh(t))),"BT")}removeData(t){const{nodes:e,edges:n,combos:r}=t;this.batch((()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(r),this.latestRemovedComboIds=new Set(r)}))}removeNodeData(t=[]){t.length&&this.batch((()=>{t.forEach((t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(xh)),this.pushChange({value:this.getNodeData([t])[0],type:fu.NodeRemoved}),this.removeNodeLikeHierarchy(t)})),this.model.removeNodes(t)}))}removeEdgeData(t=[]){t.length&&(t.forEach((t=>this.pushChange({value:this.getEdgeData([t])[0],type:fu.EdgeRemoved}))),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch((()=>{t.forEach((t=>{this.pushChange({value:this.getComboData([t])[0],type:fu.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)})),this.model.removeNodes(t)}))}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(ku)){const e=Eh(this.getNodeLikeDatum(t));this.setParent(t,void 0,ku,!1),this.model.getChildren(t,ku).forEach((t=>{const n=dW(t),r=xh(n);this.setParent(xh(n),e,ku,!1);const i=sW(n,{id:xh(n),combo:e});this.pushChange({value:i,original:n,type:this.isCombo(r)?fu.ComboUpdated:fu.NodeUpdated}),this.model.mergeNodeData(xh(n),i)})),ye(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(Tu(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map((t=>t.id))),t.removeNodes(e.map((t=>t.id))),this.context={}}}var pW=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class gW{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){if(!this.container){const{canvas:t}=this.context;this.container=t.appendChild(new Fl({className:"elements"}))}}emit(t,e){e.silence||QG(this.context.graph,t)}forEachElementData(t){Ed.forEach((e=>{const n=this.context.model.getElementsDataByType(e);t(e,n)}))}getElementType(t,e){var n;const{options:r,graph:i}=this.context,o=(null===(n=r[t])||void 0===n?void 0:n.type)||e.type;return o?"string"==typeof o?o:o.call(i,e):"edge"===t?"line":"circle"}getTheme(t){return Au(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:n={}}=this.getTheme(t);return Object.assign({},...e.map((t=>n[t]||{})))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData(((e,n)=>{var r,i;const o=Object.assign({},Vd(null===(r=this.getTheme(e))||void 0===r?void 0:r.palette),Vd(null===(i=t[e])||void 0===i?void 0:i.palette));(null==o?void 0:o.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};const{type:n,color:r,field:i,invert:o}=e,a=t=>{const e="string"==typeof r?Su("palette",r):r;if("function"==typeof e){const n={};return t.forEach((([t,r])=>{n[t]=e(o?1-r:r)})),n}if(Array.isArray(e)){const n=o?[...e].reverse():e,r={};return t.forEach((([t,i])=>{r[t]=n[i%e.length]})),r}return{}},s=(t,e)=>{var n;return"string"==typeof t?null===(n=e.data)||void 0===n?void 0:n[t]:null==t?void 0:t(e)};if("group"===n){const e=ae(t,(t=>{if(!i)return"default";const e=s(i,t);return e?String(e):"default"})),n=a(Object.keys(e).map(((t,e)=>[t,e]))),r={};return Object.entries(e).forEach((([t,e])=>{e.forEach((e=>{r[xh(e)]=n[t]}))})),r}if("value"===n){const[e,n]=t.reduce((([t,e],n)=>{const r=s(i,n);if("number"!=typeof r)throw new Error(Tu(`Palette field ${i} is not a number`));return[Math.min(t,r),Math.max(e,r)]}),[1/0,-1/0]),r=n-e;return a(t.map((t=>[t.id,(s(i,t)-e)/r])))}}(n,o))}))}getPaletteStyle(t,e){const n=this.paletteStyle[e];return n?"edge"===t?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;const{options:r}=this.context,i=(null===(n=r[t])||void 0===n?void 0:n.style)||{};"transform"in i&&Array.isArray(i.transform)&&(i.transform=[...i.transform]),this.defaultStyle[xh(e.datum)]=Id(i,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData(((n,r)=>{const i=r.length;for(let o=0;o<i;o++){const i=r[o];(void 0===t||t.includes(xh(i)))&&this.computeElementDefaultStyle(n,{datum:i,graph:e})}}))}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,n){var r,i;const{options:o}=this.context;return Id((null===(i=null===(r=o[t])||void 0===r?void 0:r.state)||void 0===i?void 0:i[e])||{},n)}computeElementStatesStyle(t,e,n){this.stateStyle[xh(n.datum)]=Object.assign({},...e.map((e=>this.getElementStateStyle(t,e,n))))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData(((n,r)=>{const i=r.length;for(let o=0;o<i;o++){const i=r[o];if(void 0===t||t.includes(xh(i))){const t=this.getElementState(xh(i));this.computeElementStatesStyle(n,t,{datum:i,graph:e})}}}))}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getElementZIndex(t){var e;const n=this.getElement(t);return n&&null!==(e=n.style.zIndex)&&void 0!==e?e:0}getNodes(){return this.context.model.getNodeData().map((({id:t})=>this.elementMap[t]))}getEdges(){return this.context.model.getEdgeData().map((t=>this.elementMap[xh(t)]))}getCombos(){return this.context.model.getComboData().map((({id:t})=>this.elementMap[t]))}getElementComputedStyle(t,e){const n=xh(e),r=this.getThemeStyle(t),i=this.getPaletteStyle(t,n),o=e.style||{},a=this.getDefaultStyle(n),s=this.getThemeStateStyle(t,this.getElementState(n)),l=this.getStateStyle(n),c=Object.assign({},r,i,o,a,s,l);if("combo"===t){const t=this.context.model.getChildrenData(n),e=!!c.collapsed?[]:t.map(xh).filter((t=>this.getElement(t)));Object.assign(c,{childrenNode:e,childrenData:t})}return c}draw(t={animation:!0}){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:n="draw",stage:r=n,animation:i,silence:o}=t,{dataChanges:a,drawData:s}=e;this.markDestroyElement(s),this.computeStyle(r);const{add:l,update:c,remove:u}=s;return this.destroyElements(u,t),this.createElements(l,t),this.updateElements(c,t),this.context.animation.animate(i,o?{}:{before:()=>this.emit(new XG(xu.BEFORE_DRAW,{dataChanges:a,animation:i,stage:r,render:"render"===n}),t),beforeAnimate:e=>this.emit(new KG(xu.BEFORE_ANIMATE,pu.DRAW,e,s),t),afterAnimate:e=>this.emit(new KG(xu.AFTER_ANIMATE,pu.DRAW,e,s),t),after:()=>this.emit(new XG(xu.AFTER_DRAW,{dataChanges:a,animation:i,stage:r,render:"render"===n,firstRender:!1===this.context.graph.rendered}),t)})}computeChangesAndDrawData(t){const{model:e}=this.context,n=e.getChanges(),r=uj(n);if(0===r.length)return null;const{NodeAdded:i=[],NodeUpdated:o=[],NodeRemoved:a=[],EdgeAdded:s=[],EdgeUpdated:l=[],EdgeRemoved:c=[],ComboAdded:u=[],ComboUpdated:h=[],ComboRemoved:d=[]}=ae(r,(t=>t.type)),f=t=>new Map(t.map((t=>{const e=t.value;return[xh(e),e]}))),p={add:{nodes:f(i),edges:f(s),combos:f(u)},update:{nodes:f(o),edges:f(l),combos:f(h)},remove:{nodes:f(a),edges:f(c),combos:f(d)}},g=this.transformData(p,t);return e.clearChanges(),{dataChanges:n,drawData:g}}transformData(t,e){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce(((t,n)=>n.beforeDraw(t,e)),t)}createElement(t,e,n){var r,i;const o=xh(e);if(this.getElement(o))return;const a=this.getElementType(t,e),s=this.getElementComputedStyle(t,e),l=Su(t,a);if(!l)return _u(`The element ${a} of ${t} is not registered.`);if(this.emit(new ZG(xu.BEFORE_ELEMENT_CREATE,t,e),n),"expand"===n.stage){const t=this.getElementZIndex(n.target);(!s.zIndex||s.zIndex<t)&&(s.zIndex=t+(null!==(r=s.zIndex)&&void 0!==r?r:0))}const c=this.container.appendChild(new l({id:o,style:Object.assign({context:this.context},s)}));this.shapeTypeMap[o]=a,this.elementMap[o]=c;const{stage:u="enter"}=n;null===(i=this.context.animation)||void 0===i||i.add({element:c,elementType:t,stage:u,originalStyle:Object.assign({},c.attributes),modifiedStyle:Object.assign(Object.assign({},c.attributes),s)},{after:()=>{var r;this.emit(new ZG(xu.AFTER_ELEMENT_CREATE,t,e),n),null===(r=c.onCreate)||void 0===r||r.call(c)}})}createElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["node",n],["combo",i],["edge",r]].forEach((([t,n])=>{n.forEach((n=>this.createElement(t,n,e)))}))}getUpdateStageStyle(t,e,n){const{stage:r="update"}=n;if("translate"===r){if("node"===t||"combo"===t){const{style:{x:t=0,y:n=0,z:r=0}={}}=e;return{x:t,y:n,z:r}}return{}}return this.getElementComputedStyle(t,e)}updateElement(t,e,n){var r;const i=xh(e),{stage:o="update"}=n,a=this.getElement(i);if(!a)return()=>null;this.emit(new ZG(xu.BEFORE_ELEMENT_UPDATE,t,e),n);const s=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,n);this.shapeTypeMap[i]!==s&&(a.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(t,e,{animation:!1,silence:!0}));const c="visibility"!==o?o:"hidden"===l.visibility?"hide":"show";"hide"===c&&delete l.visibility,null===(r=this.context.animation)||void 0===r||r.add({element:a,elementType:t,stage:c,originalStyle:Object.assign({},a.attributes),modifiedStyle:Object.assign(Object.assign({},a.attributes),l)},{before:()=>{const t=this.elementMap[i];"collapse"!==o&&Wg(t,l),"visibility"===o&&(function(t,e){return eW(e)in(Te(t,tW)||{})}(t,"opacity")||function(t,e){const n=Array.isArray(e)?e:[e];Te(t,tW)||_e(t,tW,{}),n.forEach((e=>{_e(Te(t,tW),eW(e),t.attributes[e])}))}(t,"opacity"),this.visibilityCache.set(t,"show"===c?"visible":"hidden"),"show"===c&&Dh(t,"visible"))},after:()=>{var r;const a=this.elementMap[i];"collapse"===o&&Wg(a,l),"hide"===c&&Dh(a,this.visibilityCache.get(a)),this.emit(new ZG(xu.AFTER_ELEMENT_UPDATE,t,e),n),null===(r=a.onUpdate)||void 0===r||r.call(a)}})}updateElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["node",n],["combo",i],["edge",r]].forEach((([t,n])=>{n.forEach((n=>this.updateElement(t,n,e)))}))}markDestroyElement(t){Object.values(t.remove).forEach((t=>{t.forEach((t=>{const e=xh(t),n=this.getElement(e);n&&function(t){_e(t,"__to_be_destroyed__",!0)}(n)}))}))}destroyElement(t,e,n){var r;const{stage:i="exit"}=n,o=xh(e),a=this.elementMap[o];if(!a)return()=>null;this.emit(new ZG(xu.BEFORE_ELEMENT_DESTROY,t,e),n),null===(r=this.context.animation)||void 0===r||r.add({element:a,elementType:t,stage:i,originalStyle:Object.assign({},a.attributes),modifiedStyle:Object.assign({},a.attributes)},{after:()=>{var r;this.clearElement(o),a.destroy(),null===(r=a.onDestroy)||void 0===r||r.call(a),this.emit(new ZG(xu.AFTER_ELEMENT_DESTROY,t,e),n)}})}destroyElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["combo",i],["edge",r],["node",n]].forEach((([t,n])=>{n.forEach((n=>this.destroyElement(t,n,e)))}))}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}collapseNode(t,e){return pW(this,void 0,void 0,(function*(){var n;const{model:r,layout:i}=this.context,o=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!o)return;this.markDestroyElement(o.drawData);const a=yield i.simulate();r.updateData(a);const s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;const{drawData:l}=s,{add:c,remove:u,update:h}=l;this.markDestroyElement(l);const d={animation:e,stage:"collapse",data:l};this.destroyElements(u,d),this.createElements(c,d),this.updateElements(h,d),yield null===(n=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new KG(xu.BEFORE_ANIMATE,pu.COLLAPSE,t,l),d),afterAnimate:t=>this.emit(new KG(xu.AFTER_ANIMATE,pu.COLLAPSE,t,l),d)},{collapse:{target:t,descendants:Array.from(u.nodes).map((([,t])=>xh(t))),position:ed(h.nodes.get(t))}}))||void 0===n?void 0:n.finished}))}expandNode(t,e){return pW(this,void 0,void 0,(function*(){var n;const{model:r,layout:i}=this.context;if(!r.getAncestorsData(t,ku).every((t=>Td(t))))return;const o=ed(r.getNodeData([t])[0]),a=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!a)return;const{drawData:{add:s}}=a;this.createElements(s,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();const l=yield i.simulate();r.updateData(l),this.computeStyle("expand");const c=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!c)return;const{drawData:u}=c,{update:h}=u,d={animation:e,stage:"expand",data:u};s.edges.forEach((t=>h.edges.set(xh(t),t))),s.nodes.forEach((t=>h.nodes.set(xh(t),t))),this.updateElements(h,d),yield null===(n=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new KG(xu.BEFORE_ANIMATE,pu.EXPAND,t,u),d),afterAnimate:t=>this.emit(new KG(xu.AFTER_ANIMATE,pu.EXPAND,t,u),d)},{expand:{target:t,descendants:Array.from(s.nodes).map((([,t])=>xh(t))),position:o}}))||void 0===n?void 0:n.finished}))}collapseCombo(t,e){return pW(this,void 0,void 0,(function*(){var n;const{model:r,element:i}=this.context;if(r.getAncestorsData(t,ku).some((t=>Td(t))))return;const o=i.getElement(t),a=o.getComboPosition(Object.assign(Object.assign({},o.attributes),{collapsed:!0})),s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;const{dataChanges:l,drawData:c}=s;this.markDestroyElement(c);const{update:u,remove:h}=c,d={animation:e,stage:"collapse",data:c};this.destroyElements(h,d),this.updateElements(u,d);const f=t=>Array.from(t).map((([,t])=>xh(t)));yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new XG(xu.BEFORE_DRAW,{dataChanges:l,animation:e}),d),beforeAnimate:t=>this.emit(new KG(xu.BEFORE_ANIMATE,pu.COLLAPSE,t,c),d),afterAnimate:t=>this.emit(new KG(xu.AFTER_ANIMATE,pu.COLLAPSE,t,c),d),after:()=>this.emit(new XG(xu.AFTER_DRAW,{dataChanges:l,animation:e}),d)},{collapse:{target:t,descendants:[...f(h.nodes),...f(h.combos)],position:a}}))||void 0===n?void 0:n.finished}))}expandCombo(t,e){return pW(this,void 0,void 0,(function*(){var n;const{model:r}=this.context,i=ed(r.getComboData([t])[0]);this.computeStyle("expand");const o=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!o)return;const{dataChanges:a,drawData:s}=o,{add:l,update:c}=s,u={animation:e,stage:"expand",data:s,target:t};this.createElements(l,u),this.updateElements(c,u);const h=t=>Array.from(t).map((([,t])=>xh(t)));yield null===(n=this.context.animation.animate(e,{before:()=>this.emit(new XG(xu.BEFORE_DRAW,{dataChanges:a,animation:e}),u),beforeAnimate:t=>this.emit(new KG(xu.BEFORE_ANIMATE,pu.EXPAND,t,s),u),afterAnimate:t=>this.emit(new KG(xu.AFTER_ANIMATE,pu.EXPAND,t,s),u),after:()=>this.emit(new XG(xu.AFTER_DRAW,{dataChanges:a,animation:e}),u)},{expand:{target:t,descendants:[...h(l.nodes),...h(l.combos)],position:i}}))||void 0===n?void 0:n.finished}))}getFrontZIndex(t){const{model:e}=this.context,n=e.getElementType(t),r=e.getElementDataById(t),i=e.getData();if(Object.assign(i,{[`${n}s`]:i[`${n}s`].filter((e=>xh(e)!==t))}),"combo"===n&&!Td(r)){const n=e.getAncestorsData(t,ku).map(xh);i.nodes=i.nodes.filter((t=>!n.includes(xh(t)))),i.combos=i.combos.filter((t=>!n.includes(xh(t)))),i.edges=i.edges.filter((({source:t,target:e})=>n.includes(t)&&n.includes(e)))}return Math.max(0,...Object.values(i).flat().map((t=>{const e=xh(t);return this.getElementZIndex(e)})))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}var vW=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},mW=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class yW{get presetOptions(){return{animation:!!Ru(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}layout(){return vW(this,void 0,void 0,(function*(){if(!this.options)return;const t=Array.isArray(this.options)?this.options:[this.options],{graph:e}=this.context;QG(e,new XG(xu.BEFORE_LAYOUT));for(const n of t){const r=t.indexOf(n),i=this.getLayoutData(n),o=Object.assign(Object.assign({},this.presetOptions),n);QG(e,new XG(xu.BEFORE_STAGE_LAYOUT,{options:o,index:r}));const a=yield this.stepLayout(i,o,r);QG(e,new XG(xu.AFTER_STAGE_LAYOUT,{options:o,index:r})),n.animation||this.updateElementPosition(a,!1)}QG(e,new XG(xu.AFTER_LAYOUT)),this.transformDataAfterLayout()}))}transformDataAfterLayout(){const t=this.context.transform.getTransformInstance();Object.values(t).forEach((t=>t.afterLayout()))}simulate(){return vW(this,void 0,void 0,(function*(){if(!this.options)return{};const t=Array.isArray(this.options)?this.options:[this.options];let e={};for(const n of t){const r=t.indexOf(n),i=this.getLayoutData(n);e=yield this.stepLayout(i,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),r)}return e}))}stepLayout(t,e,n){return vW(this,void 0,void 0,(function*(){return function(t){const{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.treeLayout(t,e,n):yield this.graphLayout(t,e,n)}))}graphLayout(t,e,n){return vW(this,void 0,void 0,(function*(){const{animation:r,enableWorker:i,iterations:o=300}=e,a=this.initGraphLayout(e);if(!a)return{};if(this.instances[n]=a,this.instance=a,i){const e=a;return this.supervisor=new tI(e.graphData2LayoutModel(t),e.instance,{iterations:o}),cv(yield this.supervisor.execute())}if(hx(a))return r?yield a.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(a.execute(t),a.stop(),a.tick(o));const s=yield a.execute(t);if(r){const t=this.updateElementPosition(s,r);yield null==t?void 0:t.finished}return s}))}treeLayout(t,e,n){return vW(this,void 0,void 0,(function*(){const{type:n,animation:r}=e,i=Su("layout",n);if(!i)return{};const{nodes:o=[],edges:a=[]}=t,s=new ov({nodes:o.map((t=>({id:xh(t),data:t.data||{}}))),edges:a.map((t=>({id:xh(t),source:t.source,target:t.target,data:t.data||{}})))});!function(t){if(t.hasTreeStructure(Mu))return;t.attachTreeStructure(Mu);const e=t.getAllEdges();for(const n of e){const{source:e,target:r}=n;t.setParent(r,e,Mu)}}(s);const l={nodes:[],edges:[]},c={nodes:[],edges:[]};s.getRoots(Mu).forEach((t=>{wd(t,(t=>{t.children=s.getSuccessors(t.id)}),(t=>s.getSuccessors(t.id)),"TB");const n=i(t,e),{x:r,y:o,z:a=0}=n;wd(n,(t=>{const{id:e,x:n,y:i,z:s=0}=t;l.nodes.push({id:e,style:{x:r,y:o,z:a}}),c.nodes.push({id:e,style:{x:n,y:i,z:s}})}),(t=>t.children),"TB")}));const u=this.inferTreeLayoutOffset(c);if(bW(c,u),r){bW(l,u),this.updateElementPosition(l,!1);const t=this.updateElementPosition(c,r);yield null==t?void 0:t.finished}return c}))}inferTreeLayoutOffset(t){var e;let[n,r]=[1/0,-1/0],[i,o]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach((t=>{const{x:e=0,y:a=0}=t.style||{};n=Math.min(n,e),r=Math.max(r,e),i=Math.min(i,a),o=Math.max(o,a)}));const{canvas:a}=this.context,s=a.getSize(),[l,c]=a.getCanvasByViewport([0,0]),[u,h]=a.getCanvasByViewport(s);if(n>=l&&r<=u&&i>=c&&o<=h)return[0,0];return[(l+u)/2-(n+r)/2,(c+h)/2-(i+o)/2]}stopLayout(){this.instance&&hx(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0}=t,{nodes:n,edges:r,combos:i}=this.context.model.getData(),o=t=>this.context.element.getElement(t),a=n.filter((t=>{const n=xh(t),r=o(n);return!!r&&(!$g(r)&&e(t))})),s=new Map(a.map((t=>[xh(t),t])));return{nodes:a,edges:r.filter((t=>{const{source:e,target:n}=t;return!(!s.has(e)||!s.has(n))})),combos:i}}initGraphLayout(t){var e;const{element:n,viewport:r}=this.context,{type:i,enableWorker:o,animation:a,iterations:s}=t,l=mW(t,["type","enableWorker","animation","iterations"]),[c,u]=r.getCanvasSize(),h=[c/2,u/2],d=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{const e=null==n?void 0:n.getElement(t.id),{size:r}=(null==e?void 0:e.attributes)||{};return r},f=Su("layout",i);if(!f)return _u(`The layout of ${i} is not registered.`);const p=Object.getPrototypeOf(f.prototype)===av.prototype?f:function(t,e){return class extends av{constructor(e,n){if(super(e,n),this.instance=new t({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>cv(t.tick(e))}}execute(t,e){return sv(this,void 0,void 0,(function*(){return cv(yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions(Me({},this.options,e))))}))}transformOptions(t){const{onTick:e}=t;return e?(t.onTick=t=>e(cv(t)),t):t}graphData2LayoutModel(t){const{nodes:n=[],edges:r=[],combos:i=[]}=t,o=n.map((t=>{const e=xh(t),{data:n,style:r,combo:i}=t,o=lv(t,["data","style","combo"]),a={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),i?{parentId:i}:{}),{style:r}),o)};return(null==r?void 0:r.x)&&Object.assign(a.data,{x:r.x}),(null==r?void 0:r.y)&&Object.assign(a.data,{y:r.y}),(null==r?void 0:r.z)&&Object.assign(a.data,{z:r.z}),a})),a=new Map(o.map((t=>[t.id,t]))),s=r.filter((t=>{const{source:e,target:n}=t;return a.has(e)&&a.has(n)})).map((t=>{const{source:e,target:n,data:r,style:i}=t;return{id:xh(t),source:e,target:n,data:Object.assign({},r),style:Object.assign({},i)}})),l=i.map((t=>({id:xh(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)}))),c=new ov({nodes:[...o,...l],edges:s});return e.model.model.hasTreeStructure(ku)&&(c.attachTreeStructure(ku),o.forEach((t=>{const n=e.model.model.getParent(t.id,ku);n&&c.hasNode(n.id)&&c.setParent(t.id,n.id,ku)}))),c}}}(f,this.context),g=new p(this.context),v={nodeSize:d,width:c,height:u,center:h};switch(g.id){case"d3-force":case"d3-force-3d":Object.assign(v,{center:{x:c/2,y:u/2,z:0}})}return Me(g.options,v,l),g}updateElementPosition(t,e){const{model:n,element:r}=this.context;return r?(n.updateData(t),r.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const bW=(t,e)=>{var n;const[r,i]=e;null===(n=t.nodes)||void 0===n||n.forEach((t=>{if(t.style){const{x:e=0,y:n=0}=t.style;t.style.x=e+r,t.style.y=n+i}else t.style={x:r,y:i}}))};class xW extends Rh{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;_u(`Cannot find the plugin ${t}, will try to find it by type.`);const n=this.extensions.find((e=>e.type===t));return n?this.extensionMap[n.key]:void 0}}const EW=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class wW extends Rh{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...EW.slice(0,EW.length-1),...t,EW[EW.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var kW=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class MW{get padding(){return Yu(this.context.options.padding)}get paddingOffset(){const[t,e,n,r]=this.padding,[i,o,a]=[(r-e)/2,(t-n)/2,0];return[i,o,a]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,n]=this.paddingOffset,{zoom:r,rotation:i,x:o=e,y:a=n}=t.options;this.transform({mode:"absolute",scale:r,translate:[o,a],rotate:i},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{const r=Object.entries(t.getLayers()).filter((([t])=>!["main"].includes(t))).map((([,t])=>t.getCamera())),i=e[n];if("function"==typeof i)return(...t)=>{const o=i.apply(e,t);return r.forEach((e=>{e[n].apply(e,t)})),o}}})}createLandmark(t){return this.camera.createLandmark("landmark-"+this.landmarkCounter++,t)}getAnimation(t){const e=Ru(this.context.options,t);return!!e&&Ce(Object.assign({},e),["easing","duration"])}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:n,translate:r=[]}=t,i=this.getZoom(),o=e.getPosition(),a=e.getFocalPoint(),[s,l]=this.getCanvasCenter(),[c=0,u=0,h=0]=r,d=Gh([-c,-u,-h],i);return"relative"===n?{position:Bh(o,d),focalPoint:Bh(a,d)}:{position:Bh([s,l,o[2]],d),focalPoint:Bh([s,l,a[2]],d)}}getRotateOptions(t){const{mode:e,rotate:n=0}=t;return{roll:"relative"===e?this.camera.getRoll()+n:n}}getZoomOptions(t){const{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:r,scale:i=1}=t;return se("relative"===r?n*i:i,...e)}transform(t,e){return kW(this,void 0,void 0,(function*(){const{graph:n}=this.context,{translate:r,rotate:i,scale:o,origin:a}=t;this.cancelAnimation();const s=this.getAnimation(e);if(QG(n,new JG(xu.BEFORE_TRANSFORM,t)),!i&&o&&!r&&a&&!s)return this.camera.setZoomByViewportPoint(this.getZoomOptions(t),a),void QG(n,new JG(xu.AFTER_TRANSFORM,t));const l={};if(r&&Object.assign(l,this.getTranslateOptions(t)),le(i)&&Object.assign(l,this.getRotateOptions(t)),le(o)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),s)return QG(n,new KG(xu.BEFORE_ANIMATE,pu.TRANSFORM,null,t)),new Promise((e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},s),{onfinish:()=>{QG(n,new KG(xu.AFTER_ANIMATE,pu.TRANSFORM,null,t)),QG(n,new JG(xu.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}}))}));this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),QG(n,new JG(xu.AFTER_TRANSFORM,t))}))}fitView(t,e){return kW(this,void 0,void 0,(function*(){const[n,r,i,o]=this.padding,{when:a="always",direction:s="both"}=t||{},[l,c]=this.context.canvas.getSize(),u=l-o-r,h=c-n-i,d=this.context.canvas.getBounds(),f=this.getBBoxInViewport(d),[p,g]=Zu(f);if("overflow"===a&&!("x"===s&&p>=u||"y"===s&&g>=h||"both"===s&&p>=u&&g>=h))return yield this.fitCenter(e);const v=u/p,m=h/g,y="x"===s?v:"y"===s?m:Math.min(v,m),b=this.getAnimation(e);yield this.transform({mode:"relative",scale:y,translate:Bh(zh(this.getCanvasCenter(),this.getBBoxInViewport(d).center),Gh(this.paddingOffset,y))},b)}))}fitCenter(t){return kW(this,void 0,void 0,(function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)}))}focusElements(t,e){return kW(this,void 0,void 0,(function*(){const{element:n}=this.context;if(!n)return;const r=eh(t.map((t=>n.getElement(t).getRenderBounds())));yield this.focus(r,e)}))}focus(t,e){return kW(this,void 0,void 0,(function*(){const n=this.context.graph.getViewportByCanvas(t.center),r=zh(this.getCanvasCenter(),n);yield this.transform({mode:"relative",translate:Bh(r,this.paddingOffset)},e)}))}getBBoxInViewport(t){const{min:e,max:n}=t,{graph:r}=this.context,[i,o]=r.getViewportByCanvas(e),[a,s]=r.getViewportByCanvas(n),l=new Yr;return l.setMinMax([i,o,0],[a,s,0]),l}isInViewport(t,e=!1,n=0){const{graph:r}=this.context,i=this.getCanvasSize(),[o,a]=r.getCanvasByViewport([0,0]),[s,l]=r.getCanvasByViewport(i);let c=new Yr;return c.setMinMax([o,a,0],[s,l,0]),n&&(c=th(c,n)),Hu(t)?nh(t,c):e?function(t,e){const[n,r]=t.min,[i,o]=t.max,[a,s]=e.min,[l,c]=e.max;return n>=a&&i<=l&&r>=s&&o<=c}(t,c):c.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}var NW=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};class OW extends tv{constructor(t){var e;super(),this.rendered=!1,this.destroyed=!1,this.context={model:new fW},this.isCollapsingExpanding=!1,this.onResize=xe((()=>{this.resize()}),300),this.options=Object.assign({},OW.defaultOptions,t),this._setOptions(this.options,!0),this.context.graph=this,this.options.autoResize&&(null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),e){const{data:e}=t;return void(e&&this.addData(e))}Object.assign(this.options,t);const{behaviors:n,combo:r,data:i,edge:o,layout:a,node:s,plugins:l,theme:c,transforms:u}=t;n&&this.setBehaviors(n),i&&this.setData(i),s&&this.setNode(s),o&&this.setEdge(o),r&&this.setCombo(r),a&&this.setLayout(a),c&&this.setTheme(c),l&&this.setPlugins(l),u&&this.setTransforms(u)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=Yt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=Yt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=Yt(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=Yt(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=Yt(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms((e=>e.map((e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)))),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map((t=>this.context.model.getElementDataById(t))):this.context.model.getElementDataById(t)}getNodeData(t){var e;return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):null===(e=this.context.model.getNodeData([t]))||void 0===e?void 0:e[0]}getEdgeData(t){var e;return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):null===(e=this.context.model.getEdgeData([t]))||void 0===e?void 0:e[0]}getComboData(t){var e;return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):null===(e=this.context.model.getComboData([t]))||void 0===e?void 0:e[0]}setData(t){this.context.model.setData(Yt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(Yt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(Yt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(Yt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(Yt(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData(Yt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(Yt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(Yt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(Yt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(Yt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(Yt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(Yt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(Yt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return NW(this,void 0,void 0,(function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;const{container:e="container",width:n,height:r,renderer:i,cursor:o,background:a,canvas:s,devicePixelRatio:l=(null!==(t=globalThis.devicePixelRatio)&&void 0!==t?t:1)}=this.options;if(e instanceof HG)this.context.canvas=e,o&&e.setCursor(o),i&&e.setRenderer(i),yield e.ready;else{const t=ie(e)?document.getElementById(e):e,c=nI(t);this.emit(xu.BEFORE_CANVAS_INIT,{container:t,width:n,height:r});const u=Object.assign(Object.assign({},s),{container:t,width:n||c[0],height:r||c[1],background:a,renderer:i,cursor:o,devicePixelRatio:l}),h=new HG(u);this.context.canvas=h,yield h.ready,this.emit(xu.AFTER_CANVAS_INIT,{canvas:h})}}))}updateCanvas(t){var e,n;const{renderer:r,cursor:i,height:o,width:a}=t,s=this.context.canvas;s&&(r&&(this.emit(xu.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),s.setRenderer(r),this.emit(xu.AFTER_RENDERER_CHANGE,{renderer:r})),i&&s.setCursor(i),(le(a)||le(o))&&this.setSize(null!==(e=null!=a?a:this.options.width)&&void 0!==e?e:0,null!==(n=null!=o?o:this.options.height)&&void 0!==n?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new iW(this.context)),this.context.plugin||(this.context.plugin=new xW(this.context)),this.context.viewport||(this.context.viewport=new MW(this.context)),this.context.transform||(this.context.transform=new wW(this.context)),this.context.element||(this.context.element=new gW(this.context)),this.context.animation||(this.context.animation=new rW(this.context)),this.context.layout||(this.context.layout=new yW(this.context)),this.context.behavior||(this.context.behavior=new oW(this.context))}prepare(){return NW(this,void 0,void 0,(function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(Tu("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()}))}render(){return NW(this,void 0,void 0,(function*(){yield this.prepare(),QG(this,new XG(xu.BEFORE_RENDER));const t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.layout()]),yield this.autoFit(),this.rendered=!0,QG(this,new XG(xu.AFTER_RENDER))}))}draw(){return NW(this,void 0,void 0,(function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished}))}layout(){return NW(this,void 0,void 0,(function*(){yield this.context.layout.layout()}))}stopLayout(){this.context.layout.stopLayout()}clear(){return NW(this,void 0,void 0,(function*(){this.context.model.setData({}),yield this.draw()}))}destroy(){var t;QG(this,new XG(xu.BEFORE_DESTROY));const{layout:e,animation:n,element:r,model:i,canvas:o,behavior:a,plugin:s}=this.context;null==s||s.destroy(),null==a||a.destroy(),null==e||e.destroy(),null==n||n.destroy(),null==r||r.destroy(),i.destroy(),null==o||o.destroy(),this.options={},this.context={},this.off(),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,QG(this,new XG(xu.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var n;const r=nI(null===(n=this.context.canvas)||void 0===n?void 0:n.getContainer()),i=[t||r[0],e||r[1]];if(!this.context.canvas)return;const o=this.context.canvas.getSize();Se(i,o)||(QG(this,new XG(xu.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),QG(this,new XG(xu.AFTER_SIZE_CHANGE,{size:i})))}fitView(t,e){return NW(this,void 0,void 0,(function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.fitView(t,e)}))}fitCenter(t){return NW(this,void 0,void 0,(function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter(t)}))}autoFit(){return NW(this,void 0,void 0,(function*(){const{autoFit:t}=this.context.options;if(t)if(ie(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{const{type:e,animation:n}=t;"view"===e?yield this.fitView(t.options,n):"center"===e&&(yield this.fitCenter(n))}}))}focusElement(t,e){return NW(this,void 0,void 0,(function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.focusElements(Array.isArray(t)?t:[t],e)}))}zoomBy(t,e,n){return NW(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)}))}zoomTo(t,e,n){return NW(this,void 0,void 0,(function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)}))}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return NW(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)}))}rotateTo(t,e,n){return NW(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)}))}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return NW(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)}))}translateTo(t,e){return NW(this,void 0,void 0,(function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)}))}getPosition(){return zh([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return NW(this,arguments,void 0,(function*(t,e,n=!0){var r,i;const[o,a]=Kt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n];Object.entries(o).forEach((([t,e])=>this.context.model.translateNodeLikeBy(t,e))),yield null===(i=this.context.element.draw({animation:a,stage:"translate"}))||void 0===i?void 0:i.finished}))}translateElementTo(t,e){return NW(this,arguments,void 0,(function*(t,e,n=!0){var r,i;const[o,a]=Kt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n];Object.entries(o).forEach((([t,e])=>this.context.model.translateNodeLikeTo(t,e))),yield null===(i=this.context.element.draw({animation:a,stage:"translate"}))||void 0===i?void 0:i.finished}))}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return Pe(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return NW(this,arguments,void 0,(function*(t,e,n=!0){var r,i;const[o,a]=Kt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(o).forEach((([t,e])=>{const n=this.getElementType(t);s[`${n}s`].push({id:t,style:{visibility:e}})}));const{model:l,element:c}=this.context;l.preventUpdateNodeLikeHierarchy((()=>{l.updateData(s)})),yield null===(i=c.draw({animation:a,stage:"visibility"}))||void 0===i?void 0:i.finished}))}showElement(t,e){return NW(this,void 0,void 0,(function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map((t=>[t,"visible"]))),e)}))}hideElement(t,e){return NW(this,void 0,void 0,(function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map((t=>[t,"hidden"]))),e)}))}getElementVisibility(t){var e,n;const r=this.context.element.getElement(t);return null!==(n=null===(e=null==r?void 0:r.style)||void 0===e?void 0:e.visibility)&&void 0!==n?n:"visible"}setElementZIndex(t,e){return NW(this,void 0,void 0,(function*(){var n;const r={nodes:[],edges:[],combos:[]},i=Kt(t)?t:{[t]:e};Object.entries(i).forEach((([t,e])=>{const n=this.getElementType(t);r[`${n}s`].push({id:t,style:{zIndex:e}})}));const{model:o,element:a}=this.context;o.preventUpdateNodeLikeHierarchy((()=>o.updateData(r))),yield null===(n=a.draw({animation:!1,stage:"zIndex"}))||void 0===n?void 0:n.finished}))}frontElement(t){return NW(this,void 0,void 0,(function*(){const e=Array.isArray(t)?t:[t],{model:n,element:r}=this.context,i={};e.map((t=>{const e=r.getFrontZIndex(t);if("combo"===n.getElementType(t)){const o=n.getAncestorsData(t,ku).at(-1)||this.getComboData(t),a=[o,...n.getDescendantsData(xh(o))],s=e-r.getElementZIndex(t);a.forEach((t=>{i[xh(t)]=this.getElementZIndex(xh(t))+s}));const{internal:l}=sg(a.map(xh),(t=>n.getRelatedEdgesData(t)));l.forEach((t=>{const e=xh(t);i[e]=this.getElementZIndex(e)+s}))}else i[t]=e})),yield this.setElementZIndex(i)}))}getElementZIndex(t){var e,n,r;const{model:i,element:o}=this.context;return null!==(r=null===(n=null===(e=i.getElementDataById(t))||void 0===e?void 0:e.style)||void 0===n?void 0:n.zIndex)&&void 0!==r?r:o.getElementZIndex(t)}setElementState(t,e){return NW(this,arguments,void 0,(function*(t,e,n=!0){var r,i;const[o,a]=Kt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(o).forEach((([t,e])=>{const n=this.getElementType(t);var r;s[`${n}s`].push({id:t,states:(r=e,r?Array.isArray(r)?r:[r]:[])})})),this.updateData(s),yield null===(i=this.context.element.draw({animation:a,stage:"state"}))||void 0===i?void 0:i.finished}))}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return NW(this,arguments,void 0,(function*(t,e=!0){const{model:n,element:r}=this.context;if(Td(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;const i=n.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),"node"===i?yield r.collapseNode(t,e):"combo"===i&&(yield r.collapseCombo(t,e)),this.isCollapsingExpanding=!1}))}expandElement(t){return NW(this,arguments,void 0,(function*(t,e=!0){const{model:n,element:r}=this.context;if(!Td(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;const i=n.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),"node"===i?yield r.expandNode(t,e):"combo"===i&&(yield r.expandCombo(t,e)),this.isCollapsingExpanding=!1}))}setElementCollapsibility(t,e){const n=this.getElementType(t);"node"===n?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===n&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return NW(this,arguments,void 0,(function*(t={}){return this.context.canvas.toDataURL(t)}))}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}OW.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};const SW=(t,e)=>{const{source:n,target:r}=e,i=t.getElementDataById(n),o=t.getElementDataById(r),a=lg(i,(e=>t.getParentData(e,ku))),s=lg(o,(e=>t.getParentData(e,ku))),l={sourceNode:xh(a),targetNode:xh(s)};return e.style?Object.assign(e.style,l):e.style=l,e};class TW extends LG{constructor(t,e){super(t,Me({},TW.defaultOptions,e)),this.assignSizeByCentrality=(t,e,n,r,i,o)=>{const a=[e,n],s=[r[0],i[0]],l=[r[1],i[1]],c=[r[2],i[2]],u=(t,e)=>{if("function"==typeof o)return o(t,a,e);switch(o){case"linear":return((t,e,n)=>{const[r,i]=e,[o,a]=n;return i===r?o:o+(t-r)/(i-r)*(a-o)})(t,a,e);case"log":return((t,e,n)=>{const[r,i]=e,[o,a]=n;return o+Math.log(t-r+1)/Math.log(i-r+1)*(a-o)})(t,a,e);case"pow":return((t,e,n,r=2)=>{const[i,o]=e,[a,s]=n;return a+Math.pow((t-i)/(o-i),r)*(s-a)})(t,a,e,2);case"sqrt":return((t,e,n)=>{const[r,i]=e,[o,a]=n;return o+Math.sqrt((t-r)/(i-r))*(a-o)})(t,a,e);default:return e[0]}};return[u(t,s),u(t,l),u(t,c)]}}beforeDraw(t){const{model:e}=this.context,n=e.getNodeData(),r=Rd(this.options.maxSize),i=Rd(this.options.minSize),o=this.getCentralities(this.options.centrality),a=o.size>0?Math.max(...o.values()):0,s=o.size>0?Math.min(...o.values()):0;return n.forEach((e=>{var n;const l=this.assignSizeByCentrality(o.get(xh(e))||0,s,a,i,r,this.options.scale),c=null===(n=this.context.element)||void 0===n?void 0:n.getElement(xh(e)),u={size:l};this.assignLabelStyle(u,l,e,c),c&&jG(u,c.attributes)||IG(t,c?"update":"add","node",Me(e,{style:u}),!0)})),t}assignLabelStyle(t,e,n,r){var i;const o=r?r.config.style:null===(i=this.context.element)||void 0===i?void 0:i.getElementComputedStyle("node",n);if(Object.assign(t,Ce(o,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const n=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:n,labelLineHeight:n+qu(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,n){const r=Math.min(...t)/2,[i,o]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e];return Math.min(o,Math.max(r,i))}getCentralities(t){const{model:e}=this.context,n=e.getData();if("function"==typeof t)return t(n);const r=e.getRelatedEdgesData.bind(e);return kh(n,r,t)}}TW.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class _W extends LG{constructor(t,e){super(t,Object.assign({},_W.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=ed(this.ref),{graph:n,model:r}=this.context;null===(t=r.getData().nodes)||void 0===t||t.forEach((t=>{if(xh(t)===xh(this.ref))return;const i=Zh(zh(ed(t),e)),o=Math.abs(i)>Math.PI/2,a=!t.children||0===t.children.length,s=(a?1:-1)*(Rd(n.getElementRenderStyle(xh(t)).size)[0]/2+this.options.offset),l=[["translate",s*Math.cos(i),s*Math.sin(i)],["rotate",o?si(i)+180:si(i)]];r.updateNodeData([{id:xh(t),style:{labelTextAlign:o===a?"right":"left",labelTextBaseline:"middle",labelTransform:l}}])})),n.draw()}}_W.defaultOptions={offset:5};const AW=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class CW extends LG{constructor(t,e){super(t,Object.assign({},CW.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{const{add:{edges:e},update:{nodes:n,edges:r,combos:i},remove:{edges:o}}=t,{model:a}=this.context,s=new Map,l=(t,e)=>{a.getRelatedEdgesData(e).forEach((t=>!s.has(xh(t))&&s.set(xh(t),t)))};n.forEach(l),i.forEach(l);const c=t=>{const e=a.getEdgeData().map((t=>SW(a,t)));DW(t,e).forEach((t=>!s.has(xh(t))&&s.set(xh(t),t)))};if(o.size&&o.forEach(c),e.size&&e.forEach(c),r.size){const t=hj(uj(a.getChanges())).update.edges;r.forEach((e=>{var n;c(e);const r=null===(n=t.find((t=>xh(t.value)===xh(e))))||void 0===n?void 0:n.original;r&&!RW(e,r)&&c(r)}))}Oe(this.options.edges)||s.forEach(((t,e)=>!this.options.edges.includes(e)&&s.delete(e)));const u=a.getEdgeData().map(xh);return new Map([...s].sort(((t,e)=>u.indexOf(t[0])-u.indexOf(e[0]))))},this.applyBundlingStyle=(t,e,n)=>{const{edgeMap:r,reverses:i}=PW(e);r.forEach((e=>{e.forEach(((e,r,o)=>{var a;const s=o.length,l=e.style||{};if(e.source===e.target){const t=AW.length;l.loopPlacement=AW[r%t],l.loopDist=Math.floor(r/t)*n+50}else if(1===s)l.curveOffset=0;else{const t=(r%2==0?1:-1)*(i[`${e.source}|${e.target}|${r}`]?-1:1);l.curveOffset=s%2==1?t*Math.ceil(r/2)*n*2:t*(Math.floor(r/2)*n*2+n)}const c=Object.assign(e,{type:"quadratic",style:l}),u=null===(a=this.context.element)||void 0===a?void 0:a.getElement(xh(e));u&&jG(c.style,u.attributes)||IG(t,u?"update":"add","edge",c,!0)}))}))},this.resetEdgeStyle=t=>{const e=t.style||{},n=this.cacheMergeStyle.get(xh(t))||{};return Object.keys(n).forEach((r=>{Se(e[r],n[r])&&(t[r]?e[r]=t[r]:delete e[r])})),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{const{edgeMap:n,reverses:r}=PW(e);n.forEach((e=>{var n;if(1===e.length){const r=e[0],i=null===(n=this.context.element)||void 0===n?void 0:n.getElement(xh(r)),o=this.resetEdgeStyle(r);return void(i&&jG(o,i.attributes)||IG(t,i?"update":"add","edge",o))}const i=e.map((({source:t,target:e,style:n={}},i)=>{const{startArrow:o,endArrow:a}=n,s={},[l,c]=r[`${t}|${e}|${i}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return ve(o)&&(s[l]=o),ve(a)&&(s[c]=a),s})).reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{});e.forEach(((e,n,r)=>{var o;if(0!==n)return void IG(t,"remove","edge",e);const a=Object.assign({},Yt(this.options.style)?this.options.style(r):this.options.style,{childrenData:r});this.cacheMergeStyle.set(xh(e),a);const s=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),i),a)}),l=null===(o=this.context.element)||void 0===o?void 0:o.getElement(xh(e));l&&jG(s.style,l.attributes)||IG(t,l?"update":"add","edge",s,!0)}))}))}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}CW.defaultOptions={mode:"bundle",distance:15};const PW=t=>{const e=new Map,n=new Set,r={};for(const[i,o]of t){if(n.has(i))continue;const{source:a,target:s}=o,l=`${a}-${s}`;e.has(l)||e.set(l,[]),e.get(l).push(o),n.add(i);for(const[i,c]of t)n.has(i)||RW(o,c)&&(e.get(l).push(c),n.add(i),a===c.target&&s===c.source&&(r[`${c.source}|${c.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:r}},DW=(t,e,n)=>e.filter((e=>RW(e,t))),RW=(t,e)=>{const{sourceNode:n,targetNode:r}=t.style||{},{sourceNode:i,targetNode:o}=e.style||{};return n===i&&r===o||n===o&&r===i};const LW={animation:{"combo-collapse":Wu,"combo-expand":$u,"node-collapse":Bu,"node-expand":zu,"path-in":Vu,"path-out":Gu,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":yd,"click-select":Sd,"collapse-expand":Ug,"create-edge":Xg,"drag-canvas":Zg,"drag-element-force":class extends Qg{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find((t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id)))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(_u("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){return dv(this,void 0,void 0,(function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach(((r,i)=>{const{x:o=0,y:a=0}=r.style||{};n&&uv(n,"setFixedPosition",t[i],[...Bh([+o,+a],e)])}))}))}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&hv(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach((t=>{const{x:n=0,y:r=0}=t.style||{};e&&uv(e,"setFixedPosition",xh(t),[+n,+r])}))}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&hv(t,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach((e=>{t&&uv(t,"setFixedPosition",xh(e),[null,null,null])}))}},"drag-element":Qg,"fix-element-size":pv,"focus-element":vv,"hover-activate":mv,"lasso-select":class extends yd{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e}=this.context;this.pathShape=new Hl({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[bd(t)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:n,mode:r}=this.options;this.points.push(bd(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t,e=!0){const n=[];return t.forEach(((t,e)=>{n.push([0===e?"M":"L",...t])})),e&&n.push(["Z"]),n}(this.points)),n&&"default"===r&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){this.points&&(this.points.length<2||super.updateElementsStates(this.points),this.clearLasso())}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"auto-adapt-label":jh,"optimize-viewport-transform":yv,"scroll-canvas":xv,"zoom-canvas":Kv},combo:{circle:class extends zp{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Rl,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,n=super.getKeyStyle(t),[r]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&Cd(n,"collapsed")),{r:r/2})}getCollapsedKeySize(t){const[e,n]=Rd(t.collapsedSize),r=Math.max(e,n)/2;return[2*r,2*r,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[n,r]=Zu(e),i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2))/2;return[2*i,2*i,0]}getIntersectPoint(t,e=!1){return hd(t,this.getShape("key").getBounds(),e)}},rect:class extends zp{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Kl,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,r]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&Cd(e,"collapsed")),{width:n,height:r,x:-n/2,y:-r/2})}}},edge:{cubic:fg,line:mg,polyline:Tg,quadratic:_g,"cubic-horizontal":pg,"cubic-radial":gg,"cubic-vertical":vg},layout:{"antv-dagre":class{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},pb),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericDagreLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericDagreLayout(!0,t,e)}))}genericDagreLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{nodeSize:i,align:o,rankdir:a="TB",ranksep:s,nodesep:l,ranksepFunc:c,nodesepFunc:u,edgeLabelSpace:h,ranker:d,nodeOrder:f,begin:p,controlPoints:g,radial:v,sortByCombo:m,preset:y}=r,b=new ov({tree:[]}),x=hb(s||50,c),E=hb(l||50,u);let w=E,k=x;"LR"!==a&&"RL"!==a||(w=x,k=E);const M=db(10,i,!1),N=e.getAllNodes(),O=e.getAllEdges();let S;N.forEach((t=>{const e=ub(M(t)),n=k(t),r=w(t),i=e[0]+2*r,o=e[1]+2*n,a=t.data.layer;le(a)?b.addNode({id:t.id,data:{width:i,height:o,layer:a}}):b.addNode({id:t.id,data:{width:i,height:o}})})),m&&(b.attachTreeStructure("combo"),N.forEach((t=>{const{parentId:e}=t.data;void 0!==e&&b.hasNode(e)&&b.setParent(t.id,e,"combo")}))),O.forEach((t=>{b.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})})),(null==y?void 0:y.length)&&(S=new ov({nodes:y})),((t,e)=>{const{edgeLabelSpace:n,keepNodeOrder:r,prevGraph:i,rankdir:o,ranksep:a}=e;!r&&i&&Ly(t,i);const s=Gy(t);let l;n&&(e.ranksep=Wy(s,{rankdir:o,ranksep:a}));try{l=Ry(s,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}Iy(t,s)})(b,{prevGraph:S,edgeLabelSpace:h,keepNodeOrder:!!f,nodeOrder:f||[],acyclicer:"greedy",ranker:d,rankdir:a,nodesep:l,align:o});const T=[0,0];if(p){let t=1/0,e=1/0;b.getAllNodes().forEach((n=>{t>n.data.x&&(t=n.data.x),e>n.data.y&&(e=n.data.y)})),b.getAllEdges().forEach((n=>{var r;null===(r=n.data.points)||void 0===r||r.forEach((n=>{t>n.x&&(t=n.x),e>n.y&&(e=n.y)}))})),T[0]=p[0]-t,T[1]=p[1]-e}const _="LR"===a||"RL"===a;if(v);else{const t=new Set,e="BT"===a||"RL"===a?(t,e)=>e-t:(t,e)=>t-e;b.getAllNodes().forEach((e=>{e.data.x=e.data.x+T[0],e.data.y=e.data.y+T[1],t.add(_?e.data.x:e.data.y)}));const n=Array.from(t).sort(e),r=_?(t,e)=>t.x!==e.x:(t,e)=>t.y!==e.y,i=_?(t,e,n)=>{const r=Math.max(e.y,n.y),i=Math.min(e.y,n.y);return t.filter((t=>t.y<=r&&t.y>=i))}:(t,e,n)=>{const r=Math.max(e.x,n.x),i=Math.min(e.x,n.x);return t.filter((t=>t.x<=r&&t.x>=i))};b.getAllEdges().forEach(((t,e)=>{var o;h&&g&&"loop"!==t.data.type&&(t.data.controlPoints=gb(null===(o=t.data.points)||void 0===o?void 0:o.map((({x:t,y:e})=>({x:t+T[0],y:e+T[1]}))),b.getNode(t.source),b.getNode(t.target),n,_,r,i))}))}let A=[];A=b.getAllNodes().map((t=>cb(t)));const C=b.getAllEdges();t&&(A.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),C.forEach((t=>{e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})})));return{nodes:A,edges:C}}))}},"combo-combined":class{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},fx),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericComboCombinedLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericComboCombinedLayout(!0,t,e)}))}genericComboCombinedLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:i,treeKey:o,outerLayout:a}=r,s=e.getAllNodes().filter((t=>!t.data._isCombo)),l=e.getAllNodes().filter((t=>t.data._isCombo)),c=e.getAllEdges(),u=null==s?void 0:s.length;if(!u||1===u)return vb(e,t,i);const h=[],d=new Map;s.forEach((t=>{d.set(t.id,t)}));const f=new Map;l.forEach((t=>{f.set(t.id,t)}));const p=new Map,g=this.getInnerGraphs(e,o,d,f,c,r,p);yield Promise.all(g);const v=new Map,m=[],y=new Map;let b=!0;e.getRoots(o).forEach((t=>{const n=p.get(t.id),r=f.get(t.id)||d.get(t.id),i={id:t.id,data:Object.assign(Object.assign({},t.data),{x:n.data.x||r.data.x,y:n.data.y||r.data.y,fx:n.data.fx||r.data.fx,fy:n.data.fy||r.data.fy,mass:n.data.mass||r.data.mass,size:n.data.size})};m.push(i),v.set(t.id,!0),isNaN(i.data.x)||0===i.data.x||isNaN(i.data.y)||0===i.data.y?(i.data.x=100*Math.random(),i.data.y=100*Math.random()):b=!1,sb(e,[t],(e=>{e.id!==t.id&&y.set(e.id,t.id)}),"TB",o)}));const x=[];let E;if(c.forEach((t=>{const e=y.get(t.source)||t.source,n=y.get(t.target)||t.target;e!==n&&v.has(e)&&v.has(n)&&x.push({id:t.id,source:e,target:n,data:{}})})),null==m?void 0:m.length){if(1===m.length)m[0].data.x=i[0],m[0].data.y=i[1];else{const t=new ov({nodes:m,edges:x}),e=a||new Wb;if(b&&dx[e.id]){const e=m.length<100?new lx:new Eb;yield e.assign(t)}const n=Object.assign({center:i,kg:5,preventOverlap:!0,animate:!1},"force"===e.id?{gravity:1,factor:4,linkDistance:(t,e,n)=>(Math.max(...e.data.size)||32)/2+(Math.max(...n.data.size)||32)/2+200}:{});E=yield px(e,t,n)}p.forEach((t=>{var e;const n=E.nodes.find((e=>e.id===t.id));if(n){const{x:e,y:r}=n.data;t.data.visited=!0,t.data.x=e,t.data.y=r,h.push({id:t.id,data:{x:e,y:r}})}const{x:r,y:i}=t.data;null===(e=t.data.nodes)||void 0===e||e.forEach((t=>{h.push({id:t.id,data:{x:t.data.x+r,y:t.data.y+i}})}))})),p.forEach((({data:t})=>{const{x:e,y:n,visited:r,nodes:i}=t;null==i||i.forEach((t=>{if(!r){const r=h.find((e=>e.id===t.id));r.data.x+=e||0,r.data.y+=n||0}}))}))}t&&h.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}));return{nodes:h,edges:c}}))}initVals(t){const e=Object.assign({},t),{nodeSize:n,spacing:r,comboPadding:i}=t;let o,a,s;if(a=le(r)?()=>r:Yt(r)?r:()=>0,e.spacing=a,n)if(Yt(n))o=t=>{const e=n(t),r=a(t);if(rb(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+r)/2}return((e||32)+r)/2};else if(rb(n)){const t=(n[0]>n[1]?n[0]:n[1])/2;o=e=>t+a(e)/2}else{const t=n/2;o=e=>t+a(e)/2}else o=t=>{const e=a(t);if(t.size){if(rb(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2}if(Kt(t.size)){return((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2}return(t.size+e)/2}return 32+e/2};return e.nodeSize=o,s=le(i)?()=>i:rb(i)?()=>Math.max.apply(null,i):Yt(i)?i:()=>0,e.comboPadding=s,e}getInnerGraphs(t,e,n,r,i,o,a){const{nodeSize:s,comboPadding:l,spacing:c,innerLayout:u}=o,h=u||new Eb({}),d={center:[0,0],preventOverlap:!0,nodeSpacing:c},f=[],p=t=>{let e=(null==l?void 0:l(t))||10;return rb(e)&&(e=Math.max(...e)),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach((o=>{a.set(o.id,{id:o.id,data:{nodes:[],size:p(o).size}});let l=Promise.resolve();sb(t,[o],(o=>{var c;if(!o.data._isCombo)return;const{size:u,padding:f}=p(o);if(null===(c=t.getChildren(o.id,e))||void 0===c?void 0:c.length){const c=a.get(o.id);a.set(o.id,{id:o.id,data:Object.assign({nodes:[]},null==c?void 0:c.data)});const u=new Map,p=t.getChildren(o.id,e).map((t=>{if(t.data._isCombo)return a.has(t.id)||a.set(t.id,{id:t.id,data:Object.assign({},t.data)}),u.set(t.id,!0),a.get(t.id);const e=n.get(t.id)||r.get(t.id);return u.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}})),g={nodes:p,edges:i.filter((t=>u.has(t.source)&&u.has(t.target)))};let v=1/0;p.forEach((t=>{var e;let{size:n}=t.data;n||(n=(null===(e=a.get(t.id))||void 0===e?void 0:e.data.size)||(null==s?void 0:s(t))||[30,30]),le(n)&&(n=[n,n]);const[r,i]=n;v>r&&(v=r),v>i&&(v=i),t.data.size=n})),l=l.then((()=>Ve(this,void 0,void 0,(function*(){const t=new ov(g);yield px(h,t,d,!0);const{minX:e,minY:n,maxX:r,maxY:i}=(t=>{let e=1/0,n=1/0,r=-1/0,i=-1/0;return t.forEach((t=>{let o=t.data.size;rb(o)?1===o.length&&(o=[o[0],o[0]]):le(o)?o=[o,o]:(void 0===o||isNaN(o))&&(o=[30,30]);const a=[o[0]/2,o[1]/2],s=t.data.x-a[0],l=t.data.x+a[0],c=t.data.y-a[1],u=t.data.y+a[1];e>s&&(e=s),n>c&&(n=c),r<l&&(r=l),i<u&&(i=u)})),{minX:e,minY:n,maxX:r,maxY:i}})(p),s=(r+e)/2,l=(i+n)/2;g.nodes.forEach((t=>{t.data.x-=s,t.data.y-=l}));const c=[Math.max(r-e,v)+2*f,Math.max(i-n,v)+2*f];a.get(o.id).data.size=c,a.get(o.id).data.nodes=p}))))}else a.set(o.id,{id:o.id,data:Object.assign(Object.assign({},o.data),{size:u})});return!0}),"BT",e),f.push(l)})),f}},"compact-box":um.compactBox,"force-atlas2":class{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},gL),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericForceAtlas2Layout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericForceAtlas2Layout(!0,t,e)}))}genericForceAtlas2Layout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=e.getAllEdges(),i=e.getAllNodes(),o=this.formatOptions(n,i.length),{width:a,height:s,prune:l,maxIteration:c,nodeSize:u,center:h}=o;if(!(null==i?void 0:i.length)||1===i.length)return vb(e,t,h);const d=i.map((t=>cb(t,[a,s]))),f=r.filter((t=>{const{source:e,target:n}=t;return e!==n})),p=new ov({nodes:d,edges:f}),g=this.getSizes(p,u);if(this.run(p,e,c,g,t,o),l){for(let t=0;t<f.length;t+=1){const{source:e,target:n}=f[t],r=p.getDegree(e),i=p.getDegree(e);if(r<=1){const t=p.getNode(n);p.mergeNodeData(e,{x:t.data.x,y:t.data.y})}else if(i<=1){const t=p.getNode(e);p.mergeNodeData(n,{x:t.data.x,y:t.data.y})}}const n=Object.assign(Object.assign({},o),{prune:!1,barnesHut:!1});this.run(p,e,100,g,t,n)}return{nodes:d,edges:r}}))}getSizes(t,e){const n=t.getAllNodes(),r={};for(let t=0;t<n.length;t+=1){const i=n[t];r[i.id]=fb(e,void 0)(i)}return r}formatOptions(t={},e){const n=Object.assign(Object.assign({},this.options),t),{center:r,width:i,height:o,barnesHut:a,prune:s,maxIteration:l,kr:c,kg:u}=n;return n.width=i||"undefined"==typeof window?i:window.innerWidth,n.height=o||"undefined"==typeof window?o:window.innerHeight,n.center=r||[n.width/2,n.height/2],void 0===a&&e>250&&(n.barnesHut=!0),void 0===s&&e>100&&(n.prune=!0),0!==l||s?0===l&&s&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),c||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),u||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n}run(t,e,n,r,i,o){const{kr:a,barnesHut:s,onTick:l}=o,c=t.getAllNodes();let u=0,h=n;const d={},f={},p={};for(let e=0;e<c.length;e+=1){const{data:n,id:r}=c[e];if(d[r]=[0,0],s){const i={id:e,rx:n.x,ry:n.y,mass:1,g:a,degree:t.getDegree(r)};p[r]=new dL(i)}}for(;h>0;)u=this.oneStep(t,{iter:h,preventOverlapIters:50,krPrime:100,sg:u,forces:d,preForces:f,bodies:p,sizes:r},o),h--,null==l||l({nodes:c,edges:e.getAllEdges()});return t}oneStep(t,e,n){const{iter:r,preventOverlapIters:i,krPrime:o,sg:a,preForces:s,bodies:l,sizes:c}=e;let{forces:u}=e;const{preventOverlap:h,barnesHut:d}=n,f=t.getAllNodes();for(let t=0;t<f.length;t+=1){const{id:e}=f[t];s[e]=[...u[e]],u[e]=[0,0]}return u=this.getAttrForces(t,r,i,c,u,n),u=d&&(h&&r>i||!h)?this.getOptRepGraForces(t,u,l,n):this.getRepGraForces(t,r,i,u,o,c,n),this.updatePos(t,u,s,a,n)}getAttrForces(t,e,n,r,i,o){const{preventOverlap:a,dissuadeHubs:s,mode:l,prune:c}=o,u=t.getAllEdges();for(let o=0;o<u.length;o+=1){const{source:h,target:d}=u[o],f=t.getNode(h),p=t.getNode(d),g=t.getDegree(h),v=t.getDegree(d);if(c&&(g<=1||v<=1))continue;const m=[p.data.x-f.data.x,p.data.y-f.data.y];let y=Math.hypot(m[0],m[1]);y=y<1e-4?1e-4:y,m[0]=m[0]/y,m[1]=m[1]/y,a&&e<n&&(y=y-r[h]-r[d]);let b=y,x=b;"linlog"===l&&(b=Math.log(1+y),x=b),s&&(b=y/g,x=y/v),a&&e<n&&y<=0?(b=0,x=0):a&&e<n&&y>0&&(b=y,x=y),i[h][0]+=b*m[0],i[d][0]-=x*m[0],i[h][1]+=b*m[1],i[d][1]-=x*m[1]}return i}getOptRepGraForces(t,e,n,r){const{kg:i,center:o,prune:a}=r,s=t.getAllNodes(),l=s.length;let c=9e10,u=-9e10,h=9e10,d=-9e10;for(let e=0;e<l;e+=1){const{id:r,data:i}=s[e];a&&t.getDegree(r)<=1||(n[r].setPos(i.x,i.y),i.x>=u&&(u=i.x),i.x<=c&&(c=i.x),i.y>=d&&(d=i.y),i.y<=h&&(h=i.y))}const f=Math.max(u-c,d-h),p=new fL({xmid:(u+c)/2,ymid:(d+h)/2,length:f,massCenter:o,mass:l}),g=new pL(p);for(let e=0;e<l;e+=1){const{id:r}=s[e];a&&t.getDegree(r)<=1||n[r].in(p)&&g.insert(n[r])}for(let r=0;r<l;r+=1){const{id:l,data:c}=s[r],u=t.getDegree(l);if(a&&u<=1)continue;n[l].resetForce(),g.updateForce(n[l]),e[l][0]-=n[l].fx,e[l][1]-=n[l].fy;const h=[c.x-o[0],c.y-o[1]];let d=Math.hypot(h[0],h[1]);d=d<1e-4?1e-4:d,h[0]=h[0]/d,h[1]=h[1]/d;const f=i*(u+1);e[l][0]-=f*h[0],e[l][1]-=f*h[1]}return e}getRepGraForces(t,e,n,r,i,o,a){const{preventOverlap:s,kr:l,kg:c,center:u,prune:h}=a,d=t.getAllNodes(),f=d.length;for(let a=0;a<f;a+=1){const p=d[a],g=t.getDegree(p.id);for(let c=a+1;c<f;c+=1){const a=d[c],u=t.getDegree(a.id);if(h&&(g<=1||u<=1))continue;const f=[a.data.x-p.data.x,a.data.y-p.data.y];let v=Math.hypot(f[0],f[1]);v=v<1e-4?1e-4:v,f[0]=f[0]/v,f[1]=f[1]/v,s&&e<n&&(v=v-o[p.id]-o[a.id]);let m=l*(g+1)*(u+1)/v;s&&e<n&&v<0?m=i*(g+1)*(u+1):s&&e<n&&0===v?m=0:s&&e<n&&v>0&&(m=l*(g+1)*(u+1)/v),r[p.id][0]-=m*f[0],r[a.id][0]+=m*f[0],r[p.id][1]-=m*f[1],r[a.id][1]+=m*f[1]}const v=[p.data.x-u[0],p.data.y-u[1]],m=Math.hypot(v[0],v[1]);v[0]=v[0]/m,v[1]=v[1]/m;const y=c*(g+1);r[p.id][0]-=y*v[0],r[p.id][1]-=y*v[1]}return r}updatePos(t,e,n,r,i){const{ks:o,tao:a,prune:s,ksmax:l}=i,c=t.getAllNodes(),u=c.length,h=[],d=[];let f=0,p=0,g=r;for(let r=0;r<u;r+=1){const{id:i}=c[r],o=t.getDegree(i);if(s&&o<=1)continue;const a=[e[i][0]-n[i][0],e[i][1]-n[i][1]],l=Math.hypot(a[0],a[1]),u=[e[i][0]+n[i][0],e[i][1]+n[i][1]],g=Math.hypot(u[0],u[1]);h[r]=l,d[r]=g/2,f+=(o+1)*h[r],p+=(o+1)*d[r]}const v=g;g=a*p/f,0!==v&&(g=g>1.5*v?1.5*v:g);for(let n=0;n<u;n+=1){const{id:r,data:i}=c[n],a=t.getDegree(r);if(s&&a<=1)continue;if(le(i.fx)&&le(i.fy))continue;let u=o*g/(1+g*Math.sqrt(h[n])),d=Math.hypot(e[r][0],e[r][1]);d=d<1e-4?1e-4:d;const f=l/d;u=u>f?f:u;const p=u*e[r][0],v=u*e[r][1];t.mergeNodeData(r,{x:i.x+p,y:i.y+v})}return g}},circular:class{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},mb),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericCircularLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericCircularLayout(!0,t,e)}))}genericCircularLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{width:i,height:o,center:a,divisions:s,startAngle:l=0,endAngle:c=2*Math.PI,angleRatio:u,ordering:h,clockwise:d,nodeSpacing:f,nodeSize:p}=r,g=e.getAllNodes(),v=e.getAllEdges(),[m,y,b]=bb(i,o,a),x=null==g?void 0:g.length;if(!x||1===x)return vb(e,t,b);const E=(c-l)/x;let{radius:w,startRadius:k,endRadius:M}=r;if(f){const t=hb(10,f),e=db(10,p);let n=-1/0;g.forEach((t=>{const r=e(t);n<r&&(n=r)}));let r=0;g.forEach(((e,i)=>{r+=0===i?n||10:(t(e)||0)+(n||10)})),w=r/(2*Math.PI)}else w||k||M?!k&&M?k=M:k&&!M&&(M=k):w=Math.min(y,m)/2;const N=E*u;let O=[];O="topology"===h?yb(e,g):"topology-directed"===h?yb(e,g,!0):"degree"===h?function(t,e){const n=[];return e.forEach(((t,e)=>{n.push(cb(t))})),n.sort(((e,n)=>t.getDegree(e.id,"both")-t.getDegree(n.id,"both"))),n}(e,g):g.map((t=>cb(t)));const S=Math.ceil(x/s);for(let t=0;t<x;++t){let e=w;e||null===k||null===M||(e=k+t*(M-k)/(x-1)),e||(e=10+100*t/(x-1));let n=l+t%S*N+2*Math.PI/s*Math.floor(t/S);d||(n=c-t%S*N-2*Math.PI/s*Math.floor(t/S)),O[t].data.x=b[0]+Math.cos(n)*e,O[t].data.y=b[1]+Math.sin(n)*e}t&&O.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}));return{nodes:O,edges:v}}))}},concentric:Eb,"d3-force":class{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:kx,manyBody:Zx,center:gx,collide:xx,radial:Jx,x:Qx,y:tE},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Me(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericLayout(!0,t,e)}))}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const n=this.context.nodes.find((e=>e.id===t));n&&e.forEach(((t,e)=>{if("number"==typeof t||null===t){n[["fx","fy","fz"][e]]=t}}))}getOptions(t){var e,n;const r=Me({},this.options,t);return r.collide&&void 0===(null===(e=r.collide)||void 0===e?void 0:e.radius)&&(r.collide=r.collide||{},r.collide.radius=null!==(n=r.nodeSize)&&void 0!==n?n:10),void 0===r.iterations&&(r.link&&void 0===r.link.iterations&&(r.iterations=r.link.iterations),r.collide&&void 0===r.collide.iterations&&(r.iterations=r.collide.iterations)),this.context.options=r,r}genericLayout(t,e,n){var r;return Ve(this,void 0,void 0,(function*(){const i=this.getOptions(n),o=e.getAllNodes().map((({id:t,data:e})=>Object.assign(Object.assign({id:t},e),Ce(e.data,this.config.inputNodeAttrs)))),a=e.getAllEdges().map((t=>Object.assign({},t)));Object.assign(this.context,{assign:t,nodes:o,edges:a,graph:e});const s=new Promise((t=>{this.resolver=t})),l=this.setSimulation(i);return l.nodes(o),null===(r=l.force("link"))||void 0===r||r.links(a),s}))}getResult(){const{assign:t,nodes:e,edges:n,graph:r}=this.context,i=e.map((t=>({id:t.id,data:Object.assign(Object.assign({},t.data),Ce(t,this.config.outputNodeAttrs))}))),o=n.map((({id:t,source:e,target:n,data:r})=>({id:t,source:"object"==typeof e?e.id:e,target:"object"==typeof n?n.id:n,data:r})));return t&&i.forEach((t=>r.mergeNodeData(t.id,t.data))),{nodes:i,edges:o}}initSimulation(){return Kx()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",(()=>{var e;return null===(e=t.onTick)||void 0===e?void 0:e.call(t,this.getResult())})).on("end",(()=>{var t;return null===(t=this.resolver)||void 0===t?void 0:t.call(this,this.getResult())}))),eE(e,this.config.simulationAttrs.map((e=>[e,t[e]]))),Object.entries(this.forceMap).forEach((([n,r])=>{const i=n;if(t[n]){let n=e.force(i);n||(n=r(),e.force(i,n)),eE(n,Object.entries(t[i]))}else e.force(i,null)})),e}},dagre:hL,dendrogram:um.dendrogram,force:Wb,fruchterman:class{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},vL),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericFruchtermanLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericFruchtermanLayout(!0,t,e)}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;e<t;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach((t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0}))),e}genericFruchtermanLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){if(this.running)return;const r=this.formatOptions(n),{dimensions:i,width:o,height:a,center:s,clustering:l,nodeClusterBy:c,maxIteration:u,onTick:h}=r,d=e.getAllNodes(),f=e.getAllEdges();if(!(null==d?void 0:d.length)){const t={nodes:[],edges:f};return this.lastResult=t,t}if(1===d.length){t&&e.mergeNodeData(d[0].id,{x:s[0],y:s[1],z:3===i?s[2]:void 0});const n={nodes:[Object.assign(Object.assign({},d[0]),{data:Object.assign(Object.assign({},d[0].data),{x:s[0],y:s[1],z:3===i?s[2]:void 0})})],edges:f};return this.lastResult=n,n}const p=d.map((t=>cb(t,[o,a]))),g=new ov({nodes:p,edges:f}),v={};if(l&&p.forEach((t=>{const e=t.data[c];v[e]||(v[e]={name:e,cx:0,cy:0,count:0})})),this.lastLayoutNodes=p,this.lastLayoutEdges=f,this.lastAssign=t,this.lastGraph=g,this.lastOptions=r,this.lastClusterMap=v,"undefined"==typeof window)return;let m=0;return new Promise((n=>{this.timeInterval=window.setInterval((()=>{this.running?(this.runOneStep(g,v,r),t&&p.forEach((({id:t,data:n})=>e.mergeNodeData(t,{x:n.x,y:n.y,z:3===i?n.z:void 0}))),null==h||h({nodes:p,edges:f}),m++,m>=u&&(window.clearInterval(this.timeInterval),n({nodes:p,edges:f}))):n({nodes:p,edges:f})}),0),this.running=!0}))}))}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:n,nodeClusterBy:r}=e,{center:i,width:o,height:a}=e;return e.width=o||"undefined"==typeof window?o:window.innerWidth,e.height=a||"undefined"==typeof window?a:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=n&&!!r,e}runOneStep(t,e,n){const{dimensions:r,height:i,width:o,gravity:a,center:s,speed:l,clustering:c,nodeClusterBy:u,clusterGravity:h}=n,d=i*o,f=Math.sqrt(d)/10,p=t.getAllNodes(),g=d/(p.length+1),v=Math.sqrt(g),m={};if(this.applyCalculate(t,m,v,g),c){for(const t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;p.forEach((t=>{const{data:n}=t,r=e[n[u]];le(n.x)&&(r.cx+=n.x),le(n.y)&&(r.cy+=n.y),r.count++}));for(const t in e)e[t].cx/=e[t].count,e[t].cy/=e[t].count;const t=h||a;p.forEach(((n,r)=>{const{id:i,data:o}=n;if(!le(o.x)||!le(o.y))return;const a=e[o[u]],s=Math.sqrt((o.x-a.cx)*(o.x-a.cx)+(o.y-a.cy)*(o.y-a.cy)),l=v*t;m[i].x-=l*(o.x-a.cx)/s,m[i].y-=l*(o.y-a.cy)/s}))}p.forEach(((t,e)=>{const{id:n,data:i}=t;if(!le(i.x)||!le(i.y))return;const o=.01*v*a;m[n].x-=o*(i.x-s[0]),m[n].y-=o*(i.y-s[1]),3===r&&(m[n].z-=o*(i.z-s[2]))})),p.forEach(((e,n)=>{const{id:i,data:o}=e;if(le(o.fx)&&le(o.fy))return o.x=o.fx,o.y=o.fy,void(3===r&&(o.z=o.fz));if(!le(o.x)||!le(o.y))return;const a=Math.sqrt(m[i].x*m[i].x+m[i].y*m[i].y+(3===r?m[i].z*m[i].z:0));if(a>0){const e=Math.min(f*(l/800),a);t.mergeNodeData(i,{x:o.x+m[i].x/a*e,y:o.y+m[i].y/a*e,z:3===r?o.z+m[i].z/a*e:void 0})}}))}applyCalculate(t,e,n,r){this.calRepulsive(t,e,r),this.calAttractive(t,e,n)}calRepulsive(t,e,n){const r=t.getAllNodes();r.forEach((({data:t,id:i},o)=>{e[i]={x:0,y:0,z:0},r.forEach((({data:r,id:a},s)=>{if(o<=s||!le(t.x)||!le(r.x)||!le(t.y)||!le(r.y))return;let l=t.x-r.x,c=t.y-r.y,u=3===this.options.dimensions?t.z-r.z:0,h=l*l+c*c+u*u;0===h&&(h=1,l=.01,c=.01,u=.01);const d=n/h,f=l*d,p=c*d,g=u*d;e[i].x+=f,e[i].y+=p,e[a].x-=f,e[a].y-=p,3===this.options.dimensions&&(e[i].z+=g,e[a].z-=g)}))}))}calAttractive(t,e,n){t.getAllEdges().forEach((r=>{const{source:i,target:o}=r;if(!i||!o||i===o)return;const{data:a}=t.getNode(i),{data:s}=t.getNode(o);if(!(le(s.x)&&le(a.x)&&le(s.y)&&le(a.y)))return;const l=s.x-a.x,c=s.y-a.y,u=3===this.options.dimensions?s.z-a.z:0,h=Math.sqrt(l*l+c*c+u*u)/n,d=l*h,f=c*h,p=u*h;e[i].x+=d,e[i].y+=f,e[o].x-=d,e[o].y-=f,3===this.options.dimensions&&(e[i].z+=p,e[o].z-=p)}))}},grid:class{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},mL),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericGridLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericGridLayout(!0,t,e)}))}genericGridLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{begin:i=[0,0],condense:o,preventOverlapPadding:a,preventOverlap:s,rows:l,cols:c,nodeSpacing:u,nodeSize:h,width:d,height:f,position:p}=r;let{sortBy:g}=r;const v=e.getAllNodes(),m=e.getAllEdges(),y=null==v?void 0:v.length;if(!y||1===y)return vb(e,t,i);const b=v.map((t=>cb(t)));"id"===g||ie(g)&&void 0!==b[0].data[g]||(g="degree"),"degree"===g?b.sort(((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both"))):"id"===g?b.sort(((t,e)=>le(e.id)&&le(t.id)?e.id-t.id:`${t.id}`.localeCompare(`${e.id}`))):b.sort(((t,e)=>e.data[g]-t.data[g]));const x=d||"undefined"==typeof window?d:window.innerWidth,E=f||"undefined"==typeof window?f:window.innerHeight,w=y,k={rows:l,cols:c};if(null!=l&&null!=c)k.rows=l,k.cols=c;else if(null!=l&&null==c)k.rows=l,k.cols=Math.ceil(w/k.rows);else if(null==l&&null!=c)k.cols=c,k.rows=Math.ceil(w/k.cols);else{const t=Math.sqrt(w*E/x);k.rows=Math.round(t),k.cols=Math.round(x/E*t)}if(k.rows=Math.max(k.rows,1),k.cols=Math.max(k.cols,1),k.cols*k.rows>w){const t=yL(k),e=bL(k);(t-1)*e>=w?yL(k,t-1):(e-1)*t>=w&&bL(k,e-1)}else for(;k.cols*k.rows<w;){const t=yL(k),e=bL(k);(e+1)*t>=w?bL(k,e+1):yL(k,t+1)}let M=o?0:x/k.cols,N=o?0:E/k.rows;if(s||u){const t=hb(10,u),n=db(30,h,!1);b.forEach((r=>{r.data.x&&r.data.y||(r.data.x=0,r.data.y=0);const i=e.getNode(r.id),[o,s]=ub(n(i)||30),l=void 0!==t?t(r):a,c=o+l,u=s+l;M=Math.max(M,c),N=Math.max(N,u)}))}const O={},S={row:0,col:0},T={};for(let t=0;t<b.length;t++){const n=b[t];let r;if(p&&(r=p(e.getNode(n.id))),r&&(void 0!==r.row||void 0!==r.col)){const t={row:r.row,col:r.col};if(void 0===t.col)for(t.col=0;xL(O,t);)t.col++;else if(void 0===t.row)for(t.row=0;xL(O,t);)t.row++;T[n.id]=t,EL(O,t)}kL(n,i,M,N,T,k,S,O)}const _={nodes:b,edges:m};return t&&b.forEach((t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})})),_}))}},indented:um.indented,mds:lx,mindmap:um.mindmap,radial:class{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},SL),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericRadialLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericRadialLayout(!0,t,e)}))}genericRadialLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{width:i,height:o,center:a,focusNode:s,unitRadius:l,nodeSize:c,nodeSpacing:u,strictRadial:h,preventOverlap:d,maxPreventOverlapIteration:f,sortBy:p,linkDistance:g=50,sortStrength:v=10,maxIteration:m=1e3}=r,y=e.getAllNodes(),b=e.getAllEdges(),x=i||"undefined"==typeof window?i:window.innerWidth,E=o||"undefined"==typeof window?o:window.innerHeight,w=a||[x/2,E/2];if(!(null==y?void 0:y.length)||1===y.length)return vb(e,t,w);let k=y[0];if(ie(s)){for(let t=0;t<y.length;t++)if(y[t].id===s){k=y[t];break}}else k=s||y[0];const M=AL(y,k.id),N=ob({nodes:y,edges:b}),O=ib(N),S=PL(O,M);CL(O,M,S+1);const T=O[M];let _=x-w[0]>w[0]?w[0]:x-w[0],A=E-w[1]>w[1]?w[1]:E-w[1];0===_&&(_=x/2),0===A&&(A=E/2);const C=Math.min(_,A),P=Math.max(...T),D=[],R=l||C/P;T.forEach(((t,e)=>{D[e]=t*R}));const L=TL(y,O,g,D,R,p,v),I=_L(L),j=((t,e,n)=>{try{const n=ox.mul(ox.pow(e,2),-.5),r=n.mean("row"),i=n.mean("column"),o=n.mean();n.add(o).subRowVector(r).subColumnVector(i);const a=new ax(n),s=ox.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map((e=>ox.mul([e],[s]).toJSON()[0].splice(0,t)))}catch(t){const r=[];for(let t=0;t<e.length;t++){const t=Math.random()*n,e=Math.random()*n;r.push([t,e])}return r}})(g,L,g);let F,B=j.map((([t,e])=>({x:(isNaN(t)?Math.random()*g:t)-j[M][0],y:(isNaN(e)?Math.random()*g:e)-j[M][1]})));if(this.run(m,B,I,L,D,M),d){F=fb(c,u);const t={nodes:y,nodeSizeFunc:F,positions:B,radii:D,height:E,width:x,strictRadial:Boolean(h),focusIdx:M,iterations:f||200,k:B.length/4.5};B=((t,e)=>{const n=Object.assign(Object.assign({},ML),e),{positions:r,iterations:i,width:o,k:a,speed:s=100,strictRadial:l,focusIdx:c,radii:u=[],nodeSizeFunc:h}=n,d=t.getAllNodes(),f=[],p=o/10;for(let t=0;t<i;t++)r.forEach(((t,e)=>{f[e]={x:0,y:0}})),NL(d,r,f,a,u,h),OL(r,f,s,l,c,p,o,u);return r})(e,t)}const z=[];B.forEach(((t,e)=>{const n=cb(y[e]);n.data.x=t.x+w[0],n.data.y=t.y+w[1],z.push(n)})),t&&z.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:z,edges:b}}))}run(t,e,n,r,i,o){for(let a=0;a<=t;a++){const s=a/t;this.oneIteration(s,e,i,r,n,o)}}oneIteration(t,e,n,r,i,o){const a=1-t;e.forEach(((s,l)=>{const c=ab(s,{x:0,y:0}),u=0===c?0:1/c;if(l===o)return;let h=0,d=0,f=0;e.forEach(((t,e)=>{if(l===e)return;const n=ab(s,t),o=0===n?0:1/n,a=r[e][l];f+=i[l][e],h+=i[l][e]*(t.x+a*(s.x-t.x)*o),d+=i[l][e]*(t.y+a*(s.y-t.y)*o)}));const p=0===n[l]?0:1/n[l];f*=a,f+=t*p*p,h*=a,h+=t*p*s.x*u,s.x=h/f,d*=a,d+=t*p*s.y*u,s.y=d/f}))}},random:class{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},DL),t)}execute(t,e){return Ve(this,void 0,void 0,(function*(){return this.genericRandomLayout(!1,t,e)}))}assign(t,e){return Ve(this,void 0,void 0,(function*(){yield this.genericRandomLayout(!0,t,e)}))}genericRandomLayout(t,e,n){return Ve(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i,width:o,height:a}=r,s=e.getAllNodes(),l=o||"undefined"==typeof window?o:window.innerWidth,c=a||"undefined"==typeof window?a:window.innerHeight,u=i||[l/2,c/2],h=[];s&&s.forEach((t=>{h.push({id:t.id,data:{x:.9*(Math.random()-.5)*l+u[0],y:.9*(Math.random()-.5)*c+u[1]}})})),t&&h.forEach((t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})));return{nodes:h,edges:e.getAllEdges()}}))}}},node:{circle:hf,diamond:class extends df{constructor(t){super(t)}getPoints(t){const[e,n]=this.getSize(t);return function(t,e){return[[0,-e/2],[t/2,0],[0,e/2],[-t/2,0]]}(e,n)}},ellipse:mf,hexagon:class extends df{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]];var e}getIconStyle(t){const e=super.getIconStyle(t),n=this.getOuterR(t)*xd;return!!e&&Object.assign({width:n,height:n},e)}},html:Rp,image:Ip,rect:jp,star:class extends df{constructor(t){super(t)}getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return e=this.getOuterR(t),n=this.getInnerR(t),[[0,-e],[n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,n],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]];var e,n}getIconStyle(t){const e=super.getIconStyle(t),n=2*this.getInnerR(t)*xd;return!!e&&Object.assign({width:n,height:n},e)}getPortXY(t,e){const{placement:n="top"}=e;return Rg(this.getShape("key").getLocalBounds(),n,function(t,e){const n={};return n.top=[0,-t],n.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.bottom=[0,e],n["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.right=n.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n}(this.getOuterR(t),this.getInnerR(t)),!1)}},donut:pf,triangle:Fp},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:DG,light:RG},plugin:{"bubble-sets":HI,"edge-bundling":KI,"edge-filter-lens":oj,"grid-line":cj,background:sI,contextmenu:XI,fisheye:sj,fullscreen:lj,history:pj,hull:Rj,legend:iG,minimap:oG,snapline:uG,timebar:vG,toolbar:EG,tooltip:wG,watermark:TG},transform:{"arrange-draw-order":class extends LG{beforeDraw(t){const{model:e}=this.context,n=t.add.combos,r=t=>{const n=[];return t.forEach(((t,r)=>{const i=e.getAncestorsData(r,"combo").map((t=>xh(t))).reverse();n.push([r,t,i.length])})),new Map(n.sort((([,,t],[,,e])=>e-t)).map((([t,e])=>[t,e])))};return t.add.combos=r(n),t.update.combos=r(t.update.combos),t}},"collapse-expand-combo":class extends LG{beforeDraw(t,e){if("visibility"===e.stage)return t;if(!this.context.model.model.hasTreeStructure(ku))return t;const{model:n}=this.context,{add:r,update:i}=t,o=[...t.update.combos.entries(),...t.add.combos.entries()];for(;o.length;){const[e,a]=o.pop();if(Td(a)){const a=n.getDescendantsData(e),s=a.map(xh),{internal:l,external:c}=sg(s,(t=>n.getRelatedEdgesData(t)));a.forEach((e=>{const r=xh(e),i=o.findIndex((([t])=>t===r));-1!==i&&o.splice(i,1);const a=n.getElementType(r);IG(t,"remove",a,e)})),l.forEach((e=>IG(t,"remove","edge",e))),c.forEach((t=>{var e;const n=xh(t);(null===(e=this.context.element)||void 0===e?void 0:e.getElement(n))?i.edges.set(n,t):r.edges.set(n,t)}))}else{const r=n.getChildrenData(e),i=r.map(xh),{edges:a}=sg(i,(t=>n.getRelatedEdgesData(t)));[...r,...a].forEach((e=>{var r;const i=xh(e),a=n.getElementType(i),s=null===(r=this.context.element)||void 0===r?void 0:r.getElement(i);IG(t,s?"update":"add",a,e),"combo"===a&&o.push([i,e])}))}}return t}},"collapse-expand-node":class extends LG{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(FG(e,"add","node",t),Td(t))return;const n=xh(t);FG(e,"add","node",t);this.context.model.getRelatedEdgesData(n,"out").forEach((t=>{IG(e,"add","edge",t)}));this.context.model.getChildrenData(n).forEach((t=>{this.handleExpand(t,e)}))}beforeDraw(t){const{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(Mu))return t;const{add:{nodes:r,edges:i},update:{nodes:o}}=t,a=new Map,s=new Map;r.forEach(((t,e)=>{Td(t)&&a.set(e,t)})),i.forEach((t=>{if("node"!==e.getElementType(t.source))return;const n=e.getNodeData(t.source);Td(n)&&a.set(t.source,n)})),o.forEach(((t,e)=>{const n=this.getElement(e);if(!n)return;const r=n.attributes.collapsed;Td(t)?r||a.set(e,t):r&&s.set(e,t)}));const l=new Set;return a.forEach(((e,r)=>{n.getDescendantsData(r).forEach((e=>{const r=xh(e);if(l.has(r))return;IG(t,"remove","node",e);n.getRelatedEdgesData(r).forEach((e=>{IG(t,"remove","edge",e)})),l.add(r)}))})),s.forEach(((e,r)=>{n.getAncestorsData(r,Mu).some(Td)?IG(t,"remove","node",e):this.handleExpand(e,t)})),t}},"get-edge-actual-ends":class extends LG{beforeDraw(t){const{add:e,update:n}=t,{model:r}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach((([,t])=>{SW(r,t)})),t}},"map-node-size":TW,"place-radial-labels":_W,"process-parallel-edges":CW,"update-related-edges":class extends LG{beforeDraw(t,e){const{stage:n}=e;if("visibility"===n)return t;const{model:r}=this.context,{update:{nodes:i,edges:o,combos:a}}=t,s=(t,e)=>{r.getRelatedEdgesData(e).forEach((t=>!o.has(xh(t))&&o.set(xh(t),t)))};return i.forEach(s),a.forEach(s),t}}},shape:{circle:Rl,ellipse:jl,group:Fl,html:zl,image:ef,line:Wl,path:Hl,polygon:Yl,polyline:Xl,rect:Kl,text:Jl,label:qd,badge:Xd}};Object.entries(LW).forEach((([t,e])=>{Object.entries(e).forEach((([e,n])=>{!function(t,e,n,r=!1){const i=Ou[t][e];!r&&i?i!==n&&_u(`The extension ${e} of ${t} has been registered before.`):Object.assign(Ou[t],{[e]:n})}(t,e,n)}))}));"function"==typeof n.setTimeout&&setTimeout,"function"==typeof n.clearTimeout&&clearTimeout;function IW(t,e){this.fun=t,this.array=e}IW.prototype.run=function(){this.fun.apply(null,this.array)};var jW=n.performance||{};jW.now||jW.mozNow||jW.msNow||jW.oNow||jW.webkitNow;new Date;var FW={};
/**
  * @vue/shared v3.5.12
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
/*! #__NO_SIDE_EFFECTS__ */function BW(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return t=>t in e}const zW="production"!==FW.NODE_ENV?Object.freeze({}):{},VW="production"!==FW.NODE_ENV?Object.freeze([]):[],GW=()=>{},WW=()=>!1,$W=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),HW=t=>t.startsWith("onUpdate:"),UW=Object.assign,YW=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},qW=Object.prototype.hasOwnProperty,XW=(t,e)=>qW.call(t,e),KW=Array.isArray,ZW=t=>"[object Map]"===i$(t),JW=t=>"function"==typeof t,QW=t=>"string"==typeof t,t$=t=>"symbol"==typeof t,e$=t=>null!==t&&"object"==typeof t,n$=t=>(e$(t)||JW(t))&&JW(t.then)&&JW(t.catch),r$=Object.prototype.toString,i$=t=>r$.call(t),o$=t=>i$(t).slice(8,-1),a$=t=>QW(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,s$=BW(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),l$=BW("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),c$=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},u$=/-(\w)/g,h$=c$((t=>t.replace(u$,((t,e)=>e?e.toUpperCase():"")))),d$=/\B([A-Z])/g,f$=c$((t=>t.replace(d$,"-$1").toLowerCase())),p$=c$((t=>t.charAt(0).toUpperCase()+t.slice(1))),g$=c$((t=>t?`on${p$(t)}`:"")),v$=(t,e)=>!Object.is(t,e),m$=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},y$=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},b$=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let x$;const E$=()=>x$||(x$="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{});function w$(t){if(KW(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=QW(r)?O$(r):w$(r);if(i)for(const t in i)e[t]=i[t]}return e}if(QW(t)||e$(t))return t}const k$=/;(?![^(]*\))/g,M$=/:([^]+)/,N$=/\/\*[^]*?\*\//g;function O$(t){const e={};return t.replace(N$,"").split(k$).forEach((t=>{if(t){const n=t.split(M$);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function S$(t){let e="";if(QW(t))e=t;else if(KW(t))for(let n=0;n<t.length;n++){const r=S$(t[n]);r&&(e+=r+" ")}else if(e$(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const T$=BW("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function _$(t){return!!t||""===t}function A$(t,...e){console.warn(`[Vue warn] ${t}`,...e)}let C$,P$;class D${constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=C$,!t&&C$&&(this.index=(C$.scopes||(C$.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let t,e;if(this._isPaused=!0,this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){let t,e;if(this._isPaused=!1,this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=C$;try{return C$=this,t()}finally{C$=e}}else"production"!==FW.NODE_ENV&&A$("cannot run an inactive effect scope.")}on(){C$=this}off(){C$=this.parent}stop(t){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}const R$=new WeakSet;class L${constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,C$&&C$.active&&C$.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,R$.has(this)&&(R$.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||B$(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,J$(this),G$(this);const t=P$,e=q$;P$=this,q$=!0;try{return this.fn()}finally{"production"!==FW.NODE_ENV&&P$!==this&&A$("Active effect was not restored correctly - this is likely a Vue internal bug."),W$(this),P$=t,q$=e,this.flags&=-3}}stop(){if(1&this.flags){for(let t=this.deps;t;t=t.nextDep)U$(t);this.deps=this.depsTail=void 0,J$(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?R$.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$$(this)&&this.run()}get dirty(){return $$(this)}}let I$,j$,F$=0;function B$(t,e=!1){if(t.flags|=8,e)return t.next=j$,void(j$=t);t.next=I$,I$=t}function z$(){F$++}function V$(){if(--F$>0)return;if(j$){let t=j$;for(j$=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let t;for(;I$;){let e=I$;for(I$=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,1&e.flags)try{e.trigger()}catch(e){t||(t=e)}e=n}}if(t)throw t}function G$(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function W$(t){let e,n=t.depsTail,r=n;for(;r;){const t=r.prevDep;-1===r.version?(r===n&&(n=t),U$(r),Y$(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=t}t.deps=e,t.depsTail=n}function $$(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(H$(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function H$(t){if(4&t.flags&&!(16&t.flags))return;if(t.flags&=-17,t.globalVersion===Q$)return;t.globalVersion=Q$;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!$$(t))return void(t.flags&=-3);const n=P$,r=q$;P$=t,q$=!0;try{G$(t);const n=t.fn(t._value);(0===e.version||v$(n,t._value))&&(t._value=n,e.version++)}catch(t){throw e.version++,t}finally{P$=n,q$=r,W$(t),t.flags&=-3}}function U$(t,e=!1){const{dep:n,prevSub:r,nextSub:i}=t;if(r&&(r.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=r,t.nextSub=void 0),"production"!==FW.NODE_ENV&&n.subsHead===t&&(n.subsHead=i),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let t=n.computed.deps;t;t=t.nextDep)U$(t,!0)}e||--n.sc||!n.map||n.map.delete(n.key)}function Y$(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let q$=!0;const X$=[];function K$(){X$.push(q$),q$=!1}function Z$(){const t=X$.pop();q$=void 0===t||t}function J$(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const t=P$;P$=void 0;try{e()}finally{P$=t}}}let Q$=0;class tH{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class eH{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,"production"!==FW.NODE_ENV&&(this.subsHead=void 0)}track(t){if(!P$||!q$||P$===this.computed)return;let e=this.activeLink;if(void 0===e||e.sub!==P$)e=this.activeLink=new tH(P$,this),P$.deps?(e.prevDep=P$.depsTail,P$.depsTail.nextDep=e,P$.depsTail=e):P$.deps=P$.depsTail=e,nH(e);else if(-1===e.version&&(e.version=this.version,e.nextDep)){const t=e.nextDep;t.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=t),e.prevDep=P$.depsTail,e.nextDep=void 0,P$.depsTail.nextDep=e,P$.depsTail=e,P$.deps===e&&(P$.deps=t)}return"production"!==FW.NODE_ENV&&P$.onTrack&&P$.onTrack(UW({effect:P$},t)),e}trigger(t){this.version++,Q$++,this.notify(t)}notify(t){z$();try{if("production"!==FW.NODE_ENV)for(let e=this.subsHead;e;e=e.nextSub)!e.sub.onTrigger||8&e.sub.flags||e.sub.onTrigger(UW({effect:e.sub},t));for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{V$()}}}function nH(t){if(t.dep.sc++,4&t.sub.flags){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let t=e.deps;t;t=t.nextDep)nH(t)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),"production"!==FW.NODE_ENV&&void 0===t.dep.subsHead&&(t.dep.subsHead=t),t.dep.subs=t}}const rH=new WeakMap,iH=Symbol("production"!==FW.NODE_ENV?"Object iterate":""),oH=Symbol("production"!==FW.NODE_ENV?"Map keys iterate":""),aH=Symbol("production"!==FW.NODE_ENV?"Array iterate":"");function sH(t,e,n){if(q$&&P$){let r=rH.get(t);r||rH.set(t,r=new Map);let i=r.get(n);i||(r.set(n,i=new eH),i.map=r,i.key=n),"production"!==FW.NODE_ENV?i.track({target:t,type:e,key:n}):i.track()}}function lH(t,e,n,r,i,o){const a=rH.get(t);if(!a)return void Q$++;const s=a=>{a&&("production"!==FW.NODE_ENV?a.trigger({target:t,type:e,key:n,newValue:r,oldValue:i,oldTarget:o}):a.trigger())};if(z$(),"clear"===e)a.forEach(s);else{const i=KW(t),o=i&&a$(n);if(i&&"length"===n){const t=Number(r);a.forEach(((e,n)=>{("length"===n||n===aH||!t$(n)&&n>=t)&&s(e)}))}else switch((void 0!==n||a.has(void 0))&&s(a.get(n)),o&&s(a.get(aH)),e){case"add":i?o&&s(a.get("length")):(s(a.get(iH)),ZW(t)&&s(a.get(oH)));break;case"delete":i||(s(a.get(iH)),ZW(t)&&s(a.get(oH)));break;case"set":ZW(t)&&s(a.get(iH))}}V$()}function cH(t){const e=KH(t);return e===t?e:(sH(e,"iterate",aH),qH(t)?e:e.map(ZH))}function uH(t){return sH(t=KH(t),"iterate",aH),t}const hH={__proto__:null,[Symbol.iterator](){return dH(this,Symbol.iterator,ZH)},concat(...t){return cH(this).concat(...t.map((t=>KW(t)?cH(t):t)))},entries(){return dH(this,"entries",(t=>(t[1]=ZH(t[1]),t)))},every(t,e){return pH(this,"every",t,e,void 0,arguments)},filter(t,e){return pH(this,"filter",t,e,(t=>t.map(ZH)),arguments)},find(t,e){return pH(this,"find",t,e,ZH,arguments)},findIndex(t,e){return pH(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return pH(this,"findLast",t,e,ZH,arguments)},findLastIndex(t,e){return pH(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return pH(this,"forEach",t,e,void 0,arguments)},includes(...t){return vH(this,"includes",t)},indexOf(...t){return vH(this,"indexOf",t)},join(t){return cH(this).join(t)},lastIndexOf(...t){return vH(this,"lastIndexOf",t)},map(t,e){return pH(this,"map",t,e,void 0,arguments)},pop(){return mH(this,"pop")},push(...t){return mH(this,"push",t)},reduce(t,...e){return gH(this,"reduce",t,e)},reduceRight(t,...e){return gH(this,"reduceRight",t,e)},shift(){return mH(this,"shift")},some(t,e){return pH(this,"some",t,e,void 0,arguments)},splice(...t){return mH(this,"splice",t)},toReversed(){return cH(this).toReversed()},toSorted(t){return cH(this).toSorted(t)},toSpliced(...t){return cH(this).toSpliced(...t)},unshift(...t){return mH(this,"unshift",t)},values(){return dH(this,"values",ZH)}};function dH(t,e,n){const r=uH(t),i=r[e]();return r===t||qH(t)||(i._next=i.next,i.next=()=>{const t=i._next();return t.value&&(t.value=n(t.value)),t}),i}const fH=Array.prototype;function pH(t,e,n,r,i,o){const a=uH(t),s=a!==t&&!qH(t),l=a[e];if(l!==fH[e]){const e=l.apply(t,o);return s?ZH(e):e}let c=n;a!==t&&(s?c=function(e,r){return n.call(this,ZH(e),r,t)}:n.length>2&&(c=function(e,r){return n.call(this,e,r,t)}));const u=l.call(a,c,r);return s&&i?i(u):u}function gH(t,e,n,r){const i=uH(t);let o=n;return i!==t&&(qH(t)?n.length>3&&(o=function(e,r,i){return n.call(this,e,r,i,t)}):o=function(e,r,i){return n.call(this,e,ZH(r),i,t)}),i[e](o,...r)}function vH(t,e,n){const r=KH(t);sH(r,"iterate",aH);const i=r[e](...n);return-1!==i&&!1!==i||!XH(n[0])?i:(n[0]=KH(n[0]),r[e](...n))}function mH(t,e,n=[]){K$(),z$();const r=KH(t)[e].apply(t,n);return V$(),Z$(),r}const yH=BW("__proto__,__v_isRef,__isVue"),bH=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter(t$));function xH(t){t$(t)||(t=String(t));const e=KH(this);return sH(e,"has",t),e.hasOwnProperty(t)}class EH{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,n){const r=this._isReadonly,i=this._isShallow;if("__v_isReactive"===e)return!r;if("__v_isReadonly"===e)return r;if("__v_isShallow"===e)return i;if("__v_raw"===e)return n===(r?i?VH:zH:i?BH:FH).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const o=KW(t);if(!r){let t;if(o&&(t=hH[e]))return t;if("hasOwnProperty"===e)return xH}const a=Reflect.get(t,e,QH(t)?t:n);return(t$(e)?bH.has(e):yH(e))?a:(r||sH(t,"get",e),i?a:QH(a)?o&&a$(e)?a:a.value:e$(a)?r?WH(a):GH(a):a)}}class wH extends EH{constructor(t=!1){super(!1,t)}set(t,e,n,r){let i=t[e];if(!this._isShallow){const e=YH(i);if(qH(n)||YH(n)||(i=KH(i),n=KH(n)),!KW(t)&&QH(i)&&!QH(n))return!e&&(i.value=n,!0)}const o=KW(t)&&a$(e)?Number(e)<t.length:XW(t,e),a=Reflect.set(t,e,n,QH(t)?t:r);return t===KH(r)&&(o?v$(n,i)&&lH(t,"set",e,n,i):lH(t,"add",e,n)),a}deleteProperty(t,e){const n=XW(t,e),r=t[e],i=Reflect.deleteProperty(t,e);return i&&n&&lH(t,"delete",e,void 0,r),i}has(t,e){const n=Reflect.has(t,e);return t$(e)&&bH.has(e)||sH(t,"has",e),n}ownKeys(t){return sH(t,"iterate",KW(t)?"length":iH),Reflect.ownKeys(t)}}class kH extends EH{constructor(t=!1){super(!0,t)}set(t,e){return"production"!==FW.NODE_ENV&&A$(`Set operation on key "${String(e)}" failed: target is readonly.`,t),!0}deleteProperty(t,e){return"production"!==FW.NODE_ENV&&A$(`Delete operation on key "${String(e)}" failed: target is readonly.`,t),!0}}const MH=new wH,NH=new kH,OH=new wH(!0),SH=new kH(!0),TH=t=>t,_H=t=>Reflect.getPrototypeOf(t);function AH(t){return function(...e){if("production"!==FW.NODE_ENV){const n=e[0]?`on key "${e[0]}" `:"";A$(`${p$(t)} operation ${n}failed: target is readonly.`,KH(this))}return"delete"!==t&&("clear"===t?void 0:this)}}function CH(t,e){const n={get(n){const r=this.__v_raw,i=KH(r),o=KH(n);t||(v$(n,o)&&sH(i,"get",n),sH(i,"get",o));const{has:a}=_H(i),s=e?TH:t?JH:ZH;return a.call(i,n)?s(r.get(n)):a.call(i,o)?s(r.get(o)):void(r!==i&&r.get(n))},get size(){const e=this.__v_raw;return!t&&sH(KH(e),"iterate",iH),Reflect.get(e,"size",e)},has(e){const n=this.__v_raw,r=KH(n),i=KH(e);return t||(v$(e,i)&&sH(r,"has",e),sH(r,"has",i)),e===i?n.has(e):n.has(e)||n.has(i)},forEach(n,r){const i=this,o=i.__v_raw,a=KH(o),s=e?TH:t?JH:ZH;return!t&&sH(a,"iterate",iH),o.forEach(((t,e)=>n.call(r,s(t),s(e),i)))}};UW(n,t?{add:AH("add"),set:AH("set"),delete:AH("delete"),clear:AH("clear")}:{add(t){e||qH(t)||YH(t)||(t=KH(t));const n=KH(this);return _H(n).has.call(n,t)||(n.add(t),lH(n,"add",t,t)),this},set(t,n){e||qH(n)||YH(n)||(n=KH(n));const r=KH(this),{has:i,get:o}=_H(r);let a=i.call(r,t);a?"production"!==FW.NODE_ENV&&jH(r,i,t):(t=KH(t),a=i.call(r,t));const s=o.call(r,t);return r.set(t,n),a?v$(n,s)&&lH(r,"set",t,n,s):lH(r,"add",t,n),this},delete(t){const e=KH(this),{has:n,get:r}=_H(e);let i=n.call(e,t);i?"production"!==FW.NODE_ENV&&jH(e,n,t):(t=KH(t),i=n.call(e,t));const o=r?r.call(e,t):void 0,a=e.delete(t);return i&&lH(e,"delete",t,void 0,o),a},clear(){const t=KH(this),e=0!==t.size,n="production"!==FW.NODE_ENV?ZW(t)?new Map(t):new Set(t):void 0,r=t.clear();return e&&lH(t,"clear",void 0,void 0,n),r}});return["keys","values","entries",Symbol.iterator].forEach((r=>{n[r]=function(t,e,n){return function(...r){const i=this.__v_raw,o=KH(i),a=ZW(o),s="entries"===t||t===Symbol.iterator&&a,l="keys"===t&&a,c=i[t](...r),u=n?TH:e?JH:ZH;return!e&&sH(o,"iterate",l?oH:iH),{next(){const{value:t,done:e}=c.next();return e?{value:t,done:e}:{value:s?[u(t[0]),u(t[1])]:u(t),done:e}},[Symbol.iterator](){return this}}}}(r,t,e)})),n}function PH(t,e){const n=CH(t,e);return(e,r,i)=>"__v_isReactive"===r?!t:"__v_isReadonly"===r?t:"__v_raw"===r?e:Reflect.get(XW(n,r)&&r in e?n:e,r,i)}const DH={get:PH(!1,!1)},RH={get:PH(!1,!0)},LH={get:PH(!0,!1)},IH={get:PH(!0,!0)};function jH(t,e,n){const r=KH(n);if(r!==n&&e.call(t,r)){const e=o$(t);A$(`Reactive ${e} contains both the raw and reactive versions of the same object${"Map"===e?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const FH=new WeakMap,BH=new WeakMap,zH=new WeakMap,VH=new WeakMap;function GH(t){return YH(t)?t:HH(t,!1,MH,DH,FH)}function WH(t){return HH(t,!0,NH,LH,zH)}function $H(t){return HH(t,!0,SH,IH,VH)}function HH(t,e,n,r,i){if(!e$(t))return"production"!==FW.NODE_ENV&&A$(`value cannot be made ${e?"readonly":"reactive"}: ${String(t)}`),t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const o=i.get(t);if(o)return o;const a=(s=t).__v_skip||!Object.isExtensible(s)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(o$(s));var s;if(0===a)return t;const l=new Proxy(t,2===a?r:n);return i.set(t,l),l}function UH(t){return YH(t)?UH(t.__v_raw):!(!t||!t.__v_isReactive)}function YH(t){return!(!t||!t.__v_isReadonly)}function qH(t){return!(!t||!t.__v_isShallow)}function XH(t){return!!t&&!!t.__v_raw}function KH(t){const e=t&&t.__v_raw;return e?KH(e):t}const ZH=t=>e$(t)?GH(t):t,JH=t=>e$(t)?WH(t):t;function QH(t){return!!t&&!0===t.__v_isRef}const tU={get:(t,e,n)=>{return"__v_raw"===e?t:QH(r=Reflect.get(t,e,n))?r.value:r;var r},set:(t,e,n,r)=>{const i=t[e];return QH(i)&&!QH(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function eU(t){return UH(t)?t:new Proxy(t,tU)}class nU{constructor(t,e,n){this.fn=t,this.setter=e,this._value=void 0,this.dep=new eH(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Q$-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags)&&P$!==this)return B$(this,!0),!0}get value(){const t="production"!==FW.NODE_ENV?this.dep.track({target:this,type:"get",key:"value"}):this.dep.track();return H$(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter?this.setter(t):"production"!==FW.NODE_ENV&&A$("Write operation failed: computed value is readonly")}}const rU={},iU=new WeakMap;let oU;function aU(t,e,n=zW){const{immediate:r,deep:i,once:o,scheduler:a,augmentJob:s,call:l}=n,c=t=>{(n.onWarn||A$)("Invalid watch source: ",t,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},u=t=>i?t:qH(t)||!1===i||0===i?sU(t,1):sU(t);let h,d,f,p,g=!1,v=!1;if(QH(t)?(d=()=>t.value,g=qH(t)):UH(t)?(d=()=>u(t),g=!0):KW(t)?(v=!0,g=t.some((t=>UH(t)||qH(t))),d=()=>t.map((t=>QH(t)?t.value:UH(t)?u(t):JW(t)?l?l(t,2):t():void("production"!==FW.NODE_ENV&&c(t))))):JW(t)?d=e?l?()=>l(t,2):t:()=>{if(f){K$();try{f()}finally{Z$()}}const e=oU;oU=h;try{return l?l(t,3,[p]):t(p)}finally{oU=e}}:(d=GW,"production"!==FW.NODE_ENV&&c(t)),e&&i){const t=d,e=!0===i?1/0:i;d=()=>sU(t(),e)}const m=C$,y=()=>{h.stop(),m&&YW(m.effects,h)};if(o&&e){const t=e;e=(...e)=>{t(...e),y()}}let b=v?new Array(t.length).fill(rU):rU;const x=t=>{if(1&h.flags&&(h.dirty||t))if(e){const t=h.run();if(i||g||(v?t.some(((t,e)=>v$(t,b[e]))):v$(t,b))){f&&f();const n=oU;oU=h;try{const n=[t,b===rU?void 0:v&&b[0]===rU?[]:b,p];l?l(e,3,n):e(...n),b=t}finally{oU=n}}}else h.run()};return s&&s(x),h=new L$(d),h.scheduler=a?()=>a(x,!1):x,p=t=>function(t,e=!1,n=oU){if(n){let e=iU.get(n);e||iU.set(n,e=[]),e.push(t)}else"production"===FW.NODE_ENV||e||A$("onWatcherCleanup() was called when there was no active watcher to associate with.")}(t,!1,h),f=h.onStop=()=>{const t=iU.get(h);if(t){if(l)l(t,4);else for(const e of t)e();iU.delete(h)}},"production"!==FW.NODE_ENV&&(h.onTrack=n.onTrack,h.onTrigger=n.onTrigger),e?r?x(!0):b=h.run():a?a(x.bind(null,!0),!0):h.run(),y.pause=h.pause.bind(h),y.resume=h.resume.bind(h),y.stop=y,y}function sU(t,e=1/0,n){if(e<=0||!e$(t)||t.__v_skip)return t;if((n=n||new Set).has(t))return t;if(n.add(t),e--,QH(t))sU(t.value,e,n);else if(KW(t))for(let r=0;r<t.length;r++)sU(t[r],e,n);else if("[object Set]"===i$(t)||ZW(t))t.forEach((t=>{sU(t,e,n)}));else if((t=>"[object Object]"===i$(t))(t)){for(const r in t)sU(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&sU(t[r],e,n)}return t}const lU=[];function cU(t){lU.push(t)}function uU(){lU.pop()}let hU=!1;function dU(t,...e){if(hU)return;hU=!0,K$();const n=lU.length?lU[lU.length-1].component:null,r=n&&n.appContext.config.warnHandler,i=function(){let t=lU[lU.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const r=t.component&&t.component.parent;t=r&&r.vnode}return e}();if(r)vU(r,n,11,[t+e.map((t=>{var e,n;return null!=(n=null==(e=t.toString)?void 0:e.call(t))?n:JSON.stringify(t)})).join(""),n&&n.proxy,i.map((({vnode:t})=>`at <${jX(n,t.type)}>`)).join("\n"),i]);else{const n=[`[Vue warn]: ${t}`,...e];i.length&&n.push("\n",...function(t){const e=[];return t.forEach(((t,n)=>{e.push(...0===n?[]:["\n"],...function({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",r=!!t.component&&null==t.component.parent,i=` at <${jX(t.component,t.type,r)}`,o=">"+n;return t.props?[i,...fU(t.props),o]:[i+o]}(t))})),e}(i)),console.warn(...n)}Z$(),hU=!1}function fU(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach((n=>{e.push(...pU(n,t[n]))})),n.length>3&&e.push(" ..."),e}function pU(t,e,n){return QW(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):"number"==typeof e||"boolean"==typeof e||null==e?n?e:[`${t}=${e}`]:QH(e)?(e=pU(t,KH(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):JW(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=KH(e),n?e:[`${t}=`,e])}const gU={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function vU(t,e,n,r){try{return r?t(...r):t()}catch(t){yU(t,e,n)}}function mU(t,e,n,r){if(JW(t)){const i=vU(t,e,n,r);return i&&n$(i)&&i.catch((t=>{yU(t,e,n)})),i}if(KW(t)){const i=[];for(let o=0;o<t.length;o++)i.push(mU(t[o],e,n,r));return i}"production"!==FW.NODE_ENV&&dU("Invalid value type passed to callWithAsyncErrorHandling(): "+typeof t)}function yU(t,e,n,r=!0){const i=e?e.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||zW;if(e){let r=e.parent;const i=e.proxy,a="production"!==FW.NODE_ENV?gU[n]:`https://vuejs.org/error-reference/#runtime-${n}`;for(;r;){const e=r.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,i,a))return;r=r.parent}if(o)return K$(),vU(o,null,10,[t,i,a]),void Z$()}!function(t,e,n,r=!0,i=!1){if("production"!==FW.NODE_ENV){const i=gU[e];if(n&&cU(n),dU("Unhandled error"+(i?` during execution of ${i}`:"")),n&&uU(),r)throw t;console.error(t)}else{if(i)throw t;console.error(t)}}(t,n,i,r,a)}const bU=[];let xU=-1;const EU=[];let wU=null,kU=0;const MU=Promise.resolve();let NU=null;function OU(t){const e=NU||MU;return t?e.then(this?t.bind(this):t):e}function SU(t){if(!(1&t.flags)){const e=PU(t),n=bU[bU.length-1];!n||!(2&t.flags)&&e>=PU(n)?bU.push(t):bU.splice(function(t){let e=xU+1,n=bU.length;for(;e<n;){const r=e+n>>>1,i=bU[r],o=PU(i);o<t||o===t&&2&i.flags?e=r+1:n=r}return e}(e),0,t),t.flags|=1,TU()}}function TU(){NU||(NU=MU.then(DU))}function _U(t){KW(t)?EU.push(...t):wU&&-1===t.id?wU.splice(kU+1,0,t):1&t.flags||(EU.push(t),t.flags|=1),TU()}function AU(t,e,n=xU+1){for("production"!==FW.NODE_ENV&&(e=e||new Map);n<bU.length;n++){const r=bU[n];if(r&&2&r.flags){if(t&&r.id!==t.uid)continue;if("production"!==FW.NODE_ENV&&RU(e,r))continue;bU.splice(n,1),n--,4&r.flags&&(r.flags&=-2),r(),4&r.flags||(r.flags&=-2)}}}function CU(t){if(EU.length){const e=[...new Set(EU)].sort(((t,e)=>PU(t)-PU(e)));if(EU.length=0,wU)return void wU.push(...e);for(wU=e,"production"!==FW.NODE_ENV&&(t=t||new Map),kU=0;kU<wU.length;kU++){const e=wU[kU];"production"!==FW.NODE_ENV&&RU(t,e)||(4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2)}wU=null,kU=0}}const PU=t=>null==t.id?2&t.flags?-1:1/0:t.id;function DU(t){"production"!==FW.NODE_ENV&&(t=t||new Map);const e="production"!==FW.NODE_ENV?e=>RU(t,e):GW;try{for(xU=0;xU<bU.length;xU++){const t=bU[xU];if(t&&!(8&t.flags)){if("production"!==FW.NODE_ENV&&e(t))continue;4&t.flags&&(t.flags&=-2),vU(t,t.i,t.i?15:14),4&t.flags||(t.flags&=-2)}}}finally{for(;xU<bU.length;xU++){const t=bU[xU];t&&(t.flags&=-2)}xU=-1,bU.length=0,CU(t),NU=null,(bU.length||EU.length)&&DU(t)}}function RU(t,e){const n=t.get(e)||0;if(n>100){const t=e.i,n=t&&IX(t.type);return yU(`Maximum recursive updates exceeded${n?` in component <${n}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`,null,10),!0}return t.set(e,n+1),!1}let LU=!1;const IU=new Map;"production"!==FW.NODE_ENV&&(E$().__VUE_HMR_RUNTIME__={createRecord:VU(FU),rerender:VU((function(t,e){const n=jU.get(t);if(!n)return;n.initialDef.render=e,[...n.instances].forEach((t=>{e&&(t.render=e,BU(t.type).render=e),t.renderCache=[],LU=!0,t.update(),LU=!1}))})),reload:VU((function(t,e){const n=jU.get(t);if(!n)return;e=BU(e),zU(n.initialDef,e);const r=[...n.instances];for(let t=0;t<r.length;t++){const i=r[t],o=BU(i.type);let a=IU.get(o);a||(o!==n.initialDef&&zU(o,e),IU.set(o,a=new Set)),a.add(i),i.appContext.propsCache.delete(i.type),i.appContext.emitsCache.delete(i.type),i.appContext.optionsCache.delete(i.type),i.ceReload?(a.add(i),i.ceReload(e.styles),a.delete(i)):i.parent?SU((()=>{LU=!0,i.parent.update(),LU=!1,a.delete(i)})):i.appContext.reload?i.appContext.reload():"undefined"!=typeof window?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required."),i.root.ce&&i!==i.root&&i.root.ce._removeChildStyle(o)}_U((()=>{IU.clear()}))}))});const jU=new Map;function FU(t,e){return!jU.has(t)&&(jU.set(t,{initialDef:BU(e),instances:new Set}),!0)}function BU(t){return FX(t)?t.__vccOpts:t}function zU(t,e){UW(t,e);for(const n in t)"__file"===n||n in e||delete t[n]}function VU(t){return(e,n)=>{try{return t(e,n)}catch(t){console.error(t),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let GU,WU=[],$U=!1;function HU(t,...e){GU?GU.emit(t,...e):$U||WU.push({event:t,args:e})}function UU(t,e){var n,r;if(GU=t,GU)GU.enabled=!0,WU.forEach((({event:t,args:e})=>GU.emit(t,...e))),WU=[];else if("undefined"!=typeof window&&window.HTMLElement&&!(null==(r=null==(n=window.navigator)?void 0:n.userAgent)?void 0:r.includes("jsdom"))){(e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push((t=>{UU(t,e)})),setTimeout((()=>{GU||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,$U=!0,WU=[])}),3e3)}else $U=!0,WU=[]}const YU=KU("component:added"),qU=KU("component:updated"),XU=KU("component:removed");
/*! #__NO_SIDE_EFFECTS__ */
function KU(t){return e=>{HU(t,e.appContext.app,e.uid,e.parent?e.parent.uid:void 0,e)}}const ZU=QU("perf:start"),JU=QU("perf:end");function QU(t){return(e,n,r)=>{HU(t,e.appContext.app,e.uid,e,n,r)}}let tY=null,eY=null;function nY(t){const e=tY;return tY=t,eY=t&&t.type.__scopeId||null,e}function rY(t){l$(t)&&dU("Do not use built-in directive ids as custom directive id: "+t)}function iY(t,e,n,r){const i=t.dirs,o=e&&e.dirs;for(let a=0;a<i.length;a++){const s=i[a];o&&(s.oldValue=o[a].value);let l=s.dir[r];l&&(K$(),mU(l,n,8,[t.el,s,t,e]),Z$())}}const oY=Symbol("_vte");function aY(t,e){6&t.shapeFlag&&t.component?(t.transition=e,aY(t.component.subTree,e)):128&t.shapeFlag?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function sY(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const lY=new WeakSet;function cY(t,e,n,r,i=!1){if(KW(t))return void t.forEach(((t,o)=>cY(t,e&&(KW(e)?e[o]:e),n,r,i)));if(uY(r)&&!i)return;const o=4&r.shapeFlag?DX(r.component):r.el,a=i?null:o,{i:s,r:l}=t;if("production"!==FW.NODE_ENV&&!s)return void dU("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");const c=e&&e.r,u=s.refs===zW?s.refs={}:s.refs,h=s.setupState,d=KH(h),f=h===zW?()=>!1:t=>("production"===FW.NODE_ENV||(XW(d,t)&&!QH(d[t])&&dU(`Template ref "${t}" used on a non-ref value. It will not work in the production build.`),!lY.has(d[t])))&&XW(d,t);if(null!=c&&c!==l&&(QW(c)?(u[c]=null,f(c)&&(h[c]=null)):QH(c)&&(c.value=null)),JW(l))vU(l,s,12,[a,u]);else{const e=QW(l),r=QH(l);if(e||r){const s=()=>{if(t.f){const n=e?f(l)?h[l]:u[l]:l.value;i?KW(n)&&YW(n,o):KW(n)?n.includes(o)||n.push(o):e?(u[l]=[o],f(l)&&(h[l]=u[l])):(l.value=[o],t.k&&(u[t.k]=l.value))}else e?(u[l]=a,f(l)&&(h[l]=a)):r?(l.value=a,t.k&&(u[t.k]=a)):"production"!==FW.NODE_ENV&&dU("Invalid template ref type:",l,`(${typeof l})`)};a?(s.id=-1,Mq(s,n)):s()}else"production"!==FW.NODE_ENV&&dU("Invalid template ref type:",l,`(${typeof l})`)}}E$().requestIdleCallback,E$().cancelIdleCallback;const uY=t=>!!t.type.__asyncLoader,hY=t=>t.type.__isKeepAlive;function dY(t,e){pY(t,"a",e)}function fY(t,e){pY(t,"da",e)}function pY(t,e,n=bX){const r=t.__wdc||(t.__wdc=()=>{let e=n;for(;e;){if(e.isDeactivated)return;e=e.parent}return t()});if(vY(e,r,n),n){let t=n.parent;for(;t&&t.parent;)hY(t.parent.vnode)&&gY(r,e,n,t),t=t.parent}}function gY(t,e,n,r){const i=vY(e,t,r,!0);kY((()=>{YW(r[e],i)}),n)}function vY(t,e,n=bX,r=!1){if(n){const i=n[t]||(n[t]=[]),o=e.__weh||(e.__weh=(...r)=>{K$();const i=wX(n),o=mU(e,n,t,r);return i(),Z$(),o});return r?i.unshift(o):i.push(o),o}if("production"!==FW.NODE_ENV){dU(`${g$(gU[t].replace(/ hook$/,""))} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const mY=t=>(e,n=bX)=>{TX&&"sp"!==t||vY(t,((...t)=>e(...t)),n)},yY=mY("bm"),bY=mY("m"),xY=mY("bu"),EY=mY("u"),wY=mY("bum"),kY=mY("um"),MY=mY("sp"),NY=mY("rtg"),OY=mY("rtc");function SY(t,e=bX){vY("ec",t,e)}const TY=Symbol.for("v-ndc"),_Y=t=>t?OX(t)?DX(t):_Y(t.parent):null,AY=UW(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>"production"!==FW.NODE_ENV?$H(t.props):t.props,$attrs:t=>"production"!==FW.NODE_ENV?$H(t.attrs):t.attrs,$slots:t=>"production"!==FW.NODE_ENV?$H(t.slots):t.slots,$refs:t=>"production"!==FW.NODE_ENV?$H(t.refs):t.refs,$parent:t=>_Y(t.parent),$root:t=>_Y(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>__VUE_OPTIONS_API__?BY(t):t.type,$forceUpdate:t=>t.f||(t.f=()=>{SU(t.update)}),$nextTick:t=>t.n||(t.n=OU.bind(t.proxy)),$watch:t=>__VUE_OPTIONS_API__?Lq.bind(t):GW}),CY=t=>"_"===t||"$"===t,PY=(t,e)=>t!==zW&&!t.__isScriptSetup&&XW(t,e),DY={get({_:t},e){if("__v_skip"===e)return!0;const{ctx:n,setupState:r,data:i,props:o,accessCache:a,type:s,appContext:l}=t;if("production"!==FW.NODE_ENV&&"__isVue"===e)return!0;let c;if("$"!==e[0]){const s=a[e];if(void 0!==s)switch(s){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return o[e]}else{if(PY(r,e))return a[e]=1,r[e];if(i!==zW&&XW(i,e))return a[e]=2,i[e];if((c=t.propsOptions[0])&&XW(c,e))return a[e]=3,o[e];if(n!==zW&&XW(n,e))return a[e]=4,n[e];__VUE_OPTIONS_API__&&!LY||(a[e]=0)}}const u=AY[e];let h,d;return u?("$attrs"===e?(sH(t.attrs,"get",""),"production"!==FW.NODE_ENV&&Gq()):"production"!==FW.NODE_ENV&&"$slots"===e&&sH(t,"get",e),u(t)):(h=s.__cssModules)&&(h=h[e])?h:n!==zW&&XW(n,e)?(a[e]=4,n[e]):(d=l.config.globalProperties,XW(d,e)?d[e]:void("production"===FW.NODE_ENV||!tY||QW(e)&&0===e.indexOf("__v")||(i!==zW&&CY(e[0])&&XW(i,e)?dU(`Property ${JSON.stringify(e)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):t===tY&&dU(`Property ${JSON.stringify(e)} was accessed during render but is not defined on instance.`))))},set({_:t},e,n){const{data:r,setupState:i,ctx:o}=t;return PY(i,e)?(i[e]=n,!0):"production"!==FW.NODE_ENV&&i.__isScriptSetup&&XW(i,e)?(dU(`Cannot mutate <script setup> binding "${e}" from Options API.`),!1):r!==zW&&XW(r,e)?(r[e]=n,!0):XW(t.props,e)?("production"!==FW.NODE_ENV&&dU(`Attempting to mutate prop "${e}". Props are readonly.`),!1):"$"===e[0]&&e.slice(1)in t?("production"!==FW.NODE_ENV&&dU(`Attempting to mutate public property "${e}". Properties starting with $ are reserved and readonly.`),!1):("production"!==FW.NODE_ENV&&e in t.appContext.config.globalProperties?Object.defineProperty(o,e,{enumerable:!0,configurable:!0,value:n}):o[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:o}},a){let s;return!!n[a]||t!==zW&&XW(t,a)||PY(e,a)||(s=o[0])&&XW(s,a)||XW(r,a)||XW(AY,a)||XW(i.config.globalProperties,a)},defineProperty(t,e,n){return null!=n.get?t._.accessCache[e]=0:XW(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function RY(t){return KW(t)?t.reduce(((t,e)=>(t[e]=null,t)),{}):t}"production"!==FW.NODE_ENV&&(DY.ownKeys=t=>(dU("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(t)));let LY=!0;function IY(t){const e=BY(t),n=t.proxy,r=t.ctx;LY=!1,e.beforeCreate&&jY(e.beforeCreate,t,"bc");const{data:i,computed:o,methods:a,watch:s,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:g,deactivated:v,beforeDestroy:m,beforeUnmount:y,destroyed:b,unmounted:x,render:E,renderTracked:w,renderTriggered:k,errorCaptured:M,serverPrefetch:N,expose:O,inheritAttrs:S,components:T,directives:_,filters:A}=e,C="production"!==FW.NODE_ENV?function(){const t=Object.create(null);return(e,n)=>{t[n]?dU(`${e} property "${n}" is already defined in ${t[n]}.`):t[n]=e}}():null;if("production"!==FW.NODE_ENV){const[e]=t.propsOptions;if(e)for(const t in e)C("Props",t)}if(c&&function(t,e,n=GW){KW(t)&&(t=WY(t));for(const r in t){const i=t[r];let o;o=e$(i)?"default"in i?ZY(i.from||r,i.default,!0):ZY(i.from||r):ZY(i),QH(o)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:t=>o.value=t}):e[r]=o,"production"!==FW.NODE_ENV&&n("Inject",r)}}(c,r,C),a)for(const t in a){const e=a[t];JW(e)?("production"!==FW.NODE_ENV?Object.defineProperty(r,t,{value:e.bind(n),configurable:!0,enumerable:!0,writable:!0}):r[t]=e.bind(n),"production"!==FW.NODE_ENV&&C("Methods",t)):"production"!==FW.NODE_ENV&&dU(`Method "${t}" has type "${typeof e}" in the component definition. Did you reference the function correctly?`)}if(i){"production"===FW.NODE_ENV||JW(i)||dU("The data option must be a function. Plain object usage is no longer supported.");const e=i.call(n,n);if("production"!==FW.NODE_ENV&&n$(e)&&dU("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),e$(e)){if(t.data=GH(e),"production"!==FW.NODE_ENV)for(const t in e)C("Data",t),CY(t[0])||Object.defineProperty(r,t,{configurable:!0,enumerable:!0,get:()=>e[t],set:GW})}else"production"!==FW.NODE_ENV&&dU("data() should return an object.")}if(LY=!0,o)for(const t in o){const e=o[t],i=JW(e)?e.bind(n,n):JW(e.get)?e.get.bind(n,n):GW;"production"!==FW.NODE_ENV&&i===GW&&dU(`Computed property "${t}" has no getter.`);const a=!JW(e)&&JW(e.set)?e.set.bind(n):"production"!==FW.NODE_ENV?()=>{dU(`Write operation failed: computed property "${t}" is readonly.`)}:GW,s=BX({get:i,set:a});Object.defineProperty(r,t,{enumerable:!0,configurable:!0,get:()=>s.value,set:t=>s.value=t}),"production"!==FW.NODE_ENV&&C("Computed",t)}if(s)for(const t in s)FY(s[t],r,n,t);if(l){const t=JW(l)?l.call(n):l;Reflect.ownKeys(t).forEach((e=>{!function(t,e){if(bX){let n=bX.provides;const r=bX.parent&&bX.parent.provides;r===n&&(n=bX.provides=Object.create(r)),n[t]=e}else"production"!==FW.NODE_ENV&&dU("provide() can only be used inside setup().")}(e,t[e])}))}function P(t,e){KW(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(u&&jY(u,t,"c"),P(yY,h),P(bY,d),P(xY,f),P(EY,p),P(dY,g),P(fY,v),P(SY,M),P(OY,w),P(NY,k),P(wY,y),P(kY,x),P(MY,N),KW(O))if(O.length){const e=t.exposed||(t.exposed={});O.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});E&&t.render===GW&&(t.render=E),null!=S&&(t.inheritAttrs=S),T&&(t.components=T),_&&(t.directives=_),N&&sY(t)}function jY(t,e,n){mU(KW(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function FY(t,e,n,r){let i=r.includes(".")?Iq(n,r):()=>n[r];if(QW(t)){const n=e[t];JW(n)?Dq(i,n):"production"!==FW.NODE_ENV&&dU(`Invalid watch handler specified by key "${t}"`,n)}else if(JW(t))Dq(i,t.bind(n));else if(e$(t))if(KW(t))t.forEach((t=>FY(t,e,n,r)));else{const r=JW(t.handler)?t.handler.bind(n):e[t.handler];JW(r)?Dq(i,r,t):"production"!==FW.NODE_ENV&&dU(`Invalid watch handler specified by key "${t.handler}"`,r)}else"production"!==FW.NODE_ENV&&dU(`Invalid watch option: "${r}"`,t)}function BY(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:o,config:{optionMergeStrategies:a}}=t.appContext,s=o.get(e);let l;return s?l=s:i.length||n||r?(l={},i.length&&i.forEach((t=>zY(l,t,a,!0))),zY(l,e,a)):l=e,e$(e)&&o.set(e,l),l}function zY(t,e,n,r=!1){const{mixins:i,extends:o}=e;o&&zY(t,o,n,!0),i&&i.forEach((e=>zY(t,e,n,!0)));for(const i in e)if(r&&"expose"===i)"production"!==FW.NODE_ENV&&dU('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const r=VY[i]||n&&n[i];t[i]=r?r(t[i],e[i]):e[i]}return t}const VY={data:GY,props:UY,emits:UY,methods:HY,computed:HY,beforeCreate:$Y,created:$Y,beforeMount:$Y,mounted:$Y,beforeUpdate:$Y,updated:$Y,beforeDestroy:$Y,beforeUnmount:$Y,destroyed:$Y,unmounted:$Y,activated:$Y,deactivated:$Y,errorCaptured:$Y,serverPrefetch:$Y,components:HY,directives:HY,watch:function(t,e){if(!t)return e;if(!e)return t;const n=UW(Object.create(null),t);for(const r in e)n[r]=$Y(t[r],e[r]);return n},provide:GY,inject:function(t,e){return HY(WY(t),WY(e))}};function GY(t,e){return e?t?function(){return UW(JW(t)?t.call(this,this):t,JW(e)?e.call(this,this):e)}:e:t}function WY(t){if(KW(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function $Y(t,e){return t?[...new Set([].concat(t,e))]:e}function HY(t,e){return t?UW(Object.create(null),t,e):e}function UY(t,e){return t?KW(t)&&KW(e)?[...new Set([...t,...e])]:UW(Object.create(null),RY(t),RY(null!=e?e:{})):e}function YY(){return{app:null,config:{isNativeTag:WW,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let qY=0;function XY(t,e){return function(n,r=null){JW(n)||(n=UW({},n)),null==r||e$(r)||("production"!==FW.NODE_ENV&&dU("root props passed to app.mount() must be an object."),r=null);const i=YY(),o=new WeakSet,a=[];let s=!1;const l=i.app={_uid:qY++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:zX,get config(){return i.config},set config(t){"production"!==FW.NODE_ENV&&dU("app.config cannot be replaced. Modify individual options instead.")},use:(t,...e)=>(o.has(t)?"production"!==FW.NODE_ENV&&dU("Plugin has already been applied to target app."):t&&JW(t.install)?(o.add(t),t.install(l,...e)):JW(t)?(o.add(t),t(l,...e)):"production"!==FW.NODE_ENV&&dU('A plugin must either be a function or an object with an "install" function.'),l),mixin:t=>(__VUE_OPTIONS_API__?i.mixins.includes(t)?"production"!==FW.NODE_ENV&&dU("Mixin has already been applied to target app"+(t.name?`: ${t.name}`:"")):i.mixins.push(t):"production"!==FW.NODE_ENV&&dU("Mixins are only available in builds supporting Options API"),l),component:(t,e)=>("production"!==FW.NODE_ENV&&NX(t,i.config),e?("production"!==FW.NODE_ENV&&i.components[t]&&dU(`Component "${t}" has already been registered in target app.`),i.components[t]=e,l):i.components[t]),directive:(t,e)=>("production"!==FW.NODE_ENV&&rY(t),e?("production"!==FW.NODE_ENV&&i.directives[t]&&dU(`Directive "${t}" has already been registered in target app.`),i.directives[t]=e,l):i.directives[t]),mount(o,a,c){if(!s){"production"!==FW.NODE_ENV&&o.__vue_app__&&dU("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const u=l._ceVNode||lX(n,r);return u.appContext=i,!0===c?c="svg":!1===c&&(c=void 0),"production"!==FW.NODE_ENV&&(i.reload=()=>{t(uX(u),o,c)}),a&&e?e(u,o):t(u,o,c),s=!0,l._container=o,o.__vue_app__=l,("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(l._instance=u.component,function(t,e){HU("app:init",t,e,{Fragment:Zq,Text:Jq,Comment:Qq,Static:tX})}(l,zX)),DX(u.component)}"production"!==FW.NODE_ENV&&dU("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`")},onUnmount(t){"production"!==FW.NODE_ENV&&"function"!=typeof t&&dU("Expected function as first argument to app.onUnmount(), but got "+typeof t),a.push(t)},unmount(){s?(mU(a,l._instance,16),t(null,l._container),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(l._instance=null,function(t){HU("app:unmount",t)}(l)),delete l._container.__vue_app__):"production"!==FW.NODE_ENV&&dU("Cannot unmount an app that is not mounted.")},provide:(t,e)=>("production"!==FW.NODE_ENV&&t in i.provides&&dU(`App already provides property with key "${String(t)}". It will be overwritten with the new value.`),i.provides[t]=e,l),runWithContext(t){const e=KY;KY=l;try{return t()}finally{KY=e}}};return l}}let KY=null;function ZY(t,e,n=!1){const r=bX||tY;if(r||KY){const i=KY?KY._context.provides:r?null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&JW(e)?e.call(r&&r.proxy):e;"production"!==FW.NODE_ENV&&dU(`injection "${String(t)}" not found.`)}else"production"!==FW.NODE_ENV&&dU("inject() can only be used inside setup() or functional components.")}const JY={},QY=()=>Object.create(JY),tq=t=>Object.getPrototypeOf(t)===JY;function eq(t,e,n,r=!1){const i={},o=QY();t.propsDefaults=Object.create(null),nq(t,e,i,o);for(const e in t.propsOptions[0])e in i||(i[e]=void 0);"production"!==FW.NODE_ENV&&sq(e||{},i,t),n?t.props=r?i:HH(i,!1,OH,RH,BH):t.type.props?t.props=i:t.props=o,t.attrs=o}function nq(t,e,n,r){const[i,o]=t.propsOptions;let a,s=!1;if(e)for(let l in e){if(s$(l))continue;const c=e[l];let u;i&&XW(i,u=h$(l))?o&&o.includes(u)?(a||(a={}))[u]=c:n[u]=c:zq(t.emitsOptions,l)||l in r&&c===r[l]||(r[l]=c,s=!0)}if(o){const e=KH(n),r=a||zW;for(let a=0;a<o.length;a++){const s=o[a];n[s]=rq(i,e,s,r[s],t,!XW(r,s))}}return s}function rq(t,e,n,r,i,o){const a=t[n];if(null!=a){const t=XW(a,"default");if(t&&void 0===r){const t=a.default;if(a.type!==Function&&!a.skipFactory&&JW(t)){const{propsDefaults:o}=i;if(n in o)r=o[n];else{const a=wX(i);r=o[n]=t.call(null,e),a()}}else r=t;i.ce&&i.ce._setProp(n,r)}a[0]&&(o&&!t?r=!1:!a[1]||""!==r&&r!==f$(n)||(r=!0))}return r}const iq=new WeakMap;function oq(t,e,n=!1){const r=__VUE_OPTIONS_API__&&n?iq:e.propsCache,i=r.get(t);if(i)return i;const o=t.props,a={},s=[];let l=!1;if(__VUE_OPTIONS_API__&&!JW(t)){const r=t=>{l=!0;const[n,r]=oq(t,e,!0);UW(a,n),r&&s.push(...r)};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}if(!o&&!l)return e$(t)&&r.set(t,VW),VW;if(KW(o))for(let t=0;t<o.length;t++){"production"===FW.NODE_ENV||QW(o[t])||dU("props must be strings when using array syntax.",o[t]);const e=h$(o[t]);aq(e)&&(a[e]=zW)}else if(o){"production"===FW.NODE_ENV||e$(o)||dU("invalid props options",o);for(const t in o){const e=h$(t);if(aq(e)){const n=o[t],r=a[e]=KW(n)||JW(n)?{type:n}:UW({},n),i=r.type;let l=!1,c=!0;if(KW(i))for(let t=0;t<i.length;++t){const e=i[t],n=JW(e)&&e.name;if("Boolean"===n){l=!0;break}"String"===n&&(c=!1)}else l=JW(i)&&"Boolean"===i.name;r[0]=l,r[1]=c,(l||XW(r,"default"))&&s.push(e)}}}const c=[a,s];return e$(t)&&r.set(t,c),c}function aq(t){return"$"!==t[0]&&!s$(t)||("production"!==FW.NODE_ENV&&dU(`Invalid prop name: "${t}" is a reserved property.`),!1)}function sq(t,e,n){const r=KH(e),i=n.propsOptions[0],o=Object.keys(t).map((t=>h$(t)));for(const t in i){let e=i[t];null!=e&&lq(t,r[t],e,"production"!==FW.NODE_ENV?$H(r):r,!o.includes(t))}}function lq(t,e,n,r,i){const{type:o,required:a,validator:s,skipCheck:l}=n;if(a&&i)dU('Missing required prop: "'+t+'"');else if(null!=e||a){if(null!=o&&!0!==o&&!l){let n=!1;const r=KW(o)?o:[o],i=[];for(let t=0;t<r.length&&!n;t++){const{valid:o,expectedType:a}=uq(e,r[t]);i.push(a||""),n=o}if(!n)return void dU(function(t,e,n){if(0===n.length)return`Prop type [] for prop "${t}" won't match anything. Did you mean to use type Array instead?`;let r=`Invalid prop: type check failed for prop "${t}". Expected ${n.map(p$).join(" | ")}`;const i=n[0],o=o$(e),a=hq(e,i),s=hq(e,o);1===n.length&&dq(i)&&!function(...t){return t.some((t=>"boolean"===t.toLowerCase()))}(i,o)&&(r+=` with value ${a}`);r+=`, got ${o} `,dq(o)&&(r+=`with value ${s}.`);return r}(t,e,i))}s&&!s(e,r)&&dU('Invalid prop: custom validator check failed for prop "'+t+'".')}}const cq=BW("String,Number,Boolean,Function,Symbol,BigInt");function uq(t,e){let n;const r=function(t){if(null===t)return"null";if("function"==typeof t)return t.name||"";if("object"==typeof t)return t.constructor&&t.constructor.name||"";return""}(e);if("null"===r)n=null===t;else if(cq(r)){const i=typeof t;n=i===r.toLowerCase(),n||"object"!==i||(n=t instanceof e)}else n="Object"===r?e$(t):"Array"===r?KW(t):t instanceof e;return{valid:n,expectedType:r}}function hq(t,e){return"String"===e?`"${t}"`:"Number"===e?`${Number(t)}`:`${t}`}function dq(t){return["string","number","boolean"].some((e=>t.toLowerCase()===e))}const fq=t=>"_"===t[0]||"$stable"===t,pq=t=>KW(t)?t.map(fX):[fX(t)],gq=(t,e,n)=>{if(e._n)return e;const r=function(t,e=tY){if(!e)return t;if(t._n)return t;const n=(...r)=>{n._d&&rX(-1);const i=nY(e);let o;try{o=t(...r)}finally{nY(i),n._d&&rX(1)}return("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&qU(e),o};return n._n=!0,n._c=!0,n._d=!0,n}(((...r)=>("production"===FW.NODE_ENV||!bX||n&&n.root!==bX.root||dU(`Slot "${t}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),pq(e(...r)))),n);return r._c=!1,r},vq=(t,e,n)=>{const r=t._ctx;for(const n in t){if(fq(n))continue;const i=t[n];if(JW(i))e[n]=gq(n,i,r);else if(null!=i){"production"!==FW.NODE_ENV&&dU(`Non-function value encountered for slot "${n}". Prefer function slots for better performance.`);const t=pq(i);e[n]=()=>t}}},mq=(t,e)=>{"production"===FW.NODE_ENV||hY(t.vnode)||dU("Non-function value encountered for default slot. Prefer function slots for better performance.");const n=pq(e);t.slots.default=()=>n},yq=(t,e,n)=>{for(const r in e)(n||"_"!==r)&&(t[r]=e[r])};let bq,xq;function Eq(t,e){t.appContext.config.performance&&kq()&&xq.mark(`vue-${e}-${t.uid}`),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&ZU(t,e,kq()?xq.now():Date.now())}function wq(t,e){if(t.appContext.config.performance&&kq()){const n=`vue-${e}-${t.uid}`,r=n+":end";xq.mark(r),xq.measure(`<${jX(t,t.type)}> ${e}`,n,r),xq.clearMarks(n),xq.clearMarks(r)}("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&JU(t,e,kq()?xq.now():Date.now())}function kq(){return void 0!==bq||("undefined"!=typeof window&&window.performance?(bq=!0,xq=window.performance):bq=!1),bq}const Mq=function(t,e){e&&e.pendingBranch?KW(t)?e.effects.push(...t):e.effects.push(t):_U(t)};function Nq(t){return function(t){!function(){const t=[];if("boolean"!=typeof __VUE_OPTIONS_API__&&("production"!==FW.NODE_ENV&&t.push("__VUE_OPTIONS_API__"),E$().__VUE_OPTIONS_API__=!0),"boolean"!=typeof __VUE_PROD_DEVTOOLS__&&("production"!==FW.NODE_ENV&&t.push("__VUE_PROD_DEVTOOLS__"),E$().__VUE_PROD_DEVTOOLS__=!1),"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&("production"!==FW.NODE_ENV&&t.push("__VUE_PROD_HYDRATION_MISMATCH_DETAILS__"),E$().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1),"production"!==FW.NODE_ENV&&t.length){const e=t.length>1;console.warn(`Feature flag${e?"s":""} ${t.join(", ")} ${e?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.\n\nFor more details, see https://link.vuejs.org/feature-flags.`)}}();const e=E$();e.__VUE__=!0,"production"===FW.NODE_ENV&&!__VUE_PROD_DEVTOOLS__||UU(e.__VUE_DEVTOOLS_GLOBAL_HOOK__,e);const{insert:n,remove:r,patchProp:i,createElement:o,createText:a,createComment:s,setText:l,setElementText:c,parentNode:u,nextSibling:h,setScopeId:d=GW,insertStaticContent:f}=t,p=(t,e,n,r=null,i=null,o=null,a=void 0,s=null,l=("production"===FW.NODE_ENV||!LU)&&!!e.dynamicChildren)=>{if(t===e)return;t&&!oX(t,e)&&(r=W(t),F(t,i,o,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:u,shapeFlag:h}=e;switch(c){case Jq:g(t,e,n,r);break;case Qq:v(t,e,n,r);break;case tX:null==t?m(e,n,r,a):"production"!==FW.NODE_ENV&&y(t,e,n,a);break;case Zq:T(t,e,n,r,i,o,a,s,l);break;default:1&h?E(t,e,n,r,i,o,a,s,l):6&h?_(t,e,n,r,i,o,a,s,l):64&h||128&h?c.process(t,e,n,r,i,o,a,s,l,U):"production"!==FW.NODE_ENV&&dU("Invalid VNode type:",c,`(${typeof c})`)}null!=u&&i&&cY(u,t&&t.ref,o,e||t,!e)},g=(t,e,r,i)=>{if(null==t)n(e.el=a(e.children),r,i);else{const n=e.el=t.el;e.children!==t.children&&l(n,e.children)}},v=(t,e,r,i)=>{null==t?n(e.el=s(e.children||""),r,i):e.el=t.el},m=(t,e,n,r)=>{[t.el,t.anchor]=f(t.children,e,n,r,t.el,t.anchor)},y=(t,e,n,r)=>{if(e.children!==t.children){const i=h(t.anchor);x(t),[e.el,e.anchor]=f(e.children,n,i,r)}else e.el=t.el,e.anchor=t.anchor},b=({el:t,anchor:e},r,i)=>{let o;for(;t&&t!==e;)o=h(t),n(t,r,i),t=o;n(e,r,i)},x=({el:t,anchor:e})=>{let n;for(;t&&t!==e;)n=h(t),r(t),t=n;r(e)},E=(t,e,n,r,i,o,a,s,l)=>{"svg"===e.type?a="svg":"math"===e.type&&(a="mathml"),null==t?w(e,n,r,i,o,a,s,l):N(t,e,i,o,a,s,l)},w=(t,e,r,a,s,l,u,h)=>{let d,f;const{props:p,shapeFlag:g,transition:v,dirs:m}=t;if(d=t.el=o(t.type,l,p&&p.is,p),8&g?c(d,t.children):16&g&&M(t.children,d,null,a,s,Oq(t,l),u,h),m&&iY(t,null,a,"created"),k(d,t,t.scopeId,u,a),p){for(const t in p)"value"===t||s$(t)||i(d,t,null,p[t],l,a);"value"in p&&i(d,"value",null,p.value,l),(f=p.onVnodeBeforeMount)&&vX(f,a,t)}("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(y$(d,"__vnode",t,!0),y$(d,"__vueParentComponent",a,!0)),m&&iY(t,null,a,"beforeMount");const y=function(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}(s,v);y&&v.beforeEnter(d),n(d,e,r),((f=p&&p.onVnodeMounted)||y||m)&&Mq((()=>{f&&vX(f,a,t),y&&v.enter(d),m&&iY(t,null,a,"mounted")}),s)},k=(t,e,n,r,i)=>{if(n&&d(t,n),r)for(let e=0;e<r.length;e++)d(t,r[e]);if(i){let n=i.subTree;if("production"!==FW.NODE_ENV&&n.patchFlag>0&&2048&n.patchFlag&&(n=Hq(n.children)||n),e===n||Kq(n.type)&&(n.ssContent===e||n.ssFallback===e)){const e=i.vnode;k(t,e,e.scopeId,e.slotScopeIds,i.parent)}}},M=(t,e,n,r,i,o,a,s,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=s?pX(t[c]):fX(t[c]);p(null,l,e,n,r,i,o,a,s)}},N=(t,e,n,r,o,a,s)=>{const l=e.el=t.el;("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(l.__vnode=e);let{patchFlag:u,dynamicChildren:h,dirs:d}=e;u|=16&t.patchFlag;const f=t.props||zW,p=e.props||zW;let g;if(n&&Sq(n,!1),(g=p.onVnodeBeforeUpdate)&&vX(g,n,e,t),d&&iY(e,t,n,"beforeUpdate"),n&&Sq(n,!0),"production"!==FW.NODE_ENV&&LU&&(u=0,s=!1,h=null),(f.innerHTML&&null==p.innerHTML||f.textContent&&null==p.textContent)&&c(l,""),h?(O(t.dynamicChildren,h,l,n,r,Oq(e,o),a),"production"!==FW.NODE_ENV&&Tq(t,e)):s||R(t,e,l,null,n,r,Oq(e,o),a,!1),u>0){if(16&u)S(l,f,p,n,o);else if(2&u&&f.class!==p.class&&i(l,"class",null,p.class,o),4&u&&i(l,"style",f.style,p.style,o),8&u){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const r=t[e],a=f[r],s=p[r];s===a&&"value"!==r||i(l,r,a,s,o,n)}}1&u&&t.children!==e.children&&c(l,e.children)}else s||null!=h||S(l,f,p,n,o);((g=p.onVnodeUpdated)||d)&&Mq((()=>{g&&vX(g,n,e,t),d&&iY(e,t,n,"updated")}),r)},O=(t,e,n,r,i,o,a)=>{for(let s=0;s<e.length;s++){const l=t[s],c=e[s],h=l.el&&(l.type===Zq||!oX(l,c)||70&l.shapeFlag)?u(l.el):n;p(l,c,h,null,r,i,o,a,!0)}},S=(t,e,n,r,o)=>{if(e!==n){if(e!==zW)for(const a in e)s$(a)||a in n||i(t,a,e[a],null,o,r);for(const a in n){if(s$(a))continue;const s=n[a],l=e[a];s!==l&&"value"!==a&&i(t,a,l,s,o,r)}"value"in n&&i(t,"value",e.value,n.value,o)}},T=(t,e,r,i,o,s,l,c,u)=>{const h=e.el=t?t.el:a(""),d=e.anchor=t?t.anchor:a("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:g}=e;"production"!==FW.NODE_ENV&&(LU||2048&f)&&(f=0,u=!1,p=null),g&&(c=c?c.concat(g):g),null==t?(n(h,r,i),n(d,r,i),M(e.children||[],r,d,o,s,l,c,u)):f>0&&64&f&&p&&t.dynamicChildren?(O(t.dynamicChildren,p,r,o,s,l,c),"production"!==FW.NODE_ENV?Tq(t,e):(null!=e.key||o&&e===o.subTree)&&Tq(t,e,!0)):R(t,e,r,d,o,s,l,c,u)},_=(t,e,n,r,i,o,a,s,l)=>{e.slotScopeIds=s,null==t?512&e.shapeFlag?i.ctx.activate(e,n,r,a,l):A(e,n,r,i,o,a,l):C(t,e,l)},A=(t,e,n,r,i,o,a)=>{const s=t.component=function(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||mX,o={uid:yX++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new D$(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oq(r,i),emitsOptions:Bq(r,i),emit:null,emitted:null,propsDefaults:zW,inheritAttrs:r.inheritAttrs,ctx:zW,data:zW,props:zW,attrs:zW,slots:zW,refs:zW,setupState:zW,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};"production"!==FW.NODE_ENV?o.ctx=function(t){const e={};return Object.defineProperty(e,"_",{configurable:!0,enumerable:!1,get:()=>t}),Object.keys(AY).forEach((n=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,get:()=>AY[n](t),set:GW})})),e}(o):o.ctx={_:o};o.root=e?e.root:o,o.emit=Fq.bind(null,o),t.ce&&t.ce(o);return o}(t,r,i);if("production"!==FW.NODE_ENV&&s.type.__hmrId&&function(t){const e=t.type.__hmrId;let n=jU.get(e);n||(FU(e,t.type),n=jU.get(e)),n.instances.add(t)}(s),"production"!==FW.NODE_ENV&&(cU(t),Eq(s,"mount")),hY(t)&&(s.ctx.renderer=U),"production"!==FW.NODE_ENV&&Eq(s,"init"),function(t,e=!1,n=!1){e&&EX(e);const{props:r,children:i}=t.vnode,o=OX(t);eq(t,r,o,e),((t,e,n)=>{const r=t.slots=QY();if(32&t.vnode.shapeFlag){const t=e._;t?(yq(r,e,n),n&&y$(r,"_",t,!0)):vq(e,r)}else e&&mq(t,e)})(t,i,n);const a=o?function(t,e){var n;const r=t.type;if("production"!==FW.NODE_ENV){if(r.name&&NX(r.name,t.appContext.config),r.components){const e=Object.keys(r.components);for(let n=0;n<e.length;n++)NX(e[n],t.appContext.config)}if(r.directives){const t=Object.keys(r.directives);for(let e=0;e<t.length;e++)rY(t[e])}r.compilerOptions&&AX()&&dU('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,DY),"production"===FW.NODE_ENV||function(t){const{ctx:e,propsOptions:[n]}=t;n&&Object.keys(n).forEach((n=>{Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>t.props[n],set:GW})}))}(t);const{setup:i}=r;if(i){K$();const o=t.setupContext=i.length>1?function(t){const e=e=>{if("production"!==FW.NODE_ENV&&(t.exposed&&dU("expose() should be called only once per setup()."),null!=e)){let t=typeof e;"object"===t&&(KW(e)?t="array":QH(e)&&(t="ref")),"object"!==t&&dU(`expose() should be passed a plain object, received ${t}.`)}t.exposed=e||{}};if("production"!==FW.NODE_ENV){let n,r;return Object.freeze({get attrs(){return n||(n=new Proxy(t.attrs,PX))},get slots(){return r||(r=function(t){return new Proxy(t.slots,{get:(e,n)=>(sH(t,"get","$slots"),e[n])})}(t))},get emit(){return(e,...n)=>t.emit(e,...n)},expose:e})}return{attrs:new Proxy(t.attrs,PX),slots:t.slots,emit:t.emit,expose:e}}(t):null,a=wX(t),s=vU(i,t,0,["production"!==FW.NODE_ENV?$H(t.props):t.props,o]),l=n$(s);if(Z$(),a(),!l&&!t.sp||uY(t)||sY(t),l){if(s.then(kX,kX),e)return s.then((n=>{_X(t,n,e)})).catch((e=>{yU(e,t,0)}));if(t.asyncDep=s,"production"!==FW.NODE_ENV&&!t.suspense){dU(`Component <${null!=(n=r.name)?n:"Anonymous"}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else _X(t,s,e)}else CX(t,e)}(t,e):void 0;e&&EX(!1)}(s,!1,a),"production"!==FW.NODE_ENV&&wq(s,"init"),s.asyncDep){if("production"!==FW.NODE_ENV&&LU&&(t.el=null),i&&i.registerDep(s,P,a),!t.el){const t=s.subTree=lX(Qq);v(null,t,e,n)}}else P(s,t,e,n,i,o,a);"production"!==FW.NODE_ENV&&(uU(),wq(s,"mount"))},C=(t,e,n)=>{const r=e.component=t.component;if(function(t,e,n){const{props:r,children:i,component:o}=t,{props:a,children:s,patchFlag:l}=e,c=o.emitsOptions;if("production"!==FW.NODE_ENV&&(i||s)&&LU)return!0;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!i&&!s||s&&s.$stable)||r!==a&&(r?!a||Xq(r,a,c):!!a);if(1024&l)return!0;if(16&l)return r?Xq(r,a,c):!!a;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(a[n]!==r[n]&&!zq(c,n))return!0}}return!1}(t,e,n)){if(r.asyncDep&&!r.asyncResolved)return"production"!==FW.NODE_ENV&&cU(e),D(r,e,n),void("production"!==FW.NODE_ENV&&uU());r.next=e,r.update()}else e.el=t.el,r.vnode=e},P=(t,e,n,r,i,o,a)=>{const s=()=>{if(t.isMounted){let{next:e,bu:n,u:r,parent:l,vnode:c}=t;{const n=_q(t);if(n)return e&&(e.el=c.el,D(t,e,a)),void n.asyncDep.then((()=>{t.isUnmounted||s()}))}let h,d=e;"production"!==FW.NODE_ENV&&cU(e||t.vnode),Sq(t,!1),e?(e.el=c.el,D(t,e,a)):e=c,n&&m$(n),(h=e.props&&e.props.onVnodeBeforeUpdate)&&vX(h,l,e,c),Sq(t,!0),"production"!==FW.NODE_ENV&&Eq(t,"render");const f=Wq(t);"production"!==FW.NODE_ENV&&wq(t,"render");const g=t.subTree;t.subTree=f,"production"!==FW.NODE_ENV&&Eq(t,"patch"),p(g,f,u(g.el),W(g),t,i,o),"production"!==FW.NODE_ENV&&wq(t,"patch"),e.el=f.el,null===d&&function({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r!==t)break;(t=e.vnode).el=n,e=e.parent}}(t,f.el),r&&Mq(r,i),(h=e.props&&e.props.onVnodeUpdated)&&Mq((()=>vX(h,l,e,c)),i),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&qU(t),"production"!==FW.NODE_ENV&&uU()}else{let a;const{el:s,props:l}=e,{bm:c,m:u,parent:h,root:d,type:f}=t,g=uY(e);if(Sq(t,!1),c&&m$(c),!g&&(a=l&&l.onVnodeBeforeMount)&&vX(a,h,e),Sq(t,!0),s&&q){const e=()=>{"production"!==FW.NODE_ENV&&Eq(t,"render"),t.subTree=Wq(t),"production"!==FW.NODE_ENV&&wq(t,"render"),"production"!==FW.NODE_ENV&&Eq(t,"hydrate"),q(s,t.subTree,t,i,null),"production"!==FW.NODE_ENV&&wq(t,"hydrate")};g&&f.__asyncHydrate?f.__asyncHydrate(s,t,e):e()}else{d.ce&&d.ce._injectChildStyle(f),"production"!==FW.NODE_ENV&&Eq(t,"render");const a=t.subTree=Wq(t);"production"!==FW.NODE_ENV&&wq(t,"render"),"production"!==FW.NODE_ENV&&Eq(t,"patch"),p(null,a,n,r,t,i,o),"production"!==FW.NODE_ENV&&wq(t,"patch"),e.el=a.el}if(u&&Mq(u,i),!g&&(a=l&&l.onVnodeMounted)){const t=e;Mq((()=>vX(a,h,t)),i)}(256&e.shapeFlag||h&&uY(h.vnode)&&256&h.vnode.shapeFlag)&&t.a&&Mq(t.a,i),t.isMounted=!0,("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&YU(t),e=n=r=null}};t.scope.on();const l=t.effect=new L$(s);t.scope.off();const c=t.update=l.run.bind(l),h=t.job=l.runIfDirty.bind(l);h.i=t,h.id=t.uid,l.scheduler=()=>SU(h),Sq(t,!0),"production"!==FW.NODE_ENV&&(l.onTrack=t.rtc?e=>m$(t.rtc,e):void 0,l.onTrigger=t.rtg?e=>m$(t.rtg,e):void 0),c()},D=(t,e,n)=>{e.component=t;const r=t.vnode.props;t.vnode=e,t.next=null,function(t,e,n,r){const{props:i,attrs:o,vnode:{patchFlag:a}}=t,s=KH(i),[l]=t.propsOptions;let c=!1;if("production"!==FW.NODE_ENV&&function(t){for(;t;){if(t.type.__hmrId)return!0;t=t.parent}}(t)||!(r||a>0)||16&a){let r;nq(t,e,i,o)&&(c=!0);for(const o in s)e&&(XW(e,o)||(r=f$(o))!==o&&XW(e,r))||(l?!n||void 0===n[o]&&void 0===n[r]||(i[o]=rq(l,s,o,void 0,t,!0)):delete i[o]);if(o!==s)for(const t in o)e&&XW(e,t)||(delete o[t],c=!0)}else if(8&a){const n=t.vnode.dynamicProps;for(let r=0;r<n.length;r++){let a=n[r];if(zq(t.emitsOptions,a))continue;const u=e[a];if(l)if(XW(o,a))u!==o[a]&&(o[a]=u,c=!0);else{const e=h$(a);i[e]=rq(l,s,e,u,t,!1)}else u!==o[a]&&(o[a]=u,c=!0)}}c&&lH(t.attrs,"set",""),"production"!==FW.NODE_ENV&&sq(e||{},i,t)}(t,e.props,r,n),((t,e,n)=>{const{vnode:r,slots:i}=t;let o=!0,a=zW;if(32&r.shapeFlag){const r=e._;r?"production"!==FW.NODE_ENV&&LU?(yq(i,e,n),lH(t,"set","$slots")):n&&1===r?o=!1:yq(i,e,n):(o=!e.$stable,vq(e,i)),a=e}else e&&(mq(t,e),a={default:1});if(o)for(const t in i)fq(t)||null!=a[t]||delete i[t]})(t,e.children,n),K$(),AU(t),Z$()},R=(t,e,n,r,i,o,a,s,l=!1)=>{const u=t&&t.children,h=t?t.shapeFlag:0,d=e.children,{patchFlag:f,shapeFlag:p}=e;if(f>0){if(128&f)return void I(u,d,n,r,i,o,a,s,l);if(256&f)return void L(u,d,n,r,i,o,a,s,l)}8&p?(16&h&&G(u,i,o),d!==u&&c(n,d)):16&h?16&p?I(u,d,n,r,i,o,a,s,l):G(u,i,o,!0):(8&h&&c(n,""),16&p&&M(d,n,r,i,o,a,s,l))},L=(t,e,n,r,i,o,a,s,l)=>{e=e||VW;const c=(t=t||VW).length,u=e.length,h=Math.min(c,u);let d;for(d=0;d<h;d++){const r=e[d]=l?pX(e[d]):fX(e[d]);p(t[d],r,n,null,i,o,a,s,l)}c>u?G(t,i,o,!0,!1,h):M(e,n,r,i,o,a,s,l,h)},I=(t,e,n,r,i,o,a,s,l)=>{let c=0;const u=e.length;let h=t.length-1,d=u-1;for(;c<=h&&c<=d;){const r=t[c],u=e[c]=l?pX(e[c]):fX(e[c]);if(!oX(r,u))break;p(r,u,n,null,i,o,a,s,l),c++}for(;c<=h&&c<=d;){const r=t[h],c=e[d]=l?pX(e[d]):fX(e[d]);if(!oX(r,c))break;p(r,c,n,null,i,o,a,s,l),h--,d--}if(c>h){if(c<=d){const t=d+1,h=t<u?e[t].el:r;for(;c<=d;)p(null,e[c]=l?pX(e[c]):fX(e[c]),n,h,i,o,a,s,l),c++}}else if(c>d)for(;c<=h;)F(t[c],i,o,!0),c++;else{const f=c,g=c,v=new Map;for(c=g;c<=d;c++){const t=e[c]=l?pX(e[c]):fX(e[c]);null!=t.key&&("production"!==FW.NODE_ENV&&v.has(t.key)&&dU("Duplicate keys found during update:",JSON.stringify(t.key),"Make sure keys are unique."),v.set(t.key,c))}let m,y=0;const b=d-g+1;let x=!1,E=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=f;c<=h;c++){const r=t[c];if(y>=b){F(r,i,o,!0);continue}let u;if(null!=r.key)u=v.get(r.key);else for(m=g;m<=d;m++)if(0===w[m-g]&&oX(r,e[m])){u=m;break}void 0===u?F(r,i,o,!0):(w[u-g]=c+1,u>=E?E=u:x=!0,p(r,e[u],n,null,i,o,a,s,l),y++)}const k=x?function(t){const e=t.slice(),n=[0];let r,i,o,a,s;const l=t.length;for(r=0;r<l;r++){const l=t[r];if(0!==l){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}for(o=0,a=n.length-1;o<a;)s=o+a>>1,t[n[s]]<l?o=s+1:a=s;l<t[n[o]]&&(o>0&&(e[r]=n[o-1]),n[o]=r)}}o=n.length,a=n[o-1];for(;o-- >0;)n[o]=a,a=e[a];return n}(w):VW;for(m=k.length-1,c=b-1;c>=0;c--){const t=g+c,h=e[t],d=t+1<u?e[t+1].el:r;0===w[c]?p(null,h,n,d,i,o,a,s,l):x&&(m<0||c!==k[m]?j(h,n,d,2):m--)}}},j=(t,e,r,i,o=null)=>{const{el:a,type:s,transition:l,children:c,shapeFlag:u}=t;if(6&u)return void j(t.component.subTree,e,r,i);if(128&u)return void t.suspense.move(e,r,i);if(64&u)return void s.move(t,e,r,U);if(s===Zq){n(a,e,r);for(let t=0;t<c.length;t++)j(c[t],e,r,i);return void n(t.anchor,e,r)}if(s===tX)return void b(t,e,r);if(2!==i&&1&u&&l)if(0===i)l.beforeEnter(a),n(a,e,r),Mq((()=>l.enter(a)),o);else{const{leave:t,delayLeave:i,afterLeave:o}=l,s=()=>n(a,e,r),c=()=>{t(a,(()=>{s(),o&&o()}))};i?i(a,s,c):c()}else n(a,e,r)},F=(t,e,n,r=!1,i=!1)=>{const{type:o,props:a,ref:s,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:h,dirs:d,cacheIndex:f}=t;if(-2===h&&(i=!1),null!=s&&cY(s,null,n,t,!0),null!=f&&(e.renderCache[f]=void 0),256&u)return void e.ctx.deactivate(t);const p=1&u&&d,g=!uY(t);let v;if(g&&(v=a&&a.onVnodeBeforeUnmount)&&vX(v,e,t),6&u)V(t.component,n,r);else{if(128&u)return void t.suspense.unmount(n,r);p&&iY(t,null,e,"beforeUnmount"),64&u?t.type.remove(t,e,n,U,r):c&&!c.hasOnce&&(o!==Zq||h>0&&64&h)?G(c,e,n,!1,!0):(o===Zq&&384&h||!i&&16&u)&&G(l,e,n),r&&B(t)}(g&&(v=a&&a.onVnodeUnmounted)||p)&&Mq((()=>{v&&vX(v,e,t),p&&iY(t,null,e,"unmounted")}),n)},B=t=>{const{type:e,el:n,anchor:i,transition:o}=t;if(e===Zq)return void("production"!==FW.NODE_ENV&&t.patchFlag>0&&2048&t.patchFlag&&o&&!o.persisted?t.children.forEach((t=>{t.type===Qq?r(t.el):B(t)})):z(n,i));if(e===tX)return void x(t);const a=()=>{r(n),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&t.shapeFlag&&o&&!o.persisted){const{leave:e,delayLeave:r}=o,i=()=>e(n,a);r?r(t.el,a,i):i()}else a()},z=(t,e)=>{let n;for(;t!==e;)n=h(t),r(t),t=n;r(e)},V=(t,e,n)=>{"production"!==FW.NODE_ENV&&t.type.__hmrId&&function(t){jU.get(t.type.__hmrId).instances.delete(t)}(t);const{bum:r,scope:i,job:o,subTree:a,um:s,m:l,a:c}=t;var u;Aq(l),Aq(c),r&&m$(r),i.stop(),o&&(o.flags|=8,F(a,t,e,n)),s&&Mq(s,e),Mq((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve()),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(u=t,GU&&"function"==typeof GU.cleanupBuffer&&!GU.cleanupBuffer(u)&&XU(u))},G=(t,e,n,r=!1,i=!1,o=0)=>{for(let a=o;a<t.length;a++)F(t[a],e,n,r,i)},W=t=>{if(6&t.shapeFlag)return W(t.component.subTree);if(128&t.shapeFlag)return t.suspense.next();const e=h(t.anchor||t.el),n=e&&e[oY];return n?h(n):e};let $=!1;const H=(t,e,n)=>{null==t?e._vnode&&F(e._vnode,null,null,!0):p(e._vnode||null,t,e,null,null,null,n),e._vnode=t,$||($=!0,AU(),CU(),$=!1)},U={p:p,um:F,m:j,r:B,mt:A,mc:M,pc:R,pbc:O,n:W,o:t};let Y,q;return{render:H,hydrate:Y,createApp:XY(H,Y)}}(t)}function Oq({type:t,props:e},n){return"svg"===n&&"foreignObject"===t||"mathml"===n&&"annotation-xml"===t&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Sq({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Tq(t,e,n=!1){const r=t.children,i=e.children;if(KW(r)&&KW(i))for(let t=0;t<r.length;t++){const e=r[t];let o=i[t];1&o.shapeFlag&&!o.dynamicChildren&&((o.patchFlag<=0||32===o.patchFlag)&&(o=i[t]=pX(i[t]),o.el=e.el),n||-2===o.patchFlag||Tq(e,o)),o.type===Jq&&(o.el=e.el),"production"===FW.NODE_ENV||o.type!==Qq||o.el||(o.el=e.el)}}function _q(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_q(e)}function Aq(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Cq=Symbol.for("v-scx"),Pq=()=>{{const t=ZY(Cq);return t||"production"!==FW.NODE_ENV&&dU("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),t}};function Dq(t,e,n){return"production"===FW.NODE_ENV||JW(e)||dU("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),Rq(t,e,n)}function Rq(t,e,n=zW){const{immediate:r,deep:i,flush:o,once:a}=n;"production"===FW.NODE_ENV||e||(void 0!==r&&dU('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),void 0!==i&&dU('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'),void 0!==a&&dU('watch() "once" option is only respected when using the watch(source, callback, options?) signature.'));const s=UW({},n);"production"!==FW.NODE_ENV&&(s.onWarn=dU);const l=e&&r||!e&&"post"!==o;let c;if(TX)if("sync"===o){const t=Pq();c=t.__watcherHandles||(t.__watcherHandles=[])}else if(!l){const t=()=>{};return t.stop=GW,t.resume=GW,t.pause=GW,t}const u=bX;s.call=(t,e,n)=>mU(t,u,e,n);let h=!1;"post"===o?s.scheduler=t=>{Mq(t,u&&u.suspense)}:"sync"!==o&&(h=!0,s.scheduler=(t,e)=>{e?t():SU(t)}),s.augmentJob=t=>{e&&(t.flags|=4),h&&(t.flags|=2,u&&(t.id=u.uid,t.i=u))};const d=aU(t,e,s);return TX&&(c?c.push(d):l&&d()),d}function Lq(t,e,n){const r=this.proxy,i=QW(t)?t.includes(".")?Iq(r,t):()=>r[t]:t.bind(r,r);let o;JW(e)?o=e:(o=e.handler,n=e);const a=wX(this),s=Rq(i,o.bind(r),n);return a(),s}function Iq(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}const jq=(t,e)=>"modelValue"===e||"model-value"===e?t.modelModifiers:t[`${e}Modifiers`]||t[`${h$(e)}Modifiers`]||t[`${f$(e)}Modifiers`];function Fq(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||zW;if("production"!==FW.NODE_ENV){const{emitsOptions:r,propsOptions:[i]}=t;if(r)if(e in r){const t=r[e];if(JW(t)){t(...n)||dU(`Invalid event arguments: event validation failed for event "${e}".`)}}else i&&g$(h$(e))in i||dU(`Component emitted event "${e}" but it is neither declared in the emits option nor as an "${g$(h$(e))}" prop.`)}let i=n;const o=e.startsWith("update:"),a=o&&jq(r,e.slice(7));if(a&&(a.trim&&(i=n.map((t=>QW(t)?t.trim():t))),a.number&&(i=n.map(b$))),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&function(t,e,n){HU("component:emit",t.appContext.app,t,e,n)}(t,e,i),"production"!==FW.NODE_ENV){const n=e.toLowerCase();n!==e&&r[g$(n)]&&dU(`Event "${n}" is emitted in component ${jX(t,t.type)} but the handler is registered for "${e}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${f$(e)}" instead of "${e}".`)}let s,l=r[s=g$(e)]||r[s=g$(h$(e))];!l&&o&&(l=r[s=g$(f$(e))]),l&&mU(l,t,6,i);const c=r[s+"Once"];if(c){if(t.emitted){if(t.emitted[s])return}else t.emitted={};t.emitted[s]=!0,mU(c,t,6,i)}}function Bq(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(void 0!==i)return i;const o=t.emits;let a={},s=!1;if(__VUE_OPTIONS_API__&&!JW(t)){const r=t=>{const n=Bq(t,e,!0);n&&(s=!0,UW(a,n))};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}return o||s?(KW(o)?o.forEach((t=>a[t]=null)):UW(a,o),e$(t)&&r.set(t,a),a):(e$(t)&&r.set(t,null),null)}function zq(t,e){return!(!t||!$W(e))&&(e=e.slice(2).replace(/Once$/,""),XW(t,e[0].toLowerCase()+e.slice(1))||XW(t,f$(e))||XW(t,e))}let Vq=!1;function Gq(){Vq=!0}function Wq(t){const{type:e,vnode:n,proxy:r,withProxy:i,propsOptions:[o],slots:a,attrs:s,emit:l,render:c,renderCache:u,props:h,data:d,setupState:f,ctx:p,inheritAttrs:g}=t,v=nY(t);let m,y;"production"!==FW.NODE_ENV&&(Vq=!1);try{if(4&n.shapeFlag){const t=i||r,e="production"!==FW.NODE_ENV&&f.__isScriptSetup?new Proxy(t,{get:(t,e,n)=>(dU(`Property '${String(e)}' was accessed via 'this'. Avoid using 'this' in templates.`),Reflect.get(t,e,n))}):t;m=fX(c.call(e,t,u,"production"!==FW.NODE_ENV?$H(h):h,f,d,p)),y=s}else{const t=e;"production"!==FW.NODE_ENV&&s===h&&Gq(),m=fX(t.length>1?t("production"!==FW.NODE_ENV?$H(h):h,"production"!==FW.NODE_ENV?{get attrs(){return Gq(),$H(s)},slots:a,emit:l}:{attrs:s,slots:a,emit:l}):t("production"!==FW.NODE_ENV?$H(h):h,null)),y=e.props?s:Uq(s)}}catch(e){yU(e,t,1),m=lX(Qq)}let b,x=m;if("production"!==FW.NODE_ENV&&m.patchFlag>0&&2048&m.patchFlag&&([x,b]=$q(m)),y&&!1!==g){const t=Object.keys(y),{shapeFlag:e}=x;if(t.length)if(7&e)o&&t.some(HW)&&(y=Yq(y,o)),x=uX(x,y,!1,!0);else if("production"!==FW.NODE_ENV&&!Vq&&x.type!==Qq){const t=Object.keys(s),e=[],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];$W(i)?HW(i)||e.push(i[2].toLowerCase()+i.slice(3)):n.push(i)}n.length&&dU(`Extraneous non-props attributes (${n.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.`),e.length&&dU(`Extraneous non-emits event listeners (${e.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}return n.dirs&&("production"===FW.NODE_ENV||qq(x)||dU("Runtime directive used on component with non-element root node. The directives will not function as intended."),x=uX(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&("production"===FW.NODE_ENV||qq(x)||dU("Component inside <Transition> renders non-element root node that cannot be animated."),aY(x,n.transition)),"production"!==FW.NODE_ENV&&b?b(x):m=x,nY(v),m}const $q=t=>{const e=t.children,n=t.dynamicChildren,r=Hq(e,!1);if(!r)return[t,void 0];if("production"!==FW.NODE_ENV&&r.patchFlag>0&&2048&r.patchFlag)return $q(r);const i=e.indexOf(r),o=n?n.indexOf(r):-1;return[fX(r),r=>{e[i]=r,n&&(o>-1?n[o]=r:r.patchFlag>0&&(t.dynamicChildren=[...n,r]))}]};function Hq(t,e=!0){let n;for(let r=0;r<t.length;r++){const i=t[r];if(!iX(i))return;if(i.type!==Qq||"v-if"===i.children){if(n)return;if(n=i,"production"!==FW.NODE_ENV&&e&&n.patchFlag>0&&2048&n.patchFlag)return Hq(n.children)}}return n}const Uq=t=>{let e;for(const n in t)("class"===n||"style"===n||$W(n))&&((e||(e={}))[n]=t[n]);return e},Yq=(t,e)=>{const n={};for(const r in t)HW(r)&&r.slice(9)in e||(n[r]=t[r]);return n},qq=t=>7&t.shapeFlag||t.type===Qq;function Xq(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const o=r[i];if(e[o]!==t[o]&&!zq(n,o))return!0}return!1}const Kq=t=>t.__isSuspense;const Zq=Symbol.for("v-fgt"),Jq=Symbol.for("v-txt"),Qq=Symbol.for("v-cmt"),tX=Symbol.for("v-stc");let eX=null,nX=1;function rX(t){nX+=t,t<0&&eX&&(eX.hasOnce=!0)}function iX(t){return!!t&&!0===t.__v_isVNode}function oX(t,e){if("production"!==FW.NODE_ENV&&6&e.shapeFlag&&t.component){const n=IU.get(e.type);if(n&&n.has(t.component))return t.shapeFlag&=-257,e.shapeFlag&=-513,!1}return t.type===e.type&&t.key===e.key}const aX=({key:t})=>null!=t?t:null,sX=({ref:t,ref_key:e,ref_for:n})=>("number"==typeof t&&(t=""+t),null!=t?QW(t)||QH(t)||JW(t)?{i:tY,r:t,k:e,f:!!n}:t:null);const lX="production"!==FW.NODE_ENV?(...t)=>cX(...t):cX;function cX(t,e=null,n=null,r=0,i=null,o=!1){if(t&&t!==TY||("production"===FW.NODE_ENV||t||dU(`Invalid vnode type when creating vnode: ${t}.`),t=Qq),iX(t)){const r=uX(t,e,!0);return n&&gX(r,n),nX>0&&!o&&eX&&(6&r.shapeFlag?eX[eX.indexOf(t)]=r:eX.push(r)),r.patchFlag=-2,r}if(FX(t)&&(t=t.__vccOpts),e){e=function(t){return t?XH(t)||tq(t)?UW({},t):t:null}(e);let{class:t,style:n}=e;t&&!QW(t)&&(e.class=S$(t)),e$(n)&&(XH(n)&&!KW(n)&&(n=UW({},n)),e.style=w$(n))}const a=QW(t)?1:Kq(t)?128:(t=>t.__isTeleport)(t)?64:e$(t)?4:JW(t)?2:0;return"production"!==FW.NODE_ENV&&4&a&&XH(t)&&dU("Vue received a Component that was made a reactive object. This can lead to unnecessary performance overhead and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.","\nComponent that was made reactive: ",t=KH(t)),function(t,e=null,n=null,r=0,i=null,o=(t===Zq?0:1),a=!1,s=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&aX(e),ref:e&&sX(e),scopeId:eY,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:tY};return s?(gX(l,n),128&o&&t.normalize(l)):n&&(l.shapeFlag|=QW(n)?8:16),"production"!==FW.NODE_ENV&&l.key!=l.key&&dU("VNode created with invalid key (NaN). VNode type:",l.type),nX>0&&!a&&eX&&(l.patchFlag>0||6&o)&&32!==l.patchFlag&&eX.push(l),l}(t,e,n,r,i,a,o,!0)}function uX(t,e,n=!1,r=!1){const{props:i,ref:o,patchFlag:a,children:s,transition:l}=t,c=e?function(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const t in r)if("class"===t)e.class!==r.class&&(e.class=S$([e.class,r.class]));else if("style"===t)e.style=w$([e.style,r.style]);else if($W(t)){const n=e[t],i=r[t];!i||n===i||KW(n)&&n.includes(i)||(e[t]=n?[].concat(n,i):i)}else""!==t&&(e[t]=r[t])}return e}(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&aX(c),ref:e&&e.ref?n&&o?KW(o)?o.concat(sX(e)):[o,sX(e)]:sX(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:"production"!==FW.NODE_ENV&&-1===a&&KW(s)?s.map(hX):s,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Zq?-1===a?16:16|a:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&uX(t.ssContent),ssFallback:t.ssFallback&&uX(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&r&&aY(u,l.clone(u)),u}function hX(t){const e=uX(t);return KW(t.children)&&(e.children=t.children.map(hX)),e}function dX(t=" ",e=0){return lX(Jq,null,t,e)}function fX(t){return null==t||"boolean"==typeof t?lX(Qq):KW(t)?lX(Zq,null,t.slice()):iX(t)?pX(t):lX(Jq,null,String(t))}function pX(t){return null===t.el&&-1!==t.patchFlag||t.memo?t:uX(t)}function gX(t,e){let n=0;const{shapeFlag:r}=t;if(null==e)e=null;else if(KW(e))n=16;else if("object"==typeof e){if(65&r){const n=e.default;return void(n&&(n._c&&(n._d=!1),gX(t,n()),n._c&&(n._d=!0)))}{n=32;const r=e._;r||tq(e)?3===r&&tY&&(1===tY.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=tY}}else JW(e)?(e={default:e,_ctx:tY},n=32):(e=String(e),64&r?(n=16,e=[dX(e)]):n=8);t.children=e,t.shapeFlag|=n}function vX(t,e,n,r=null){mU(t,e,7,[n,r])}const mX=YY();let yX=0;let bX=null;let xX,EX;{const t=E$(),e=(e,n)=>{let r;return(r=t[e])||(r=t[e]=[]),r.push(n),t=>{r.length>1?r.forEach((e=>e(t))):r[0](t)}};xX=e("__VUE_INSTANCE_SETTERS__",(t=>bX=t)),EX=e("__VUE_SSR_SETTERS__",(t=>TX=t))}const wX=t=>{const e=bX;return xX(t),t.scope.on(),()=>{t.scope.off(),xX(e)}},kX=()=>{bX&&bX.scope.off(),xX(null)},MX=BW("slot,component");function NX(t,{isNativeTag:e}){(MX(t)||e(t))&&dU("Do not use built-in or reserved HTML elements as component id: "+t)}function OX(t){return 4&t.vnode.shapeFlag}let SX,TX=!1;function _X(t,e,n){JW(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:e$(e)?("production"!==FW.NODE_ENV&&iX(e)&&dU("setup() should not return VNodes directly - return a render function instead."),("production"!==FW.NODE_ENV||__VUE_PROD_DEVTOOLS__)&&(t.devtoolsRawSetupState=e),t.setupState=eU(e),"production"!==FW.NODE_ENV&&function(t){const{ctx:e,setupState:n}=t;Object.keys(KH(n)).forEach((t=>{if(!n.__isScriptSetup){if(CY(t[0]))return void dU(`setup() return property ${JSON.stringify(t)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:()=>n[t],set:GW})}}))}(t)):"production"!==FW.NODE_ENV&&void 0!==e&&dU("setup() should return an object. Received: "+(null===e?"null":typeof e)),CX(t,n)}const AX=()=>!SX;function CX(t,e,n){const r=t.type;if(!t.render){if(!e&&SX&&!r.render){const e=r.template||BY(t).template;if(e){"production"!==FW.NODE_ENV&&Eq(t,"compile");const{isCustomElement:n,compilerOptions:i}=t.appContext.config,{delimiters:o,compilerOptions:a}=r,s=UW(UW({isCustomElement:n,delimiters:o},i),a);r.render=SX(e,s),"production"!==FW.NODE_ENV&&wq(t,"compile")}}t.render=r.render||GW}if(__VUE_OPTIONS_API__){const e=wX(t);K$();try{IY(t)}finally{Z$(),e()}}"production"===FW.NODE_ENV||r.render||t.render!==GW||e||(r.template?dU('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):dU("Component is missing template or render function: ",r))}const PX="production"!==FW.NODE_ENV?{get:(t,e)=>(Gq(),sH(t,"get",""),t[e]),set:()=>(dU("setupContext.attrs is readonly."),!1),deleteProperty:()=>(dU("setupContext.attrs is readonly."),!1)}:{get:(t,e)=>(sH(t,"get",""),t[e])};function DX(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(eU((e=t.exposed,!XW(e,"__v_skip")&&Object.isExtensible(e)&&y$(e,"__v_skip",!0),e)),{get:(e,n)=>n in e?e[n]:n in AY?AY[n](t):void 0,has:(t,e)=>e in t||e in AY})):t.proxy;var e}const RX=/(?:^|[-_])(\w)/g,LX=t=>t.replace(RX,(t=>t.toUpperCase())).replace(/[-_]/g,"");function IX(t,e=!0){return JW(t)?t.displayName||t.name:t.name||e&&t.__name}function jX(t,e,n=!1){let r=IX(e);if(!r&&e.__file){const t=e.__file.match(/([^/\\]+)\.\w+$/);t&&(r=t[1])}if(!r&&t&&t.parent){const n=t=>{for(const n in t)if(t[n]===e)return n};r=n(t.components||t.parent.type.components)||n(t.appContext.components)}return r?LX(r):n?"App":"Anonymous"}function FX(t){return JW(t)&&"__vccOpts"in t}const BX=(t,e)=>{const n=function(t,e,n=!1){let r,i;JW(t)?r=t:(r=t.get,i=t.set);const o=new nU(r,i,n);return"production"!==FW.NODE_ENV&&e&&!n&&(o.onTrack=e.onTrack,o.onTrigger=e.onTrigger),o}(t,e,TX);if("production"!==FW.NODE_ENV){const t=bX||tY;t&&t.appContext.config.warnRecursiveComputed&&(n._warnRecursive=!0)}return n};const zX="3.5.12",VX="production"!==FW.NODE_ENV?dU:GW;let GX;const WX="undefined"!=typeof window&&window.trustedTypes;if(WX)try{GX=WX.createPolicy("vue",{createHTML:t=>t})}catch(t){"production"!==FW.NODE_ENV&&VX(`Error creating trusted types policy: ${t}`)}const $X=GX?t=>GX.createHTML(t):t=>t,HX="undefined"!=typeof document?document:null,UX=HX&&HX.createElement("template"),YX={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i="svg"===e?HX.createElementNS("http://www.w3.org/2000/svg",t):"mathml"===e?HX.createElementNS("http://www.w3.org/1998/Math/MathML",t):n?HX.createElement(t,{is:n}):HX.createElement(t);return"select"===t&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:t=>HX.createTextNode(t),createComment:t=>HX.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>HX.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,o){const a=n?n.previousSibling:e.lastChild;if(i&&(i===o||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),i!==o&&(i=i.nextSibling););else{UX.innerHTML=$X("svg"===r?`<svg>${t}</svg>`:"mathml"===r?`<math>${t}</math>`:t);const i=UX.content;if("svg"===r||"mathml"===r){const t=i.firstChild;for(;t.firstChild;)i.appendChild(t.firstChild);i.removeChild(t)}e.insertBefore(i,n)}return[a?a.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},qX=Symbol("_vtc");const XX=Symbol("_vod"),KX=Symbol("_vsh"),ZX=Symbol("production"!==FW.NODE_ENV?"CSS_VAR_TEXT":""),JX=/(^|;)\s*display\s*:/;const QX=/[^\\];\s*$/,tK=/\s*!important$/;function eK(t,e,n){if(KW(n))n.forEach((n=>eK(t,e,n)));else if(null==n&&(n=""),"production"!==FW.NODE_ENV&&QX.test(n)&&VX(`Unexpected semicolon at the end of '${e}' style value: '${n}'`),e.startsWith("--"))t.setProperty(e,n);else{const r=function(t,e){const n=rK[e];if(n)return n;let r=h$(e);if("filter"!==r&&r in t)return rK[e]=r;r=p$(r);for(let n=0;n<nK.length;n++){const i=nK[n]+r;if(i in t)return rK[e]=i}return e}(t,e);tK.test(n)?t.setProperty(f$(r),n.replace(tK,""),"important"):t[r]=n}}const nK=["Webkit","Moz","ms"],rK={};const iK="http://www.w3.org/1999/xlink";function oK(t,e,n,r,i,o=T$(e)){r&&e.startsWith("xlink:")?null==n?t.removeAttributeNS(iK,e.slice(6,e.length)):t.setAttributeNS(iK,e,n):null==n||o&&!_$(n)?t.removeAttribute(e):t.setAttribute(e,o?"":t$(n)?String(n):n)}function aK(t,e,n,r,i){if("innerHTML"===e||"textContent"===e)return void(null!=n&&(t[e]="innerHTML"===e?$X(n):n));const o=t.tagName;if("value"===e&&"PROGRESS"!==o&&!o.includes("-")){const r="OPTION"===o?t.getAttribute("value")||"":t.value,i=null==n?"checkbox"===t.type?"on":"":String(n);return r===i&&"_value"in t||(t.value=i),null==n&&t.removeAttribute(e),void(t._value=n)}let a=!1;if(""===n||null==n){const r=typeof t[e];"boolean"===r?n=_$(n):null==n&&"string"===r?(n="",a=!0):"number"===r&&(n=0,a=!0)}try{t[e]=n}catch(t){"production"===FW.NODE_ENV||a||VX(`Failed setting prop "${e}" on <${o.toLowerCase()}>: value ${n} is invalid.`,t)}a&&t.removeAttribute(i||e)}const sK=Symbol("_vei");function lK(t,e,n,r,i=null){const o=t[sK]||(t[sK]={}),a=o[e];if(r&&a)a.value="production"!==FW.NODE_ENV?fK(r,e):r;else{const[n,s]=function(t){let e;if(cK.test(t)){let n;for(e={};n=t.match(cK);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}const n=":"===t[2]?t.slice(3):f$(t.slice(2));return[n,e]}(e);if(r){const a=o[e]=function(t,e){const n=t=>{if(t._vts){if(t._vts<=n.attached)return}else t._vts=Date.now();mU(function(t,e){if(KW(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}(t,n.value),e,5,[t])};return n.value=t,n.attached=dK(),n}("production"!==FW.NODE_ENV?fK(r,e):r,i);!function(t,e,n,r){t.addEventListener(e,n,r)}(t,n,a,s)}else a&&(!function(t,e,n,r){t.removeEventListener(e,n,r)}(t,n,a,s),o[e]=void 0)}}const cK=/(?:Once|Passive|Capture)$/;let uK=0;const hK=Promise.resolve(),dK=()=>uK||(hK.then((()=>uK=0)),uK=Date.now());function fK(t,e){return JW(t)||KW(t)?t:(VX(`Wrong type passed as event handler to ${e} - did you forget @ or : in front of your prop?\nExpected function or array of functions, received type ${typeof t}.`),GW)}const pK=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123;const gK=UW({patchProp:(t,e,n,r,i,o)=>{const a="svg"===i;"class"===e?function(t,e,n){const r=t[qX];r&&(e=(e?[e,...r]:[...r]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}(t,r,a):"style"===e?function(t,e,n){const r=t.style,i=QW(n);let o=!1;if(n&&!i){if(e)if(QW(e))for(const t of e.split(";")){const e=t.slice(0,t.indexOf(":")).trim();null==n[e]&&eK(r,e,"")}else for(const t in e)null==n[t]&&eK(r,t,"");for(const t in n)"display"===t&&(o=!0),eK(r,t,n[t])}else if(i){if(e!==n){const t=r[ZX];t&&(n+=";"+t),r.cssText=n,o=JX.test(n)}}else e&&t.removeAttribute("style");XX in t&&(t[XX]=o?r.display:"",t[KX]&&(r.display="none"))}(t,n,r):$W(e)?HW(e)||lK(t,e,0,r,o):("."===e[0]?(e=e.slice(1),1):"^"===e[0]?(e=e.slice(1),0):function(t,e,n,r){if(r)return"innerHTML"===e||"textContent"===e||!!(e in t&&pK(e)&&JW(n));if("spellcheck"===e||"draggable"===e||"translate"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if("width"===e||"height"===e){const e=t.tagName;if("IMG"===e||"VIDEO"===e||"CANVAS"===e||"SOURCE"===e)return!1}if(pK(e)&&QW(n))return!1;return e in t}(t,e,r,a))?(aK(t,e,r),t.tagName.includes("-")||"value"!==e&&"checked"!==e&&"selected"!==e||oK(t,e,r,a,0,"value"!==e)):!t._isVueCE||!/[A-Z]/.test(e)&&QW(r)?("true-value"===e?t._trueValue=r:"false-value"===e&&(t._falseValue=r),oK(t,e,r,a)):aK(t,h$(e),r,0,e)}},YX);let vK;const mK=(...t)=>{(vK||(vK=Nq(gK))).render(...t)};"production"!==FW.NODE_ENV&&function(){if("production"===FW.NODE_ENV||"undefined"==typeof window)return;const t={style:"color:#3ba776"},e={style:"color:#1677ff"},n={style:"color:#f5222d"},r={style:"color:#eb2f96"},i={__vue_custom_formatter:!0,header:e=>e$(e)?e.__isVue?["div",t,"VueInstance"]:QH(e)?["div",{},["span",t,u(e)],"<",s("_value"in e?e._value:e),">"]:UH(e)?["div",{},["span",t,qH(e)?"ShallowReactive":"Reactive"],"<",s(e),">"+(YH(e)?" (readonly)":"")]:YH(e)?["div",{},["span",t,qH(e)?"ShallowReadonly":"Readonly"],"<",s(e),">"]:null:null,hasBody:t=>t&&t.__isVue,body(t){if(t&&t.__isVue)return["div",{},...o(t.$)]}};function o(t){const e=[];t.type.props&&t.props&&e.push(a("props",KH(t.props))),t.setupState!==zW&&e.push(a("setup",t.setupState)),t.data!==zW&&e.push(a("data",KH(t.data)));const n=l(t,"computed");n&&e.push(a("computed",n));const i=l(t,"inject");return i&&e.push(a("injected",i)),e.push(["div",{},["span",{style:r.style+";opacity:0.66"},"$ (internal): "],["object",{object:t}]]),e}function a(t,e){return e=UW({},e),Object.keys(e).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},t],["div",{style:"padding-left:1.25em"},...Object.keys(e).map((t=>["div",{},["span",r,t+": "],s(e[t],!1)]))]]:["span",{}]}function s(t,i=!0){return"number"==typeof t?["span",e,t]:"string"==typeof t?["span",n,JSON.stringify(t)]:"boolean"==typeof t?["span",r,t]:e$(t)?["object",{object:i?KH(t):t}]:["span",n,String(t)]}function l(t,e){const n=t.type;if(JW(n))return;const r={};for(const i in t.ctx)c(n,i,e)&&(r[i]=t.ctx[i]);return r}function c(t,e,n){const r=t[n];return!!(KW(r)&&r.includes(e)||e$(r)&&e in r)||!(!t.extends||!c(t.extends,e,n))||!(!t.mixins||!t.mixins.some((t=>c(t,e,n))))||void 0}function u(t){return qH(t)?"ShallowRef":t.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(i):window.devtoolsFormatters=[i]}();function yK(t){return t}const bK=jr.CIRCLE,xK=jr.ELLIPSE,EK=jr.GROUP,wK=jr.HTML,kK=jr.IMAGE,MK=jr.LINE,NK=jr.PATH,OK=jr.POLYGON,SK=jr.POLYLINE,TK=jr.RECT,_K=jr.TEXT,AK=t=>"on"===t.slice(0,2),CK=t=>t.substring(2).toLowerCase(),PK=Nq({patchProp:function(t,e,n,r,i,o){((t,e,n,r)=>{r!==n&&(r&&(AK(e)?t.removeEventListener(CK(e)):t.removeAttribute(e)),n&&(AK(e)?"function"==typeof n&&t.addEventListener(CK(e),n):t.setAttribute(e,n)))})(t,e,r,n)},insert:function(t,e,n){e.appendChild(t)},remove:function(t){const e=t.parent;null==e||e.removeChild(t)},createElement:function(t,e,n,r){switch(t){case jr.GROUP:return new Fl(r);case jr.TEXT:return new Jl(r);case jr.CIRCLE:return new Rl(r);case jr.RECT:return new Kl(r);case jr.ELLIPSE:return new jl(r);case jr.HTML:return new zl(r);case jr.IMAGE:return new Vl(r);case jr.LINE:return new Wl(r);case jr.PATH:return new Hl(r);case jr.POLYGON:return new Yl(r);case jr.POLYLINE:return new Xl(r)}},createText:function(t){const e=new Jl;return e.textContent=t,e},createComment:function(t){const e=new Jl;return e.textContent=t,e},setText:function(t,e){t.nodeValue=e},setElementText:function(t,e){t.textContent=e},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling}}),DK=new WeakMap,RK=(t,e,n)=>{const r=DK.get(e),i=r||PK.createApp(t);DK.set(e,i),r?PK.render(t,e):i.mount(e)};class LK extends jp{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},LK.defaultStyleProps),t.style)}))}drawKeyShape(t,e){const{component:n}=t,[r,i]=this.getSize();return this.upsert("key",Fl,{width:r,height:i},e,{afterCreate:t=>{RK(n,t)},afterUpdate:t=>{RK(n,t)}})}}LK.defaultStyleProps={halo:!1,label:!1,icon:!1},t.Circle=bK,t.ElementOf=yK,t.Ellipse=xK,t.GVueNode=LK,t.Group=EK,t.HTML=wK,t.Image=kK,t.Line=MK,t.Path=NK,t.Polygon=OK,t.Polyline=SK,t.Rect=TK,t.Text=_K,t.VueNode=class extends Rp{getKeyStyle(t){return Object.assign({},super.getKeyStyle(t))}connectedCallback(){super.connectedCallback();const{component:t}=this.attributes;mK(t,this.getDomElement())}attributeChangedCallback(t,e,n){"component"===t&&e!==n&&(mK(null,this.getDomElement()),setTimeout((()=>{mK(this.attributes.component,this.getDomElement())})))}destroy(){mK(null,this.getDomElement()),super.destroy()}}}));
